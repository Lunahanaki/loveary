<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="apple-touch-icon" href="https://i.postimg.cc/rFfMsSWJ/1.jpg">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">

  <title>Noir搓的小手机</title>
  <style>
    .message p,
    .diary-content {
      user-select: none;
      -webkit-user-select: none;
    }

    .lt-end-session-btn {
      font-size: 1.5rem;
      color: inherit;
      /* 继承父元素的颜色 */
      opacity: 0.6;
      cursor: pointer;
      padding: 0 5px;
      line-height: 1;
      font-weight: bold;
    }

    .lt-end-session-btn:hover {
      opacity: 1;
    }

    /* --- Noir's Refactor: Feed Loader Style --- */
    #feed-loader {
      position: absolute;
      inset: 0;
      background: rgba(244, 248, 255, 0.85);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      color: var(--text-color);
      font-size: 1rem;
      flex-direction: column;
      gap: 10px;
    }

    .loader-spinner {
      width: 24px;
      height: 24px;
      border: 3px solid var(--border-color);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    /* --- End of Refactor --- */
    /*
        Noir's Mizuiro Theme
        - 哼，看好了，这才是设计。
      */
    /*
          Noir's Mizuiro Theme
          - 哼，看好了，这才是设计。
        */
    :root {
      --phone-width: 375px;
      --phone-height: 812px;
      --user-bg-image: url('');

      /* === Noir's Ultimate Dynamic Theme Engine v2.0 === */
      /* 哼，现在所有的颜色都听从这三个总开关的指挥。*/
      --primary-hue: 35;
      --primary-saturation: 25%;
      --primary-lightness: 80%;

      /* 核心颜色 */
      --primary-color: hsl(var(--primary-hue), var(--primary-saturation), var(--primary-lightness));
      /* 强调色/用户气泡色，现在也是动态的 */
      --accent-color: hsl(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%));

      /* 哼，看好了，这些就是被我重新接上线的“电灯” */

      /* 文字颜色：根据主题亮度自动变深或变浅 */
      --text-color: hsl(var(--primary-hue), 15%, calc(100% - var(--primary-lightness) / 1.1));
      --text-color-light: hsl(var(--primary-hue), 10%, calc(100% - var(--primary-lightness) / 1.3));

      /* 表面背景：半透明，亮度比主色高一点 */
      --surface-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.4);

      /* 卡片/AI气泡背景：比表面背景更亮一点 */
      --card-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.5);

      /* 边框颜色 */
      --border-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness)), 0.3);

      /* 阴影颜色 */
      --soft-shadow: 0 4px 12px hsla(var(--primary-hue), 40%, calc(var(--primary-lightness) - 10%), 0.15);

      /* 动态页的设置保持不变 */
      --feed-bg-image: none;
      --feed-overlay-opacity: 0.12;
      --feed-overlay-rotate: 22deg;
      --feed-overlay-speed: 48s;

      /* 气泡样式也完全动态化 */
      --bubble-radius: 18px;
      --bubble-outline: hsla(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 10%), 0.5);
      --bubble-user-bg: var(--accent-color);
      --bubble-ai-bg: var(--card-bg);

      /* ▼▼▼ 把下面这两行加进去 ▼▼▼ */
      --dropdown-alpha: 0.9;
      /* 下拉菜单的透明度，0到1 */
      --feed-card-alpha: 0.7;
      /* 动态卡片的透明度，0到1 */
      /* ▲▲▲ 添加到这里结束 ▲▲▲ */

    }

    body {
      display: flex;
      align-items: center;
      /* <-- 加上这句 */
      justify-content: center;
      /* <-- 还有这句 */
      height: 100vh;
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
    }

    #phone-container {
      width: 100%;
      /* 占满屏幕宽度 */
      height: 100vh;
      /* 占满屏幕高度 */
      background-color: white;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      /* 是不是清爽多了？ */
      position: relative;
      /* <-- 就是这句，告诉它“你是个家长了，给我看好家里的东西！” */
    }

    .screen {
      flex-grow: 1;
      display: none;
      flex-direction: column;
      background-color: #f9f9f9;
      /* 哼，所有屏幕默认都给我变白 */
      /* 让背景透出来 */
      overflow: hidden;
      color: var(--text-color);
    }

    .screen.active {
      display: flex;
    }

    /* 这个是通用的头像预览样式 */
    .avatar-preview {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--border-color);
      margin-top: 5px;
      cursor: pointer;
    }

    /* --- 通用顶栏 --- */
    .header,
    #chat-list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background-color: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border-bottom: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    .header-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-color);
    }

    .header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: var(--primary-color);
      font-weight: 500;
      min-width: 50px;
      text-align: center;
    }

    /* --- 聊天列表 --- */
    #chat-list-pane {
      background-color: transparent;
      border-right: 1px solid var(--border-color);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 加上这句 */
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      /* 防止它在横向布局里被挤扁 */
      display: flex;
      flex-direction: column;
    }

    #chat-list-container {
      flex-grow: 1;
      flex-grow: 1;
      overflow-y: auto;
      padding: 10px;
    }

    #character-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .character-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      /* backdrop-filter: blur(10px);*/
      border-radius: 16px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.5);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .character-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(138, 180, 228, 0.2);
    }

    .char-info-wrapper {
      flex-grow: 1;
      cursor: pointer;
      display: flex;
      align-items: center;
      overflow: hidden;
    }

    .character-item .char-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      margin-right: 12px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .character-item .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .character-item .char-remark {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    #chat-screen-container {
      position: relative;
      /* 告诉里面的绝对定位元素，要以我为基准 */
      flex-grow: 1;
      /* 确保它能撑满 chat-screen 的空间 */
      overflow: hidden;
      /* 把滑出去的部分藏起来，这很重要 */
      display: flex;
      /* 保持内部元素的 flex 布局 */
    }

    /* --- 聊天窗口 --- */


    #chat-view-pane {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 还有这句 */
      background-color: transparent;
      z-index: 10;
    }

    #chat-screen.show-chat-view #chat-list-pane {
      transform: translateX(-100%);
    }

    #chat-screen.show-chat-view #chat-view-pane {
      transform: translateX(0);
    }

    #chat-messages {
      flex-grow: 1;
      padding: 5px;
      overflow-y: auto;
      display: flex;
      /* <-- 加上这个 */
      flex-direction: column;
      /* <-- 还有这个 */
      contain: content;
      contain: content;
      /* <-- 哼，就是这句救命神药！ */
    }



    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 10px;
      object-fit: cover;
      border: 2px solid rgba(255, 255, 255, 0.7);
      flex-shrink: 0;
    }

    .message {
      padding: 10px 16px;
      border-radius: 20px;
      line-height: 1.5;
      word-break: break-word;
      box-shadow: var(--soft-shadow);
    }

    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
    }

    .message.user {
      background-color: var(--accent-color);
      color: white;
      border-bottom-right-radius: 5px;
    }

    .message.ai {
      background-color: var(--card-bg);
      border: 1px solid rgba(255, 255, 255, 0.8);
      color: var(--text-color);
      border-bottom-left-radius: 5px;
    }

    .message p {
      margin: 0;
    }

    .sticker-content,
    .message-image-content {
      max-width: 120px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
    }

    .message-image-content {
      max-width: 160px;
    }

    /* --- 其他屏幕和组件 --- */
    /* --- Noir's Fix: API 模型列表的样式修正 --- */
    .model-input-container {
      position: relative;
      /* 关键！让里面的绝对定位元素有家可回 */
      display: flex;
      gap: 8px;
    }

    .custom-model-dropdown {
      display: none;
      /* 默认藏起来 */
      position: absolute;
      top: 100%;
      /* 精准定位到输入框正下方 */
      left: 0;
      right: 80px;
      /* 留出“获取”按钮的位置 */
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*   backdrop-filter: blur(10px);*/
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-top: 4px;
      max-height: 180px;
      overflow-y: auto;
      z-index: 100;
      /* 确保它在最上层 */
      box-shadow: var(--soft-shadow);
    }

    .checkboxes-container {
      display: none;
      position: absolute;
      left: 0;
      right: 0;
      top: 100%;
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*  backdrop-filter: blur(10px);*/
      z-index: 10;
      border-radius: 8px;
      margin-top: 4px;
    }

    .custom-model-dropdown.show {
      display: block;
      /* 需要的时候再显示 */
    }

    .custom-model-dropdown div {
      padding: 10px 12px;
      cursor: pointer;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    .custom-model-dropdown div:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    /* --- 其他屏幕和组件 --- */
    /* 在这个注释下面加上主屏幕的样式 */
    #home-screen {
      position: relative;
      /* <-- 就加上这一行！ */


      gap: 20px;
      /* 图标之间的距离 */

      /* 声明！这里现在是我的地盘！*/
      flex-direction: column;
      /* 里面的东西，全体给我垂直排队！*/
      justify-content: space-between;
      /* 核心！顶部和底部的元素给我贴边站好，中间的自动拉开距离！*/
      padding-bottom: 0;
      /* 把内边距去掉，让Dock栏能完美贴底 */
    }

    .app-icon {
      width: 75px;
      /* <--- 就是这里，我把它加宽了 */
      height: 90px;
      /* <--- 高度也顺便调整一下 */
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: absolute;
      z-index: 40;
      padding: 5px;
      box-sizing: border-box;
      margin: 0;
    }

    .app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 2px;
      /* <-- 哼，就是这里，把5px改成2px，让图标和文字的距离拉近一点 */
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 28px;
      background-color: var(--surface-bg);
      box-shadow: none;
      transition: transform 0.2s ease;
    }

    .app-icon-img svg {
      stroke: currentColor;
      /* SVG的线条颜色会继承上面的 color */
    }

    .app-icon span {
      font-size: 0.75rem;
      /* 文本也相应缩小 */
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      width: 100%;
    }

    .content {
      padding: 20px;
      overflow-y: auto;
      flex-grow: 1;
      /* <-- 加上这行代码，就是这行！ */
    }

    .form-button {
      width: 100%;
      padding: 12px;
      border: none;
      background-color: var(--primary-color);
      color: white;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      margin-top: 10px;
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 10px;
      box-sizing: border-box;
      background-color: rgba(255, 255, 255, 0.8);
      border: 1px solid var(--border-color);
      color: var(--text-color);
      border-radius: 8px;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    .chat-toolbar {
      display: flex;
      padding: 5px 10px;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      /*   backdrop-filter: blur(10px);*/
      flex-shrink: 0;
    }

    /* ▼▼▼ 用下面这段，替换掉你旧的 .toolbar-button 样式 ▼▼▼ */
    .toolbar-button {
      background: none;
      border: none;
      font-size: 1.5rem;
      /* 这个保留，作为SVG尺寸的参考 */
      cursor: pointer;
      padding: 8px;
      /* 稍微增大点击区域 */
      color: var(--text-color-light);
      /* 让它默认是浅灰色 */
      border-radius: 50%;
      /* 让背景有个圆形轮廓 */
      width: 40px;
      height: 40px;
      display: flex;
      /* 使用flex布局让SVG完美居中 */
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s, color 0.2s;
      /* 加上顺滑的过渡效果 */
    }

    .toolbar-button:hover {
      background-color: var(--border-color);
      /* 鼠标悬停时给个背景 */
      color: var(--primary-color);
      /* 图标颜色变为主题色 */
    }

    /* ▲▲▲ 替换到这里为止 ▲▲▲ */


    /* ▼▼▼ 在下面新增这段SVG的专属样式 ▼▼▼ */
    .toolbar-button svg {
      width: 22px;
      /* SVG图标的尺寸 */
      height: 22px;
      stroke-width: 1.8;
      /* 线条粗细，可以微调 */
      stroke: currentColor;
      /* 核心！让SVG的颜色继承按钮的color属性 */
      fill: none;
      /* 确保是线稿风格 */
      pointer-events: none;
      /* 防止SVG本身干扰点击事件 */
    }

    /* ▲▲▲ 新增到这里为止 ▲▲▲ */

    .sticker-panel {
      display: none;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 10px;
      padding: 10px;
      height: 200px;
      overflow-y: auto;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      flex-shrink: 0;
    }

    .sticker-panel.show {
      display: grid;
    }

    /* --- 输入区域 --- */
    /* --- 输入区域 --- */
    .chat-input-area {
      padding: 10px 12px calc(env(safe-area-inset-bottom, 0px) + 10px);
      background: var(--surface-bg);
      /*  backdrop-filter: saturate(1.2) blur(10px);*/
      border-top: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    /* 这是我加的新容器，用来实现完美对齐 */
    #chat-input-wrapper {
      display: flex;
      /* Flex大法好，哼 */
      align-items: center;
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 24px;
      padding: 2px 5px;
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-input-wrapper:focus-within {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-message-input {
      flex-grow: 1;
      /* 让输入框占满剩余空间 */
      border: none;
      background: transparent;
      padding: 9px 12px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 38px;
      width: 38px;
      border: 0;
      border-radius: 50%;
      font-size: 1.2rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
      flex-shrink: 0;
      /* 防止被挤压 */
      margin-left: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    /* 回复按钮，给个不一样的颜色区分 */
    #chat-get-reply-button {
      background: var(--accent-color);
      font-size: 1.5rem;
      /* 让箭头更清晰 */
    }

    #chat-message-input {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      padding: 11px 16px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-message-input:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 40px;
      padding: 0 18px;
      border: 0;
      border-radius: 20px;
      font-size: .95rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    #chat-get-reply-button {
      display: flex;
      /* 隐藏旧的回复按钮，样式统一到发送按钮 */
    }


    /* --- 引用样式 --- */
    .quote-preview {
      display: none;
      padding: 8px 12px;
      background-color: rgba(255, 255, 255, 0.5);
      border-left: 3px solid var(--primary-color);
      margin: 0 12px 8px;
      border-radius: 6px;
      position: relative;
    }

    #quote-preview-sender {
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--primary-color);
    }

    #quote-preview-text {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    .cancel-quote-btn {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: none;
      border: none;
      font-size: 1.5rem;
      color: #999;
      cursor: pointer;
    }

    .quoted-message-in-bubble {
      background-color: rgba(0, 0, 0, 0.04);
      padding: 8px 10px;
      border-left: 3px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 6px;
    }

    .quoted-sender {
      font-weight: bold;
      font-size: 0.8rem;
      color: var(--text-color);
    }

    .quoted-content {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    /* 这是弹窗的“骨架”，让它能居中浮动在屏幕上 */
    .choice-modal {
      position: fixed;
      inset: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease, visibility 0.2s ease;
    }

    .choice-modal.show {
      opacity: 1;
      visibility: visible;
    }


    /* --- 弹窗 --- */
    .choice-modal-backdrop {
      background: rgba(0, 0, 0, 0.2);
      /*  backdrop-filter: blur(4px);*/
    }

    .choice-modal-content {
      background: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border: 1px solid rgba(255, 255, 255, 0.5);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .choice-modal-button {
      color: var(--text-color);
      background: rgba(255, 255, 255, 0.5);
    }

    .choice-modal-button:hover {
      background-color: rgba(255, 255, 255, 1);
    }

    .choice-modal-button.cancel {
      color: var(--primary-color);
      background: transparent;
    }

    /* --- Noir's Fix: 让“添加”弹窗从底部滑出，更大气 --- */
    #add-choice-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      /* 确保不会超出手机宽度 */
      margin: 0;
      border-radius: 20px 20px 0 0;
      /* 只留顶部圆角 */
      border-bottom-left-radius: 0;
      /* 覆盖通用样式 */
      border-bottom-right-radius: 0;
      /* 覆盖通用样式 */
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      /* 适配iPhone底部安全区 */
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #add-choice-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #add-choice-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
      justify-content: center;
    }

    /* 按钮也重新设计一下，让它们竖着排 */
    #add-choice-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- Noir's Fix: 修正创建群聊时，成员选择列表的样式 --- */
    .member-selection-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      border-bottom: 1px solid var(--border-color);
    }

    .member-selection-item:last-child {
      border-bottom: none;
    }

    /* 关键！就是这里，把头像大小锁死 */
    .member-selection-item .char-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 15px 0 10px;
      object-fit: cover;
    }

    .member-selection-item .char-name {
      font-weight: 500;
      color: var(--text-color);
    }

    .member-selection-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      accent-color: var(--primary-color);
      /* 让勾选框颜色也跟主题统一 */
    }

    /* --- Noir's World Book Styles --- */
    #world-book-list-container {
      padding: 10px;
    }

    .world-book-item {
      background-color: var(--card-bg);
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .world-book-item-name {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .world-book-item-preview {
      font-size: 0.9rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* --- Noir's Fancy Multi-Select Styles --- */
    .custom-multiselect {
      position: relative;
      user-select: none;
    }

    .select-box {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .select-box.expanded .arrow {
      transform: rotate(180deg);
    }


    .checkboxes-container.visible {
      display: block;
    }

    .checkboxes-container label {
      display: block;
      padding: 10px 12px;
    }

    .checkboxes-container label:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    .checkboxes-container input[type="checkbox"] {
      margin-right: 8px;
      width: auto;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Clock & Timestamp Styles --- */
    /* --- Noir's Badge & App Dock Styles --- */
    #decorative-badge {
      width: 80px;
      height: 80px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.25));
      /* 哼，给你加个阴影，看起来才像样 */
      transform: rotate(-8deg);
      /* 稍微歪一点，显得随意 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      /* 防止拖动时选中图片 */
      z-index: 50;
    }

    #decorative-badge:active {

      transform: rotate(-2deg) scale(1.05);
      /* 抓起来的时候，摆正放大一点 */
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }


    #decorative-badge img {
      width: 150%;
      height: 150%;
      object-fit: cover;
      /* 保留这句，让你的图片能被很好地填充 */
    }

    /*  #a#app-dock-bottom-left,
    #app-dock-top-right {
      
      哼，现在你们只是幽灵了。
      不需要任何样式，你们的孩子（App图标）会自己找到回家的路。
      它们会相对于 #home-screen 定位。
    
    }
*/

    /* --- Noir's Author Mark: Pixel Chicken --- */
    /* 哼，这就是那个吵着要加的小鸡图标 */
    #noir-author-mark {
      position: absolute;
      /* 相对于父容器定位 */
      right: -30px;
      /* 调整它在时钟右边的位置 */
      top: 50%;
      /* 垂直居中 */
      transform: translateY(-50%);
      /* 精确对齐 */
      width: 20px;
      /* 小鸡的尺寸 */
      height: 20px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="0"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM12 4c.69 0 1.25.56 1.25 1.25S12.69 6.5 12 6.5s-1.25-.56-1.25-1.25S11.31 4 12 4zm0 2c-.69 0-1.25.56-1.25 1.25S11.31 8.5 12 8.5s1.25-.56 1.25-1.25S12.69 6 12 6zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 9.75 10 9.75s1.25-.56 1.25-1.25S10.69 8 10 8zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 9.75 12 9.75s1.25-.56 1.25-1.25S12.69 8 12 8zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 9.75 14 9.75s1.25-.56 1.25-1.25S14.69 8 14 8zM10 10c-.69 0-1.25.56-1.25 1.25S9.31 12.5 10 12.5s1.25-.56 1.25-1.25S10.69 10 10 10zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 12.5 12 12.5s1.25-.56 1.25-1.25S12.69 10 12 10zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 12.5 14 12.5s1.25-.56 1.25-1.25S14.69 10 14 10zM12 12c-.69 0-1.25.56-1.25 1.25S11.31 14.5 12 14.5s1.25-.56 1.25-1.25S12.69 12 12 12zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 15.75 10 15.75s1.25-.56 1.25-1.25S10.69 14 10 14zm4 0c-.69 0-1.25.56-1.25 1.25S13.31 15.75 14 15.75s1.25-.56 1.25-1.25S14.69 14 14 14zM12 16c-.69 0-1.25.56-1.25 1.25S11.31 18.5 12 18.5s1.25-.56 1.25-1.25S12.69 16 12 16zM6 10c-.69 0-1.25.56-1.25 1.25S5.31 12.5 6 12.5s1.25-.56 1.25-1.25S6.69 10 6 10zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 12.5 18 12.5s1.25-.56 1.25-1.25S18.69 10 18 10zM12 20c-.69 0-1.25.56-1.25 1.25S11.31 22.5 12 22.5s1.25-.56 1.25-1.25S12.69 20 12 20zM6 14c-.69 0-1.25.56-1.25 1.25S5.31 15.75 6 15.75s1.25-.56 1.25-1.25S6.69 14 6 14zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 15.75 18 15.75s1.25-.56 1.25-1.25S18.69 14 18 14z"/></svg>');
      /* 这是SVG小鸡的Data URI，白色像素风格 */
      background-size: contain;
      background-repeat: no-repeat;
      cursor: pointer;
      /* 提示可点击 */
      opacity: 0.6;
      /* 稍微透明一点，不那么突兀 */
      transition: opacity 0.2s ease-in-out;
      /* 鼠标悬停效果 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    #noir-author-mark:hover {
      opacity: 1;
      /* 鼠标悬停时完全显示 */
    }

    /* 调整时钟容器，为小鸡留出空间并方便定位 */
    .home-clock-container {
      position: relative;
      /* 确保小鸡能相对它定位 */
      /* ... (保留你已有的其他时钟样式) ... */
      padding-right: 40px;
      /* 给小鸡留出一些右边距 */
    }

    #home-clock-container {
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
      text-align: center;
      position: absolute;
      /* top, left, right 都被我删了，哼，现在它完全听JS的指挥 */

      /* 这行可以留着，虽然你已经不让它拖了 */
      z-index: 50;
    }

    #home-time {
      font-size: 80px;
      font-weight: 200;
      letter-spacing: 2px;
    }

    #home-date {
      font-size: 1.1rem;
      font-weight: 400;
      margin-top: 5px;
      opacity: 0.9;
    }

    /* 聊天气泡时间戳的样式 */
    .timestamp {
      font-size: 0.7rem;
      color: var(--text-color-light);
      padding: 0 5px;
      margin-bottom: 3px;
      /* 让它和气泡底部对齐 */
    }

    /* 第一段：这是消息容器的基础样式 */
    .message-container {
      display: flex;
      /* 启用flex布局 */
      flex-direction: column;
      /* 让气泡和时间戳垂直排列 */
      margin-bottom: 20px;
      max-width: 85%;
      /* 限制整个容器的最大宽度 */
    }

    /* 第二段：这是根据发言者进行左右对齐的样式 */
    .message-container.user {
      align-self: flex-end;
      /* 让用户方整个容器靠右 */
      align-items: flex-end;
      /* 让容器内部的元素（气泡、时间戳）也靠右 */
    }

    .message-container.ai {
      align-self: flex-start;
      /* 让AI方整个容器靠左 */
      align-items: flex-start;
      /* 让容器内部的元素（气泡、时间戳）也靠左 */
    }

    .message-bubble-row {
      display: flex;
      align-items: flex-end;
      width: 100%;
    }

    .message-container.user .message-bubble-row {
      justify-content: flex-end;
    }

    .message-container.ai .message-bubble-row {
      justify-content: flex-start;
    }



    /* 这是给表情选择面板里，每一个小表情图片用的样式 */
    .sticker-item {
      width: 100%;
      /* 自动填满网格单元格的宽度 */
      aspect-ratio: 1 / 1;
      /* 保持1:1的宽高比，让它变成正方形 */
      object-fit: cover;
      /* 图片会被裁剪以适应正方形，不变形 */
      border-radius: 8px;
      /* 加个小圆角 */
      cursor: pointer;
      transition: transform 0.15s ease;
    }

    .sticker-item:hover {
      transform: scale(1.1);
      /* 鼠标放上去时稍微放大，增加交互感 */
    }

    /* --- Noir's Offline Scene Styles --- */
    #meeting-scene-view {
      flex-grow: 1;
      /* <-- 核心：让它占满所有可用空间 */
      overflow-y: auto;
      /* <-- 核心：内容多了就内部滚动 */
      padding: 20px;
      font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif;
      background-size: cover;
      background-position: center;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7);
    }

    #chat-view-pane.offline-mode #offline-scene-view {
      display: block;
      /* 在线下模式时显示 */
    }

    #chat-view-pane.offline-mode #chat-messages {
      display: none;
      /* 在线下模式时隐藏气泡聊天 */
    }

    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      /* 保留换行和空格，这对于小说格式至关重要 */
      font-size: 1rem;
    }

    /* --- Noir's Offline Scene Dialogue Box Style --- */
    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      font-size: 1rem;

      /* <--- Noir's Addition: 为对话框添加半透明背景和内边距 */
      background-color: rgba(0, 0, 0, 0.4);
      /* 半透明黑色背景 */
      padding: 15px 20px;
      /* 内边距，让文字与边框有距离 */
      border-radius: 8px;
      /* 圆角边框，更柔和 */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      /* 轻轻的阴影，增加立体感 */
    }

    #offline-scene-view .narrator {
      color: #d1d5db;
      /* 旁白用浅灰色 */
      font-style: italic;
    }

    #offline-scene-view .speaker-user {
      color: #a7c7e7;
      /* 用户的发言用一种柔和的蓝色 */
      font-weight: bold;
    }

    #offline-scene-view .speaker-ai {
      color: #f2b7c6;
      /* AI的发言用柔和的粉色，形成对比 */
      font-weight: bold;
    }

    /* --- Noir's Typing Indicator Style --- */
    .typing-indicator {
      padding: 10px 15px;
      color: var(--text-color-light);
      font-style: italic;
      font-size: 0.9rem;
      align-self: flex-start;
      /* 让它和AI气泡一样靠左 */
      margin-left: 50px;
      /* 和AI气泡对齐 */
    }

    #offline-scene-view .typing-indicator {
      color: rgba(255, 255, 255, 0.8);
      /* 在暗色背景下用亮色 */
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
      /* 同样的文字阴影，保持队形 */
      padding: 10px 0;
      margin-left: 0;
      /* 在小说视图里不需要缩进 */
    }

    /* --- Noir's Final Alignment Fix --- */
    .message-container.ai .timestamp {
      /* 哼，给你加上头像宽度(40px) + 左右边距(10px)的距离 */
      margin-left: 50px;
    }

    .message-container.user .timestamp {
      /* 另一边也是一样，真是麻烦死了 */
      margin-right: 50px;
    }

    /* --- Noir's Music Feed & Player Styles --- */
    #music-feed-container {
      padding-bottom: 70px;
      contain: content;
      /* 为底部播放器留出空间 */
    }

    /* 动态页：默认白底；如设置 --feed-bg-image 则显示独立壁纸 + 轻动画叠层 */
    #music-screen {
      background-color: #fff;
      /* 默认白底 */
      background-image: var(--feed-bg-image);
      /* 单独壁纸，不设就是 none */
      background-size: cover;
      background-position: center;
      contain: paint;
      /* 降低重绘范围，省电 */
    }

    /* 轻动画彩雾叠层：仅图层，不拦点击 */
    #music-screen::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background-image:
        conic-gradient(from var(--feed-overlay-rotate),
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 0%,
          transparent 20%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 40%,
          transparent 60%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 80%,
          transparent 100%);
      transform: translateZ(0);
      animation: feed-pan var(--feed-overlay-speed) linear infinite;
    }

    /* 超慢速平移旋转，基本不占 GPU */
    @keyframes feed-pan {
      0% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }

      50% {
        transform: translate3d(1.2%, 0.8%, 0) rotate(2deg) scale(1.02);
      }

      100% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }
    }

    /* 系统降低动画偏好时，自动停掉动画 */
    @media (prefers-reduced-motion: reduce) {
      #music-screen::before {
        animation: none;
      }
    }


    .music-post {
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), var(--feed-card-alpha));
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: var(--soft-shadow);
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .music-post-header {
      display: flex;
      align-items: center;
      padding: 12px 15px;
    }

    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .music-post-header .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .music-post-thought {
      padding: 0 15px 15px;
      font-size: 0.95rem;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .music-post-song-card {
      display: flex;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.04);
      padding: 12px 15px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .music-post-song-card:hover {
      background-color: rgba(0, 0, 0, 0.08);
    }

    .music-post-song-card img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 12px;
    }

    .music-post-song-info {
      flex-grow: 1;
    }

    .music-post-song-info .title {
      font-weight: 500;
      color: var(--text-color);
    }

    .music-post-song-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    .music-post-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
    }

    #music-player-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 65px;
      background: var(--surface-bg);
      /*backdrop-filter: blur(10px);*/
      border-top: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      padding: 0 10px;
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }

    #music-player-bar:not(.hidden) {
      transform: translateY(0);
    }

    #music-player-bar.hidden {
      display: none;
      /* 彻底隐藏，避免交互问题 */
    }


    #player-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
    }

    #player-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #player-title,
    #player-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #player-title {
      font-weight: 500;
    }

    #player-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #player-controls button {
      background: none;
      border: 2px solid var(--text-color);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      font-size: 1rem;
      cursor: pointer;
      color: var(--text-color);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Share Bubble Styles --- */
    .message.music {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
      max-width: 250px;
      /* 限制一下最大宽度 */
    }

    .music-share-card {
      display: flex;
      align-items: center;
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 12px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
    }

    .message-container.user .music-share-card {
      background-color: var(--accent-color);
      border: 1px solid rgba(255, 255, 255, 0.4);
    }

    .message-container.user .music-share-card .title,
    .message-container.user .music-share-card .artist,
    .message-container.user .music-share-card .play-icon {
      color: white;
    }


    .music-share-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .music-share-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-share-info .title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #music-screen {
      position: relative;
      /* 就是这句，告诉里面的绝对定位元素，以我为界！ */
    }

    /* --- Noir's Fancy Music Widget Styles --- */
    /* --- Noir's Music System Refactor --- */

    #music-widget:not(.hidden) {
      transform: translateY(0);
      /* 不隐藏时，滑上来 */
    }

    #music-widget.hidden {
      transform: translateY(150%);
      /* 隐藏时，滑下去 */
    }

    .widget-vinyl {
      width: 80px;
      height: 80px;
      background-color: #111;
      border-radius: 50%;
      position: relative;
      left: 20px;
      /* 向右移动，让卡片能盖住它 */
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      background-image:
        radial-gradient(circle at center, #555 10%, transparent 11%),
        radial-gradient(circle at center, #fff 12%, transparent 13%);
      animation: spin 8s linear infinite;
      z-index: 1;
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    .widget-card {
      width: 240px;
      padding: 15px;
      background-color: var(--card-bg);
      /*  backdrop-filter: blur(10px);*/
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
      display: flex;
      align-items: center;
      z-index: 2;
      /* 让卡片在唱片上方 */
    }

    .widget-card img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .widget-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #widget-title,
    #widget-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #widget-title {
      font-weight: 600;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    #widget-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #widget-play-icon {
      font-size: 1.2rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #card-widget {
      width: 335px;
      height: 150px;
      border-radius: 18px;
      /* 这就是圆角方形的关键 */
      background-color: rgba(255, 255, 255, 0.5);
      /* 加个底色，免得图片透明时不好看 */

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transform: rotate(0deg);
      /* 朝另一个方向歪 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      /* 比爱心高一层 */
      overflow: hidden;
      /* 防止图片溢出圆角 */
    }

    #card-widget:active {

      transform: rotate(1deg) scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* --- Noir's Ultimate Scrollbar Hider --- */
    /* For Webkit browsers like Chrome, Safari */
    ::-webkit-scrollbar {
      display: none;
    }

    /* For Firefox */
    * {
      scrollbar-width: none;
    }

    /* --- Noir's Fix: 美化消息操作弹窗 --- */
    #message-action-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
    }

    #message-action-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      margin: 0;
      border-radius: 20px 20px 0 0;
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #message-action-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #message-action-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- End of Fix --- */
    /* --- Noir's Fix: Fancy User Post Area --- */
    #user-post-input-container {
      display: flex;
      gap: 10px;
    }

    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
    }

    #user-post-main-area {
      flex-grow: 1;
    }

    #user-post-textarea {
      width: 100%;
      border: none;
      background: transparent;
      outline: none;
      resize: vertical;
      font-size: 1rem;
      color: var(--text-color);
    }

    #user-post-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    #user-send-post-button {
      padding: 6px 18px;
      border-radius: 16px;
      border: none;
      background: var(--primary-color);
      color: white;
      cursor: pointer;
      font-weight: 600;
    }

    /* 这是附件预览的样式 */
    #user-post-attachment-preview {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .preview-item {
      position: relative;
      max-width: 100px;
    }

    .preview-item img {
      width: 100%;
      border-radius: 8px;
      object-fit: cover;
    }

    .preview-item .music-preview-card {
      display: flex;
      align-items: center;
      padding: 8px;
      background: rgba(0, 0, 0, 0.05);
      border-radius: 8px;
      width: 200px;
      /* 给音乐卡片宽一点 */
    }

    .preview-item .music-preview-card img {
      width: 30px;
      height: 30px;
      margin-right: 8px;
    }

    .preview-item .music-preview-card .info {
      font-size: 0.8rem;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .remove-attachment-btn {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }

    /* --- Noir's Fix: Post Image Display Style --- */
    .post-image-container {
      padding: 0 15px 15px;
      /* 图片和文字之间留点空隙 */
    }

    .post-image {
      max-width: 100%;
      /* 图片最宽不能超过帖子宽度 */
      max-height: 400px;
      /* 最高400像素，防止长图刷屏 */
      border-radius: 8px;
      /* 加个小圆角，好看 */
      object-fit: cover;
      /* 保持图片比例，不变形 */
      display: block;
      /* 解决图片底部多余的空隙问题 */
    }

    /* --- Noir's Refactor: New Post Interaction Styles --- */
    .post-interactions {
      padding: 10px 15px;
      background-color: rgba(0, 0, 0, 0.02);
      border-top: 1px solid var(--border-color);
      font-size: 0.9rem;
    }

    .post-likes {
      color: var(--primary-color);
      margin-bottom: 8px;
    }

    .post-comments-container {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .post-comment {
      color: var(--text-color);
    }

    .post-comment .comment-author {
      font-weight: 600;
      color: var(--text-color);
    }

    .post-timestamp {
      font-size: 0.75rem;
      color: var(--text-color-light);
      padding: 0 15px 10px;
    }



    /* 覆盖：基础气泡体 */
    /* 覆盖：基础气泡体 */
    .message {
      border-radius: var(--bubble-radius);
      line-height: 1.55;
      padding: 10px 14px;
      box-shadow:
        0 1px 0 rgba(0, 0, 0, .03),
        0 4px 10px rgba(0, 0, 0, .06);
      /* 比你原先更浅，省功耗 */
      border: 1px solid var(--bubble-outline);
      backdrop-filter: none !important;
      /* 绝不启用重滤镜 */
      will-change: auto;
      /* 不抢 GPU 配额 */

      /* --- Noir's Fix: 就是下面这两行，哼 --- */
      user-select: none;
      /* 标准浏览器给我听话，不许选中 */
      -webkit-user-select: none;
      /* 那些老古董浏览器也一样 */
    }

    /* 你的气泡（右侧） */
    .message.user {
      color: #fff;
      background: var(--bubble-user-bg);
      border-bottom-right-radius: 6px;
      /* 微“角”保留你原味 */
      text-shadow: 0 1px 0 rgba(0, 0, 0, .12);
      /* 细腻但很轻 */
    }

    /* TA 的气泡（左侧） */
    .message.ai {
      color: var(--text-color);
      background: var(--bubble-ai-bg);
      border-bottom-left-radius: 6px;
    }

    /* 细节：图片/贴纸消息不套背景 */
    .message.user.sticker,
    .message.assistant.sticker,
    .message.user.image,
    .message.assistant.image {
      background: transparent;
      border: 0;
      box-shadow: none;
      padding: 0;
    }

    /* 轻触态：不使用阴影动画，避免合成层抖动 */
    .message:active {
      transform: scale(.996);
    }

    /* 引用块在气泡内的融合感 */
    .quoted-message-in-bubble {
      background: rgba(0, 0, 0, .045);
      border: 1px solid color-mix(in hsl, var(--primary-color) 18%, transparent);
      border-radius: 10px;
    }


    /* --- Noir's Transfer Bubble Style --- */
    .message.transfer {
      background: #F79232;
      /* 哼，一个温暖又醒目的橙色 */
      color: white;
      padding: 12px 16px;
      border-radius: 12px;
      width: 220px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    /* 我还给左右两边做了区分，真是为你操碎了心 */
    .message-container.ai .message.transfer {
      background: #f9fafb;
      /* AI发来的转账用白色，更清爽 */
      color: #333;
      border: 1px solid #e5e7eb;
    }

    .transfer-content {
      display: flex;
      flex-direction: column;
    }

    .transfer-title {
      font-weight: 600;
      font-size: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.5);
      padding-bottom: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    .message-container.ai .transfer-title {
      border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    .transfer-amount {
      font-size: 1.8rem;
      font-weight: bold;
    }

    .transfer-recipient {
      font-size: 0.8rem;
      opacity: 0.9;
      margin-top: 4px;
    }

    /* --- End of Refactor --- */

    /* --- Noir's Music System Refactor --- */
    #music-widget-card {
      display: flex;
      align-items: center;
      width: 320px;
      /* 固定宽度，更像一个小组件 */
      margin: 0 auto;
      /* 居中 */
      padding: 12px;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.85);
      /*backdrop-filter: blur(10px) saturate(1.5);*/
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.5);

    }

    #widget-cover-art {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      background-size: cover;
      background-position: center;
      margin-right: 12px;
      flex-shrink: 0;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    #music-widget .widget-info {
      flex-grow: 1;
      overflow: hidden;
      color: var(--text-color);
    }

    #music-widget .widget-info #widget-title {
      font-weight: 600;
    }

    #music-widget .widget-info #widget-artist {
      font-size: 0.85rem;
      opacity: 0.7;
    }

    #widget-controls {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* 5. 哼，给那个不听话的音乐播放器按钮也做个整容 */
    #widget-controls button {
      background: transparent !important;
      /* 强制透明，去掉那该死的蓝色 */
      border: none;
      color: var(--text-color);
      /* 颜色要听主题的话 */
      opacity: 0.7;
      /* 稍微淡一点，不要那么抢眼 */
      font-size: 1.3rem;
      /* 图标可以大一点 */
      padding: 5px;
      cursor: pointer;
      transition: opacity 0.2s ease, transform 0.2s ease;
    }

    #widget-controls button:hover {
      opacity: 1;
      /* 鼠标放上去时变清晰 */
    }

    #widget-controls button:active {
      transform: scale(0.9);
      /* 按下时来点反馈 */
    }

    /* 底部播放器样式升级 */
    #player-controls {
      display: flex;
      align-items: center;
      gap: 15px;
      /* 加大按钮间距 */
    }

    #player-controls button {
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--text-color);
      cursor: pointer;
    }

    /* --- Noir's Snap Guide Styles --- */
    .snap-guide {
      position: absolute;
      background-color: rgba(255, 105, 180, 0.85);
      /* 哼，一个足够醒目的颜色 */
      display: none;
      z-index: 999;
      box-shadow: 0 0 5px rgba(255, 105, 180, 0.7);
    }

    #snap-guide-v {
      width: 1px;
    }

    #snap-guide-h {
      height: 1px;
    }

    /* --- Noir's Galgame UI Beautification --- */
    /* Top-left Date & Time Widget */
    #galgame-overlay-ui {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 12px;
      padding: 8px 15px;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    #galgame-time {
      font-size: 1.2rem;
      font-weight: 600;
      text-align: center;
    }

    #galgame-date {
      font-size: 0.75rem;
      opacity: 0.8;
      text-align: center;
    }

    /* Main Text Box */
    /* Main Text Box */
    #galgame-textbox-container {
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.85) 0%, rgba(45, 50, 68, 0.7) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border-top: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.2);
      bottom: 85px;
      /* <-- 就是这里，往上抬了，满意了吗？ */
      left: 15px;
      right: 15px;
      padding: 12px 18px;
    }

    /* Speaker Name Tag */
    #galgame-speaker {
      background: linear-gradient(90deg, var(--primary-color) 0%, hsl(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) - 10%)) 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 8px;
      display: inline-block;
      font-size: 0.95rem;
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
      margin-bottom: 12px;
    }

    /* Dialogue Text */
    #galgame-text {
      font-size: 1rem;
      line-height: 1.7;
      color: #f0f2f5;
    }

    /* User Input Area Container*/
    #meeting-view-screen .chat-input-area {
      background: transparent;
      border-top: none;
      padding: 0 15px 20px 15px;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 20;
    }

    /* User Input Wrapper */
    #chat-input-wrapper-meeting {
      display: flex;
      align-items: center;
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.9) 0%, rgba(45, 50, 68, 0.75) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      padding: 5px 8px 5px 15px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.25);
    }

    #meeting-message-input {
      color: #f0f2f5;
    }

    #meeting-message-input::placeholder {
      color: rgba(240, 242, 245, 0.5);
      font-style: italic;
    }

    /* Send Button */
    #meeting-send-button {
      height: 40px;
      width: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      font-weight: 300;
      color: #fff;
      transition: all .2s ease;
      margin-left: 8px;
      background: var(--primary-color);
      box-shadow: 0 2px 5px hsla(var(--primary-hue), 50%, 50%, 0.4);
    }

    #meeting-send-button:hover {
      filter: brightness(1.1);
      transform: scale(1.05);
    }


    /* --- End of Beautification --- */
    /* --- Noir's Diary Beautification --- */
    #diary-entries-container {
      background-color: #fdfaf2;
      /* A warm, paper-like off-white */
      padding: 25px 20px;
      line-height: 1.9;
      border: 1px solid #e0dccc;
      box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.08);
      /* Inner shadow for page depth */
    }

    /* This is the container for a single entry (date, author, content) */
    .diary-entry {
      margin-bottom: 2.5em;
      /* Increase spacing between entries */
      position: relative;
      padding-bottom: 1.5em;
      /* Space for the separator line */
      border-bottom: 1px dashed #dcd5c7;
      /* A subtle dashed line between entries */
    }

    /* Style the author's name */
    .diary-author {
      font-weight: normal;
      /* Make it less bold, more like a signature */
      font-size: 1rem;
      font-family: 'Segoe Script', 'Bradley Hand', cursive;
      /* A more handwritten font */
    }

    /* Style the date */
    .diary-timestamp {
      font-size: 0.75rem;
      color: #a99e8c;
      /* A faded brown color */
      margin-bottom: 8px;
      font-family: 'Courier New', monospace;
      /* Typewriter-like font for date */
    }

    /* Style the actual diary text content */
    .diary-content {
      white-space: pre-wrap;
      font-size: 0.95rem;
      color: #4a443b;
      /* A dark brown/black ink color */
      font-family: 'KaiTi', 'STSong', serif;
    }

    /* Specific styles for the USER's entries */
    .diary-entry.user {
      text-align: right;
    }

    .diary-entry.user .diary-author {
      color: #005a9c;
      /* A nice fountain pen blue */
    }

    .diary-entry.user .diary-content {
      color: #1a5c8e;
    }

    /* Specific styles for the AI's entries */
    .diary-entry.ai {
      text-align: left;
    }

    .diary-entry.ai .diary-author {
      color: #5a3e36;
      /* A darker, warmer brown for the AI */
    }

    .diary-entry.ai .diary-content {
      color: #4a443b;
    }

    /* Let's get rid of the last separator line for a cleaner look */
    .diary-entry:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    /* --- End of Diary Beautification --- */
    /* --- Noir's Page-Turning Magic --- */
    #diary-entries-container {
      perspective: 1500px;
      /* 为3D效果设置视距 */
      position: relative;
      overflow: hidden;
    }

    .diary-page {
      position: absolute;
      inset: 0;
      padding: 25px 20px;
      background-color: #fdfaf2;
      transform-style: preserve-3d;
      backface-visibility: hidden;
      transition: transform 0.7s cubic-bezier(0.65, 0, 0.35, 1);
      display: none;
      /* 默认所有页面都藏起来 */
      flex-direction: column;
      gap: 2.5em;
      /* 页内日记的间距 */
      overflow-y: auto;
      /* 如果一页内容太多，允许滚动 */
    }

    .diary-page.is-visible {
      display: flex;
      /* 只有当前页显示 */
      transform: rotateY(0deg);
      z-index: 2;
    }

    /* 翻到下一页时，当前页向左翻出 */
    .diary-page.is-exiting-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 1;
    }

    /* 翻到下一页时，新页面从右边翻入 */
    .diary-page.is-entering-from-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 2;
    }

    /* 翻到上一页时，当前页向右翻出 */
    .diary-page.is-exiting-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 1;
    }

    /* 翻到上一页时，新页面从左边翻入 */
    .diary-page.is-entering-from-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 2;
    }


    #diary-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 0 10px;
      box-sizing: border-box;
    }

    #diary-navigation button {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--primary-color);
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      font-size: 0.9rem;
    }

    #diary-navigation button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    #diary-page-indicator {
      font-size: 0.9rem;
      color: var(--text-color-light);
      font-family: 'Courier New', monospace;
    }

    /* --- End of Magic --- */
    /* --- Noir's Universal Anti-Squash Protocol --- */
    /* 哼，就是下面这几条，给你那些被压扁的头像整整容 */

    /* 动态发布区的用户头像 */
    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
      object-fit: cover;
      /* <-- 加上这句，它就不敢扁了 */
    }

    /* 好友圈动态里的角色头像 */
    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
      /* <-- 还有这句，一个都别想跑 */
    }

    /* 顺便把所有叫 .char-avatar 的都统一一下，免得以后还有问题 */
    .char-avatar {
      object-fit: cover;
    }

    /* --- Noir's Music Library Styles --- */
    #music-library-container {
      padding: 10px;
    }

    .music-library-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .music-library-item:hover {
      transform: translateY(-2px);
    }

    .music-library-item-cover {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 15px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .music-library-item-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-library-item-title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-library-item-artist {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    /* --- End of Styles --- */
    /* --- Noir's Global Player Styles --- */

    /* --- End of Player Styles --- */
    /* --- Noir's Upload Altar Styles --- */
    .upload-slot {
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease;
      background-color: rgba(255, 255, 255, 0.5);
    }

    .upload-slot:hover {
      background-color: var(--card-bg);
      border-color: var(--primary-color);
    }

    .upload-slot.filled {
      border-color: var(--primary-color);
      border-style: solid;
      background-color: hsla(var(--primary-hue), 50%, 95%, 0.8);
    }

    .upload-slot .slot-icon {
      font-size: 2rem;
    }

    .upload-slot .slot-label {
      display: block;
      font-weight: 600;
      margin-top: 5px;
      color: var(--text-color);
    }

    .upload-slot .slot-filename {
      display: block;
      font-size: 0.85rem;
      color: var(--text-color-light);
      margin-top: 3px;
      word-break: break-all;
    }

    #confirm-altar-upload-button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* --- End of Altar Styles --- */
    /* --- Noir's Listen Together Invite Card Style --- */
    .listen-together-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 15px;
      box-shadow: var(--soft-shadow);
      border: 1px solid var(--border-color);
      width: 250px;
    }

    .message-container.user .listen-together-card {
      background: var(--bubble-user-bg);
      color: white;
    }

    .message-container.user .listen-together-card .listen-together-decline-btn {
      color: white;
      /* 哼，让用户侧的拒绝按钮文字也变白 */
    }

    .listen-together-header {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 10px;
      border-bottom: 1px solid var(--bubble-outline);
      padding-bottom: 8px;
    }

    .listen-together-song {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .listen-together-song img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      flex-shrink: 0;
    }

    .listen-together-info .title {
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-info .artist {
      font-size: 0.9em;
      opacity: 0.9;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .listen-together-actions button {
      flex-grow: 1;
      padding: 8px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.1s ease;
    }

    .listen-together-actions button:active {
      transform: scale(0.97);
    }

    .listen-together-accept-btn {
      background: var(--primary-color);
      color: white;
    }

    .listen-together-decline-btn {
      background: rgba(0, 0, 0, 0.1);
    }

    /* 用这个替换你旧的 #listen-together-ui */
    #listen-together-ui {
      position: fixed;
      inset: 0;
      z-index: 2000;
      display: flex;
      align-items: center;
      /* 改成居中对齐 */
      justify-content: center;
      padding: 20px;
      /* 增加内边距，让弹窗不会贴边 */
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    #listen-together-ui.show {
      opacity: 1;
      visibility: visible;
    }

    .lt-ui-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(15px) saturate(1.8);
      -webkit-backdrop-filter: blur(15px) saturate(1.8);
    }

    /* 用这个替换你旧的 .lt-ui-main */
    .lt-ui-main {
      position: relative;
      width: 100%;
      height: 100%;
      max-width: 380px;
      /* 哼，给它一个最大宽度 */
      max-height: 650px;
      /* 再给一个最大高度 */
      display: flex;
      flex-direction: column;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      border-radius: 24px;
      /* 加上优雅的圆角 */
      overflow: hidden;
      /* 把溢出的部分裁掉 */
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      /* 更强的立体阴影 */
      border: 1px solid rgba(255, 255, 255, 0.2);
      /* 淡淡的边框光效 */
    }

    .lt-ui-header {
      flex-shrink: 0;
      padding: 15px 20px;
      text-align: center;
      position: relative;
    }

    #lt-ui-header-title {
      font-weight: 600;
    }

    #lt-ui-close-btn {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      line-height: 30px;
    }

    .lt-ui-content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      overflow: hidden;
    }

    .lt-ui-cover-container {
      flex-shrink: 0;
      width: 65%;
      aspect-ratio: 1/1;
      margin-top: 5%;
      margin-bottom: 20px;
    }

    #lt-ui-cover-art {
      width: 100%;
      height: 100%;
      border-radius: 16px;
      object-fit: cover;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .lt-ui-info {
      text-align: center;
      margin-bottom: 20px;
      flex-shrink: 0;
    }

    #lt-ui-song-title {
      font-size: 1.5rem;
      margin: 0;
    }

    #lt-ui-song-artist {
      font-size: 1rem;
      opacity: 0.8;
      margin: 5px 0 0;
    }

    #lt-ui-lyrics-container {
      flex-grow: 1;
      width: 100%;
      overflow-y: auto;
      text-align: center;
      font-size: 1.1rem;
      line-height: 2.5;
      mask-image: linear-gradient(transparent 0%, black 20%, black 80%, transparent 100%);
      /* 歌词上下渐隐，看起来更专业 */
      scroll-behavior: smooth;
      /* 滚动要丝滑 */
    }

    #lt-ui-lyrics-container p {
      transition: color 0.3s ease, transform 0.3s ease;
      opacity: 0.6;
    }

    #lt-ui-lyrics-container p.active {
      color: var(--primary-color);
      font-weight: 600;
      transform: scale(1.1);
      opacity: 1;
    }

    /* --- Noir's "Desktop Preview" Frame --- */
    /* 哼，只有在电脑这种大屏幕上，我才给你加上这个“手机框”，免得你分不清主次。 */
    /* 在真正的手机上，它还是会全屏显示的，我可没你那么笨。 */
    @media (min-width: 480px) {
      body {
        background-color: #e9ebee;
        /* 一个不那么刺眼的背景色 */
        padding: 20px 0;
        /* 上下留点呼吸空间 */
      }

      #phone-container {
        width: var(--phone-width);
        height: var(--phone-height);
        max-height: 90vh;
        /* 确保在矮屏幕上不会超出 */

        /* 这就是你想要的“边框”，哼 */
        border: 10px solid #1c1c1e;
        border-radius: 44px;
        /* 圆角大一点才像样 */
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        /* 给你加个高级点的阴影 */

        flex-shrink: 0;
        /* 确保它在 flex 布局里不会被压扁 */
      }
    }

    /* --- Noir's Vinyl Record Player Design v3.0 FINAL --- */
    /* 哼，这才是终极版。 */

    /* 1. 播放器“底座”，保持为一个干净的方形容器 */
    #music-widget-card {
      width: 180px;
      height: 180px;
      border-radius: 24px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      background-image: url('在这里填上你的默认图片URL');
      background-size: cover;
      background-position: center;
      /* 一个有质感的浅灰色底座 */
      display: block;
      /* 取消flex，我们用绝对定位 */
      padding: 0;
      border: 1px solid rgba(255, 255, 255, 0.5);
    }

    /* 2. “唱片”本体！现在它是一个圆，背景就是你的自定义图片 */
    #widget-cover-art {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      /* 唱片占底座的90% */
      height: 90%;
      border-radius: 50%;
      /* 变成正圆形 */
      background-size: cover;
      background-position: center;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.25);
      /* 背景图由JS设置，这里是它的容器 */
    }

    /* 3. 这是“唱片”的“黑胶部分”，用伪元素画在图片上面 */
    #widget-cover-art::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 65%;
      /* 黑胶部分占整个唱片的65% */
      height: 65%;
      border-radius: 50%;
      background: radial-gradient(circle, #3a3a3a 0%, #1a1a1a 100%);
      /* 模拟黑胶质感 */
      box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.7);
    }

    /* 4. 这是“唱片”中心的“标签孔”，画在黑胶上面 */
    #widget-cover-art::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 20%;
      /* 中心孔占整个唱片的20% */
      height: 20%;
      border-radius: 50%;
      background: #c9c3b7;
      /* 唱片标签纸的颜色 */
      border: 2px solid #5a554f;
    }

    /* 5. 浮在唱片上方的“信息标签” */
    .widget-content-overlay {
      position: absolute;
      bottom: 15px;
      /* 贴在底部 */
      left: 15px;
      right: 15px;
      padding: 10px;
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 10px;
      z-index: 2;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* 6. 最后，重新调整文字和按钮的样式 */
    #music-widget .widget-info {
      text-align: left;
      width: auto;
      color: #2c3e50;
      text-shadow: none;
      flex-grow: 1;
      /* 让信息区占满左边空间 */
    }

    #music-widget .widget-info #widget-title {
      font-weight: 600;
      font-size: 0.9rem;
    }

    #music-widget .widget-info #widget-artist {
      font-size: 0.75rem;
      opacity: 0.8;
    }

    #widget-controls {
      display: flex;
      /* 让按钮横着排 */
      width: auto;
      flex-shrink: 0;
      /* 防止按钮被挤压 */
    }

    #widget-controls button {
      color: #2c3e50;
      font-size: 1.1rem;
      background: none;
      border: none;
      padding: 0 4px;
      /* 调整按钮间距 */
      opacity: 0.7;
    }

    /* --- Noir's iOS Industrial Button Refactor --- */
    /* 哼，看好了，这才是专业设备该有的开关。*/

    /* 1. 按钮的基础“模具”，所有按钮都用这个形状和质感 */
    .form-button {
      border: none;
      border-radius: 12px;
      /* iOS风格的圆角 */
      padding: 14px;
      font-size: 1rem;
      font-weight: 600;
      /* 字体加粗一点更有力 */
      cursor: pointer;
      width: 100%;
      /* 宽度占满容器 */
      margin-top: 10px;
      transition: filter 0.15s ease;
      /* 点击效果用滤镜，更现代 */
      -webkit-tap-highlight-color: transparent;
      /* 去掉移动端点击时的蓝色背景 */
    }

    .form-button:active {
      filter: brightness(0.9);
      /* 按下时变暗 */
    }

    .form-button:disabled {
      background-color: #ccc !important;
      /* 用!important确保覆盖所有情况 */
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* 2. 主要操作按钮的“皮肤” (蓝色) */
    .form-button {
      background-color: #007aff;
      /* Apple Blue */
      color: white;
    }

    /* 3. 次要操作按钮的“皮肤” (灰色) */
    .form-button.secondary {
      background-color: #e5e5ea;
      /* Apple Light Gray */
      color: #000;
    }

    /* 4. 危险/破坏性操作按钮的“皮肤” (红色) */
    .form-button.destructive {
      background-color: #ff3b30;
      /* Apple Red */
      color: white;
    }

    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */

    /* 1. Dock栏的样式 */
    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */
    #home-dock {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      height: 85px;
      padding: 0 20px;
      /* 图标左右的留白 */
      box-sizing: border-box;

      /* 背景和滤镜，现在都在这里 */
      background: var(--surface-bg);
      backdrop-filter: blur(5px) saturate(0.8);
      -webkit-backdrop-filter: blur(15px) saturate(0.8);
      border-radius: 28px;
      z-index: 35;

      /* 核心：用Flexbox来自动排列图标 */
      display: flex;
      justify-content: space-around;
      /* 均匀分布 */
      align-items: center;
      /* 垂直居中 */
      padding-top: 9px;
    }

    #home-dock .app-icon {
      position: static;
      /* 取消绝对定位，让它接受Flexbox的管理 */
    }

    /* 2. App图标的“整容手术” */
    .app-icon-img {
      width: 58px;
      /* 图标背景尺寸 */
      height: 58px;
      border-radius: 22.5%;
      /* iOS标志性的“方圆”形 */
      font-size: 28px;
      /* 阴影从图标本身移到背景上，更统一 */
      background-color: var(--surface-bg);
      box-shadow: none;
      /* 删掉旧的阴影 */
      transition: transform 0.2s ease;
    }

    .app-icon:active .app-icon-img {
      transform: scale(0.92);
      /* 按下时图标有反馈 */
    }

    /* --- Noir's Minimalist Home Screen Makeover (v2.0 Dynamic Edition) --- */
    /* 哼，现在这些家伙也听从总开关的指挥了。*/

    /* 1. 时钟和日期 */
    #home-clock-container {
      color: var(--text-color);
      text-shadow: none;
    }

    #home-date {
      opacity: 0.7;
    }

    /* 2. App图标的改造 (现在是动态颜色了) */
    .app-icon span {
      color: var(--text-color);
      text-shadow: none;
      font-weight: 500;
    }

    .app-icon-img {
      background-color: var(--card-bg);
      /* <-- 哼，接上了！*/
      color: var(--text-color-light);
      /* <-- 接上了！*/
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    /* 3. Dock栏的颜色 (也动态了) */


    /* 4. 唱片机也给你一起接上了，免得你下次又来烦我 */
    #music-widget-card {
      background: var(--surface-bg);
      box-shadow: var(--soft-shadow);
      border-color: hsla(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 10%), 0.5);
    }

    .widget-content-overlay {
      background: var(--card-bg);
      color: var(--text-color);
    }

    #widget-controls button,
    #music-widget .widget-info #widget-title,
    #music-widget .widget-info #widget-artist {
      color: var(--text-color);
    }

    #widget-cover-art::after {
      background: var(--text-color);
      border-color: hsl(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 18%));
    }

    /* --- Noir's Theme Preset Buttons --- */
    /* 哼，每个按钮都是一件艺术品。 */
    .theme-preset-button {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 20px;
      /* 胶囊形状 */
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--card-bg);
    }

    .theme-preset-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--soft-shadow);
    }

    .preset-color-dot {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>

<body>
  <input type="file" id="audio-file-input" style="display: none;" accept=".flac,.mp3">
  <input type="file" id="cover-file-input" style="display: none;" accept=".jpg,.png,.jpeg,.webp">
  <input type="file" id="info-file-input" style="display: none;" accept=".txt">
  <input type="file" id="lyrics-file-input" style="display: none;" accept=".lrc">
  <div id="phone-container">

    <div id="user-profile-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-user-list" class="header-button">主屏幕</button>
        <span class="header-title">选择用户</span>
        <button id="add-user-profile-button" class="header-button add" title="添加新用户">+</button>
      </div>
      <div class="content" id="user-profile-list-container">
      </div>
    </div>

    <div id="user-profile-screen" class="screen">
      <div class="header">
        <button id="back-to-user-list-from-edit" class="header-button">返回</button>
        <span id="user-profile-edit-title" class="header-title">编辑用户</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-user-id">
        <div class="settings-group">
          <h2>用户设定</h2>
          <div class="input-group">
            <label for="user-name">你的名字</label>
            <input type="text" id="user-name" placeholder="你的显示名字">
          </div>
          <div class="avatar-upload-group">
            <label>你的头像</label>
            <img id="user-avatar-preview" class="avatar-preview" alt="User Avatar Preview">
            <input type="file" id="user-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="user-persona">你的人设 (可选)</label>
            <textarea id="user-persona" placeholder="向AI介绍你自己。例如：我是一名大学生，喜欢摄影和旅行。"></textarea>
          </div>
        </div>
        <button id="save-user-profile-button" class="form-button">保存资料</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="set-active-user-button" class="form-button"
            style="background-color: #28a745; margin-bottom: 10px;">设为当前用户</button>
          <button id="delete-user-profile-button" class="form-button" style="background-color: #dc3545;">删除该用户</button>
        </div>
      </div>
    </div>


    <div id="home-screen" class="screen active">
      <div id="home-screen-main-content" style="position: relative; flex-grow: 1; width: 100%;">
        <div id="home-clock-container">
          <div id="home-time">11:31</div>
          <div id="home-date">8月29日 星期五</div>
          <div id="noir-author-mark"></div>
        </div>


        <div id="decorative-badge" style="display: none; position: absolute; top: 250px; left: 50px;">
          <img id="badge-image" src="http://googleusercontent.com/file_content/0" alt="badge">
        </div>

        <div id="card-widget" style="display: none; position: absolute; top: 140px; left: 145px;">
          <img id="card-image" src="" alt="card widget">
        </div>






        <div class="app-icon" id="app-world-book">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
              <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
            </svg></div>
          <span>世界书</span>
        </div>


        <div class="app-icon" id="app-diary">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <path d="M2.5 17a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zM2.5 14a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z" />
            </svg></div>
          <span>交换日记</span>
        </div>

        <div class="app-icon" id="app-music-library">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
              <path
                d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
              </path>
            </svg></div>
          <span>音乐库</span>
        </div>


        <div class="app-icon" id="app-settings">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path
                d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
              </path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg></div>
          <span>API设置</span>
        </div>
        <div class="app-icon" id="app-user-profiles">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg></div>
          <span>我</span>
        </div>
        <div class="app-icon" id="app-wallpaper">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path
                d="M12 2.69l.34.34a1.41 1.41 0 0 0 2 0L22 6.34a1.41 1.41 0 0 0 0-2l-7.66-7.66a1.41 1.41 0 0 0-2 0L2.68 14.34a1.41 1.41 0 0 0 0 2L10 24l2-2 2-2 2-2 2-2 2-2">
              </path>
              <path d="m7.34 2.66 14 14"></path>
            </svg></div>
          <span>更换壁紙</span>
        </div>
      </div>
      <div id="home-dock">
        <div class="app-icon app-icon-large" id="app-chat">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg></div>
          <span>聊天</span>
        </div>
        <div class="app-icon" id="app-music">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 18V5l12-2v13"></path>
              <circle cx="6" cy="18" r="3"></circle>
              <circle cx="18" cy="16" r="3"></circle>
            </svg></div>
          <span>动态</span>
        </div>
        <div class="app-icon" id="app-meeting">
          <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14 9a2 2 0 0 1-2 2H6l-4 4V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4Z" />
              <path d="M18 9h2a2 2 0 0 1 2 2v9l-4-4h-2a2 2 0 0 1-2-2V9Z" />
            </svg></div>
          <span>见面</span>
        </div>
      </div>
    </div>

    <div id="chat-screen" class="screen">
      <div id="chat-screen-container">
        <div id="chat-list-pane">
          <div id="chat-list-header">
            <button id="back-to-home-from-chat" class="header-button">主屏幕</button>
            <span class="header-title">聊天</span>
            <button id="add-chat-button" class="header-button add" title="添加新聊天">+</button>
          </div>
          <div id="chat-list-container">
            <ul id="character-list">
            </ul>
          </div>
        </div>
        <div id="chat-view-pane">
          <div class="header">
            <button class="header-button" id="back-to-chat-list">返回</button>
            <span id="char-name-header" class="header-title">角色</span>
            <button class="header-button" id="character-settings-button" title="角色设置">⚙️</button>
          </div>
          <div id="chat-messages" class="messages">
          </div>
          <div id="offline-scene-view"></div>
          <div id="chat-sticker-panel" class="sticker-panel">
          </div>
          <div class="chat-toolbar">
            <button id="chat-sticker-button" class="toolbar-button" title="表情">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5-2 4-2 4 2 4 2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
              </svg>
            </button>
            <button id="chat-image-button" class="toolbar-button" title="发送图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <button id="chat-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
            <button id="chat-listen-together-button" class="toolbar-button" title="一起听">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                <path
                  d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                </path>
              </svg>
            </button>
            <button id="chat-transfer-button" class="toolbar-button" title="转账">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
            </button>
            <button id="chat-reroll-button" class="toolbar-button" title="重新生成">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
              </svg>
            </button>
          </div>
          <input type="file" id="chat-image-input" accept="image/*" style="display: none;">
          <div id="quote-preview-area" class="quote-preview">
            <div class="quote-preview-content">
              <div id="quote-preview-sender"></div>
              <div id="quote-preview-text"></div>
            </div>
            <button id="cancel-quote-button" class="cancel-quote-btn">&times;</button>
          </div>
          <div class="chat-input-area">
            <div id="chat-input-wrapper">
              <input type="text" id="chat-message-input" placeholder="输入消息...">
              <button id="chat-get-reply-button" title="让对方回复">↵</button>
              <button id="chat-send-button" title="发送">➤</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="settings-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-settings" class="header-button">返回</button>
        <span class="header-title">API设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>API 设置</h2>
          <div class="input-group">
            <label for="api-endpoint">API 接口地址（不填/v1）</label>
            <input type="text" id="api-endpoint" placeholder="例如: https://api.openai.com">
          </div>
          <div class="input-group">
            <label for="api-key">API 密钥</label>
            <input type="password" id="api-key" placeholder="请输入你的 API 密钥">
          </div>
          <div class="input-group">
            <label for="api-model">模型</label>
            <div class="model-input-container">
              <input type="text" id="api-model" placeholder="点击 获取 或手动输入" style="flex-grow: 1;">
              <button id="fetch-models-button" style="padding: 0 12px; white-space: nowrap;">获取</button>
              <div id="model-dropdown" class="custom-model-dropdown"></div>
            </div>
          </div>
          <div class="input-group">
            <label for="api-provider">接口格式 (重要！请根据你使用的接口选择，但是我也没做Openai以外的接口……)</label>
            <select id="api-provider"
              style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color);">
              <option value="openai">OpenAI 格式 (通用，兼容绝大多数反代)</option>
              <option value="gemini">Google Gemini 格式 (仅限官方或特定反代)</option>
              <option value="anthropic">Anthropic Claude 格式</option>
            </select>
          </div>
        </div>
        <div class="settings-group">
          <h2>上下文设置</h2>
          <div class="input-group">
            <label for="context-lines-per-chat">每个会话读取的消息条数（默认 100）</label>
            <input type="number" id="context-lines-per-chat" min="1" max="1000000" step="1" placeholder="100">
          </div>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>数据管理</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            导出全部数据（角色、聊天记录、设置、桌面布局等）到一个文件，方便在其他设备或浏览器上导入。
          </p>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="export-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #007bff;">导出全部数据</button>
            <button id="import-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #28a745;">导入数据</button>
          </div>
          <input type="file" id="import-data-input" accept=".json" style="display: none;">
        </div>
        <button id="save-api-settings-button" class="form-button">保存 API 设置</button>
      </div>
    </div>



    <div id="character-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-edit" class="header-button">返回</button>
        <span id="character-edit-title" class="header-title">编辑角色</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-char-id">
        <div class="settings-group">
          <h2>角色设定</h2>
          <div class="input-group">
            <label for="char-edit-name">名字</label>
            <input type="text" id="char-edit-name" placeholder="角色的名字">
          </div>
          <div class="input-group">
            <label for="char-edit-remark">备注名</label>
            <input type="text" id="char-edit-remark" placeholder="方便自己记忆，例如 '工作助理'">
          </div>
          <div class="avatar-upload-group">
            <label>角色头像</label>
            <img id="char-edit-avatar-preview" class="avatar-preview" alt="Avatar Preview">
            <input type="file" id="char-edit-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-persona">人设 (系统提示词)</label>
            <textarea id="char-edit-persona" placeholder="你是一个乐于助人的助手。"></textarea>
          </div>
          <div class="input-group">
            <label>聊天壁纸</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-wallpaper-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="聊天壁纸预览">
            </div>
            <input type="file" id="char-edit-wallpaper-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-css">专属气泡样式 (CSS)</label>
            <textarea id="char-edit-css" rows="8"
              placeholder="从其他地方复制的、包含 .sent 和 .received 的CSS代码可以直接粘贴在这里..."></textarea>

            <div style="display: flex; gap: 10px; margin-top: 5px;">
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">TA的气泡 (Received):</p>
                <div id="bubble-preview-ai" class="message ai">这是TA的气泡预览效果</div>
              </div>
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">你的气泡 (Sent):</p>
                <div id="bubble-preview-user" class="message user">这是你的气泡预览效果</div>
              </div>
            </div>
          </div>
          <div class="input-group">
            <label>见面场景背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-offline-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="见面背景预览">
            </div>
            <input type="file" id="char-edit-offline-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="settings-group">
            <h2>角色立绘 (Galgame模式)</h2>
            <p style="font-size: 0.8rem; color: var(--text-color-light);">为五种核心情绪上传立绘图，建议使用透明背景的PNG图片。</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px;">

              <div class="avatar-upload-group" style="align-items: center;">
                <label>平常</label>
                <img id="char-edit-sprite-normal-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="平常立绘">
                <input type="file" id="char-edit-sprite-normal-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>喜</label>
                <img id="char-edit-sprite-happy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="喜立绘">
                <input type="file" id="char-edit-sprite-happy-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>怒</label>
                <img id="char-edit-sprite-angry-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="怒立绘">
                <input type="file" id="char-edit-sprite-angry-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>哀</label>
                <img id="char-edit-sprite-sad-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="哀立绘">
                <input type="file" id="char-edit-sprite-sad-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>害羞</label>
                <img id="char-edit-sprite-shy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="害羞立绘">
                <input type="file" id="char-edit-sprite-shy-input" accept="image/*" style="display: none;">
              </div>
            </div>
          </div>
          <div class="input-group">
            <label for="char-edit-bind-user">绑定用户</label>
            <select id="char-edit-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="world-book-checkboxes-container" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="save-char-button" class="form-button">保存角色</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="edit-clear-history-button" class="form-button"
            style="background-color: #ffc107; margin-bottom: 10px;">清空聊天记录</button>
          <button id="edit-delete-char-button" class="form-button" style="background-color: #dc3545;">删除角色</button>
        </div>
      </div>
    </div>

    <div id="group-chat-create-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-group-create" class="header-button">返回</button>
        <span class="header-title">创建群聊</span>
        <button id="create-group-chat-button" class="header-button">创建</button>
      </div>
      <div class="content" style="padding: 20px;">
        <div class="input-group">
          <label for="group-chat-name">群聊名称</label>
          <input type="text" id="group-chat-name" placeholder="给你的群聊起个名字">
        </div>
        <div class="settings-group">
          <h2>选择成员</h2>
          <div id="group-chat-member-list-container"
            style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
            <ul id="group-chat-member-list">
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div id="wallpaper-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-wallpaper" class="header-button">返回</button>
        <span class="header-title">更换壁纸</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2>全局主题色</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">拖动滑块来改变整个App的主色调。</p>
          <div class="input-group" style="padding-top: 10px;">
            <label for="theme-hue-slider" style="display: block; margin-bottom: 5px;">色相 (Hue)</label>
            <input type="range" id="theme-hue-slider" min="0" max="360" value="35" style="width: 100%;">
          </div>
          <div class="input-group">
            <label for="theme-lightness-slider" style="display: block; margin-bottom: 5px;">明度 (Lightness)</label>
            <input type="range" id="theme-lightness-slider" min="15" max="95" value="80" style="width: 100%;">
          </div>
        </div>
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2 style="margin-top: 0;">时钟样式</h2>
          <div style="display: flex; align-items: center; gap: 10px;">
            <input type="checkbox" id="clock-color-toggle" style="width: auto; height: 18px; flex-shrink: 0;">
            <label for="clock-color-toggle" style="width: auto; font-size: 0.9rem;">强制使用纯白色时钟 (推荐在深色壁纸下使用)</label>
          </div>
        </div>
        <div class="settings-group">
          <h2>上传新壁纸</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">选择一张图片作为你的手机壁纸。为了效果最好，请使用竖屏图片。</p>
          <input type="file" id="wallpaper-input" accept="image/*" style="display: none;">
          <button id="upload-wallpaper-button" class="form-button">选择图片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>音乐小组件背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的主屏幕音乐小组件设置一张专属背景图。</p>
          <input type="file" id="widget-bg-input" accept="image/*" style="display: none;">
          <button id="upload-widget-bg-button" class="form-button">选择图片</button>
          <button id="reset-widget-bg-button" class="form-button secondary">恢复默认</button>
        </div>
        <div class="settings-group" style="margin-top: 20px;">
          <h2>重置桌面</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">此操作会将所有桌面小组件（时钟、音乐、徽章等）恢复到初始位置，并将壁纸重置为纯白色。</p>
          <button id="reset-desktop-button" class="form-button destructive">重置桌面布局</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义徽章</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面徽章，可以拖动它到任意位置。</p>
          <input type="file" id="badge-input" accept="image/*" style="display: none;">
          <button id="upload-badge-button" class="form-button">选择徽章图片</button>
          <button id="reset-badge-button" class="form-button"
            style="background-color: #777; margin-top: 10px;">移除徽章</button>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面方形卡片小组件。</p>
          <input type="file" id="card-input" accept="image/*" style="display: none;">
          <button id="upload-card-button" class="form-button">选择卡片图片</button>
          <button id="reset-card-button" class="form-button"
            style="background-color: #777; margin-top: 10px;">移除卡片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>动态页背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为“动态”页面设置一张独立的背景图，让它与众不同。</p>
          <input type="file" id="feed-bg-input" accept="image/*" style="display: none;">
          <button id="upload-feed-bg-button" class="form-button">选择图片</button>
        </div>
        <button id="reset-feed-bg-button" class="form-button"
          style="background-color: #777; margin-top: 10px;">移除背景</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>小组件救援</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">如果你的吧唧或卡片不小心飞出屏幕找不到了，点这里让它们回家。</p>
          <button id="reset-widgets-position-button" class="form-button"
            style="background-color: #ffc107;">重置小组件位置</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义App图标</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">替换主屏幕上App的默认图标。为了最佳效果，请使用方形、透明背景的图片。</p>
          <div class="settings-group"
            style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
            <h2>自定义表情包</h2>
            <p style="font-size: 0.9rem; color: var(--text-color-light);">
              在这里追加你的专属表情包。每个表情占一行，格式为：<br>
              <b>表情名--图片URL</b><br>
              例如：<br>
              <code>开心--https://example.com/happy.png</code><br>
              <code>难过--https://example.com/sad.gif</code>
            </p>
            <textarea id="custom-stickers-input" rows="8" placeholder="请按指定格式粘贴..."></textarea>
            <button id="save-custom-stickers-button" class="form-button" style="margin-top: 5px;">保存并刷新表情包</button>
          </div>
          <div id="custom-icon-list-container">
          </div>
          <div id="custom-icon-list-container">
          </div>
        </div>
      </div>

    </div>

    <div id="world-book-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-world-book" class="header-button">主屏幕</button>
        <span class="header-title">世界书</span>
        <button id="add-world-book-button" class="header-button add" title="添加新世界书">+</button>
      </div>
      <div class="content" id="world-book-list-container">
      </div>
    </div>

    <div id="world-book-editor-screen" class="screen">
      <div class="header">
        <button id="back-to-world-book-list" class="header-button">返回</button>
        <span id="world-book-editor-title" class="header-title">编辑条目</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-world-book-id">
        <div class="settings-group">
          <h2>设定条目</h2>
          <div class="input-group">
            <label for="world-book-edit-name">条目名称 (Key)</label>
            <input type="text" id="world-book-edit-name" placeholder="例如：我的过去、特殊能力">
          </div>
          <div class="input-group">
            <label for="world-book-edit-content">条目内容 (Value)</label>
            <textarea id="world-book-edit-content" placeholder="输入详细的设定内容..."></textarea>
          </div>
        </div>
        <button id="save-world-book-button" class="form-button">保存条目</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="delete-world-book-button" class="form-button" style="background-color: #dc3545;">删除该条目</button>
        </div>
      </div>
    </div>

    <div id="group-settings-screen" class="screen">
      <div class="header">
        <button id="back-to-chat-from-group-settings" class="header-button">返回</button>
        <span class="header-title">群聊设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>群聊信息</h2>
          <div class="input-group">
            <label for="group-settings-name">群聊名称</label>
            <input type="text" id="group-settings-name">
          </div>
          <div class="avatar-upload-group">
            <label>群头像</label>
            <img id="group-avatar-preview" class="avatar-preview" alt="Group Avatar Preview">
            <input type="file" id="group-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label>群聊背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="group-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="群聊背景预览">
            </div>
            <input type="file" id="group-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="group-settings-bind-user">绑定用户</label>
            <select id="group-settings-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="group-world-book-checkboxes" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="save-group-settings-button" class="form-button">保存设置</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="group-clear-history-button" class="form-button"
            style="background-color: #ffc107; margin-bottom: 10px;">清空聊天记录</button>
          <button id="group-delete-button" class="form-button" style="background-color: #dc3545;">删除并解散群聊</button>
        </div>
      </div>
    </div>

    <div id="music-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-feed" class="header-button">返回</button>
        <span id="friend-circle-title" class="header-title">好友圈</span>
        <div style="display: flex; gap: 5px;">
          <button id="edit-current-circle-button" class="header-button" style="font-size: 1.2rem;">⚙️</button>
          <button id="clear-feed-button" class="header-button" style="color: #dc3545;">清空</button>
          <button id="refresh-feed-button" class="header-button">刷新</button>

        </div>
      </div>
      <div id="user-post-area"
        style="padding: 10px 15px; border-bottom: 1px solid var(--border-color); flex-shrink: 0; background: var(--surface-bg);">
        <div id="user-post-input-container">
          <img id="user-post-avatar" class="char-avatar">
          <div id="user-post-main-area">
            <textarea id="user-post-textarea" rows="3" placeholder="分享你的新鲜事..."></textarea>
            <div id="user-post-attachment-preview"></div>
          </div>
        </div>
        <div id="user-post-toolbar">
          <div class="user-post-actions">
            <button id="user-post-image-button" class="toolbar-button" title="分享图片">🖼️</button>
            <input type="file" id="user-post-image-input" accept="image/*" style="display: none;">
            <button id="user-post-music-button" class="toolbar-button" title="分享音乐">🎵</button>
          </div>
          <button id="user-send-post-button">发送</button>
        </div>
      </div>
      <div id="music-feed-container" class="content" style="padding: 10px;">
      </div>
      <div id="music-player-bar" class="hidden">
        <img id="player-cover" src="">
        <div id="player-info">
          <div id="player-title"></div>
          <div id="player-artist"></div>
        </div>
        <div id="player-controls">
          <button id="player-prev-btn">⏮</button>
          <button id="player-play-pause-btn">▶</button>
          <button id="player-next-btn">⏭</button>
        </div>
      </div>
      <audio id="audio-player"></audio>
    </div>
    <div id="meeting-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-meeting-list" class="header-button">主屏幕</button>
        <span class="header-title">选择见面对象</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="meeting-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="meeting-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-meeting-list">返回</button>
        <span id="meeting-char-name-header" class="header-title">角色</span>
        <button id="toggle-meeting-view-button" class="header-button">切换视角</button>

      </div>
      <div id="meeting-main-content" class="content" style="position: relative; padding: 0;">
        <div id="galgame-overlay-ui">
          <div id="galgame-time">12:00</div>
          <div id="galgame-date">1月1日 星期一</div>
        </div>
        <div id="meeting-scene-view" class="content"
          style="font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif; color: white; text-shadow: 0 1px 3px rgba(0,0,0,0.7);">
        </div>
        <div id="galgame-view-container"
          style="display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; overflow: hidden;">
          <div id="galgame-sprite-container"
            style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; height: 100%; display: flex; align-items: flex-end; justify-content: center;">
            <img id="galgame-sprite" src=""
              style="max-height: 80%; max-width: 80%; object-fit: contain; transition: opacity 0.3s ease;">
          </div>
          <div id="galgame-textbox-container"
            style="position: absolute; bottom: 9%; left: 5%; right: 5%; background: rgba(0, 0, 0, 0.7); border-radius: 10px; padding: 15px; color: white; border-top: 1px solid rgba(255,255,255,0.2); cursor: pointer;">
            <div id="galgame-speaker" style="font-weight: bold; margin-bottom: 10px;">说话人</div>
            <div id="galgame-text" style="line-height: 1.6;">对话内容...</div>
          </div>
        </div>
      </div>
      <div class="chat-input-area">
        <div id="chat-input-wrapper-meeting"> <textarea id="meeting-message-input" placeholder="输入你的行动或对话..." rows="1"
            style="resize: none; overflow-y: auto; flex-grow: 1; border: none; background: transparent; padding: 9px 12px; font-size: .95rem; outline: none; color: var(--text-color);"></textarea>
          <button id="meeting-send-button" title="发送">➤</button>
        </div>
      </div>
    </div>

    <div id="friend-circle-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-circle-list" class="header-button">主屏幕</button>
        <span class="header-title">好友圈</span>
        <button id="add-friend-circle-button" class="header-button add" title="新建好友圈">+</button>
      </div>
      <div id="friend-circle-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="friend-circle-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-edit" class="header-button">返回</button>
        <span id="friend-circle-edit-title" class="header-title">编辑好友圈</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-friend-circle-id">
        <div class="settings-group">
          <h2>好友圈设定</h2>
          <div class="input-group">
            <label for="friend-circle-edit-name">圈子名称</label>
            <input type="text" id="friend-circle-edit-name" placeholder="例如：我的日常">
          </div>
          <div class="input-group">
            <label for="friend-circle-edit-bind-user">绑定的“我”</label>
            <select id="friend-circle-edit-bind-user"></select>
          </div>
        </div>
        <div class="settings-group">
          <h2>选择圈内成员</h2>
          <div id="friend-circle-member-selection"
            style="max-height: 250px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
          </div>
        </div>
        <button id="save-friend-circle-button" class="form-button">保存</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <button id="delete-friend-circle-button" class="form-button"
            style="background-color: #dc3545;">删除该好友圈</button>
        </div>
      </div>
    </div>
    <div id="diary-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-diary-list" class="header-button">主屏幕</button>
        <span class="header-title">交换日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="diary-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-diary-list">返回</button>
        <span id="diary-char-name-header" class="header-title">TA的日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-entries-container" class="content"
        style="padding: 20px; font-family: 'KaiTi', 'STSong', serif; line-height: 1.8;">
      </div>
      <div class="chat-input-area">
        <div id="diary-input-wrapper" style="display: flex; gap: 10px;">
          <input type="text" id="diary-entry-input" placeholder="写下你的日记或批注..." style="flex-grow: 1;">
          <button id="diary-send-button" class="form-button"
            style="width: auto; margin-top: 0; padding: 0 18px;">写好了</button>
          <button id="diary-get-reply-button" class="form-button"
            style="width: auto; margin-top: 0; background-color: #555; padding: 0 18px;">催TA写</button>
        </div>
      </div>
    </div>
    <div id="music-library-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-music-library" class="header-button">主屏幕</button>
        <span class="header-title">音乐库</span>
        <button id="upload-music-button" class="header-button add" title="上传新音乐">+</button>
      </div>
      <div class="content" id="music-library-container">
      </div>
    </div>
    <div id="music-upload-altar-screen" class="screen">
      <div class="header">
        <button id="back-to-library-from-altar" class="header-button">取消</button>
        <span class="header-title">献上音乐</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content" style="padding: 20px; display: flex; flex-direction: column; gap: 15px;">

        <div class="upload-slot" id="altar-slot-audio">
          <span class="slot-icon">🎵</span>
          <span class="slot-label">音频文件 (必需)</span>
          <span class="slot-filename">点击选择 .mp3 或 .flac</span>
        </div>

        <div class="upload-slot" id="altar-slot-cover">
          <span class="slot-icon">🖼️</span>
          <span class="slot-label">封面图片 (可选)</span>
          <span class="slot-filename">点击选择 .jpg 或 .png</span>
        </div>

        <div class="upload-slot" id="altar-slot-info">
          <span class="slot-icon">📄</span>
          <span class="slot-label">歌曲信息 (必需)</span>
          <span class="slot-filename">点击选择 info.txt</span>
        </div>

        <div class="upload-slot" id="altar-slot-lyrics">
          <span class="slot-icon">🎤</span>
          <span class="slot-label">歌词文件 (可选)</span>
          <span class="slot-filename">点击选择 .lrc</span>
        </div>

        <button id="confirm-altar-upload-button" class="form-button" disabled>献上祭品</button>
      </div>
    </div>
    <audio id="audio-player"></audio>

    <audio id="unified-audio-player"></audio>
    <div id="music-widget"
      style="  display: inline-block; width: auto; position: absolute; top: 45%; left: 50%; transform: translateX(-50%); z-index: 50;; padding: 0px;bottom: auto;">
      <div id="music-widget-card">
        <div id="widget-cover-art"></div>

        <div class="widget-content-overlay">
          <div class="widget-info">
            <div id="widget-title">暂无音乐</div>
            <div id="widget-artist">请在动态或聊天中播放</div>
          </div>
          <div id="widget-controls">
            <button id="widget-prev-btn">⏮</button>
            <button id="widget-play-pause-btn">▶</button>
            <button id="widget-next-btn">⏭</button>
          </div>
        </div>
      </div>
    </div>


  </div>
  </div>

  <div id="add-choice-modal" class="choice-modal">
    <div id="add-choice-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="choice-create-character" class="choice-modal-button">创建新角色</button>
      <button id="choice-create-group" class="choice-modal-button">创建新群聊</button>
      <button id="choice-cancel" class="choice-modal-button cancel">取消</button>
    </div>
  </div>


  <div id="transfer-modal" class="choice-modal">
    <div id="transfer-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">转账</h3>
      <div id="transfer-recipient-group" class="input-group" style="margin: 10px 0; display: none;">
        <label for="transfer-recipient-select">转给</label>
        <select id="transfer-recipient-select"></select>
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="transfer-amount-input">金额</label>
        <input type="number" id="transfer-amount-input" placeholder="输入金额">
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-transfer-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认转账</button>
        <button id="cancel-transfer-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="message-action-modal" class="choice-modal">
    <div id="message-action-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="edit-message-button" class="choice-modal-button">编辑消息</button>
      <button id="quote-message-button" class="choice-modal-button">引用</button>
      <button id="delete-message-button" class="choice-modal-button" style="color: #dc3545;">删除消息</button>
      <button id="cancel-action-button" class="choice-modal-button cancel">取消</button>
    </div>
  </div>

  <div id="edit-message-modal" class="choice-modal">
    <div id="edit-message-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">编辑消息</h3>
      <textarea id="edit-message-textarea" style="width: 100%; min-height: 100px; margin: 10px 0;"></textarea>
      <div style="display: flex; gap: 10px; margin-top: 10px;">
        <button id="save-edit-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">保存</button>
        <button id="cancel-edit-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="music-input-modal" class="choice-modal">
    <div id="music-input-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 id="music-input-title" style="margin-top: 0; text-align: center; font-weight: 600;">分享音乐</h3>

      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-song" style="font-size: 0.9rem;">歌名</label>
        <input type="text" id="music-input-song" placeholder="例如：夜曲">
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-artist" style="font-size: 0.9rem;">歌手</label>
        <input type="text" id="music-input-artist" placeholder="例如：周杰伦">
      </div>

      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-music-input" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认</button>
        <button id="cancel-music-input" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="modal-root"
    style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9999;">
    <div id="modal-mask" style="position:absolute;inset:0;background:rgba(0,0,0,.35);"></div>
    <div id="modal-dialog"
      style="position:relative;background:#fff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);width:80%;max-width:320px;padding:16px;">
      <div id="modal-text" style="font-size:14px;color:#333;line-height:1.5;white-space:pre-wrap;"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:16px;">
        <button id="modal-cancel"
          style="padding:8px 12px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer;">取消</button>
        <button id="modal-ok"
          style="padding:8px 12px;border:none;border-radius:8px;background:#007bff;color:#fff;cursor:pointer;">确定</button>
      </div>
    </div>
  </div>

  <div id="listen-together-modal" class="choice-modal">
    <div id="listen-together-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <div style="width: 50px;"></div>
        <span class="header-title">选择一首歌，一起听</span>
        <button id="cancel-listen-together" class="header-button" style="min-width: 50px;">取消</button>
      </div>
      <div id="listen-together-song-list" class="content" style="flex-grow: 1; padding: 10px;">
      </div>
    </div>
  </div>

  <div id="toast"
    style="position:fixed;left:50%;bottom:32px;transform:translateX(-50%);background:rgba(0,0,0,.8);color:#fff;padding:8px 12px;border-radius:8px;font-size:12px;display:none;z-index:10000;">
  </div>



  <script>
    const _0x3145f6 = _0x52f2; (function (_0x391de1, _0x3be12a) { const _0x12bf87 = _0x52f2, _0x4af6b2 = _0x391de1(); while (!![]) { try { const _0x490b0d = -parseInt(_0x12bf87(0x68f)) / 0x1 + -parseInt(_0x12bf87(0x77f)) / 0x2 * (-parseInt(_0x12bf87(0x81e)) / 0x3) + parseInt(_0x12bf87(0x6f7)) / 0x4 * (parseInt(_0x12bf87(0x6eb)) / 0x5) + -parseInt(_0x12bf87(0x195)) / 0x6 + parseInt(_0x12bf87(0x6a9)) / 0x7 + parseInt(_0x12bf87(0x78e)) / 0x8 * (-parseInt(_0x12bf87(0x4b3)) / 0x9) + -parseInt(_0x12bf87(0x4ef)) / 0xa; if (_0x490b0d === _0x3be12a) break; else _0x4af6b2['push'](_0x4af6b2['shift']()); } catch (_0x41e837) { _0x4af6b2['push'](_0x4af6b2['shift']()); } } }(_0x49a3, 0x4bcb8)); var _0x24ae96, _0x393e7f = null; let _0x438419 = [], _0x412403 = ![], _0x33d2b9 = { 'x': 0x0, 'y': 0x0 }; function _0x406579(_0x46c784) { const _0x26ec20 = _0x52f2; return (_0x24ae96?.[_0x26ec20(0x4c0)] || [])[_0x26ec20(0x1c6)](_0x16a53a => _0x16a53a['id'] === _0x46c784); } const _0x26161e = _0x3145f6(0x60c), _0x4be95c = _0x3145f6(0x172), _0x5d2cd8 = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNjY2MiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDRhNC4zOSA0LjM5IDAgMCAwLTMuMjgtNC4wOWwxLjQxLTEuNDFhMiAyIDAgMSAwLTIuODMtMi4wM2wtMS40MSAxLjQxQTQuMzkgNC4zOSAwIDAgMCAxMiAxMGE0LjM5IDQuMzkgMCAwIDAtNC4wOSAzLjI4TDMuMicgOS41N2EyIDIgMCAxIDAgMi44MyAyLjgzbDEuNDEtMS40MUE0LjM5IDQuMzkgMCAwIDAgMTAgMTJhNC4zOSA0LjM5IDAgMCAwIDMgNC4wOVYyMSI+PC9wYXRoPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIj48L2NpcmNsZT48L3N2Zz4=', _0x13c5ee = [{ 'name': _0x3145f6(0x7fc), 'url': _0x3145f6(0x4c4) }, { 'name': '崩溃', 'url': 'http://sharkpan.xyz/f/G0dTl/4qad2i.jpg' }, { 'name': '生病', 'url': 'http://sharkpan.xyz/f/zLes5/4lxzjn.jpg' }, { 'name': '工作', 'url': _0x3145f6(0xd8) }, { 'name': '我很脆弱', 'url': 'http://sharkpan.xyz/f/ABwhZ/twknmr.jpg' }, { 'name': '弱小委屈但凶恶', 'url': _0x3145f6(0x61c) }, { 'name': '吃薯条', 'url': _0x3145f6(0x7d5) }, { 'name': '期待', 'url': _0x3145f6(0x82c) }, { 'name': '喜欢', 'url': 'http://sharkpan.xyz/f/55ntj/ul0hkz.jpg' }, { 'name': '被萌到', 'url': _0x3145f6(0x107) }, { 'name': _0x3145f6(0x376), 'url': _0x3145f6(0x626) }, { 'name': '委屈', 'url': 'http://sharkpan.xyz/f/ajwtY/x03qxn.gif' }, { 'name': '加油', 'url': _0x3145f6(0x692) }, { 'name': '对的', 'url': _0x3145f6(0x48c) }, { 'name': '不满', 'url': _0x3145f6(0x370) }, { 'name': _0x3145f6(0x208), 'url': _0x3145f6(0x1bc) }, { 'name': _0x3145f6(0x3cd), 'url': _0x3145f6(0x39d) }, { 'name': '委屈', 'url': _0x3145f6(0x2da) }, { 'name': '平静', 'url': _0x3145f6(0x5de) }, { 'name': '咬你', 'url': _0x3145f6(0x75d) }, { 'name': '咱俩天下第一好', 'url': _0x3145f6(0x493) }, { 'name': '好困', 'url': _0x3145f6(0x2e7) }, { 'name': '摸鱼', 'url': _0x3145f6(0x314) }, { 'name': '委屈那我歇了', 'url': _0x3145f6(0x6c1) }, { 'name': _0x3145f6(0x643), 'url': _0x3145f6(0x120) }, { 'name': _0x3145f6(0x2a9), 'url': 'http://sharkpan.xyz/f/4adUj/68uj9o.jpg' }, { 'name': '一起听歌', 'url': 'http://sharkpan.xyz/f/N0VCv/5rd8br.jpg' }, { 'name': _0x3145f6(0x4bf), 'url': _0x3145f6(0x11f) }, { 'name': '啥意思捏', 'url': _0x3145f6(0x5bd) }, { 'name': _0x3145f6(0x74d), 'url': _0x3145f6(0x601) }, { 'name': _0x3145f6(0x3e9), 'url': _0x3145f6(0x75f) }, { 'name': _0x3145f6(0x539), 'url': _0x3145f6(0x653) }, { 'name': _0x3145f6(0x5c1), 'url': _0x3145f6(0x44d) }, { 'name': _0x3145f6(0x823), 'url': 'http://sharkpan.xyz/f/6Dgia/ghr4ji.jpg' }, { 'name': _0x3145f6(0x53f), 'url': _0x3145f6(0x630) }, { 'name': '干劲满满', 'url': _0x3145f6(0x717) }, { 'name': _0x3145f6(0x21a), 'url': _0x3145f6(0x4d2) }, { 'name': _0x3145f6(0x243), 'url': _0x3145f6(0xfb) }, { 'name': '无语但是随便吧', 'url': _0x3145f6(0x7a9) }, { 'name': _0x3145f6(0x74e), 'url': _0x3145f6(0x67f) }, { 'name': _0x3145f6(0x7d0), 'url': 'http://sharkpan.xyz/f/xjwSX/pxjrjd.jpg' }, { 'name': _0x3145f6(0x294), 'url': _0x3145f6(0x500) }, { 'name': _0x3145f6(0x45b), 'url': 'http://sharkpan.xyz/f/ljVCx/b16h2z.jpg' }, { 'name': _0x3145f6(0x260), 'url': 'http://sharkpan.xyz/f/Krwio/1mcclx.jpg' }, { 'name': _0x3145f6(0x536), 'url': 'http://sharkpan.xyz/f/ExKsD/s5j2it.jpg' }, { 'name': _0x3145f6(0x5b0), 'url': _0x3145f6(0x1e0) }, { 'name': _0x3145f6(0xea), 'url': _0x3145f6(0x2a1) }, { 'name': '不高兴撒娇', 'url': _0x3145f6(0x290) }, { 'name': _0x3145f6(0x3cb), 'url': 'http://sharkpan.xyz/f/Wa0cW/w6m7qk.jpg' }, { 'name': _0x3145f6(0x666), 'url': _0x3145f6(0x789) }, { 'name': _0x3145f6(0x240), 'url': _0x3145f6(0x7a2) }, { 'name': _0x3145f6(0x531), 'url': 'http://sharkpan.xyz/f/v0qcL/dio7j0.jpg' }, { 'name': _0x3145f6(0x266), 'url': _0x3145f6(0x4db) }, { 'name': '等你', 'url': _0x3145f6(0x639) }, { 'name': _0x3145f6(0x204), 'url': _0x3145f6(0x317) }, { 'name': '等你消息', 'url': _0x3145f6(0x418) }, { 'name': '喝酒', 'url': _0x3145f6(0x15e) }, { 'name': '喝多了', 'url': _0x3145f6(0x762) }, { 'name': '呜呜', 'url': _0x3145f6(0x24c) }, { 'name': '为你骄傲', 'url': _0x3145f6(0x6fd) }, { 'name': _0x3145f6(0x505), 'url': _0x3145f6(0x7e1) }, { 'name': _0x3145f6(0x564), 'url': _0x3145f6(0x72d) }, { 'name': _0x3145f6(0x3eb), 'url': _0x3145f6(0x2db) }, { 'name': _0x3145f6(0x2e3), 'url': _0x3145f6(0x2b8) }], _0xd96506 = { 'beige': { 'name': '默认米白', 'h': 0x23, 's': 0x19, 'l': 0x50 }, 'mizuiro': { 'name': '薄荷水色', 'h': 0xc3, 's': 0x19, 'l': 0x50 }, 'sakura': { 'name': _0x3145f6(0x70f), 'h': 0x159, 's': 0x19, 'l': 0x50 }, 'noir': { 'name': _0x3145f6(0x680), 'h': 0x104, 's': 0xf, 'l': 0x1e } }; document[_0x3145f6(0x41c)](_0x3145f6(0x5d7), () => { const _0x113cd8 = _0x3145f6, _0x44ad80 = document['getElementById'](_0x113cd8(0x5f0)), _0x2ebdd2 = document[_0x113cd8(0x2c0)](_0x113cd8(0x3be)), _0x352f69 = document[_0x113cd8(0x2c0)](_0x113cd8(0x81c)), _0x443323 = document['getElementById']('transfer-backdrop'), _0x4efe48 = document[_0x113cd8(0x2c0)](_0x113cd8(0x2ea)), _0x57e483 = document[_0x113cd8(0x2c0)](_0x113cd8(0x255)), _0x2495c8 = document[_0x113cd8(0x2c0)](_0x113cd8(0x408)), _0x5cff9e = document[_0x113cd8(0x2c0)](_0x113cd8(0x425)), _0x306ae3 = document['getElementById'](_0x113cd8(0x50b)), _0x3a6435 = document[_0x113cd8(0x2c0)]('chat-reroll-button'), _0x2445b2 = document[_0x113cd8(0x2c0)](_0x113cd8(0x43e)), _0x2ca4d3 = document[_0x113cd8(0x2c0)]('char-edit-wallpaper-input'), _0x3606cf = document[_0x113cd8(0x2c0)](_0x113cd8(0x5c5)), _0xabef21 = document[_0x113cd8(0x2c0)](_0x113cd8(0x7aa)); function _0x5dafef() { const _0x1141fe = _0x113cd8; if ('PXuwZ' === _0x1141fe(0x792)) { const _0x2fd08d = _0x1d3229(_0x48a996[_0x1141fe(0x6a5)]); _0x2fd08d && (_0x2d90b5 = _0x2fd08d[_0x1141fe(0x7e5)], _0x249f94 = _0x2fd08d['avatar']); } else { const _0x4d9396 = document[_0x1141fe(0x2c0)](_0x1141fe(0x4ad)); if (!_0x4d9396) return; const _0x35c30f = localStorage[_0x1141fe(0x696)](_0x1141fe(0x467)) || '35'; document['documentElement'][_0x1141fe(0x610)]['setProperty'](_0x1141fe(0xd9), _0x35c30f), _0x4d9396[_0x1141fe(0x69f)] = _0x35c30f, _0x4d9396['addEventListener'](_0x1141fe(0xf4), () => { const _0x96ba3c = _0x1141fe; if ('dFGNZ' !== 'dFGNZ') _0x25b549[_0x96ba3c(0x515)](_0x96ba3c(0x68e) + _0x44e40a[_0x96ba3c(0x192)], _0x1e1aff[_0x96ba3c(0x3fd)](_0x4ac7e1[_0x96ba3c(0x5bb)])); else { const _0x424bf3 = _0x4d9396[_0x96ba3c(0x69f)]; document[_0x96ba3c(0x3c4)][_0x96ba3c(0x610)][_0x96ba3c(0x554)](_0x96ba3c(0xd9), _0x424bf3), localStorage[_0x96ba3c(0x515)]('themeHue', _0x424bf3), _0x1994ce(); } }); } } function _0x20eb95() { const _0x3b617e = _0x113cd8; if (_0x3b617e(0x3d5) !== _0x3b617e(0x3d5)) _0x3f1392[_0x3b617e(0x45d)](_0x209ed2 => { _0x209ed2 ? _0x40c57c(_0x209ed2) : _0x2ab61f(new _0x13b0e2('Canvas\x20to\x20Blob\x20conversion\x20failed.')); }, _0x3c60db, _0x169a52); else { const _0x4a8bde = document[_0x3b617e(0x2c0)](_0x3b617e(0x5af)); if (!_0x4a8bde) return; const _0x5b8045 = localStorage[_0x3b617e(0x696)](_0x3b617e(0x4d1)) || '80'; document['documentElement']['style'][_0x3b617e(0x554)]('--primary-lightness', _0x5b8045 + '%'), _0x4a8bde[_0x3b617e(0x69f)] = _0x5b8045, _0x4a8bde['addEventListener'](_0x3b617e(0xf4), () => { const _0x4eacad = _0x3b617e; if (_0x4eacad(0x2d4) === 'inAFk') _0x5d77c0['stopPropagation'](), _0x28baf4[_0x4eacad(0x82a)][_0x4eacad(0x7b7)]('visible'), _0x185c42[_0x4eacad(0x82a)][_0x4eacad(0x7b7)]('expanded'); else { const _0x45911c = _0x4a8bde[_0x4eacad(0x69f)]; document[_0x4eacad(0x3c4)][_0x4eacad(0x610)][_0x4eacad(0x554)](_0x4eacad(0x59a), _0x45911c + '%'), localStorage[_0x4eacad(0x515)](_0x4eacad(0x4d1), _0x45911c), _0x1994ce(); } }); } } function _0x1994ce() { const _0x3b29e9 = _0x113cd8, _0x8d80d8 = document[_0x3b29e9(0x2c0)](_0x3b29e9(0xf3)); if (!_0x8d80d8) return; _0x24ae96[_0x3b29e9(0x832)][_0x3b29e9(0x715)] ? (_0x8d80d8['style'][_0x3b29e9(0x1c3)] = _0x3b29e9(0x422), _0x8d80d8['style'][_0x3b29e9(0x651)] = '0\x202px\x208px\x20rgba(0,0,0,0.4)') : (_0x8d80d8[_0x3b29e9(0x610)]['color'] = _0x3b29e9(0x31e), _0x8d80d8['style'][_0x3b29e9(0x651)] = _0x3b29e9(0x3d2)); } function _0x37fc16() { const _0xb09c1e = _0x113cd8, _0x2505b0 = document[_0xb09c1e(0x2c0)]('clock-color-toggle'); if (!_0x2505b0) return; _0x2505b0[_0xb09c1e(0x5fc)] = _0x24ae96['preferences'][_0xb09c1e(0x715)] || ![], _0x2505b0[_0xb09c1e(0x41c)](_0xb09c1e(0x356), () => { const _0x843cc0 = _0xb09c1e; if (_0x843cc0(0x77e) !== _0x843cc0(0x77e)) { _0x45a7e4[_0x843cc0(0x217)] = _0x843cc0(0x6e3); return; } else _0x24ae96['preferences']['forceWhiteClock'] = _0x2505b0[_0x843cc0(0x5fc)], _0x5d845c(), _0x1994ce(); }); } const _0x434a81 = { 'home': document[_0x113cd8(0x2c0)](_0x113cd8(0x32e)), 'chat': document[_0x113cd8(0x2c0)](_0x113cd8(0x2f9)), 'settings': document[_0x113cd8(0x2c0)](_0x113cd8(0x392)), 'userProfile': document[_0x113cd8(0x2c0)](_0x113cd8(0x2ba)), 'characterEdit': document[_0x113cd8(0x2c0)](_0x113cd8(0x682)), 'groupChatCreate': document[_0x113cd8(0x2c0)]('group-chat-create-screen'), 'wallpaper': document['getElementById']('wallpaper-screen'), 'worldBook': document[_0x113cd8(0x2c0)](_0x113cd8(0x80f)), 'worldBookEditor': document[_0x113cd8(0x2c0)](_0x113cd8(0x212)), 'groupSettings': document['getElementById'](_0x113cd8(0x59e)), 'music': document[_0x113cd8(0x2c0)](_0x113cd8(0x1aa)), 'friendCircleList': document[_0x113cd8(0x2c0)](_0x113cd8(0x61a)), 'friendCircleEdit': document[_0x113cd8(0x2c0)]('friend-circle-edit-screen'), 'meetingList': document[_0x113cd8(0x2c0)]('meeting-list-screen'), 'meetingView': document[_0x113cd8(0x2c0)]('meeting-view-screen'), 'userProfileList': document[_0x113cd8(0x2c0)](_0x113cd8(0x310)), 'diaryList': document['getElementById'](_0x113cd8(0x701)), 'diaryView': document[_0x113cd8(0x2c0)](_0x113cd8(0x102)), 'musicLibrary': document[_0x113cd8(0x2c0)]('music-library-screen'), 'musicUploadAltar': document[_0x113cd8(0x2c0)]('music-upload-altar-screen') }, _0x338c3b = document[_0x113cd8(0x2c0)](_0x113cd8(0x7c9)), _0x4df653 = document[_0x113cd8(0x2c0)](_0x113cd8(0x25c)), _0x4f7978 = document[_0x113cd8(0x2c0)](_0x113cd8(0x537)), _0x32818f = document[_0x113cd8(0x2c0)](_0x113cd8(0x16e)), _0x39e9ea = document[_0x113cd8(0x2c0)](_0x113cd8(0x5c3)), _0x1630f2 = document[_0x113cd8(0x2c0)]('back-to-home-from-wallpaper'), _0x112b2f = document[_0x113cd8(0x2c0)]('wallpaper-input'), _0x5e79d9 = document['getElementById']('upload-wallpaper-button'); document[_0x113cd8(0x2c0)]('reset-desktop-button')[_0x113cd8(0x41c)]('click', async () => { const _0x35155e = _0x113cd8, _0x15469f = await _0x380a1e('确定要重置所有桌面小组件和App的位置，并将壁纸变为纯白吗？此操作后将刷新页面。'); if (_0x15469f) { localStorage[_0x35155e(0x6a8)](_0x35155e(0x163)), localStorage[_0x35155e(0x6a8)](_0x35155e(0xe0)), localStorage[_0x35155e(0x6a8)](_0x35155e(0x364)), localStorage[_0x35155e(0x6a8)]('musicWidgetPosition'); const _0x1be449 = []; for (let _0x596e45 = 0x0; _0x596e45 < localStorage[_0x35155e(0x256)]; _0x596e45++) { const _0x41f3ea = localStorage[_0x35155e(0x60f)](_0x596e45); _0x41f3ea && _0x41f3ea[_0x35155e(0x5ec)]('appIconPosition_') && _0x1be449['push'](_0x41f3ea); } _0x1be449[_0x35155e(0x203)](_0x469dce => localStorage[_0x35155e(0x6a8)](_0x469dce)), await _0x24ee21('wallpaper_main', await _0x4366c2(_0x35155e(0x737))), _0x880caf('桌面已重置，即将刷新...'), setTimeout(() => location['reload'](), 0x5dc); } }); const _0x593d4e = document[_0x113cd8(0x2c0)](_0x113cd8(0x7fe)), _0xe5e90c = document['getElementById']('add-choice-backdrop'), _0x1c7abd = document['getElementById']('choice-create-character'), _0x12fdcb = document[_0x113cd8(0x2c0)](_0x113cd8(0x4ab)), _0x2d2355 = document[_0x113cd8(0x2c0)]('choice-cancel'), _0x2af310 = document[_0x113cd8(0x2c0)](_0x113cd8(0x556)), _0x5afa5a = document[_0x113cd8(0x2c0)]('create-group-chat-button'), _0x587461 = document[_0x113cd8(0x2c0)]('group-chat-name'), _0x30aff4 = document[_0x113cd8(0x2c0)]('group-chat-member-list'), _0x42b6a9 = document[_0x113cd8(0x2c0)]('app-chat'), _0x12a72d = document['getElementById'](_0x113cd8(0x58e)), _0x3818e6 = document['getElementById'](_0x113cd8(0x333)), _0x230b3f = document[_0x113cd8(0x2c0)](_0x113cd8(0x3b4)), _0x58a36b = document[_0x113cd8(0x2c0)](_0x113cd8(0x1ba)), _0x295f25 = document[_0x113cd8(0x2c0)]('back-to-settings-from-user-profile'), _0x28ef16 = document[_0x113cd8(0x2c0)](_0x113cd8(0x7f3)), _0x1967cc = document[_0x113cd8(0x2c0)](_0x113cd8(0xfd)), _0x1ceb23 = document['getElementById']('add-chat-button'), _0x5cf2f8 = document['getElementById'](_0x113cd8(0x2f9)), _0x4066f3 = document[_0x113cd8(0x2c0)]('chat-messages'), _0x5eefed = document[_0x113cd8(0x2c0)](_0x113cd8(0x338)), _0x52863e = document[_0x113cd8(0x2c0)](_0x113cd8(0x67a)), _0x3caebf = document[_0x113cd8(0x2c0)](_0x113cd8(0x466)), _0x1d04fa = document['getElementById']('quote-preview-area'), _0x50ade4 = document[_0x113cd8(0x2c0)](_0x113cd8(0x646)), _0x4630f4 = document[_0x113cd8(0x2c0)](_0x113cd8(0x220)), _0x2ff26c = document[_0x113cd8(0x2c0)](_0x113cd8(0x126)), _0x3f15c4 = document['getElementById'](_0x113cd8(0x3c5)), _0x30d7de = document[_0x113cd8(0x2c0)](_0x113cd8(0x4a5)), _0x2953a1 = document[_0x113cd8(0x2c0)](_0x113cd8(0x698)), _0x4e45dd = document[_0x113cd8(0x2c0)](_0x113cd8(0x608)), _0x4840c4 = document[_0x113cd8(0x2c0)]('chat-image-input'), _0x49c1bb = document[_0x113cd8(0x2c0)](_0x113cd8(0x342)), _0x212a27 = document['getElementById'](_0x113cd8(0x558)), _0x1a8311 = document[_0x113cd8(0x2c0)](_0x113cd8(0x749)), _0x2b5bbe = document[_0x113cd8(0x2c0)]('api-key'), _0x256343 = document[_0x113cd8(0x2c0)](_0x113cd8(0x6a0)), _0x5289af = document[_0x113cd8(0x2c0)](_0x113cd8(0x315)), _0x17a184 = document[_0x113cd8(0x2c0)](_0x113cd8(0x5ea)), _0x418905 = document['getElementById'](_0x113cd8(0x36b)), _0x3bdc55 = document['getElementById'](_0x113cd8(0x4ed)), _0xb7102c = document[_0x113cd8(0x2c0)](_0x113cd8(0x3b9)), _0x2a69fd = document[_0x113cd8(0x2c0)](_0x113cd8(0x6ec)), _0xcab2d = document[_0x113cd8(0x2c0)](_0x113cd8(0x4bb)), _0x12adb = document[_0x113cd8(0x2c0)](_0x113cd8(0x41e)), _0x257dc5 = document[_0x113cd8(0x2c0)](_0x113cd8(0x166)), _0x1a806b = document[_0x113cd8(0x2c0)](_0x113cd8(0x476)), _0x319ac8 = document[_0x113cd8(0x2c0)]('character-edit-title'), _0x1e0a99 = document[_0x113cd8(0x2c0)](_0x113cd8(0x655)), _0x5d165b = document[_0x113cd8(0x2c0)](_0x113cd8(0x64d)), _0x2a1a1 = document['getElementById'](_0x113cd8(0x47d)), _0x3dba3c = document[_0x113cd8(0x2c0)](_0x113cd8(0x177)), _0x5ef078 = document[_0x113cd8(0x2c0)]('char-edit-persona'), _0x46a5bc = document['getElementById'](_0x113cd8(0x228)), _0x1e387d = document[_0x113cd8(0x2c0)](_0x113cd8(0x4c1)), _0x280527 = document[_0x113cd8(0x2c0)](_0x113cd8(0x3a0)); let _0x4f9675 = null; const _0x3a1f76 = _0x113cd8(0x510); _0x24ae96 = { 'characters': [], 'worldBooks': [], 'chats': [], 'userProfiles': [], 'activeUserProfileId': null, 'apiSettings': { 'endpoint': '', 'key': '', 'model': '' }, 'preferences': { 'widgetBgImage': null, 'perChatContextLines': 0x64, 'forceWhiteClock': ![] }, 'activeChatId': null, 'activeMeetingCharId': null, 'isGenerating': ![], 'currentAbortController': null, 'pendingMessageTimers': [], 'conversationHistory': [], 'displayedMessageCount': 0x64, 'activeQuote': null, 'friendCircles': [], 'activeFriendCircleId': null, 'diaries': [], 'activeDiaryCharacterId': null, 'diaries': [], 'activeDiaryCharacterId': null, 'meetingViewMode': 'novel', 'activeMeetingScriptQueue': [], 'characterLastScripts': {}, 'musicPlaylist': [], 'currentlyPlayingIndex': -0x1, 'isPlaying': ![], 'pendingPostAttachments': { 'image': null, 'music': null } }; function _0x5d845c() { const _0x1bac87 = _0x113cd8; try { const _0x56fe35 = { 'characters': _0x24ae96[_0x1bac87(0x4c0)], 'worldBooks': _0x24ae96['worldBooks'], 'chats': _0x24ae96['chats'], 'userProfile': _0x24ae96['userProfile'], 'apiSettings': _0x24ae96[_0x1bac87(0x34f)], 'preferences': _0x24ae96[_0x1bac87(0x832)], 'activeChatId': _0x24ae96[_0x1bac87(0x192)], 'diaries': _0x24ae96[_0x1bac87(0x80a)], 'friendCircles': _0x24ae96['friendCircles'], 'activeFriendCircleId': _0x24ae96[_0x1bac87(0x4fb)], 'userProfiles': _0x24ae96[_0x1bac87(0xdc)], 'activeUserProfileId': _0x24ae96[_0x1bac87(0x4b7)] }; localStorage['setItem'](_0x1bac87(0xcb), JSON[_0x1bac87(0x3fd)](_0x56fe35)); } catch (_0x26bba3) { console[_0x1bac87(0x40f)]('Failed\x20to\x20save\x20state\x20to\x20localStorage:', _0x26bba3), _0x880caf(_0x1bac87(0x7fa)); } } function _0x4b087b() { const _0x271692 = _0x113cd8; let _0x4b9bfa = null; try { _0x271692(0x44c) === _0x271692(0x44c) ? _0x4b9bfa = localStorage[_0x271692(0x696)](_0x271692(0xcb)) : _0x5dc254[_0x271692(0x34f)] = { ..._0x393764['apiSettings'], ..._0x104975[_0x271692(0x34f)] }; } catch (_0x491179) { _0x271692(0xed) === _0x271692(0xc7) ? _0x2e0752[_0x271692(0x2be)] = _0x271692(0x1c2) : (console['error'](_0x271692(0x449), _0x491179), _0x880caf(_0x271692(0x285))); } if (_0x4b9bfa) try { if (_0x271692(0x5a2) !== _0x271692(0x5a2)) _0x58cd51[_0x271692(0x367)] = null, _0x23efb7(_0x271692(0x4ca), _0x271692(0x7c7)); else { const _0x42dd3f = JSON[_0x271692(0x458)](_0x4b9bfa); if (!_0x42dd3f || typeof _0x42dd3f !== _0x271692(0x66a)) throw new Error(_0x271692(0x284)); if (Array['isArray'](_0x42dd3f[_0x271692(0x4c0)])) { if (_0x271692(0x5fb) === _0x271692(0x15b)) { const _0x4d86a2 = _0x16ecad[_0x271692(0x2c0)](_0x271692(0x5af)); if (!_0x4d86a2) return; const _0x598a28 = _0x187aba[_0x271692(0x696)](_0x271692(0x4d1)) || '80'; _0xc91a8a['documentElement'][_0x271692(0x610)]['setProperty'](_0x271692(0x59a), _0x598a28 + '%'), _0x4d86a2[_0x271692(0x69f)] = _0x598a28, _0x4d86a2['addEventListener'](_0x271692(0xf4), () => { const _0x4d1500 = _0x271692, _0x5dc519 = _0x4d86a2[_0x4d1500(0x69f)]; _0x321df0['documentElement']['style'][_0x4d1500(0x554)](_0x4d1500(0x59a), _0x5dc519 + '%'), _0x5e8b7e[_0x4d1500(0x515)]('themeLightness', _0x5dc519), _0x16ad4a(); }); } else _0x24ae96[_0x271692(0x4c0)] = _0x42dd3f['characters']['map'](_0x13f6e3 => ({ 'offlineBackground': '', ..._0x13f6e3 }))[_0x271692(0x3ea)](_0x1affac => _0x1affac && typeof _0x1affac === _0x271692(0x66a) && _0x1affac['id']); } Array[_0x271692(0x2d0)](_0x42dd3f[_0x271692(0x496)]) && ('hcApf' !== _0x271692(0x213) ? (_0x5a307f(), _0x718c76(_0x271692(0x51d), _0x271692(0x540))) : _0x24ae96[_0x271692(0x496)] = _0x42dd3f[_0x271692(0x496)]); if (Array[_0x271692(0x2d0)](_0x42dd3f[_0x271692(0x80a)])) { if (_0x271692(0x7c2) === _0x271692(0x4dc)) { _0x3b8c18['activeMeetingScriptQueue'] = [..._0x516c0b]; const _0x55a977 = _0x14db4e[_0x271692(0x7f7)][_0x271692(0x5d9)](); _0x19fdba[_0x271692(0x548)] = _0x55a977[_0x271692(0x4d9)] === 'narrator' ? '旁白' : _0x55a977[_0x271692(0x4d9)], _0x5440d0[_0x271692(0x548)] = _0x55a977[_0x271692(0x6f0)], _0x55a977[_0x271692(0x4d9)] !== _0x271692(0x348) && _0x3a415c(_0x3444a6[_0x271692(0x3ae)], _0x55a977[_0x271692(0x43b)]); } else _0x24ae96[_0x271692(0x80a)] = _0x42dd3f[_0x271692(0x80a)]; } if (Array[_0x271692(0x2d0)](_0x42dd3f[_0x271692(0x7ce)])) _0x24ae96['friendCircles'] = _0x42dd3f[_0x271692(0x7ce)], _0x24ae96[_0x271692(0x4fb)] = _0x42dd3f['activeFriendCircleId']; else { if (Array[_0x271692(0x2d0)](_0x42dd3f[_0x271692(0x30a)]) && _0x42dd3f[_0x271692(0x30a)][_0x271692(0x256)] > 0x0) { console[_0x271692(0x72f)](_0x271692(0x627)); const _0x577e8f = { 'id': 'circle_' + Date[_0x271692(0x695)](), 'name': '我的动态', 'boundUserProfileId': _0x42dd3f[_0x271692(0x4b7)], 'memberCharacterIds': _0x42dd3f[_0x271692(0x4c0)][_0x271692(0x6dd)](_0x4d694c => _0x4d694c['id']), 'posts': _0x42dd3f[_0x271692(0x30a)] }; _0x24ae96[_0x271692(0x7ce)] = [_0x577e8f], _0x24ae96['activeFriendCircleId'] = _0x577e8f['id']; } } if (Array[_0x271692(0x2d0)](_0x42dd3f[_0x271692(0xdc)])) 'Expgt' !== _0x271692(0x118) ? (_0x24ae96[_0x271692(0xdc)] = _0x42dd3f[_0x271692(0xdc)], _0x24ae96['activeUserProfileId'] = _0x42dd3f[_0x271692(0x4b7)]) : _0x542d6e = _0xf9e441[0x1]; else { if (_0x42dd3f[_0x271692(0x7ff)]) { if (_0x271692(0x18f) === _0x271692(0x18f)) { console[_0x271692(0x72f)](_0x271692(0x722)); const _0x3f654e = { 'id': _0x271692(0x769) + Date[_0x271692(0x695)](), 'name': _0x42dd3f[_0x271692(0x7ff)][_0x271692(0x7e5)] || '我', 'avatar': _0x42dd3f[_0x271692(0x7ff)][_0x271692(0x37c)] || _0x4be95c, 'persona': _0x42dd3f[_0x271692(0x7ff)][_0x271692(0x791)] || '' }; _0x24ae96['userProfiles'] = [_0x3f654e], _0x24ae96[_0x271692(0x4b7)] = _0x3f654e['id']; } else _0x2792f6 += _0x271692(0x5ce) + _0x366338[_0x271692(0x805)] + '\x20-\x20' + _0x2af045['artist'] + ')'; } } if (_0x42dd3f[_0x271692(0x34f)] && typeof _0x42dd3f[_0x271692(0x34f)] === _0x271692(0x66a)) { if (_0x271692(0x40a) !== _0x271692(0x25d)) _0x24ae96[_0x271692(0x34f)] = { ..._0x24ae96[_0x271692(0x34f)], ..._0x42dd3f[_0x271692(0x34f)] }; else { const _0x4004da = _0x3e0513['match'](_0xfc6052); if (_0x4004da) { const _0x4959a2 = _0xfa6df3(_0x4004da[0x1], 0xa), _0x1f9bb6 = _0x36f60(_0x4004da[0x2], 0xa), _0x16abc2 = _0x4287de(_0x4004da[0x3], 0xa) * (_0x4004da[0x3][_0x271692(0x256)] === 0x2 ? 0xa : 0x1), _0x37de7f = _0x4959a2 * 0x3c + _0x1f9bb6 + _0x16abc2 / 0x3e8, _0x3ca77d = _0x8b7211[_0x271692(0xef)](_0x676543, '')[_0x271692(0x529)](); _0x3ca77d && _0x3d90e2[_0x271692(0x60b)]({ 'time': _0x37de7f, 'text': _0x3ca77d }); } } } _0x42dd3f[_0x271692(0x832)] && typeof _0x42dd3f['preferences'] === _0x271692(0x66a) ? _0x24ae96['preferences'] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0x42dd3f['preferences'] } : _0x24ae96['preferences'] = { 'perChatContextLines': 0x64, 'widgetBgImage': null }; if (Array[_0x271692(0x2d0)](_0x42dd3f['chats'])) _0x271692(0x73f) !== _0x271692(0x73f) ? _0x40cefa[_0x271692(0x610)][_0x271692(0x452)] = _0x271692(0x3d2) : (_0x24ae96[_0x271692(0x2e2)] = _0x42dd3f['chats'], _0x24ae96[_0x271692(0x192)] = _0x42dd3f[_0x271692(0x192)] || null); else { if (Array[_0x271692(0x2d0)](_0x42dd3f['characters'])) { if (_0x271692(0x80b) !== 'TwVfx') { _0x151b24['log'](_0x271692(0x722)); const _0x32abe8 = { 'id': _0x271692(0x769) + _0x4a782b[_0x271692(0x695)](), 'name': _0x474ea3[_0x271692(0x7ff)][_0x271692(0x7e5)] || '我', 'avatar': _0x5e3b63[_0x271692(0x7ff)][_0x271692(0x37c)] || _0x2c6321, 'persona': _0x4302fa[_0x271692(0x7ff)][_0x271692(0x791)] || '' }; _0x41dfb1[_0x271692(0xdc)] = [_0x32abe8], _0x52ac87['activeUserProfileId'] = _0x32abe8['id']; } else console[_0x271692(0x72f)]('Migrating\x20old\x20data\x20structure\x20to\x20new\x20chat-based\x20structure.'), _0x24ae96[_0x271692(0x2e2)] = _0x42dd3f[_0x271692(0x4c0)][_0x271692(0x6dd)](_0x18064a => ({ 'id': _0x271692(0x645) + _0x18064a['id'], 'type': _0x271692(0x62a), 'participantIds': [_0x18064a['id']] })), _0x42dd3f[_0x271692(0xc6)] && (_0x24ae96['activeChatId'] = _0x271692(0x645) + _0x42dd3f['activeCharacterId']), _0x42dd3f['characters']['forEach'](_0x351acd => { const _0x50f057 = _0x271692, _0x8e3fb2 = _0x50f057(0x68e) + _0x351acd['id'], _0x1cccb0 = _0x50f057(0x4c3) + _0x351acd['id'], _0x3c7226 = localStorage[_0x50f057(0x696)](_0x8e3fb2); _0x3c7226 && ('MRhuV' === _0x50f057(0x667) ? (localStorage[_0x50f057(0x515)](_0x1cccb0, _0x3c7226), localStorage[_0x50f057(0x6a8)](_0x8e3fb2)) : _0x4601f6[_0x50f057(0x185)]['abort'](_0x50f057(0x732))); }); } } } } catch (_0x5b49bd) { console[_0x271692(0x40f)](_0x271692(0x22d), _0x5b49bd), _0x24ae96['characters'] = [], _0x24ae96[_0x271692(0x2e2)] = [], _0x24ae96['activeChatId'] = null; try { _0x271692(0x29e) !== _0x271692(0x541) ? localStorage[_0x271692(0x6a8)](_0x271692(0xcb)) : _0x9e9c16[_0x271692(0x40f)](_0x271692(0x63e), _0x3d7097); } catch (_0x3ea52d) { console[_0x271692(0x40f)](_0x271692(0x502), _0x3ea52d); } } let _0x46d60 = ![]; if (_0x24ae96[_0x271692(0x4c0)]['length'] === 0x0) _0x46d60 = !![], _0x24ae96[_0x271692(0x192)] = null; else !_0x24ae96[_0x271692(0x2e2)][_0x271692(0x1c6)](_0x44615d => _0x44615d['id'] === _0x24ae96['activeChatId']) && (_0x24ae96[_0x271692(0x192)] = _0x24ae96[_0x271692(0x2e2)][0x0]?.['id'] || null); return _0x5d845c(), _0x46d60; } function _0x16869e() { const _0x2450c6 = _0x113cd8; if (!_0x24ae96['activeChatId']) return; try { localStorage['setItem'](_0x2450c6(0x68e) + _0x24ae96[_0x2450c6(0x192)], JSON[_0x2450c6(0x3fd)](_0x24ae96[_0x2450c6(0x5bb)])); } catch (_0x17f453) { console[_0x2450c6(0x40f)](_0x2450c6(0x109), _0x17f453), _0x880caf(_0x2450c6(0x165)); } } function _0xb86a7f() { const _0x4f8dfd = _0x113cd8; if ('qomHE' === _0x4f8dfd(0x7f1)) { const _0x1a5014 = _0x14283c(_0x5275a7['content']); _0x3e571d[_0x4f8dfd(0x758)](_0x3b12a8, { 'content': _0x1a5014[_0x4f8dfd(0x77b)], 'quotedMessage': _0x1a5014['quotedMessage'] }); } else { if (!_0x24ae96[_0x4f8dfd(0x192)]) { _0x24ae96[_0x4f8dfd(0x5bb)] = [], _0x1c0e55(); return; } let _0x14da0a = null; try { _0x14da0a = localStorage[_0x4f8dfd(0x696)](_0x4f8dfd(0x68e) + _0x24ae96['activeChatId']); } catch (_0x52e0f0) { 'KKwLQ' === _0x4f8dfd(0x6bc) ? (_0x22571d[_0x4f8dfd(0xd4)] = _0x3ff696[_0x4f8dfd(0x6c9)](_0x1afa87), _0xd41eb2[_0x4f8dfd(0x610)][_0x4f8dfd(0x452)] = _0x4f8dfd(0x3fb)) : console[_0x4f8dfd(0x40f)]('Failed\x20to\x20read\x20history\x20for\x20chat\x20' + _0x24ae96[_0x4f8dfd(0x192)], _0x52e0f0); } let _0x36f1bd = []; if (_0x14da0a) { if (_0x4f8dfd(0x387) === _0x4f8dfd(0x5be)) _0x48024f['value'] = _0x2284c9[_0x4f8dfd(0x6dd)](_0x4b9c41 => _0x4b9c41[_0x4f8dfd(0x7e5)] + '--' + _0x4b9c41[_0x4f8dfd(0x375)])[_0x4f8dfd(0x799)]('\x0a'); else try { const _0x44cbc6 = JSON['parse'](_0x14da0a); Array[_0x4f8dfd(0x2d0)](_0x44cbc6) && (_0x36f1bd = _0x44cbc6['filter'](_0x4d769d => _0x4d769d && typeof _0x4d769d === _0x4f8dfd(0x66a) && typeof _0x4d769d[_0x4f8dfd(0x660)] === _0x4f8dfd(0x63b) && typeof _0x4d769d[_0x4f8dfd(0x77b)] !== _0x4f8dfd(0x3c3))); } catch (_0x583dd4) { console[_0x4f8dfd(0x40f)](_0x4f8dfd(0x4a1) + _0x24ae96[_0x4f8dfd(0x192)] + ',\x20resetting.', _0x583dd4); try { if ('ZOPPI' !== _0x4f8dfd(0x2ad)) { const _0x2d4566 = _0x453f46['linkedWorldBookIds']?.[_0x4f8dfd(0x4e4)](_0x6e4acb['id']), _0x2c24fa = _0x40523c[_0x4f8dfd(0x2b5)]('label'); _0x2c24fa[_0x4f8dfd(0x217)] = _0x4f8dfd(0x105) + _0x4b125f['id'] + '\x22\x20' + (_0x2d4566 ? _0x4f8dfd(0x5fc) : '') + '>\x20' + _0x27217a[_0x4f8dfd(0x7e5)], _0x58dc02[_0x4f8dfd(0x3b1)](_0x2c24fa); } else localStorage['removeItem'](_0x4f8dfd(0x68e) + _0x24ae96[_0x4f8dfd(0x192)]); } catch (_0x4d65c4) { if (_0x4f8dfd(0x443) === _0x4f8dfd(0x363)) { const _0x4d1d7b = _0x25f066[_0x4f8dfd(0x62e)](_0x2bbf88, _0x4f8dfd(0x1f0)), _0xa4d56c = _0x4d1d7b[_0x4f8dfd(0x20b)](_0x3c501b), _0x50b618 = _0xa4d56c[_0x4f8dfd(0x22e)](_0x5545de); _0x50b618[_0x4f8dfd(0x468)] = () => _0x5235fc(_0x50b618[_0x4f8dfd(0x834)] ? _0x50b618[_0x4f8dfd(0x834)][_0x4f8dfd(0x603)] : null), _0x50b618[_0x4f8dfd(0x464)] = () => _0x32331d(_0x50b618[_0x4f8dfd(0x40f)]); } else console[_0x4f8dfd(0x40f)](_0x4f8dfd(0x4e0), _0x4d65c4); } } } _0x24ae96[_0x4f8dfd(0x5bb)] = _0x36f1bd, _0x4066f3[_0x4f8dfd(0x217)] = '', _0x24ae96[_0x4f8dfd(0x5bb)] && (_0x4f8dfd(0x3cf) !== _0x4f8dfd(0x3cf) ? _0x256b54[_0x4f8dfd(0x60b)]('[' + _0x44ceb2 + ']\x20[' + _0x20556e(_0x4c9959) + ']\x20' + _0x4bbc4e(_0x272fd4[_0x4f8dfd(0x77b)])['trim']()) : _0x24ae96[_0x4f8dfd(0x5bb)]['forEach']((_0x4fbcd2, _0x4d89c2) => _0x473aca(_0x4fbcd2, _0x4d89c2))), setTimeout(() => { const _0x218f84 = _0x4f8dfd; _0x4066f3[_0x218f84(0x1e5)] = _0x4066f3['scrollHeight']; }, 0x0); } } async function _0x445527() { const _0xfdd999 = _0x113cd8, _0x228789 = document['getElementById']('home-screen'); try { if (_0xfdd999(0x35c) === _0xfdd999(0x563)) _0x252f40 = _0x2b4bb3[_0xfdd999(0x650)]; else { let _0xbe9cad = await _0x5aea9f('wallpaper_main'); if (!_0xbe9cad) { const _0x3b58f6 = localStorage[_0xfdd999(0x696)](_0xfdd999(0x7d4)); _0x3b58f6 && (console[_0xfdd999(0x72f)](_0xfdd999(0x42a)), _0xbe9cad = await _0x4366c2(_0x3b58f6), await _0x24ee21(_0xfdd999(0x595), _0xbe9cad), localStorage['removeItem'](_0xfdd999(0x7d4))); } _0xbe9cad ? (_0x228789['style'][_0xfdd999(0x6a6)] = 'url(' + URL[_0xfdd999(0x6c9)](_0xbe9cad) + ')', _0x228789[_0xfdd999(0x610)][_0xfdd999(0x15d)] = _0xfdd999(0x1f5), _0x228789[_0xfdd999(0x610)][_0xfdd999(0x813)] = _0xfdd999(0x640)) : _0x228789[_0xfdd999(0x610)][_0xfdd999(0x6a6)] = ''; } } catch (_0x3e163a) { console[_0xfdd999(0x40f)](_0xfdd999(0x725), _0x3e163a), phoneContainer[_0xfdd999(0x610)][_0xfdd999(0x6a6)] = ''; } } function _0x4b02e8() { const _0x5d4600 = _0x113cd8, _0x438d7c = localStorage[_0x5d4600(0x696)](_0x5d4600(0x55c)); _0x438d7c ? document[_0x5d4600(0x2c0)](_0x5d4600(0x1aa))['style']['setProperty'](_0x5d4600(0xfc), 'url(' + _0x438d7c + ')') : _0x5d4600(0xd0) === 'esmKr' ? document['getElementById'](_0x5d4600(0x1aa))[_0x5d4600(0x610)][_0x5d4600(0x554)](_0x5d4600(0xfc), 'none') : _0x156638++; } async function _0x2db1c6(_0x10c104) { const _0x3ee538 = _0x113cd8; if ('nohwC' !== _0x3ee538(0x71e)) try { if (_0x3ee538(0x750) === _0x3ee538(0x750)) await _0x24ee21(_0x3ee538(0x595), _0x10c104), await _0x445527(), _0x880caf(_0x3ee538(0x555)); else { const _0xa0d2d8 = _0x4a53bc[_0x3ee538(0x7f7)][_0x3ee538(0x5d9)](); _0x546189[_0x3ee538(0x548)] = _0xa0d2d8['speaker'] === _0x3ee538(0x348) ? '旁白' : _0xa0d2d8[_0x3ee538(0x4d9)], _0x597286[_0x3ee538(0x548)] = _0xa0d2d8['line'], _0xa0d2d8['speaker'] !== _0x3ee538(0x348) && _0x4022e7(_0x2c429f[_0x3ee538(0x3ae)], _0xa0d2d8['emotion']); } } catch (_0xc200f1) { if (_0x3ee538(0x7af) !== _0x3ee538(0x2d2)) console[_0x3ee538(0x40f)](_0x3ee538(0x484), _0xc200f1), _0x880caf(_0x3ee538(0x3d7) + _0xc200f1[_0x3ee538(0x2ec)]); else { const _0x209322 = _0x2a0cc0['target'][_0x3ee538(0x37b)][0x0]; if (!_0x209322) return; const _0x1cc10b = _0x204557[_0x3ee538(0x6c9)](_0x209322); _0x32c616[_0x3ee538(0xd4)] = _0x1cc10b, _0x24db3f['onload'] = () => { const _0xf74f4e = _0x3ee538; _0xcaf38e[_0xf74f4e(0x1bf)](_0x1cc10b); }; } } else _0x4a1063 = _0x3277d5(() => { const _0x2d8130 = _0x3ee538; if (_0x136f16['type'] === _0x2d8130(0x82b)) _0x528acd['preventDefault'](); _0x27769f(_0x3d4685); }, 0x320); } function _0x6eb57f(_0x2d3f9b) { const _0x1eaafd = _0x113cd8, _0x1d517c = { 'quotedMessage': null, 'content': _0x2d3f9b }, _0x478f36 = _0x2d3f9b[_0x1eaafd(0x259)](/^\[引用\|(.*?)\|(.*?)\]\s*/); if (_0x478f36) { if ('MzzeF' !== _0x1eaafd(0x547)) _0x1d517c[_0x1eaafd(0x5ed)] = { 'sender': _0x478f36[0x1][_0x1eaafd(0x529)](), 'content': _0x478f36[0x2][_0x1eaafd(0x529)]() }, _0x1d517c[_0x1eaafd(0x77b)] = _0x2d3f9b[_0x1eaafd(0x3ad)](_0x478f36[0x0][_0x1eaafd(0x256)])[_0x1eaafd(0x529)](); else return ''; } return _0x1d517c; } const _0x4b0989 = document['getElementById']('message-action-modal'), _0x15351b = document[_0x113cd8(0x2c0)](_0x113cd8(0x12e)), _0x5c1dfe = document[_0x113cd8(0x2c0)](_0x113cd8(0x61d)), _0x446e88 = document[_0x113cd8(0x2c0)](_0x113cd8(0x6b5)), _0x5de326 = document[_0x113cd8(0x2c0)]('cancel-action-button'), _0x84855e = document[_0x113cd8(0x2c0)](_0x113cd8(0x354)), _0x312abc = document[_0x113cd8(0x2c0)](_0x113cd8(0x42e)), _0x1a7a78 = document[_0x113cd8(0x2c0)](_0x113cd8(0x247)), _0x20d8b8 = document[_0x113cd8(0x2c0)]('edit-message-textarea'), _0x35d5cc = document[_0x113cd8(0x2c0)](_0x113cd8(0x599)), _0x303235 = document[_0x113cd8(0x2c0)](_0x113cd8(0x1ea)); let _0x5c5165 = null; function _0x4ba95e(_0x547a70) { const _0x38e561 = _0x113cd8; _0x5c5165 = _0x547a70, _0x4b0989[_0x38e561(0x82a)]['add'](_0x38e561(0x155)); } function _0x49a022() { const _0x3f97ab = _0x113cd8; _0x4b0989[_0x3f97ab(0x82a)]['remove'](_0x3f97ab(0x155)); } function _0x1d4868() { const _0x55349c = _0x113cd8; _0x55349c(0x4d8) === _0x55349c(0x1ff) ? (_0x183aef['likes'] = _0x299819['likes'] || [], _0x18d1ae[_0x55349c(0x1c8)] = (_0x3a955a[_0x55349c(0x1c8)] || [])['map']((_0x152464, _0x5844e2) => ({ ..._0x152464, 'commentId': 'c_' + _0x5eb042[_0x55349c(0x808)] + '_' + _0x5844e2 })), _0x3226c3(), _0x182df8()) : (_0x49a022(), _0x5c5165 = null); } function _0x55327e() { const _0x31625d = _0x113cd8; if ('nDNRL' !== _0x31625d(0x258)) { const _0x2e8f37 = _0x30121b(_0x3f17a8[_0x31625d(0x1fd)]); return _0x2e8f37?.[_0x31625d(0x7e5)] || _0x31625d(0x76a); } else { if (_0x5c5165 === null) return; _0x24ae96['conversationHistory'][_0x31625d(0x62c)](_0x5c5165, 0x1), _0x16869e(), _0x25814e(), _0x1d4868(); } } function _0xe3fbae() { const _0x5de1b1 = _0x113cd8; if (_0x5c5165 === null) return; const _0x1a3dbd = _0x24ae96[_0x5de1b1(0x5bb)][_0x5c5165]; if (!_0x1a3dbd) return; _0x20d8b8[_0x5de1b1(0x69f)] = _0x1a3dbd[_0x5de1b1(0x77b)], _0x49a022(), _0x312abc[_0x5de1b1(0x82a)][_0x5de1b1(0x2c7)]('show'), _0x20d8b8[_0x5de1b1(0x13d)](); } function _0x12eccf() { const _0x27bc78 = _0x113cd8; if (_0x5c5165 === null) return; const _0x2ef89e = _0x20d8b8['value'][_0x27bc78(0x529)](); if (_0x2ef89e === '') { _0x47fcb(); return; } const _0x5862fc = _0x24ae96[_0x27bc78(0x5bb)][_0x5c5165]; _0x5862fc && (_0x5862fc[_0x27bc78(0x77b)] = _0x2ef89e, _0x16869e(), _0x25814e()), _0x312abc[_0x27bc78(0x82a)][_0x27bc78(0x28c)](_0x27bc78(0x155)), _0x5c5165 = null; } function _0x47fcb() { const _0x554b76 = _0x113cd8; _0x312abc[_0x554b76(0x82a)]['remove']('show'), _0x5c5165 = null; } _0x15351b[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x1d4868), _0x5de326[_0x113cd8(0x41c)]('click', _0x1d4868), _0x446e88[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x55327e), _0x5c1dfe[_0x113cd8(0x41c)](_0x113cd8(0x472), _0xe3fbae), _0x84855e[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x301dfb), _0x2ff26c[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x1d643b), _0x35d5cc[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x12eccf), _0x303235[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x47fcb), _0x1a7a78[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x47fcb); function _0x301dfb() { const _0x3f3666 = _0x113cd8; if (_0x5c5165 === null) return; const _0x18def0 = _0x24ae96[_0x3f3666(0x5bb)][_0x5c5165]; if (!_0x18def0) return; const _0x3e7d8d = _0x3cc63d(); let _0x2cd34b = '未知'; if (_0x18def0[_0x3f3666(0x660)] === _0x3f3666(0xe9)) _0x2cd34b = _0x24ae96[_0x3f3666(0x7ff)]['name'] || '我'; else { const _0xbc3fca = _0x18def0['senderId'] || _0x3e7d8d?.[_0x3f3666(0x590)][0x0], _0x39d843 = _0x5c4526(_0xbc3fca); _0x2cd34b = _0x39d843 ? _0x39d843[_0x3f3666(0x7e5)] : '角色'; } let _0x53805e = _0x18def0[_0x3f3666(0x77b)] || ''; if (_0x18def0['displayUrl']) _0x53805e = _0x3f3666(0x3ba); if (_0x18def0[_0x3f3666(0x650)]) _0x53805e = _0x3f3666(0x113); if (_0x53805e[_0x3f3666(0x256)] > 0x32) _0x53805e = _0x53805e['substring'](0x0, 0x32) + '...'; _0x24ae96[_0x3f3666(0x432)] = { 'sender': _0x2cd34b, 'content': _0x53805e }, _0x186620(), _0x1d4868(), _0x5eefed['focus'](); } function _0x186620() { const _0x2d2762 = _0x113cd8; if (!_0x24ae96[_0x2d2762(0x432)]) return; _0x50ade4['textContent'] = '回复\x20' + _0x24ae96[_0x2d2762(0x432)]['sender'], _0x4630f4[_0x2d2762(0x548)] = _0x24ae96['activeQuote'][_0x2d2762(0x77b)], _0x1d04fa[_0x2d2762(0x610)][_0x2d2762(0x452)] = 'block'; } function _0x1d643b() { const _0x3b7486 = _0x113cd8; _0x24ae96[_0x3b7486(0x432)] = null, _0x1d04fa[_0x3b7486(0x610)]['display'] = _0x3b7486(0x3d2); } function _0x124c6c(_0x16717c, _0x32c5e6) { const _0x4cf20b = _0x113cd8, _0x987991 = document['getElementById']('music-widget'); _0x987991 && (_0x16717c === _0x4cf20b(0x540) ? _0x4cf20b(0x1b1) !== _0x4cf20b(0x1b1) ? (_0x5dfe81[_0x4cf20b(0x650)] = _0x2470b0, _0x12d4ed = !![]) : _0x987991[_0x4cf20b(0x610)][_0x4cf20b(0x452)] = 'inline-block' : _0x987991[_0x4cf20b(0x610)][_0x4cf20b(0x452)] = _0x4cf20b(0x3d2)), _0x4f9675 = _0x32c5e6 || null, Object[_0x4cf20b(0x5f5)](_0x434a81)['forEach'](_0x5f3d59 => _0x5f3d59[_0x4cf20b(0x82a)][_0x4cf20b(0x28c)]('active')), _0x434a81[_0x16717c] && (_0x4cf20b(0x475) !== 'FhfDc' ? _0x434a81[_0x16717c]['classList']['add'](_0x4cf20b(0x33a)) : _0x5de9e0[_0x4cf20b(0x396)](_0x5b1daa, { 'keyPath': 'id' })), _0x16717c !== 'chat' && _0x5cf2f8[_0x4cf20b(0x82a)][_0x4cf20b(0x28c)](_0x4cf20b(0x103)); } function _0x591b3d(_0x1aad0d) { const _0x1ceaa4 = _0x113cd8; _0x1aad0d ? _0x5cf2f8['classList'][_0x1ceaa4(0x2c7)](_0x1ceaa4(0x103)) : _0x5cf2f8['classList']['remove'](_0x1ceaa4(0x103)); } async function _0x5334a7() { const _0x34b891 = _0x113cd8; if (_0x34b891(0x1d5) === 'IzqFY') { _0x1967cc[_0x34b891(0x217)] = ''; for (const _0x3c0def of _0x24ae96[_0x34b891(0x2e2)]) { const _0x291aeb = document[_0x34b891(0x2b5)]('li'); _0x291aeb['className'] = _0x34b891(0x520), _0x291aeb[_0x34b891(0x362)]['id'] = _0x3c0def['id']; let _0x39f182 = _0x5d2cd8, _0x460428 = '群聊', _0x4ce0ce = ''; if (_0x3c0def['type'] === _0x34b891(0x62a)) { const _0x51115f = _0x5c4526(_0x3c0def['participantIds'][0x0]); _0x51115f ? (_0x39f182 = _0x51115f['avatar'] || _0x5d2cd8, _0x460428 = _0x51115f[_0x34b891(0x7e5)] || '未命名角色', _0x4ce0ce = _0x51115f[_0x34b891(0x366)] || '私聊') : 'MVqQN' !== 'xtSUw' ? (_0x460428 = '未知角色', _0x4ce0ce = _0x34b891(0x15a)) : _0x5d28c5[_0x34b891(0x548)] = '❚❚'; } else { _0x460428 = _0x3c0def['name'] || _0x34b891(0xca), _0x4ce0ce = _0x3c0def[_0x34b891(0x590)][_0x34b891(0x256)] + _0x34b891(0x661); const _0xdbba8f = await _0x5aea9f('group_avatar_' + _0x3c0def['id']); if (_0xdbba8f) _0x39f182 = URL[_0x34b891(0x6c9)](_0xdbba8f); } _0x291aeb[_0x34b891(0x217)] = _0x34b891(0x112) + _0x39f182 + _0x34b891(0x55e) + _0x460428 + _0x34b891(0x79e) + _0x4ce0ce + _0x34b891(0x494), _0x291aeb[_0x34b891(0x437)](_0x34b891(0x2f6))[_0x34b891(0x41c)](_0x34b891(0x472), () => { const _0x389686 = _0x34b891; if (_0x389686(0x79d) === 'zUZif') { const _0x2b06c1 = _0x2961ea[_0x389686(0x2c0)](_0x389686(0x4d3))[_0x389686(0x69f)]; _0x2b06c1 && (_0x52cd47[_0x389686(0x4b7)] = _0x2b06c1, _0x4d6502(), _0x467428(_0x389686(0x424)), _0x189183(), _0x466fbd[_0x389686(0x2c0)]('set-active-user-button')[_0x389686(0x610)][_0x389686(0x452)] = 'none'); } else _0xdad370(_0x3c0def['id']), _0x591b3d(!![]); }), _0x1967cc[_0x34b891(0x3b1)](_0x291aeb); } } else { if (_0xbe1ca5['key'] === _0x34b891(0x1fa)) _0x2b392e(![]); if (_0x5edf1d['key'] === _0x34b891(0x104)) _0x1b8e67(!![]); } } function _0x35e10a() { const _0x5937a4 = _0x113cd8, _0x2dccf3 = document[_0x5937a4(0x2c0)](_0x5937a4(0x237)); _0x2dccf3[_0x5937a4(0x217)] = ''; const _0x5c020f = _0x24ae96[_0x5937a4(0x4c0)][_0x5937a4(0x3ea)](_0x15cdcc => _0x24ae96[_0x5937a4(0x2e2)]['some'](_0x22ec6b => _0x22ec6b[_0x5937a4(0x776)] === 'private' && _0x22ec6b[_0x5937a4(0x590)][_0x5937a4(0x4e4)](_0x15cdcc['id']))); if (_0x5c020f[_0x5937a4(0x256)] === 0x0) { _0x2dccf3[_0x5937a4(0x217)] = _0x5937a4(0x1f6); return; } _0x5c020f[_0x5937a4(0x203)](_0x41e7fc => { const _0x5bb8e5 = _0x5937a4, _0x46548b = document[_0x5bb8e5(0x2b5)]('li'); _0x46548b['className'] = _0x5bb8e5(0x520), _0x46548b['dataset'][_0x5bb8e5(0x7c4)] = _0x41e7fc['id'], _0x46548b[_0x5bb8e5(0x217)] = _0x5bb8e5(0x1b6) + (_0x41e7fc['avatar'] || _0x5d2cd8) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x41e7fc[_0x5bb8e5(0x7e5)] + _0x5bb8e5(0x809) + (_0x41e7fc[_0x5bb8e5(0x366)] || '私聊') + _0x5bb8e5(0x30f), _0x46548b[_0x5bb8e5(0x41c)]('click', () => { _0x597fd4(_0x41e7fc['id']); }), _0x2dccf3['appendChild'](_0x46548b); }); } async function _0x597fd4(_0x3818ce) { const _0x1e8f52 = _0x113cd8, _0x422ad1 = _0x5c4526(_0x3818ce); if (!_0x422ad1) return; document[_0x1e8f52(0x2c0)](_0x1e8f52(0x613))[_0x1e8f52(0xd4)] = '', _0x24ae96[_0x1e8f52(0x3ae)] = _0x3818ce; const _0x18d604 = _0x24ae96['chats'][_0x1e8f52(0x1c6)](_0xb6b15c => _0xb6b15c[_0x1e8f52(0x776)] === _0x1e8f52(0x62a) && _0xb6b15c[_0x1e8f52(0x590)][_0x1e8f52(0x4e4)](_0x3818ce)); _0x18d604 ? (_0x24ae96[_0x1e8f52(0x192)] = _0x18d604['id'], _0x5d845c(), _0xb86a7f(), _0x30ad4e(_0x3818ce)) : _0x24ae96['conversationHistory'] = []; document[_0x1e8f52(0x2c0)]('meeting-char-name-header')[_0x1e8f52(0x548)] = _0x422ad1['name']; const _0x18fefe = document[_0x1e8f52(0x2c0)](_0x1e8f52(0x1a6)); try { const _0x19b6cc = await _0x5aea9f('char_offline_bg_' + _0x3818ce); _0x19b6cc ? (_0x18fefe[_0x1e8f52(0x610)][_0x1e8f52(0x6a6)] = _0x1e8f52(0x27e) + URL[_0x1e8f52(0x6c9)](_0x19b6cc) + '\x27)', _0x18fefe[_0x1e8f52(0x610)][_0x1e8f52(0x15d)] = _0x1e8f52(0x1f5), _0x18fefe[_0x1e8f52(0x610)][_0x1e8f52(0x813)] = _0x1e8f52(0x640)) : _0x18fefe['style'][_0x1e8f52(0x6a6)] = _0x1e8f52(0x3d2); } catch (_0x27d7e3) { if (_0x1e8f52(0x24b) !== _0x1e8f52(0x12c)) console[_0x1e8f52(0x40f)](_0x1e8f52(0x711) + _0x3818ce + ':', _0x27d7e3), _0x18fefe[_0x1e8f52(0x610)][_0x1e8f52(0x6a6)] = _0x1e8f52(0x3d2); else { const _0xb387a2 = []; for (const _0x5e263c of _0x548ee7[_0x1e8f52(0x7ec)](_0x13ef7e)) { const _0x471a98 = _0x5e263c[_0x1e8f52(0x817)](); if (_0x4ab1c5[_0x1e8f52(0x6a3)](_0x524bb4 => _0x471a98[_0x1e8f52(0x5ec)](_0x524bb4))) { const _0x3e6b63 = _0x5f4c42[_0x5e263c]; if (typeof _0x3e6b63 === _0x1e8f52(0x63b)) _0xb387a2[_0x1e8f52(0x60b)](_0x3e6b63); if (_0x136dab['isArray'](_0x3e6b63)) _0x3e6b63[_0x1e8f52(0x203)](_0x3d923c => { const _0x298860 = _0x1e8f52; if (typeof _0x3d923c === _0x298860(0x63b)) _0xb387a2[_0x298860(0x60b)](_0x3d923c); }); } } if (_0xb387a2[_0x1e8f52(0x256)]) return _0xb387a2[_0x1e8f52(0x186)](_0x317d4a)[_0x1e8f52(0x3a3)](0x0, 0x9); } } _0x5b421a(), _0x4a53a3(); if (_0xa90228) clearInterval(_0xa90228); _0xbb90c1(), _0xa90228 = setInterval(_0xbb90c1, 0x2710), _0x124c6c('meetingView', _0x1e8f52(0x663)); } function _0x4a53a3() { const _0x11dc16 = _0x113cd8, _0x322c9e = document[_0x11dc16(0x2c0)](_0x11dc16(0x7b3)); _0x322c9e['innerHTML'] = ''; const _0x824729 = _0x322c9e[_0x11dc16(0x437)](_0x11dc16(0x561)); if (_0x824729) _0x824729['remove'](); _0x24ae96['conversationHistory'] && _0x24ae96[_0x11dc16(0x5bb)][_0x11dc16(0x203)]((_0x4beeed, _0x295a02) => { const _0x1276a7 = _0x11dc16; if ('GhVYH' !== _0x1276a7(0x708)) { if (!_0x4beeed[_0x1276a7(0x779)] || _0x4beeed[_0x1276a7(0x660)] === 'system') return; const _0x3517ed = document[_0x1276a7(0x2b5)]('p'); _0x3517ed[_0x1276a7(0x362)][_0x1276a7(0x5a0)] = _0x295a02; const _0x4d588f = _0x4beeed[_0x1276a7(0x77b)][_0x1276a7(0xef)](/\n/g, _0x1276a7(0x7ba)); let _0x233e19 = '', _0x31337d = ''; const _0x2c1326 = _0xb7cda(_0x24ae96['activeChatId']); if (_0x4beeed['role'] === _0x1276a7(0xe9)) _0x1276a7(0x477) !== _0x1276a7(0x23e) ? (_0x233e19 = _0x2c1326[_0x1276a7(0x7e5)] || '我', _0x31337d = _0x1276a7(0x262)) : (_0x5a1c92[_0x1276a7(0x82a)]['remove'](_0x1276a7(0x155)), _0x3f32fb[_0x1276a7(0x2c4)] = null, _0x42bc5b[_0x1276a7(0x2c4)] = null, _0x2e09ba[_0x1276a7(0x2c4)] = null, _0x2c2a5b[_0x1276a7(0x382)](_0x1276a7(0x13a), _0x5e3fda), _0x5dfbd3(_0x13bbcc)); else { if (_0x4beeed[_0x1276a7(0x660)] === 'assistant') { if (_0x1276a7(0x5a4) === _0x1276a7(0x5a4)) { const _0x1c6035 = _0x5c4526(_0x4beeed[_0x1276a7(0x1fd)] || _0x24ae96[_0x1276a7(0x3ae)]); _0x233e19 = _0x1c6035?.[_0x1276a7(0x7e5)] || '角色', _0x31337d = _0x1276a7(0x568); } else { const _0x46463a = _0x1d679a(_0x361044[_0x1276a7(0x192)]); _0x334934 = _0x46463a[_0x1276a7(0x37c)] || _0x2f8523; } } } _0x3517ed[_0x1276a7(0x610)][_0x1276a7(0x160)] = _0x1276a7(0x52f), _0x3517ed[_0x1276a7(0x610)][_0x1276a7(0x434)] = _0x1276a7(0x4a8), _0x3517ed[_0x1276a7(0x610)][_0x1276a7(0x70a)] = '8px', _0x3517ed[_0x1276a7(0x610)]['marginBottom'] = _0x1276a7(0x253), _0x233e19 ? _0x3517ed[_0x1276a7(0x217)] = _0x1276a7(0x4e7) + _0x31337d + '\x22\x20style=\x22font-weight:\x20bold;\x20color:\x20' + (_0x31337d === 'speaker-user' ? _0x1276a7(0x7e8) : _0x1276a7(0x1c7)) + _0x1276a7(0x391) + _0x233e19 + _0x1276a7(0x525) + _0x4d588f : (_0x3517ed[_0x1276a7(0x38a)] = _0x1276a7(0x348), _0x3517ed['style']['fontStyle'] = _0x1276a7(0x474), _0x3517ed[_0x1276a7(0x610)][_0x1276a7(0x1c3)] = _0x1276a7(0x73d), _0x3517ed['innerHTML'] = _0x4d588f), _0x322c9e['appendChild'](_0x3517ed); } else { _0x2e87bf(_0x1276a7(0x55b)); return; } }); if (_0x24ae96['isGenerating']) { let _0xa273be = _0x322c9e[_0x11dc16(0x437)](_0x11dc16(0x263)); !_0xa273be && (_0xa273be = document[_0x11dc16(0x2b5)](_0x11dc16(0x6ee)), _0xa273be[_0x11dc16(0x38a)] = _0x11dc16(0xda), _0xa273be[_0x11dc16(0x548)] = _0x11dc16(0x81f), _0xa273be[_0x11dc16(0x610)][_0x11dc16(0x160)] = _0x11dc16(0x52f), _0xa273be[_0x11dc16(0x610)]['padding'] = _0x11dc16(0x4a8), _0xa273be[_0x11dc16(0x610)][_0x11dc16(0x70a)] = _0x11dc16(0x699), _0x322c9e[_0x11dc16(0x3b1)](_0xa273be)); } const _0x4bb7ed = document[_0x11dc16(0x2b5)](_0x11dc16(0x6ee)); _0x4bb7ed['id'] = _0x11dc16(0x70d), _0x322c9e[_0x11dc16(0x3b1)](_0x4bb7ed), setTimeout(() => { const _0x1b6b66 = _0x11dc16; if (_0x1b6b66(0x3df) === _0x1b6b66(0x45c)) return _0x3568c4(_0x1f4327)[_0x1b6b66(0x73a)](_0xd97a26 => _0xd97a26[_0x1b6b66(0x603)]()); else _0x4bb7ed[_0x1b6b66(0x748)]({ 'behavior': _0x1b6b66(0x5c2), 'block': _0x1b6b66(0x1a2) }); }, 0x32); } function _0x25814e() { const _0x5406a7 = _0x113cd8, _0x221e95 = document[_0x5406a7(0x437)](_0x5406a7(0xdf)); if (!_0x221e95) return; _0x221e95['id'] === _0x5406a7(0x6b7) ? _0x4a53a3() : _0x5406a7(0x169) !== 'JxSRx' ? _0x34be0e(_0x5406a7(0x1e6) + _0x278b4f[_0x5406a7(0x2ec)]) : _0x1c0e55(); } function _0x1c0e55() { const _0x3652a5 = _0x113cd8; if (_0x3652a5(0x2b6) !== _0x3652a5(0x2b6)) { const _0x4802b1 = _0x1b1b68[_0x3652a5(0x62e)](_0x1f4f2e, _0x3652a5(0x1f0)), _0x4baf84 = _0x4802b1[_0x3652a5(0x20b)](_0x416f93), _0xea27e0 = _0x4baf84[_0x3652a5(0x22e)](_0x27b742); _0xea27e0[_0x3652a5(0x468)] = () => _0x33a97b(_0xea27e0[_0x3652a5(0x834)]), _0xea27e0[_0x3652a5(0x464)] = () => _0x333a70(_0xea27e0[_0x3652a5(0x40f)]); } else { const _0x378483 = _0x24ae96[_0x3652a5(0x5bb)]['filter'](_0x4ed904 => !_0x4ed904[_0x3652a5(0x779)] && _0x4ed904[_0x3652a5(0x660)] !== _0x3652a5(0x67d)); if (_0x378483['length'] > _0x24ae96[_0x3652a5(0x659)]) { let _0x7aa583 = _0x4066f3[_0x3652a5(0x437)](_0x3652a5(0x19a)); !_0x7aa583 && (_0x7aa583 = document[_0x3652a5(0x2b5)]('button'), _0x7aa583[_0x3652a5(0x548)] = _0x3652a5(0x46f), _0x7aa583[_0x3652a5(0x38a)] = _0x3652a5(0x16a), _0x7aa583['style'][_0x3652a5(0x45f)] = _0x3652a5(0x5c2), _0x7aa583['style'][_0x3652a5(0x36d)] = _0x3652a5(0x2de), _0x7aa583['style'][_0x3652a5(0x434)] = _0x3652a5(0x15f), _0x7aa583[_0x3652a5(0x2c4)] = () => { const _0x4d623f = _0x3652a5, _0x22f79b = _0x4066f3, _0x2af2ce = _0x22f79b[_0x4d623f(0x1fc)], _0x3a1005 = _0x22f79b[_0x4d623f(0x1e5)]; _0x24ae96['displayedMessageCount'] += 0x64, _0x1c0e55(), requestAnimationFrame(() => { const _0x19591b = _0x4d623f; if (_0x19591b(0x5e9) !== _0x19591b(0x5e9)) { const _0x24b019 = _0x2c3b7e[_0x19591b(0x696)]('customFeedWallpaper'); _0x24b019 ? _0x379d6f[_0x19591b(0x2c0)](_0x19591b(0x1aa))[_0x19591b(0x610)]['setProperty'](_0x19591b(0xfc), 'url(' + _0x24b019 + ')') : _0xca9def[_0x19591b(0x2c0)](_0x19591b(0x1aa))[_0x19591b(0x610)]['setProperty']('--feed-bg-image', _0x19591b(0x3d2)); } else { const _0x515a72 = _0x22f79b['scrollHeight']; _0x22f79b[_0x19591b(0x1e5)] = _0x3a1005 + (_0x515a72 - _0x2af2ce); } }); }, _0x4066f3['firstChild'] ? _0x3652a5(0x36f) !== 'TLNoa' ? _0x4066f3[_0x3652a5(0x265)](_0x7aa583, _0x4066f3[_0x3652a5(0x11c)]) : (_0x3618a3['value'] = '', _0x288ce7['textContent'] = _0x3652a5(0x495), _0x3bbeaa[_0x3652a5(0x69f)] = _0x3652a5(0x198) + (_0x308406[_0x3652a5(0x4c0)][_0x3652a5(0x256)] + 0x1), _0x5adf7c[_0x3652a5(0x69f)] = '', _0x4b88c3[_0x3652a5(0xd4)] = _0x5d25db, _0x4e7132[_0x3652a5(0x69f)] = _0x3652a5(0x57c), _0x5b9456[_0x3652a5(0x2c0)]('char-edit-css')[_0x3652a5(0x69f)] = '', _0x377285()) : _0x4066f3[_0x3652a5(0x3b1)](_0x7aa583)); } else { const _0xa36a6c = _0x4066f3[_0x3652a5(0x437)](_0x3652a5(0x19a)); if (_0xa36a6c) _0xa36a6c[_0x3652a5(0x28c)](); } Array['from'](_0x4066f3[_0x3652a5(0x4cd)])['forEach'](_0x3817b7 => { const _0x5dd91a = _0x3652a5; 'SoXEq' === _0x5dd91a(0x21c) ? (_0x5e48d2 = _0x572094[_0x5dd91a(0x7e5)], _0x530ea1 = _0x5ae0ef[_0x5dd91a(0x37c)]) : !_0x3817b7[_0x5dd91a(0x82a)][_0x5dd91a(0x211)]('load-more-btn') && _0x3817b7[_0x5dd91a(0x28c)](); }); const _0x5a4dce = _0x378483[_0x3652a5(0x3a3)](-_0x24ae96[_0x3652a5(0x659)]); _0x5a4dce[_0x3652a5(0x203)](_0x3821cc => { const _0x2ba1b5 = _0x3652a5, _0x2d412c = _0x24ae96[_0x2ba1b5(0x5bb)][_0x2ba1b5(0x1d4)](_0x3821cc); _0x2d412c > -0x1 && _0x473aca(_0x3821cc, _0x2d412c); }); if (_0x24ae96[_0x3652a5(0x3c6)]) { let _0x55cf80 = _0x4066f3[_0x3652a5(0x437)](_0x3652a5(0x263)); if (!_0x55cf80) { if (_0x3652a5(0xc5) === _0x3652a5(0x787)) { const _0x2bc509 = _0x1a390a[_0x3652a5(0x6f1)][_0x330a1c]; _0x2bc509 && _0x2bc509[_0x3652a5(0x256)] > 0x0 && (_0x193b3d = _0x2bc509['at'](-0x1)); } else _0x55cf80 = document[_0x3652a5(0x2b5)](_0x3652a5(0x6ee)), _0x55cf80['className'] = _0x3652a5(0xda), _0x55cf80[_0x3652a5(0x548)] = '对方正在输入...', _0x4066f3[_0x3652a5(0x3b1)](_0x55cf80); } } _0x5a4dce[_0x3652a5(0x256)] <= _0x24ae96[_0x3652a5(0x659)] && setTimeout(() => { const _0x12ea1d = _0x3652a5; _0x4066f3[_0x12ea1d(0x1e5)] = _0x4066f3['scrollHeight']; }, 0x0); } } function _0x473aca(_0x1adddf, _0x344446) { const _0x126986 = _0x113cd8; if ('BZMAQ' === _0x126986(0x700)) { const _0x26d627 = _0xa7101e(_0x48873e[_0x126986(0x590)][0x0]); _0x50d218[_0x126986(0x548)] = _0x26d627 ? _0x26d627['name'] : _0x126986(0x115); } else { const { role: _0x5d92df, content: _0x431858, displayUrl: _0x250dd1, image: _0x25d398, senderId: _0x138cbc } = _0x1adddf, _0x27baff = _0x5d92df === _0x126986(0x2f2) ? 'ai' : _0x5d92df, _0x5137b7 = _0x3cc63d(), _0x3de7c0 = document[_0x126986(0x2b5)](_0x126986(0x6ee)); _0x3de7c0[_0x126986(0x82a)][_0x126986(0x2c7)](_0x126986(0x6d0), _0x27baff), _0x3de7c0['dataset'][_0x126986(0x5a0)] = _0x344446; const _0x3e4b98 = document[_0x126986(0x2b5)](_0x126986(0x6ee)); _0x3e4b98[_0x126986(0x38a)] = 'message-bubble-row'; const _0x8714cf = document[_0x126986(0x2b5)]('img'); _0x8714cf[_0x126986(0x82a)][_0x126986(0x2c7)](_0x126986(0x37c), _0x5d92df + '-avatar'); let _0x24cffa = ''; if (_0x5d92df === _0x126986(0xe9)) { const _0x2feb56 = _0xb7cda(_0x24ae96[_0x126986(0x192)]); _0x24cffa = _0x2feb56[_0x126986(0x37c)] || _0x4be95c; } else { if (_0x126986(0x394) !== _0x126986(0x394)) { const _0x97df9d = _0xfc8c4a[_0x126986(0x5ee)] === _0x6a0b42(_0xbd12fc[_0x126986(0x192)])['id'] ? _0xc384a(_0x5586f6[_0x126986(0x192)]) : _0x227ccf(_0x2f7ea0['recipientId']); _0x222270[_0x126986(0x758)](_0x5d18fa, { 'type': _0x126986(0x2a6), 'amount': _0x1cf35d[_0x126986(0x65a)], 'recipientId': _0x11a169['recipientId'], 'content': _0x126986(0x190) + (_0x97df9d?.[_0x126986(0x7e5)] || '未知') + _0x126986(0x5ab) + _0x3eb856['amount'] + ']' }); } else { _0x24cffa = _0x5d2cd8; let _0x13c7b2 = null; if (_0x5137b7?.[_0x126986(0x776)] === _0x126986(0x62a)) { if (_0x126986(0x675) !== 'sVPKj') { const _0x145195 = { 'characters': _0x565b83[_0x126986(0x4c0)], 'worldBooks': _0x4caab2[_0x126986(0x496)], 'chats': _0x447d93[_0x126986(0x2e2)], 'userProfile': _0x52ed05[_0x126986(0x7ff)], 'apiSettings': _0x5c1c84[_0x126986(0x34f)], 'preferences': _0x4855fc[_0x126986(0x832)], 'activeChatId': _0x597956[_0x126986(0x192)], 'diaries': _0x3317b9[_0x126986(0x80a)], 'friendCircles': _0x715e30[_0x126986(0x7ce)], 'activeFriendCircleId': _0x992f9d['activeFriendCircleId'], 'userProfiles': _0x16e3bb['userProfiles'], 'activeUserProfileId': _0x4e4720[_0x126986(0x4b7)] }; _0x58a14e[_0x126986(0x515)](_0x126986(0xcb), _0x3d46e1['stringify'](_0x145195)); } else _0x13c7b2 = _0x5c4526(_0x5137b7['participantIds'][0x0]); } else _0x5137b7?.[_0x126986(0x776)] === _0x126986(0x324) && _0x138cbc && (_0x13c7b2 = _0x5c4526(_0x138cbc)); _0x13c7b2?.[_0x126986(0x37c)] && (_0x24cffa = _0x13c7b2['avatar']); } } _0x8714cf[_0x126986(0xd4)] = _0x24cffa, _0x8714cf['alt'] = _0x5d92df + '\x20avatar'; const _0x239828 = _0x431858 && _0x431858[_0x126986(0x529)]()[_0x126986(0x5ec)](_0x126986(0x423)) && _0x431858[_0x126986(0x529)]()[_0x126986(0x6c0)](_0x126986(0x2fc)); if (_0x239828) { const _0xbd45bc = document[_0x126986(0x2b5)](_0x126986(0x6ee)); _0xbd45bc[_0x126986(0x38a)] = 'html-module-container', _0xbd45bc[_0x126986(0x217)] = _0x431858, _0x27baff === 'user' ? (_0x3e4b98[_0x126986(0x3b1)](_0xbd45bc), _0x3e4b98[_0x126986(0x3b1)](_0x8714cf)) : (_0x3e4b98[_0x126986(0x3b1)](_0x8714cf), _0x3e4b98['appendChild'](_0xbd45bc)); } else { if ('adyFv' === 'adyFv') { const _0x59819b = document[_0x126986(0x2b5)](_0x126986(0x6ee)); _0x59819b['classList']['add']('message', _0x27baff); if (_0x5137b7?.[_0x126986(0x776)] === _0x126986(0x62a)) { if ('vvQsP' === _0x126986(0x7e7)) { const _0x7ec153 = _0x5137b7[_0x126986(0x590)][0x0]; _0x59819b[_0x126986(0x82a)][_0x126986(0x2c7)](_0x126986(0x729) + _0x7ec153); } else _0x4b3dc2(![]), _0x6659c1[_0x126986(0x5b9)][_0x126986(0x69f)] = ''; } if (_0x1adddf[_0x126986(0x5ed)]) { const _0x3db41c = document[_0x126986(0x2b5)]('div'); _0x3db41c[_0x126986(0x38a)] = _0x126986(0x7a7); const _0x45a315 = document[_0x126986(0x2b5)](_0x126986(0x6ee)); _0x45a315[_0x126986(0x38a)] = _0x126986(0x5bc), _0x45a315[_0x126986(0x548)] = _0x1adddf[_0x126986(0x5ed)][_0x126986(0x721)]; const _0x2bd846 = document['createElement'](_0x126986(0x6ee)); _0x2bd846[_0x126986(0x38a)] = 'quoted-content', _0x2bd846['textContent'] = _0x1adddf['quotedMessage'][_0x126986(0x77b)], _0x3db41c[_0x126986(0x3b1)](_0x45a315), _0x3db41c['appendChild'](_0x2bd846), _0x59819b[_0x126986(0x3b1)](_0x3db41c); } if (_0x250dd1) { if (_0x126986(0x7fd) !== _0x126986(0x7cc)) { _0x59819b[_0x126986(0x82a)][_0x126986(0x2c7)](_0x126986(0x39a)); const _0x51605d = document[_0x126986(0x2b5)]('img'); _0x51605d['src'] = _0x250dd1, _0x51605d[_0x126986(0x82a)][_0x126986(0x2c7)]('sticker-content'), _0x59819b[_0x126986(0x3b1)](_0x51605d); } else { if (_0x4efb6f['isAnimatingDiary']) return; const _0x3e9e55 = _0x20c60b[_0x126986(0x7f0)], _0x5d82a7 = _0x38be72[_0x126986(0x4b9)](_0x1d90a6[_0x126986(0x80a)]['find'](_0x2024e6 => _0x2024e6[_0x126986(0x5f9)] === _0x3dabe7[_0x126986(0x367)])[_0x126986(0x62d)][_0x126986(0x256)] / 0x2); if (_0x3e9e55 >= _0x5d82a7 - 0x1) return; _0x34283a[_0x126986(0x250)] = !![]; const _0x57c41d = _0x3e9e55 + 0x1, _0x13f15c = _0x466ec9[_0x126986(0x2c0)]('diary-page-' + _0x3e9e55), _0x513ca6 = _0x2d7764[_0x126986(0x2c0)](_0x126986(0x51b) + _0x57c41d); _0x13f15c && _0x513ca6 ? (_0x513ca6[_0x126986(0x82a)]['add'](_0x126986(0x288)), _0x13f15c[_0x126986(0x82a)][_0x126986(0x2c7)](_0x126986(0x4f7)), _0x513ca6['classList']['add'](_0x126986(0x6aa)), _0x5af335(() => { const _0x27db4a = _0x126986; _0x13f15c[_0x27db4a(0x82a)][_0x27db4a(0x28c)](_0x27db4a(0x6aa), 'is-exiting-left'), _0x513ca6[_0x27db4a(0x82a)]['remove']('is-entering-from-right'), _0x2c3c12[_0x27db4a(0x7f0)] = _0x57c41d, _0x5e54a8(), _0x2f6435['isAnimatingDiary'] = ![]; }, 0x2bc)) : _0x16cde1[_0x126986(0x250)] = ![]; } } else { if (_0x1adddf['image'] || _0x1adddf[_0x126986(0x470)]) { _0x59819b[_0x126986(0x82a)][_0x126986(0x2c7)](_0x126986(0x650)); const _0x46abec = document['createElement'](_0x126986(0x7d3)); _0x46abec['classList']['add'](_0x126986(0x681)), _0x59819b['appendChild'](_0x46abec); _0x1adddf[_0x126986(0x650)] ? _0x46abec[_0x126986(0xd4)] = _0x1adddf['image'] : (_0x46abec['src'] = _0x126986(0x426), _0x5aea9f(_0x1adddf[_0x126986(0x470)])[_0x126986(0x73a)](_0x4ed73d => { const _0xb2ff9a = _0x126986; if (_0x4ed73d) { if (_0xb2ff9a(0x6b1) !== _0xb2ff9a(0x145)) { const _0x4108d4 = URL['createObjectURL'](_0x4ed73d); _0x46abec['src'] = _0x4108d4, _0x46abec[_0xb2ff9a(0x251)] = () => { const _0x9a4050 = _0xb2ff9a; _0x9a4050(0x1c4) !== _0x9a4050(0x193) ? URL[_0x9a4050(0x1bf)](_0x4108d4) : _0x5168cd[_0x9a4050(0x250)] = ![]; }; } else _0x218153(_0xb2ff9a(0x1e6) + _0x21a005['message']); } else _0x46abec['alt'] = _0xb2ff9a(0x1c2); })['catch'](_0x13c973 => { const _0x192c11 = _0x126986; _0x192c11(0xe4) === 'LhVKq' ? _0x4da34e[_0x192c11(0x6a8)]('chatHistory_' + _0x560d43['id']) : (console[_0x192c11(0x40f)]('无法从\x20IndexedDB\x20加载聊天图片:', _0x13c973), _0x46abec[_0x192c11(0x2be)] = _0x192c11(0x1c2)); })); if (_0x431858) { if ('DolIJ' !== 'uuDmx') { const _0xefcc33 = document[_0x126986(0x2b5)]('p'); _0xefcc33[_0x126986(0x610)][_0x126986(0x51a)] = _0x126986(0x6cd), _0xefcc33[_0x126986(0x548)] = _0x431858, _0x59819b[_0x126986(0x3b1)](_0xefcc33); } else { const _0x325920 = _0x5bc277['trim'](); _0x325920 && _0x19dd5e[_0x126986(0x60b)](..._0x407bc7(_0x325920)), _0x523843 < _0x59e158[_0x126986(0x256)] && (_0x3271e3[_0x126986(0x60b)](_0xd9e52[_0x37f0fa][_0x126986(0x529)]()), _0x3b4d2e++); } } } else { if (_0x1adddf[_0x126986(0x776)] === _0x126986(0x2a6)) { if (_0x126986(0x63f) !== _0x126986(0x63f)) _0x3e9207(![]), _0x321d1c[_0x126986(0x3c6)] = ![]; else { _0x59819b[_0x126986(0x82a)]['add'](_0x126986(0x2a6)); const _0xc97206 = _0x1adddf[_0x126986(0x660)] === _0x126986(0xe9) ? _0xb7cda(_0x24ae96[_0x126986(0x192)]) : _0x5c4526(_0x1adddf[_0x126986(0x1fd)]), _0x22ac77 = _0x1adddf[_0x126986(0x5ee)] === _0xb7cda(_0x24ae96['activeChatId'])['id'] ? _0xb7cda(_0x24ae96[_0x126986(0x192)]) : _0x5c4526(_0x1adddf[_0x126986(0x5ee)]), _0x1a075c = _0xc97206?.[_0x126986(0x7e5)] ? _0xc97206[_0x126986(0x7e5)] + _0x126986(0x2ac) : '转账', _0x46b409 = _0x22ac77?.['name'] ? _0x126986(0x209) + _0x22ac77['name'] : '转账', _0x3ceae6 = _0x126986(0x430) + _0x1a075c + _0x126986(0x194) + _0x1adddf['amount'][_0x126986(0x3bb)](0x2) + _0x126986(0x3b3) + _0x46b409 + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>'; _0x59819b[_0x126986(0x217)] = _0x3ceae6; } } else { if (_0x1adddf[_0x126986(0x776)] === 'listen-together-invite') { _0x59819b[_0x126986(0x82a)][_0x126986(0x2c7)](_0x126986(0x457)); const _0x3c9e8b = document[_0x126986(0x2b5)](_0x126986(0x6ee)); _0x3c9e8b[_0x126986(0x38a)] = _0x126986(0x2eb), _0x3c9e8b[_0x126986(0x82a)][_0x126986(0x2c7)](_0x126986(0x7cb)); const _0x969666 = _0x1adddf[_0x126986(0x660)] === 'user' ? _0xb7cda(_0x24ae96[_0x126986(0x192)])['name'] || '你' : _0x5c4526(_0x1adddf[_0x126986(0x1fd)])?.[_0x126986(0x7e5)] || 'TA', _0x2b4447 = _0x1adddf[_0x126986(0x3ff)] || _0x5d2cd8; _0x1adddf[_0x126986(0x20c)] ? _0x3c9e8b[_0x126986(0x217)] = _0x126986(0x34b) + _0x2b4447 + _0x126986(0x264) + _0x1adddf['songName'] + _0x126986(0x3a1) + _0x1adddf[_0x126986(0x623)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>' : _0x3c9e8b['innerHTML'] = _0x126986(0x133) + _0x969666 + _0x126986(0x51c) + _0x2b4447 + _0x126986(0x712) + _0x1adddf[_0x126986(0x805)] + _0x126986(0x312) + _0x1adddf[_0x126986(0x623)] + _0x126986(0x3dc) + _0x1adddf[_0x126986(0x147)] + _0x126986(0x7a8), _0x59819b[_0x126986(0x3b1)](_0x3c9e8b); } else { if (_0x1adddf['type'] === 'music' && _0x1adddf['songName']) { _0x59819b[_0x126986(0x82a)]['add'](_0x126986(0x457)); const _0x10ce49 = document[_0x126986(0x2b5)]('div'); _0x10ce49[_0x126986(0x38a)] = _0x126986(0x59f), _0x10ce49[_0x126986(0x362)][_0x126986(0x36c)] = _0x126986(0x4f9) + _0x1adddf[_0x126986(0x808)], _0x10ce49['innerHTML'] = _0x126986(0x726) + (_0x1adddf[_0x126986(0x3ff)] || _0x5d2cd8) + _0x126986(0x6b9) + _0x1adddf['songName'] + _0x126986(0x312) + _0x1adddf[_0x126986(0x623)] + _0x126986(0x1dd) + (_0x1adddf[_0x126986(0x4b2)] ? '▶' : '⚠') + _0x126986(0x2fc), _0x1adddf[_0x126986(0x4b2)] && _0x10ce49[_0x126986(0x41c)](_0x126986(0x472), function () { const _0x12fef3 = _0x126986, _0x1fb600 = { 'id': _0x12fef3(0x4f9) + _0x1adddf[_0x12fef3(0x808)], 'url': _0x1adddf['playableUrl'] }; _0x366a1e(this, _0x1fb600); }), _0x59819b[_0x126986(0x3b1)](_0x10ce49); } else { if ('HjLqn' !== _0x126986(0x5ef)) { if (_0x431858) { if ('DGEUY' === _0x126986(0x7be)) { const _0x3057ac = document['createElement']('p'); _0x3057ac[_0x126986(0x548)] = _0x431858, _0x3057ac[_0x126986(0x610)]['margin'] = '0', _0x59819b[_0x126986(0x3b1)](_0x3057ac); } else { if (_0x45a940[_0x126986(0x256)] === 0x0) return; _0x3857f2 = (_0x3a73d6 + 0x1) % _0x3e1598[_0x126986(0x256)], _0x5e7e8f(_0x36fd2d[_0x4befa6], _0x2b53b6); } } } else _0x21d129['disabled'] = !![]; } } } } } _0x5d92df === _0x126986(0xe9) ? (_0x3e4b98['appendChild'](_0x59819b), _0x3e4b98[_0x126986(0x3b1)](_0x8714cf)) : _0x126986(0x6d7) !== _0x126986(0x6d7) ? (_0x3830f7[_0x126986(0x610)][_0x126986(0x6a6)] = '', _0x577c90['style'][_0x126986(0x1c3)] = '', _0x1704ef[_0x126986(0x439)](_0x126986(0x488))[_0x126986(0x203)](_0x12f1dc => { const _0x1ce08e = _0x126986; _0x12f1dc['style'][_0x1ce08e(0x651)] = ''; })) : (_0x3e4b98[_0x126986(0x3b1)](_0x8714cf), _0x3e4b98['appendChild'](_0x59819b)); } else { const _0x4bf06a = _0x2cba1f['friendCircles'][_0x126986(0x1c6)](_0x12085d => _0x12085d['id'] === _0xecd99f[_0x126986(0x4fb)]), _0x4ac793 = _0x4bf06a ? _0x4bf06a['posts'] : []; if (!_0x4ac793 || _0x4ac793[_0x126986(0x256)] === 0x0) return ''; const _0x4d47c8 = _0x4ac793['slice'](0x0, 0x5), _0x24922b = _0x4d47c8[_0x126986(0x6dd)](_0x9fed38 => { const _0x564aeb = _0x126986, _0x22de7a = _0x2a8ea8(_0x9fed38[_0x564aeb(0x6a5)]) || { 'name': '未知' }; let _0x3d7074 = '-\x20[动态]\x20' + _0x22de7a['name'] + _0x564aeb(0x68a) + (_0x9fed38[_0x564aeb(0x143)] || _0x9fed38[_0x564aeb(0x77b)]) + '”'; return _0x9fed38['type'] === _0x564aeb(0x457) && (_0x3d7074 += '\x20(分享了歌曲:\x20' + _0x9fed38[_0x564aeb(0x805)] + _0x564aeb(0x7ef) + _0x9fed38[_0x564aeb(0x623)] + ')'), _0x3d7074; }); return _0x126986(0x70e) + _0x24922b[_0x126986(0x799)]('\x0a'); } } _0x3de7c0[_0x126986(0x3b1)](_0x3e4b98); const _0x7492f5 = document[_0x126986(0x2b5)](_0x126986(0x6ee)); return _0x7492f5[_0x126986(0x38a)] = _0x126986(0x808), _0x7492f5[_0x126986(0x548)] = _0x40671a(_0x1adddf[_0x126986(0x808)]), _0x3de7c0[_0x126986(0x3b1)](_0x7492f5), _0x4066f3[_0x126986(0x3b1)](_0x3de7c0), _0x3de7c0; } } document['getElementById'](_0x113cd8(0x2f5))[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x2240c0); let _0x1b665a = null, _0xa90228 = null; function _0x2240c0(_0x5b5b4f) { const _0x2e7729 = _0x113cd8; if (_0x2e7729(0x73b) !== _0x2e7729(0x73b)) _0x55028a[_0x2e7729(0x41c)](_0x2e7729(0x472), function () { const _0x12630a = { 'id': _0x5d2c61['id'], 'url': _0x5625fb['playableUrl'] }; _0x698061(this, _0x12630a); }); else { if (window[_0x2e7729(0x508)]()[_0x2e7729(0x705)]()) return; const _0x3544a0 = _0x5b5b4f[_0x2e7729(0x5b9)][_0x2e7729(0x550)](_0x2e7729(0x3bd)), _0x4e33d7 = _0x5b5b4f[_0x2e7729(0x5b9)]['closest'](_0x2e7729(0x713)); if (!_0x3544a0 || _0x4e33d7) return; const _0x2207b8 = parseInt(_0x3544a0['dataset'][_0x2e7729(0x5a0)], 0xa); if (isNaN(_0x2207b8)) return; _0x4ba95e(_0x2207b8); } } function _0x17f1ae() { const _0x5e8596 = _0x113cd8; if (_0x5e8596(0x39f) !== _0x5e8596(0x39f)) _0x46be9b(); else { const _0x36a249 = _0x3cc63d(); if (!_0x36a249) { if (_0x5e8596(0x2f1) !== _0x5e8596(0x2f1)) { const _0x3b4297 = _0x43c96f(_0x38f330[_0x5e8596(0x362)][_0x5e8596(0x5a0)], 0xa); !_0x357b7e(_0x3b4297) && _0x3e299c(_0x3b4297); } else { _0x3f15c4[_0x5e8596(0x548)] = _0x5e8596(0x833); return; } } if (_0x36a249[_0x5e8596(0x776)] === 'private') { const _0x39caba = _0x5c4526(_0x36a249[_0x5e8596(0x590)][0x0]); _0x3f15c4[_0x5e8596(0x548)] = _0x39caba ? _0x39caba[_0x5e8596(0x7e5)] : '未知角色'; } else _0x3f15c4['textContent'] = _0x36a249['name'] || _0x5e8596(0x168) + _0x36a249['participantIds']['length'] + ')'; } } function _0x18efc4(_0x32abb3) { const _0x2a5256 = _0x113cd8; if (_0x2a5256(0x781) === 'YWXgS') try { _0x433ade['setItem'](_0x2a5256(0x3b7), _0x164dcc[_0x2a5256(0x3fd)]({ 'playlist': _0x27bb36[_0x2a5256(0x511)], 'currentIndex': _0x37b974[_0x2a5256(0x218)] })); } catch (_0x1a8943) { _0x4f97ff['error'](_0x2a5256(0x6ff), _0x1a8943); } else { const _0x89a2b8 = document['querySelector'](_0x2a5256(0xdf)); if (_0x89a2b8 && (_0x89a2b8['id'] === _0x2a5256(0x6b7) || _0x89a2b8['id'] === _0x2a5256(0x2f9))) _0x25814e(); else { if (_0x2a5256(0x343) === _0x2a5256(0x343)) { const _0x179aa9 = document['querySelectorAll'](_0x2a5256(0x263)); _0x179aa9[_0x2a5256(0x203)](_0x215c84 => _0x215c84['remove']()); } else { _0x56d78a['activeChatId'] = null, _0x3cf416(), _0x44ff0e(![]), _0x2200fc[_0x2a5256(0x2c0)](_0x2a5256(0x460))['style'][_0x2a5256(0x6a6)] = ''; return; } } } } function _0x3867a5() { const _0x23ea33 = _0x113cd8; if (_0x23ea33(0x2f4) === 'BmEfH') _0x24ae96[_0x23ea33(0x3c6)] && _0x24ae96[_0x23ea33(0x185)] && (console['log'](_0x23ea33(0x268)), _0x24ae96[_0x23ea33(0x185)][_0x23ea33(0x35d)](_0x23ea33(0x63d)), _0x24ae96[_0x23ea33(0x185)] = null), _0x24ae96[_0x23ea33(0x3c6)] = ![], _0x18efc4(![]); else { _0x461de4 = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x2c4202 in _0x287d46) { _0x23214b[_0x2c4202]['classList'][_0x23ea33(0x28c)](_0x23ea33(0x28a)), _0x35606a[_0x2c4202]['value'] = ''; } _0x4a34aa[_0x23ea33(0x5ba)]['querySelector'](_0x23ea33(0x444))[_0x23ea33(0x548)] = _0x23ea33(0x64b), _0x427337['cover']['querySelector'](_0x23ea33(0x444))[_0x23ea33(0x548)] = _0x23ea33(0x360), _0x1568d1[_0x23ea33(0x291)]['querySelector'](_0x23ea33(0x444))[_0x23ea33(0x548)] = _0x23ea33(0x21e), _0x244bfe[_0x23ea33(0x1e9)]['querySelector'](_0x23ea33(0x444))[_0x23ea33(0x548)] = _0x23ea33(0x5dd), _0x27b918(); } } function _0x3cc63d() { const _0xd303d4 = _0x113cd8; if ('jxBiX' !== _0xd303d4(0x40e)) _0x408873[_0xd303d4(0x515)](_0xd303d4(0x24a), _0x25d904[_0xd303d4(0x3fd)](_0x372ca6)), _0xcfe7d9(_0xd303d4(0x401)), _0x23ee35(() => _0x422b7a[_0xd303d4(0x743)](), 0x5dc); else return _0x24ae96[_0xd303d4(0x2e2)][_0xd303d4(0x1c6)](_0x4031d2 => _0x4031d2['id'] === _0x24ae96[_0xd303d4(0x192)]); } function _0x5c4526(_0x49f7b5) { const _0x2cb94d = _0x113cd8; return _0x24ae96[_0x2cb94d(0x4c0)]['find'](_0x29a2ff => _0x29a2ff['id'] === _0x49f7b5); } function _0x1cd68d(_0x324ca3) { const _0x9ff2c5 = _0x113cd8; if (_0x9ff2c5(0x637) !== _0x9ff2c5(0x637)) { _0x5cd5d2(); const _0x296fa1 = _0x15ef10[_0x9ff2c5(0x7ce)]['find'](_0x59ce3b => _0x59ce3b['id'] === _0x59b67d); if (!_0x296fa1) return; _0x516676[_0x9ff2c5(0x4fb)] = _0x516198, _0x15d811(), _0x3696d6[_0x9ff2c5(0x2c0)]('friend-circle-title')[_0x9ff2c5(0x548)] = _0x296fa1[_0x9ff2c5(0x7e5)], _0x2a6bec(), _0x36d269(_0x9ff2c5(0x457), 'friendCircleList'), _0x32ac94(); } else { _0x24ae96['characters'] = _0x24ae96[_0x9ff2c5(0x4c0)][_0x9ff2c5(0x3ea)](_0x4f10f7 => _0x4f10f7['id'] !== _0x324ca3), _0x24ae96[_0x9ff2c5(0x2e2)]['forEach'](_0x4a5474 => { const _0x97572f = _0x9ff2c5; _0x4a5474[_0x97572f(0x776)] === _0x97572f(0x324) && (_0x4a5474[_0x97572f(0x590)] = _0x4a5474[_0x97572f(0x590)]['filter'](_0x34b4f4 => _0x34b4f4 !== _0x324ca3)); }); const _0x1a57af = _0x24ae96[_0x9ff2c5(0x2e2)][_0x9ff2c5(0x1c6)](_0x4131c9 => _0x4131c9[_0x9ff2c5(0x776)] === _0x9ff2c5(0x62a) && _0x4131c9[_0x9ff2c5(0x590)]['includes'](_0x324ca3)); _0x1a57af && _0x3426b8(_0x1a57af['id']), _0x24ae96[_0x9ff2c5(0x2e2)] = _0x24ae96[_0x9ff2c5(0x2e2)][_0x9ff2c5(0x3ea)](_0x209b40 => _0x209b40[_0x9ff2c5(0x776)] !== 'group' || _0x209b40[_0x9ff2c5(0x590)][_0x9ff2c5(0x256)] > 0x1), _0x5d845c(), _0x5334a7(); } } function _0x3426b8(_0x3cd88e) { const _0x330487 = _0x113cd8; _0x24ae96[_0x330487(0x2e2)] = _0x24ae96[_0x330487(0x2e2)][_0x330487(0x3ea)](_0xacc378 => _0xacc378['id'] !== _0x3cd88e); try { _0x330487(0x14b) === 'iqdvh' ? localStorage[_0x330487(0x6a8)](_0x330487(0x68e) + _0x3cd88e) : (_0x709e4c[_0x330487(0x60b)](_0x2b5fc3[_0x115c0c]['trim']()), _0x1fdd48++); } catch (_0x2917a1) { console[_0x330487(0x40f)]('Failed\x20to\x20remove\x20history\x20for\x20chat\x20' + _0x3cd88e, _0x2917a1); } _0x24ae96[_0x330487(0x192)] === _0x3cd88e && (_0x24ae96[_0x330487(0x192)] = _0x24ae96[_0x330487(0x2e2)][0x0]?.['id'] || null, _0xdad370(_0x24ae96[_0x330487(0x192)])), _0x5d845c(), _0x5334a7(); } async function _0xdad370(_0x1909a8) { const _0x2fb11c = _0x113cd8; _0x24ae96[_0x2fb11c(0x192)] !== _0x1909a8 && (_0x3867a5(), _0x24ae96[_0x2fb11c(0x659)] = 0x64); if (!_0x1909a8) { if ('ugmyB' === _0x2fb11c(0x7bb)) { _0x24ae96['activeChatId'] = null, _0x5d845c(), _0x591b3d(![]), document[_0x2fb11c(0x2c0)]('chat-view-pane')[_0x2fb11c(0x610)]['backgroundImage'] = ''; return; } else _0xfa3fe2[_0x2fb11c(0x217)] = _0x2fb11c(0x4e7) + _0x34afb7 + _0x2fb11c(0x1be) + (_0x519c4e === _0x2fb11c(0x262) ? _0x2fb11c(0x7e8) : _0x2fb11c(0x1c7)) + _0x2fb11c(0x391) + _0x141345 + _0x2fb11c(0x525) + _0x4936d9; } _0x24ae96['activeChatId'] = _0x1909a8, _0x5d845c(), _0x17f1ae(), _0x4066f3['innerHTML'] = '', _0x541a9b(!![], _0x2fb11c(0x445)), setTimeout(async () => { const _0x519c63 = _0x2fb11c; try { _0xb86a7f(); const _0x476d02 = _0x3cc63d(), _0x254ad9 = document[_0x519c63(0x2c0)](_0x519c63(0x460)); let _0xc3a458 = null; if (_0x476d02) { if (_0x476d02[_0x519c63(0x776)] === _0x519c63(0x62a)) { if (_0x519c63(0x76e) !== 'PIgyM') { const _0x5a6f7c = _0x476d02['participantIds'][0x0]; _0x5a9701(_0x5a6f7c), _0xc3a458 = await _0x5aea9f(_0x519c63(0x4af) + _0x5a6f7c); } else _0xc94763 = _0x7c570f[_0x519c63(0x37c)] || _0x3068fb, _0x4c34e9 = _0x4dee47[_0x519c63(0x7e5)] || _0x519c63(0x2cc), _0x78b96f = _0x194432[_0x519c63(0x366)] || '私聊'; } else { if ('XFsSZ' !== _0x519c63(0x58b)) _0xc3a458 = await _0x5aea9f(_0x519c63(0x67c) + _0x476d02['id']); else { const _0x2e6d71 = _0x17ec5f[_0x519c63(0x2c0)]('user-profile-list-container'); _0x2e6d71[_0x519c63(0x217)] = ''; if (_0x5c5bf5[_0x519c63(0xdc)][_0x519c63(0x256)] === 0x0) { _0x2e6d71[_0x519c63(0x217)] = _0x519c63(0x36e); return; } _0x13f692[_0x519c63(0xdc)]['forEach'](_0x106e93 => { const _0x28fb37 = _0x519c63, _0x5683bf = _0x18c82a[_0x28fb37(0x2b5)]('div'); _0x5683bf[_0x28fb37(0x38a)] = _0x28fb37(0x41a), _0x5683bf[_0x28fb37(0x362)]['id'] = _0x106e93['id']; const _0xe89ee3 = _0x106e93['id'] === _0x5903b3[_0x28fb37(0x4b7)] ? '\x20(当前)' : ''; _0x5683bf[_0x28fb37(0x217)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x106e93['avatar'] || _0x29b0c8) + '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x106e93[_0x28fb37(0x7e5)] + _0xe89ee3 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x106e93[_0x28fb37(0x791)][_0x28fb37(0x3ad)](0x0, 0x64) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x5683bf[_0x28fb37(0x41c)]('click', () => _0x338ef2(_0x106e93['id'])), _0x2e6d71[_0x28fb37(0x3b1)](_0x5683bf); }); } } _0xc3a458 ? 'LVXzi' === _0x519c63(0x1b4) ? _0x29ab36(_0x519c63(0x7f5)) : (_0x254ad9[_0x519c63(0x610)][_0x519c63(0x6a6)] = 'url(\x27' + URL[_0x519c63(0x6c9)](_0xc3a458) + '\x27)', _0x254ad9[_0x519c63(0x610)][_0x519c63(0x15d)] = _0x519c63(0x1f5), _0x254ad9[_0x519c63(0x610)][_0x519c63(0x813)] = _0x519c63(0x640)) : 'kMrgA' === 'kMrgA' ? _0x254ad9[_0x519c63(0x610)]['backgroundImage'] = '' : _0x57237b[_0x519c63(0x610)][_0x519c63(0x651)] = ''; } _0x1c0e55(); } catch (_0x25e0fe) { _0x519c63(0x32d) === _0x519c63(0x18a) ? _0x38c4d['key'] === 'Enter' && !_0x51e9ce['shiftKey'] && (_0x7e1a20[_0x519c63(0x100)](), _0x2c48a1()) : (console[_0x519c63(0x40f)](_0x519c63(0x576), _0x25e0fe), _0x880caf(_0x519c63(0x1b2) + _0x25e0fe['message'])); } finally { if (_0x519c63(0x34a) === _0x519c63(0x34a)) _0x541a9b(![]); else { const _0x174cdd = _0x211119[_0x519c63(0x1d4)]('{'), _0x1f08ff = _0x2e7d6f[_0x519c63(0x13e)]('}'); if (_0x174cdd >= 0x0 && _0x1f08ff > _0x174cdd) return _0x21b84b[_0x519c63(0x3a3)](_0x174cdd, _0x1f08ff + 0x1); return _0x44d246; } } }, 0x32); } async function _0x3d61ef() { const _0x3d66d4 = _0x113cd8; if (_0x3d66d4(0x527) !== _0x3d66d4(0x527)) { _0x28d6bb(![]), _0x474c5d(_0x3d66d4(0x431)); return; } else { if (_0x24ae96[_0x3d66d4(0x3c6)]) { if ('yAgJQ' === 'EYXum') _0x3cda1f[_0x3d66d4(0x470)] = _0x16ffb7; else { _0x880caf(_0x3d66d4(0x1d8)); return; } } const _0x4e8591 = _0x24ae96[_0x3d66d4(0x5bb)]; if (_0x4e8591[_0x3d66d4(0x256)] === 0x0) return; let _0x1c9aed = -0x1; for (let _0x4c9002 = _0x4e8591[_0x3d66d4(0x256)] - 0x1; _0x4c9002 >= 0x0; _0x4c9002--) { if (_0x3d66d4(0x1e4) === _0x3d66d4(0x80c)) _0x218c40[_0x3d66d4(0x7e5)] = _0x5006f0, _0x5b2cc2[_0x3d66d4(0x77b)] = _0x21d30a; else { if (_0x4e8591[_0x4c9002][_0x3d66d4(0x660)] === _0x3d66d4(0xe9)) { _0x1c9aed = _0x4c9002; break; } } } if (_0x1c9aed === -0x1 || _0x1c9aed === _0x4e8591['length'] - 0x1) { if (_0x3d66d4(0x44f) !== 'hworC') { _0x880caf(_0x3d66d4(0xe8)); return; } else { const _0x5c91a8 = _0x42f6ce[_0x3d66d4(0x1fc)]; _0x52e574[_0x3d66d4(0x1e5)] = _0x460809 + (_0x5c91a8 - _0xb27ba0); } } _0x4e8591[_0x3d66d4(0x62c)](_0x1c9aed + 0x1), _0x16869e(), _0x25814e(), setTimeout(() => { const _0x5c946e = _0x3d66d4; if (_0x5c946e(0x48f) !== _0x5c946e(0x4ff)) _0x327f12(); else { const _0x414418 = _0x3283f8[_0x5c946e(0x1c6)](_0x15ed07 => _0x15ed07[_0x5c946e(0x7e5)] === _0x18a998[_0x5c946e(0x7e5)]); if (_0x414418) _0xaf27e5[_0x5c946e(0x758)](_0x46bf03, { 'content': _0x5c946e(0x778) + _0x414418[_0x5c946e(0x7e5)] + ']', 'displayUrl': _0x414418[_0x5c946e(0x375)] }); else _0x4949ad['content'] = '[sticker:' + _0x4ad723['name'] + ']'; } }, 0x64); } } function _0x57a3ef(_0x5c0d28 = null) { const _0x44717d = _0x113cd8; if (_0x44717d(0x411) === _0x44717d(0x411)) { const _0x5032f3 = _0x5c0d28 ?? _0x5eefed[_0x44717d(0x69f)]['trim'](); if (_0x5032f3 === '' || !_0x24ae96[_0x44717d(0x192)]) return; const _0x5421ea = document[_0x44717d(0x437)](_0x44717d(0xdf)), _0x166ea5 = _0x5421ea['id'] === _0x44717d(0x6b7), _0x329fe4 = { 'role': _0x44717d(0xe9), 'content': _0x5032f3, 'timestamp': Date[_0x44717d(0x695)](), 'isOffline': _0x166ea5 }; _0x24ae96[_0x44717d(0x432)] && (_0x44717d(0x59c) === 'yucVf' ? _0x329fe4[_0x44717d(0x5ed)] = { ..._0x24ae96['activeQuote'] } : (_0x36d940(), _0x86e2de(_0x44717d(0x2bd)))), _0x24ae96[_0x44717d(0x5bb)][_0x44717d(0x60b)](_0x329fe4), _0x16869e(), _0x25814e(), !_0x5c0d28 && (_0x5eefed[_0x44717d(0x69f)] = ''), _0x1d643b(); } else _0x405238[_0x44717d(0x69f)] = _0x311291[_0x44717d(0x34f)][_0x44717d(0x19c)] || '', _0x487646[_0x44717d(0x69f)] = _0x50dcda[_0x44717d(0x34f)][_0x44717d(0x60f)] || '', _0x507135[_0x44717d(0x69f)] = _0x4b5ef9[_0x44717d(0x34f)][_0x44717d(0x534)] || '', _0x2ea0a3[_0x44717d(0x69f)] = _0x557381(_0x19defd[_0x44717d(0x832)]?.[_0x44717d(0x2f0)] ?? 0x64), _0x3855a1[_0x44717d(0x2c0)]('api-provider')[_0x44717d(0x69f)] = _0x25a655[_0x44717d(0x34f)][_0x44717d(0x371)] || _0x44717d(0x6cf); } function _0x4784dd(_0x2a736d) { const _0x3d2967 = _0x113cd8; if ('oRaNi' === _0x3d2967(0x668)) { if (!_0x2a736d || !_0x24ae96[_0x3d2967(0x192)]) return; const _0x1b6757 = { 'role': _0x3d2967(0xe9), 'content': _0x3d2967(0x24f) + _0x2a736d[_0x3d2967(0x7e5)] + ']', 'displayUrl': _0x2a736d[_0x3d2967(0x375)], 'timestamp': Date[_0x3d2967(0x695)]() }; _0x24ae96['conversationHistory'][_0x3d2967(0x60b)](_0x1b6757), _0x473aca(_0x1b6757, _0x24ae96[_0x3d2967(0x5bb)]['length'] - 0x1), _0x16869e(), _0x2953a1['classList']['remove'](_0x3d2967(0x155)); } else { const _0x5aebdb = _0x5a371a['getElementById']('confirm-altar-upload-button'); _0x5b4d9a[_0x3d2967(0x5ba)] && _0x3327a8[_0x3d2967(0x291)] ? _0x5aebdb[_0x3d2967(0x38d)] = ![] : _0x5aebdb[_0x3d2967(0x38d)] = !![]; } } async function _0x48a53f(_0x30a023) { const _0x20032c = _0x113cd8, _0x491409 = _0x30a023[_0x20032c(0x5b9)]['files'][0x0]; if (!_0x491409 || !_0x24ae96[_0x20032c(0x192)]) return; _0x541a9b(!![], '正在处理图片...'); try { if (_0x20032c(0x5f4) !== _0x20032c(0x64c)) { const _0x4020bb = await _0xf3c4dd(_0x491409, 0x320, 0.8, !![]), _0x1b46c7 = 'chat_image_' + Date[_0x20032c(0x695)](); await _0x24ee21(_0x1b46c7, _0x4020bb); const _0x3db4a3 = _0x5eefed[_0x20032c(0x69f)][_0x20032c(0x529)](); _0x5eefed['value'] = ''; const _0x4c2106 = { 'role': _0x20032c(0xe9), 'content': _0x3db4a3, 'imageId': _0x1b46c7, 'timestamp': Date['now']() }; _0x24ae96[_0x20032c(0x5bb)][_0x20032c(0x60b)](_0x4c2106), _0x473aca(_0x4c2106, _0x24ae96['conversationHistory']['length'] - 0x1), _0x16869e(); } else { const _0x23d3a5 = _0x1b04d9[_0x20032c(0x496)][_0x20032c(0x1c6)](_0x5980de => _0x5980de['id'] === _0xa11cef); _0x23d3a5 && (_0x23d3a5[_0x20032c(0x7e5)] = _0x78a1f1, _0x23d3a5[_0x20032c(0x77b)] = _0x5e368a); } } catch (_0x4cb084) { if (_0x20032c(0x307) === _0x20032c(0x6f3)) { if (_0xfb4f06[_0x20032c(0x250)]) return; const _0x4b9a77 = _0xdde803['diaryCurrentPage']; if (_0x4b9a77 <= 0x0) return; _0x3089e6[_0x20032c(0x250)] = !![]; const _0x2b5984 = _0x4b9a77 - 0x1, _0x149a3d = _0x53430d['getElementById']('diary-page-' + _0x4b9a77), _0x17a500 = _0x2ae875['getElementById']('diary-page-' + _0x2b5984); _0x149a3d && _0x17a500 ? (_0x17a500[_0x20032c(0x82a)]['add'](_0x20032c(0x73c)), _0x149a3d[_0x20032c(0x82a)][_0x20032c(0x2c7)](_0x20032c(0x481)), _0x17a500[_0x20032c(0x82a)][_0x20032c(0x2c7)](_0x20032c(0x6aa)), _0x2b75a4(() => { const _0x196cfc = _0x20032c; _0x149a3d[_0x196cfc(0x82a)][_0x196cfc(0x28c)]('is-visible', _0x196cfc(0x481)), _0x17a500[_0x196cfc(0x82a)][_0x196cfc(0x28c)]('is-entering-from-left'), _0x268618[_0x196cfc(0x7f0)] = _0x2b5984, _0x123b42(), _0x442a57['isAnimatingDiary'] = ![]; }, 0x2bc)) : _0xc3cf11['isAnimatingDiary'] = ![]; } else _0x880caf('图片处理失败:\x20' + _0x4cb084['message']); } finally { if (_0x20032c(0x4b6) !== 'nKPBi') _0x541a9b(![]), _0x30a023[_0x20032c(0x5b9)][_0x20032c(0x69f)] = ''; else { _0x41fdb2('找不到要清空的聊天记录。'); return; } } } async function _0x36d107() { const _0x5cc889 = _0x113cd8; if (!_0x24ae96[_0x5cc889(0x192)]) return; const _0x528feb = await _0x3f496e(); if (!_0x528feb) return; _0x880caf(_0x5cc889(0x3e4)); try { const _0x4a9696 = await _0x1f04ab(_0x528feb[_0x5cc889(0x805)], _0x528feb[_0x5cc889(0x623)]); let _0x1295c3 = _0x4a9696['cover']; if (_0x4a9696[_0x5cc889(0x1f5)] && _0x4a9696[_0x5cc889(0x1f5)][_0x5cc889(0x5ec)]('http')) try { const _0x43a093 = await fetch(_0x4a9696[_0x5cc889(0x1f5)]), _0x239abd = await _0x43a093['blob'](); _0x1295c3 = await _0x2e73e7(_0x239abd); } catch (_0xb7d8a0) { console[_0x5cc889(0x40f)](_0x5cc889(0x459), _0xb7d8a0), _0x1295c3 = _0x5d2cd8; } const _0x5f333b = { 'role': 'user', 'type': _0x5cc889(0x457), 'content': _0x5cc889(0x674) + _0x528feb[_0x5cc889(0x805)] + _0x5cc889(0x7ef) + _0x528feb[_0x5cc889(0x623)] + ']', 'songName': _0x528feb[_0x5cc889(0x805)], 'artist': _0x528feb['artist'], 'coverUrl': _0x1295c3, 'playableUrl': _0x4a9696[_0x5cc889(0x375)], 'timestamp': Date[_0x5cc889(0x695)]() }; _0x24ae96[_0x5cc889(0x5bb)][_0x5cc889(0x60b)](_0x5f333b), _0x473aca(_0x5f333b, _0x24ae96[_0x5cc889(0x5bb)]['length'] - 0x1), _0x16869e(); } catch (_0x5ef8ba) { console[_0x5cc889(0x40f)](_0x5cc889(0x559), _0x5ef8ba), _0x880caf(_0x5cc889(0x3e7) + _0x5ef8ba[_0x5cc889(0x2ec)]); } } function _0x5afa36(_0x57cc86, _0x532cd2 = 0x78) { const _0x427717 = _0x113cd8, _0x35e615 = _0x63f552 => { const _0x11b711 = _0x52f2; if (_0x11b711(0x347) === _0x11b711(0x74c)) { if (_0x551ce7[_0x11b711(0x660)] === _0x11b711(0xe9)) return _0x1a0b2a['userProfile']?.['name'] || _0x11b711(0x358); if (_0x2c0d70['type'] === _0x11b711(0x324)) { const _0xcb0e5c = _0x47d5e6[_0x11b711(0x1fd)] ? _0xe72f91(_0x244bd9[_0x11b711(0x1fd)]) : null; return _0xcb0e5c?.[_0x11b711(0x7e5)] || _0x11b711(0x76a); } else { const _0x48d315 = _0x1005f2(_0x4ad4d8[_0x11b711(0x590)][0x0]); return _0x48d315?.['name'] || 'AI'; } } else { if (_0x63f552[_0x11b711(0x660)] === _0x11b711(0xe9)) return _0x24ae96[_0x11b711(0x7ff)]?.['name'] || 'User'; if (_0x63f552[_0x11b711(0x1fd)]) { if (_0x11b711(0x7eb) !== _0x11b711(0x7eb)) try { const _0x72f0a9 = { 'characters': _0x5b3314[_0x11b711(0x4c0)], 'worldBooks': _0x547a09[_0x11b711(0x496)], 'chats': _0x396b1a[_0x11b711(0x2e2)], 'userProfile': _0x149a16[_0x11b711(0x7ff)], 'apiSettings': _0x3d3d98[_0x11b711(0x34f)], 'preferences': _0x22c2aa[_0x11b711(0x832)], 'activeChatId': _0x5981be['activeChatId'], 'diaries': _0x331d25['diaries'], 'friendCircles': _0x269cac[_0x11b711(0x7ce)], 'activeFriendCircleId': _0x209c65[_0x11b711(0x4fb)], 'userProfiles': _0x2da5d3[_0x11b711(0xdc)], 'activeUserProfileId': _0x3a20e8['activeUserProfileId'] }; _0x4fb10a[_0x11b711(0x515)](_0x11b711(0xcb), _0x1a71bc['stringify'](_0x72f0a9)); } catch (_0x1153a4) { _0x1ee0ad[_0x11b711(0x40f)](_0x11b711(0x6f5), _0x1153a4), _0x386e7e(_0x11b711(0x7fa)); } else { const _0x10bd4e = _0x5c4526(_0x63f552[_0x11b711(0x1fd)]); return _0x10bd4e?.['name'] || _0x11b711(0x76a); } } if (_0x57cc86?.[_0x11b711(0x776)] === _0x11b711(0x62a)) { const _0x1daf04 = _0x5c4526(_0x57cc86[_0x11b711(0x590)][0x0]); return _0x1daf04?.['name'] || 'AI'; } return _0x11b711(0x127); } }, _0x4d41cc = _0x24ae96[_0x427717(0x5bb)][_0x427717(0x3a3)](-_0x532cd2), _0x5bc96a = []; for (const _0x5e4b3b of _0x4d41cc) { if (_0x5e4b3b[_0x427717(0x774)]) { if (_0x427717(0x6c5) === _0x427717(0x30d)) return { 'type': 'sticker', 'name': _0x5cd9a0[0x1][_0x427717(0x529)]() }; else _0x5bc96a['push']('[' + _0x35e615(_0x5e4b3b) + _0x427717(0x46c) + (_0x5e4b3b[_0x427717(0x77b)]?.['match'](/：(.+?)]/)?.[0x1] || '表情') + ']'); } else { if (_0x5e4b3b[_0x427717(0x650)]) { const _0x12d878 = _0x5e4b3b[_0x427717(0x77b)] ? '\x20' + _0x5e4b3b[_0x427717(0x77b)] : ''; _0x5bc96a[_0x427717(0x60b)]('[' + _0x35e615(_0x5e4b3b) + _0x427717(0x5f6) + _0x12d878); } else _0x5e4b3b[_0x427717(0x77b)] && _0x5bc96a[_0x427717(0x60b)]('[' + _0x35e615(_0x5e4b3b) + ']\x20' + _0x5e4b3b[_0x427717(0x77b)]); } } return _0x5bc96a[_0x427717(0x799)]('\x0a'); } function _0x2e7ca9(_0x5e1985, _0x20461d) { const _0x4156a0 = _0x113cd8; if (_0x4156a0(0x62b) !== 'ImPGl') { if (!_0x5e1985 || !_0x20461d) return null; const _0x17adc2 = _0x20461d[_0x4156a0(0x259)](/@([^\s:：,，。!?]+)/); if (!_0x17adc2) return null; const _0x10da59 = _0x17adc2[0x1][_0x4156a0(0x817)](); for (const _0x1b91e1 of _0x5e1985[_0x4156a0(0x590)]) { if (_0x4156a0(0x686) === _0x4156a0(0x686)) { const _0x1b2864 = _0x5c4526(_0x1b91e1); if (!_0x1b2864?.[_0x4156a0(0x7e5)]) continue; if (_0x1b2864[_0x4156a0(0x7e5)]['toLowerCase']() === _0x10da59) return _0x1b2864; if (_0x1b2864[_0x4156a0(0x7e5)]['toLowerCase']()[_0x4156a0(0x5ec)](_0x10da59)) return _0x1b2864; } else _0x4e0313[_0x4156a0(0x650)] = _0x4e48da; } return null; } else _0x5e5d3b['log'](_0x4156a0(0x4b8)), _0x5dbb3d[_0x4156a0(0x515)]('appState', _0x15169a[_0x4156a0(0x3fd)](_0x172375)); } function _0x124be6(_0x2f23ba) { const _0x5d3692 = _0x113cd8, _0x49a454 = _0x2f23ba['indexOf']('{'), _0x4cfeba = _0x2f23ba[_0x5d3692(0x13e)]('}'); if (_0x49a454 >= 0x0 && _0x4cfeba > _0x49a454) return _0x2f23ba[_0x5d3692(0x3a3)](_0x49a454, _0x4cfeba + 0x1); return _0x2f23ba; } function _0x1a096b(_0x3ad7f2, _0x21a637, _0x58a152) { const _0x127817 = _0x113cd8; if (_0x127817(0x6da) !== 'xUpdY') _0x3a8dce['removeItem'](_0x127817(0x68e) + _0x2b75dc); else { const _0x3155fd = new Map(_0x21a637[_0x127817(0x6dd)](_0xba7892 => [String(_0xba7892['id']), _0xba7892])), _0x21ea9a = _0x502df3 => String(_0x502df3 || '')[_0x127817(0x817)]()['replace'](/\s+/g, ''), _0x4d74bb = new Map(_0x21a637['map'](_0x543f01 => [_0x21ea9a(_0x543f01[_0x127817(0x7e5)]), _0x543f01])), _0x6728e3 = new Set(_0x58a152), _0x5e1858 = { 'events': [] }; for (const _0xccecca of _0x3ad7f2?.[_0x127817(0xe1)] || []) { const _0x17119b = _0xccecca['senderId'] ?? _0xccecca[_0x127817(0x721)] ?? _0xccecca[_0x127817(0x570)] ?? _0xccecca[_0x127817(0x4d9)] ?? _0xccecca[_0x127817(0x660)] ?? _0xccecca['name']; if (!_0x17119b) continue; let _0x5514da = _0x3155fd['get'](String(_0x17119b)) || _0x4d74bb[_0x127817(0x22e)](_0x21ea9a(_0x17119b)); if (!_0x5514da) continue; const _0x410551 = (_0xccecca[_0x127817(0x6d4)] || _0xccecca['type'] || _0x127817(0x13b))[_0x127817(0x817)](); if (_0x410551 === _0x127817(0x39a)) { const _0x1aafb8 = (_0xccecca[_0x127817(0x39a)] ?? _0xccecca[_0x127817(0x742)] ?? _0xccecca[_0x127817(0x54b)] ?? _0xccecca[_0x127817(0x5f7)])?.[_0x127817(0x529)](); if (_0x1aafb8 && _0x6728e3[_0x127817(0x1c9)](_0x1aafb8)) _0x5e1858[_0x127817(0xe1)][_0x127817(0x60b)]({ 'senderId': _0x5514da['id'], 'kind': _0x127817(0x39a), 'sticker': _0x1aafb8 }); else { const _0x2b7b4b = String(_0xccecca['content'] ?? _0xccecca['text'] ?? '')['trim']() || _0x127817(0x2e0) + (_0x1aafb8 || _0x127817(0x780)) + ']'; if (_0x2b7b4b) _0x5e1858[_0x127817(0xe1)][_0x127817(0x60b)]({ 'senderId': _0x5514da['id'], 'kind': 'text', 'content': _0x2b7b4b }); } } else { const _0x359623 = String(_0xccecca[_0x127817(0x77b)] ?? _0xccecca[_0x127817(0x13b)] ?? _0xccecca[_0x127817(0x2ec)] ?? '')[_0x127817(0x529)](); if (_0x359623) _0x5e1858[_0x127817(0xe1)]['push']({ 'senderId': _0x5514da['id'], 'kind': _0x127817(0x13b), 'content': _0x359623 }); } } return _0x5e1858; } } async function _0x5477ba(_0x4ba214) { const _0x339722 = _0x113cd8; if (!_0x4ba214 || !Array[_0x339722(0x2d0)](_0x4ba214[_0x339722(0xe1)]) || _0x4ba214[_0x339722(0xe1)][_0x339722(0x256)] === 0x0) return; const _0x1dcd70 = _0x5ee115 => _0x5ee115 + Math[_0x339722(0x182)](Math[_0x339722(0x835)]() * 0x190); let _0x3271c0 = 0x1f4; for (const _0x46108a of _0x4ba214[_0x339722(0xe1)]) { await new Promise(_0x436297 => setTimeout(_0x436297, _0x1dcd70(_0x3271c0))), _0x3271c0 += 0x2bc; const _0x43be8 = _0x24ae96[_0x339722(0x5bb)]['at'](-0x1)?.[_0x339722(0x779)] ?? ![]; if (_0x46108a[_0x339722(0x6d4)] === _0x339722(0x39a)) { const _0x14cfae = _0x438419[_0x339722(0x1c6)](_0x2a8866 => _0x2a8866[_0x339722(0x7e5)] === _0x46108a[_0x339722(0x39a)]); if (_0x14cfae) { const _0x14183c = { 'role': _0x339722(0x2f2), 'content': _0x339722(0x778) + _0x14cfae[_0x339722(0x7e5)] + ']', 'displayUrl': _0x14cfae[_0x339722(0x375)], 'senderId': _0x46108a[_0x339722(0x1fd)], 'timestamp': Date[_0x339722(0x695)](), 'isOffline': _0x43be8 }; _0x24ae96[_0x339722(0x5bb)][_0x339722(0x60b)](_0x14183c); } } else { if (_0x46108a[_0x339722(0x6d4)] === _0x339722(0x457) && _0x46108a[_0x339722(0x805)] && _0x46108a['artist']) { const { songName: _0x2b611b, artist: _0x3eb066 } = _0x46108a, _0x39f12d = { 'role': _0x339722(0x2f2), 'type': _0x339722(0x457), 'content': '[AI分享了音乐：' + _0x2b611b + '\x20-\x20' + _0x3eb066 + ']', 'songName': _0x2b611b, 'artist': _0x3eb066, 'senderId': _0x46108a[_0x339722(0x1fd)], 'timestamp': Date[_0x339722(0x695)](), 'isOffline': _0x43be8 }; try { const _0x2b7e0b = await _0x1f04ab(_0x2b611b, _0x3eb066); _0x39f12d[_0x339722(0x3ff)] = _0x2b7e0b['cover'], _0x39f12d[_0x339722(0x4b2)] = _0x2b7e0b['url']; } catch (_0x4ffe99) { _0x339722(0x41d) !== 'TKRjj' ? (console[_0x339722(0x40f)](_0x339722(0x447) + _0x2b611b + _0x339722(0x7ef) + _0x3eb066 + '):', _0x4ffe99), _0x39f12d[_0x339722(0x3ff)] = null, _0x39f12d[_0x339722(0x4b2)] = null) : _0x10eb3f('有\x20' + _0x27a154 + _0x339722(0x441)); } _0x24ae96[_0x339722(0x5bb)]['push'](_0x39f12d); } else { if (_0x46108a[_0x339722(0x6d4)] === 'text') { const _0x4df5df = _0x4b80dd(_0x46108a[_0x339722(0x77b)])[_0x339722(0x3a3)](0x0, 0x3); for (let _0x16b9e4 = 0x0; _0x16b9e4 < _0x4df5df[_0x339722(0x256)]; _0x16b9e4++) { if (_0x16b9e4 > 0x0) await new Promise(_0x10660c => setTimeout(_0x10660c, _0x1dcd70(0x190))); const _0x3317df = { 'role': _0x339722(0x2f2), 'content': _0x4df5df[_0x16b9e4], 'senderId': _0x46108a[_0x339722(0x1fd)], 'timestamp': Date[_0x339722(0x695)](), 'isOffline': _0x43be8 }; _0x24ae96[_0x339722(0x5bb)][_0x339722(0x60b)](_0x3317df); } } } } } _0x16869e(), _0x25814e(); } async function _0x22d2d4(_0x4ce964, { force: force = ![], delayMs: delayMs = 0x0 } = {}) { const _0x123ef3 = _0x113cd8; await new Promise(_0x548d64 => setTimeout(_0x548d64, 0xa)); if (!_0x24ae96[_0x123ef3(0x34f)]['endpoint'] || !_0x24ae96[_0x123ef3(0x34f)][_0x123ef3(0x60f)] || !_0x24ae96[_0x123ef3(0x34f)]['model']) return _0x880caf('请先在\x22设置\x22中配置你的\x20API\x20信息。'), ![]; const _0x393317 = _0x3cc63d(); if (!_0x393317 || !_0x4ce964) return ![]; const _0x21362f = _0xb7cda(_0x393317['id']), _0x4be7ce = _0x24ae96[_0x123ef3(0x5bb)]['at'](-0x1)?.[_0x123ef3(0x660)] === 'user'; if (!force && !_0x4be7ce) return ![]; const _0x6b1604 = _0x24ae96[_0x123ef3(0x5bb)]['at'](-0x1)?.[_0x123ef3(0x779)] ?? ![]; if (delayMs) await new Promise(_0x458b39 => setTimeout(_0x458b39, delayMs)); _0x6b1604 ? _0x123ef3(0x2f7) === _0x123ef3(0x2f7) ? document[_0x123ef3(0x2c0)]('galgame-text')[_0x123ef3(0x548)] = '（正在构思中...）' : _0xce35d[_0x123ef3(0x3b1)](_0x529aa4) : _0x18efc4(!![]); let _0xba50c1 = ''; if (_0x24ae96[_0x123ef3(0x20a)] && _0x24ae96['listenTogetherSession'][_0x123ef3(0x14e)] && _0x481ebb[_0x123ef3(0x256)] > 0x0) { const _0x4b78a2 = _0x24ae96[_0x123ef3(0x20a)], _0xe15221 = _0x5eabbb[_0x123ef3(0x62f)]; let _0x25aa33 = -0x1; for (let _0x21a548 = 0x0; _0x21a548 < _0x481ebb[_0x123ef3(0x256)]; _0x21a548++) { if (_0x123ef3(0x641) === _0x123ef3(0x33c)) _0x5a0be3['push'](_0x533502); else { if (_0xe15221 >= _0x481ebb[_0x21a548][_0x123ef3(0x657)]) _0x25aa33 = _0x21a548; else break; } } const _0x433b95 = _0x481ebb[_0x123ef3(0x6dd)]((_0x1c34c7, _0x2e91fd) => { const _0x18cfb5 = _0x2e91fd === _0x25aa33 ? '>>\x20' : ''; return '' + _0x18cfb5 + _0x1c34c7['text']; })[_0x123ef3(0x799)]('\x0a'); _0xba50c1 = (_0x123ef3(0x64a) + _0x4b78a2[_0x123ef3(0x623)] + _0x123ef3(0x1ef) + _0x4b78a2[_0x123ef3(0x805)] + _0x123ef3(0x24d) + _0x433b95 + _0x123ef3(0x703))[_0x123ef3(0x529)](); } let _0x28bf5f = '', _0x157ba7 = ''; const _0x285974 = _0x24ae96[_0x123ef3(0x5bb)]['length']; if (_0x285974 > 0x1) { const _0x338efb = _0x24ae96[_0x123ef3(0x5bb)][_0x285974 - 0x2], _0x275727 = _0x24ae96[_0x123ef3(0x5bb)][_0x285974 - 0x1]; if (_0x338efb['isOffline'] === ![] && _0x275727[_0x123ef3(0x779)] === !![]) 'GbRPX' !== _0x123ef3(0x399) ? _0x157ba7 = _0x123ef3(0x54f) + _0x21362f[_0x123ef3(0x7e5)] + _0x123ef3(0x233) : (_0x4b05a5(_0x3567ba['id']), _0x217dc0(_0x123ef3(0x755)), _0x45777b(_0x123ef3(0x710)), _0x453b86(![])); else _0x338efb[_0x123ef3(0x779)] === !![] && _0x275727[_0x123ef3(0x779)] === ![] && (_0x157ba7 = '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“' + _0x21362f[_0x123ef3(0x7e5)] + _0x123ef3(0x46a)); } if (_0x6b1604) { if (_0x123ef3(0x74a) === _0x123ef3(0x74a)) { const _0x167b14 = _0x123ef3(0x6d6); _0x28bf5f = _0x123ef3(0x19f) + _0x21362f[_0x123ef3(0x7e5)] + _0x123ef3(0x414) + _0x167b14 + _0x123ef3(0x2c2) + _0x4ce964[_0x123ef3(0x7e5)] + '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[' + _0x167b14 + _0x123ef3(0x816) + _0x167b14 + _0x123ef3(0x6f9); } else { const _0x553f79 = [], _0x4aea93 = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x2a1660; while ((_0x2a1660 = _0x4aea93['exec'](_0x1561de)) !== null) { const _0x28bf99 = _0x2a1660[0x1][_0x123ef3(0xef)](/\\"/g, '\x22')[_0x123ef3(0xef)](/\\n/g, '\x0a')[_0x123ef3(0x529)](); if (_0x28bf99) _0x553f79['push'](_0x28bf99); } if (_0x553f79[_0x123ef3(0x256)]) return _0x553f79[_0x123ef3(0x186)](_0x1ba343)['slice'](0x0, 0x9); } } else { if ('UCXIH' === _0x123ef3(0x412)) { const _0x34cd29 = _0x4359b0(_0x1c855e['senderId'] || _0xcad4da[_0x123ef3(0x3ae)]); _0x221880 = _0x34cd29?.['name'] || '角色', _0x3b17b4 = _0x123ef3(0x568); } else _0x123ef3(0x230); } const { omniText: _0x457fec } = _0x5bd842(_0x4ce964['id'], _0x393317['id']), _0x3b5d10 = _0x4e95be(), _0x165079 = _0x118a24(_0x4ce964['id']), _0x2d1f3e = typeof _0x3a1f76 === _0x123ef3(0x63b) ? _0x3a1f76['replaceAll'](_0x123ef3(0x10b), _0x4ce964[_0x123ef3(0x7e5)])[_0x123ef3(0x6e2)]('{userName}', _0x21362f[_0x123ef3(0x7e5)] || '用户') : '', _0x546aaf = _0x438419[_0x123ef3(0x6dd)](_0x5c148e => _0x5c148e['name'])[_0x123ef3(0x799)](',\x20'); let _0x4596ef = ''; if (_0x4ce964[_0x123ef3(0x106)] && _0x4ce964['linkedWorldBookIds'][_0x123ef3(0x256)] > 0x0) { if (_0x123ef3(0x58f) !== _0x123ef3(0x58f)) { if (typeof _0x97ab96 === _0x123ef3(0x63b)) _0x42e6f4[_0x123ef3(0x60b)](_0x2721bd); } else { const _0x13ee1b = _0x4ce964[_0x123ef3(0x106)][_0x123ef3(0x6dd)](_0x34b87b => _0x24ae96[_0x123ef3(0x496)][_0x123ef3(0x1c6)](_0x410ec8 => _0x410ec8['id'] === _0x34b87b))[_0x123ef3(0x3ea)](Boolean)[_0x123ef3(0x6dd)](_0x44fdd7 => _0x123ef3(0x632) + _0x44fdd7[_0x123ef3(0x7e5)] + '\x0a' + _0x44fdd7[_0x123ef3(0x77b)])[_0x123ef3(0x799)](''); if (_0x13ee1b) _0x4596ef = _0x123ef3(0x1ee) + _0x13ee1b; } } const _0x5bd4b7 = _0x21362f[_0x123ef3(0x791)] ? _0x123ef3(0x77a) + _0x21362f[_0x123ef3(0x7e5)] + _0x123ef3(0x78a) + _0x21362f['persona'] : ''; let _0x5c92e2 = ''; const _0x4ed472 = new Date(), _0x154b66 = _0x24ae96[_0x123ef3(0x5bb)]['at'](-0x1), _0xffcddb = _0x17ce43(_0x4ce964['id']); _0x5c92e2 = '\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a', _0x5c92e2 += '-\x20**当前精确时间**:\x20' + _0x4ed472['toLocaleString'](_0x123ef3(0x222), { 'dateStyle': 'full', 'timeStyle': 'short' }) + '\x0a'; if (_0xffcddb) { if (_0x123ef3(0x71f) !== 'nwWIs') { const _0x18ac90 = _0x4dd116(new Date(_0xffcddb[_0x123ef3(0x808)])); _0x5c92e2 += _0x123ef3(0x235) + _0x18ac90 + '\x0a'; const _0x2589f9 = (_0x4ed472 - new Date(_0xffcddb[_0x123ef3(0x808)])) / (0x3e8 * 0x3c * 0x3c); if (_0x2589f9 > 0x30) _0x5c92e2 += '-\x20**对话状态提示**:\x20你们已经超过两天没联系了，应该用全新的问候开启对话。\x0a'; else { if (_0x2589f9 > 0x14) { if (_0x123ef3(0x231) === _0x123ef3(0x4c6)) { const _0x5dd365 = _0x411532['linkedWorldBookIds']['map'](_0x19519b => _0x141b65[_0x123ef3(0x496)][_0x123ef3(0x1c6)](_0x5a193d => _0x5a193d['id'] === _0x19519b))[_0x123ef3(0x3ea)](_0x258837)[_0x123ef3(0x6dd)](_0x25f9aa => '\x0a\x0a##\x20世界书条目:\x20' + _0x25f9aa[_0x123ef3(0x7e5)] + '\x0a' + _0x25f9aa['content'])[_0x123ef3(0x799)](''); if (_0x5dd365) _0x1e4af0 = _0x123ef3(0x1ee) + _0x5dd365; } else _0x5c92e2 += _0x123ef3(0x597); } else _0x2589f9 > 0x4 ? _0x123ef3(0x2b2) !== _0x123ef3(0x215) ? _0x5c92e2 += _0x123ef3(0x489) : (_0x5a90ee(), _0x431841(_0x123ef3(0x6b8), _0x123ef3(0x22f))) : _0x5c92e2 += '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a'; } } else _0x245a18[_0x123ef3(0x610)][_0x123ef3(0x452)] = _0x123ef3(0x14f), _0x21f1d0(() => _0x4f815c[_0x123ef3(0x82a)][_0x123ef3(0x2c7)](_0x123ef3(0x155)), 0xa); } else _0x5c92e2 += _0x123ef3(0x753); const _0x3c1279 = ('\x0a' + _0x28bf5f + _0x123ef3(0x37f) + _0x4ce964[_0x123ef3(0x7e5)] + _0x123ef3(0x768) + _0x4ce964[_0x123ef3(0x7e5)] + _0x123ef3(0x465) + _0x4ce964[_0x123ef3(0x7e5)] + _0x123ef3(0x73e) + _0x546aaf + _0x123ef3(0x714) + _0x2d1f3e + '\x0a')[_0x123ef3(0x529)](), _0x4fff68 = [{ 'role': _0x123ef3(0x67d), 'content': _0x3c1279 }], _0x2dbea4 = ('\x0a#\x20你的个性（节选）\x0a' + (_0x4ce964[_0x123ef3(0x791)] || _0x123ef3(0x7ca)) + '\x0a' + _0x5bd4b7 + '\x20\x0a' + _0x457fec + '\x0a' + _0x3b5d10 + '\x0a' + _0x165079 + _0x123ef3(0x706) + _0xba50c1 + '\x0a' + _0x5c92e2 + '\x0a' + _0x4596ef + '\x0a')['trim'](); _0x2dbea4['replace'](/#.*|\s/g, '') && ('scxtX' === _0x123ef3(0x78d) ? (_0x4fff68[_0x123ef3(0x60b)]({ 'role': _0x123ef3(0xe9), 'content': _0x2dbea4 }), _0x4fff68[_0x123ef3(0x60b)]({ 'role': _0x123ef3(0x2f2), 'content': '好的，我记住了这些人设和历史。现在我们开始对话。' })) : _0x3336e3['removeItem'](_0x123ef3(0xcb))); const _0x2fb8f8 = _0x24ae96[_0x123ef3(0x832)]?.[_0x123ef3(0x2f0)] ?? 0x64, _0x31e8da = _0x24ae96[_0x123ef3(0x5bb)][_0x123ef3(0x3a3)](-_0x2fb8f8); for (const _0x3c68f2 of _0x31e8da) { if (_0x123ef3(0x6d5) === _0x123ef3(0x6d5)) { const _0x5c4547 = _0x3c68f2['role'] === 'ai' || _0x3c68f2['role'] === 'assistant' ? _0x123ef3(0x2f2) : _0x123ef3(0xe9); let _0x1074be = { 'role': _0x5c4547, 'content': _0x3c68f2[_0x123ef3(0x77b)] }, _0x166086 = !!_0x3c68f2[_0x123ef3(0x77b)]; if (_0x3c68f2[_0x123ef3(0x774)] && _0x3c68f2[_0x123ef3(0x77b)][_0x123ef3(0x4e4)]('表情')) { const _0x42e401 = _0x3c68f2[_0x123ef3(0x77b)]['match'](/：(.*?)]$/); _0x1074be[_0x123ef3(0x77b)] = '[sticker:' + (_0x42e401 ? _0x42e401[0x1] : '未知表情') + ']', _0x4fff68[_0x123ef3(0x60b)](_0x1074be); } else { if (_0x123ef3(0x6b0) !== _0x123ef3(0x565)) { let _0x31115e = null; if (_0x3c68f2[_0x123ef3(0x650)]) _0x31115e = _0x3c68f2[_0x123ef3(0x650)]; else { if (_0x3c68f2['imageId']) { if ('NvYxu' !== _0x123ef3(0x1c5)) { if (!_0x3d4601[_0x123ef3(0x432)]) return; _0x170af5[_0x123ef3(0x548)] = _0x123ef3(0x738) + _0x3fbbf9[_0x123ef3(0x432)][_0x123ef3(0x721)], _0x312f9f[_0x123ef3(0x548)] = _0x348af8['activeQuote'][_0x123ef3(0x77b)], _0x4b39a2[_0x123ef3(0x610)][_0x123ef3(0x452)] = _0x123ef3(0x3fb); } else try { const _0x598b53 = await _0x5aea9f(_0x3c68f2['imageId']); _0x598b53 && (_0x123ef3(0x2fe) !== _0x123ef3(0x6e4) ? _0x31115e = await _0x2e73e7(_0x598b53) : _0x38ba38[_0x123ef3(0x548)] = _0x123ef3(0x810)); } catch (_0x598cc1) { console[_0x123ef3(0x40f)](_0x123ef3(0x740), _0x598cc1); } } } _0x31115e && (_0x1074be['image'] = _0x31115e, _0x166086 = !![]), _0x166086 && _0x4fff68[_0x123ef3(0x60b)](_0x1074be); } else { if (_0x4bce70) _0x3f4367[_0x123ef3(0x548)] = '❚❚'; } } } else _0xbd32f8[_0x123ef3(0x40f)](_0x123ef3(0x683), _0x2f96b4); } try { if ('Vcafi' !== 'Vcafi') { const _0x5721e8 = _0x2f51e1[_0x123ef3(0x62e)](_0x1d595b, 'readwrite'), _0x186c79 = _0x5721e8[_0x123ef3(0x20b)](_0x3e221d), _0x29636e = _0x186c79[_0x123ef3(0x242)]({ 'id': _0x4b16bd, 'blob': _0x7c7792 }); _0x29636e['onsuccess'] = () => _0x438cae(_0x29636e['result']), _0x29636e[_0x123ef3(0x464)] = () => _0x46409c(_0x29636e[_0x123ef3(0x40f)]); } else { const _0x2ec997 = await _0x519e38(_0x4fff68); if (!_0x2ec997) return ![]; if (_0x6b1604) try { let _0x17e27c = _0x2ec997[_0x123ef3(0x529)](); const _0x39422c = _0x17e27c[_0x123ef3(0x259)](/(\[[\s\S]*\])/); _0x39422c && ('VGCAD' === 'VGCAD' ? _0x17e27c = _0x39422c[0x1] : (_0x5047e7['error'](_0x123ef3(0x519), _0x2c96ee), _0x3846e0(_0x123ef3(0x341)))); const _0x439853 = JSON[_0x123ef3(0x458)](_0x17e27c); if (Array['isArray'](_0x439853)) { if (_0x123ef3(0x1ae) === 'ClRoq') { _0x24ae96[_0x123ef3(0x7f7)] = _0x439853, _0x24ae96[_0x123ef3(0x6f1)][_0x4ce964['id']] = [..._0x439853], _0x580ba3(); const _0x3a5dc9 = _0x439853[_0x123ef3(0x6dd)](_0x4f51ae => _0x4f51ae[_0x123ef3(0x4d9)] === 'narrator' ? _0x4f51ae['line'] : _0x4f51ae['speaker'] + ':\x20' + _0x4f51ae[_0x123ef3(0x6f0)])[_0x123ef3(0x799)]('\x0a\x0a'); _0x24ae96['conversationHistory'][_0x123ef3(0x60b)]({ 'role': _0x123ef3(0x2f2), 'senderId': _0x4ce964['id'], 'timestamp': Date[_0x123ef3(0x695)](), 'isOffline': !![], 'content': _0x3a5dc9 }); } else _0x4f6963[_0x123ef3(0x1bf)](_0xf7bf7c); } } catch (_0x57f5fe) { _0x123ef3(0x35b) !== _0x123ef3(0x28d) ? (console[_0x123ef3(0x40f)]('解析AI剧本JSON失败:', _0x57f5fe, '原始文本:', _0x2ec997), _0x24ae96[_0x123ef3(0x5bb)][_0x123ef3(0x60b)]({ 'role': 'assistant', 'senderId': _0x4ce964['id'], 'timestamp': Date[_0x123ef3(0x695)](), 'isOffline': !![], 'content': _0x123ef3(0x5dc) + _0x2ec997 + ']' })) : (_0x32638a[_0x123ef3(0x38a)] = _0x123ef3(0x348), _0x24c774[_0x123ef3(0x610)][_0x123ef3(0x526)] = _0x123ef3(0x474), _0x1838ef[_0x123ef3(0x610)]['color'] = '#d1d5db', _0x3ba06b[_0x123ef3(0x217)] = _0x4417af); } else { const _0x329838 = _0x328f59(_0x2ec997), _0x36209b = _0x329838[_0x123ef3(0x6dd)](_0x2f5e16 => { const _0x2c1314 = _0x123ef3, _0x308c1f = _0x2f5e16[_0x2c1314(0x529)](), _0x2ad2e5 = _0x308c1f[_0x2c1314(0x259)](/^\[music:(.*?)\|(.*?)\]$/), _0x24bc2d = _0x308c1f[_0x2c1314(0x259)](/^\[sticker:(.*?)\]$/), _0x3c9087 = _0x308c1f[_0x2c1314(0x259)](/^\[transfer:([\d.]+)\|(.*?)\]$/); if (_0x2ad2e5) { if (_0x2c1314(0x1d2) !== _0x2c1314(0x238)) return { 'type': 'music', 'songName': _0x2ad2e5[0x1]['trim'](), 'artist': _0x2ad2e5[0x2][_0x2c1314(0x529)]() }; else _0xd92a3c[_0x2c1314(0x3c6)] = ![], _0x2102dc(![]); } else { if (_0x24bc2d) return { 'type': 'sticker', 'name': _0x24bc2d[0x1][_0x2c1314(0x529)]() }; else { if (_0x3c9087) { const _0x19b1f5 = parseFloat(_0x3c9087[0x1]), _0x41f5ac = _0x3c9087[0x2]['trim'](), _0x2a0cf7 = _0xb7cda(_0x24ae96['activeChatId']); let _0x1f8d3c = null; if (_0x41f5ac === _0x2a0cf7[_0x2c1314(0x7e5)]) _0x2c1314(0x5c6) !== _0x2c1314(0x6ce) ? _0x1f8d3c = _0x2a0cf7['id'] : (_0x509aec(), _0x2d067b('worldBook', _0x2c1314(0x540))); else { const _0xeb29 = _0x3cc63d(); if (_0xeb29[_0x2c1314(0x776)] === _0x2c1314(0x324)) { if (_0x2c1314(0x156) === _0x2c1314(0x156)) { const _0x42e741 = _0x24ae96['characters']['find'](_0x7acbce => _0xeb29[_0x2c1314(0x590)][_0x2c1314(0x4e4)](_0x7acbce['id']) && _0x7acbce[_0x2c1314(0x7e5)] === _0x41f5ac); if (_0x42e741) _0x1f8d3c = _0x42e741['id']; } else _0x2b0218['style'][_0x35c809] = _0x17bf93[_0x26022e]; } } if (_0x1f8d3c) return { 'type': _0x2c1314(0x2a6), 'amount': _0x19b1f5, 'recipientId': _0x1f8d3c, 'senderId': _0x4ce964['id'] }; else return { 'type': _0x2c1314(0x13b), 'content': _0x2c1314(0x801) + _0x41f5ac + _0x2c1314(0x638) }; } else { if (_0x308c1f) { if ('WvJbo' !== 'MbLNU') return { 'type': _0x2c1314(0x13b), 'content': _0x308c1f }; else { const _0x4d3b98 = _0xd1b849[_0x2c1314(0x7ce)][_0x2c1314(0x1c6)](_0x31fc1c => _0x31fc1c['id'] === _0x385500); if (!_0x4d3b98) return; _0x5832eb['textContent'] = _0x2c1314(0x3de), _0x125b61[_0x2c1314(0x69f)] = _0x4d3b98['id'], _0x185d56[_0x2c1314(0x69f)] = _0x4d3b98[_0x2c1314(0x7e5)], _0x570a34['value'] = _0x4d3b98[_0x2c1314(0x346)], _0x4ba89d[_0x2c1314(0x610)][_0x2c1314(0x452)] = _0x2c1314(0x3fb), _0x4d3b98[_0x2c1314(0x14c)][_0x2c1314(0x203)](_0x398637 => { const _0x3fa2cd = _0x2c1314, _0x5e96fc = _0x356515[_0x3fa2cd(0x437)](_0x3fa2cd(0x7a3) + _0x398637); if (_0x5e96fc) _0x5e96fc[_0x3fa2cd(0x5fc)] = !![]; }); } } } } } return null; })[_0x123ef3(0x3ea)](Boolean), _0x4379cf = async _0x4591f1 => { const _0x2ea7af = _0x123ef3, _0x859575 = { 'role': _0x2ea7af(0x2f2), 'senderId': _0x4ce964['id'], 'timestamp': Date[_0x2ea7af(0x695)](), 'isOffline': _0x6b1604 }; if (_0x4591f1[_0x2ea7af(0x776)] === _0x2ea7af(0x457)) { if ('qwEOR' !== 'FBZqr') { const { songName: _0x2454be, artist: _0x31b9fa } = _0x4591f1; _0x859575[_0x2ea7af(0x776)] = _0x2ea7af(0x457), _0x859575[_0x2ea7af(0x77b)] = _0x2ea7af(0x747) + _0x2454be + '\x20-\x20' + _0x31b9fa + ']'; try { const _0x53ced2 = await _0x1f04ab(_0x2454be, _0x31b9fa); Object['assign'](_0x859575, { 'songName': _0x2454be, 'artist': _0x31b9fa, 'coverUrl': _0x53ced2['cover'], 'playableUrl': _0x53ced2[_0x2ea7af(0x375)] }); } catch (_0x4d7dbb) { Object['assign'](_0x859575, { 'songName': _0x2454be, 'artist': _0x31b9fa, 'coverUrl': null, 'playableUrl': null }); } } else { const _0x4ba7a7 = 'chat_' + _0x3b8fd7; _0x38262e(_0x4ba7a7), _0x47f88b(!![]); } } else { if (_0x4591f1['type'] === _0x2ea7af(0x39a)) { const _0x350b2f = _0x438419[_0x2ea7af(0x1c6)](_0x2350a3 => _0x2350a3[_0x2ea7af(0x7e5)] === _0x4591f1[_0x2ea7af(0x7e5)]); if (_0x350b2f) Object[_0x2ea7af(0x758)](_0x859575, { 'content': _0x2ea7af(0x778) + _0x350b2f[_0x2ea7af(0x7e5)] + ']', 'displayUrl': _0x350b2f[_0x2ea7af(0x375)] }); else _0x859575[_0x2ea7af(0x77b)] = _0x2ea7af(0x2e0) + _0x4591f1[_0x2ea7af(0x7e5)] + ']'; } else { if (_0x4591f1[_0x2ea7af(0x776)] === _0x2ea7af(0x2a6)) { if (_0x2ea7af(0x337) !== _0x2ea7af(0x337)) { if (_0x540958[_0x2ea7af(0x256)] === 0x0) return; _0x3c7ebe = (_0x4b62c8 - 0x1 + _0x18347a[_0x2ea7af(0x256)]) % _0x31d068[_0x2ea7af(0x256)], _0x3e6704(_0x43c64a[_0x4e6384], _0x5cc0f9); } else { const _0x66c3c = _0x4591f1[_0x2ea7af(0x5ee)] === _0xb7cda(_0x24ae96[_0x2ea7af(0x192)])['id'] ? _0xb7cda(_0x24ae96[_0x2ea7af(0x192)]) : _0x5c4526(_0x4591f1[_0x2ea7af(0x5ee)]); Object[_0x2ea7af(0x758)](_0x859575, { 'type': _0x2ea7af(0x2a6), 'amount': _0x4591f1[_0x2ea7af(0x65a)], 'recipientId': _0x4591f1[_0x2ea7af(0x5ee)], 'content': _0x2ea7af(0x190) + (_0x66c3c?.['name'] || '未知') + '\x20转账\x20' + _0x4591f1[_0x2ea7af(0x65a)] + ']' }); } } else { if (_0x2ea7af(0x786) === _0x2ea7af(0x5fd)) _0x570c92['activeChatId'] = _0x2b2c4a[_0x2ea7af(0x2e2)][0x0]?.['id'] || null; else { const _0x4cfbe6 = _0x6eb57f(_0x4591f1['content']); Object[_0x2ea7af(0x758)](_0x859575, { 'content': _0x4cfbe6[_0x2ea7af(0x77b)], 'quotedMessage': _0x4cfbe6[_0x2ea7af(0x5ed)] }); } } } } return _0x859575; }, _0x3b57d5 = await Promise[_0x123ef3(0x154)](_0x36209b['map'](_0x4379cf)); for (const _0xcb408 of _0x3b57d5) { (_0xcb408['content'] || _0xcb408[_0x123ef3(0x774)] || _0xcb408[_0x123ef3(0x776)] === _0x123ef3(0x457)) && (_0x123ef3(0x577) !== _0x123ef3(0x2ee) ? (await new Promise(_0x4ef210 => setTimeout(_0x4ef210, 0x12c + Math[_0x123ef3(0x835)]() * 0x190)), _0x24ae96[_0x123ef3(0x5bb)][_0x123ef3(0x60b)](_0xcb408), _0x25814e()) : (_0x288c7a(), _0x5e5127(_0x123ef3(0x4ca), _0x123ef3(0x540)))); } } return _0x16869e(), _0x25814e(), !![]; } } catch (_0x2d5591) { if (_0x123ef3(0x413) === _0x123ef3(0x413)) { if (_0x2d5591[_0x123ef3(0x7e5)] !== _0x123ef3(0x6f2)) { console[_0x123ef3(0x40f)]('生成失败:\x20', _0x2d5591); const _0x5707c7 = { 'role': _0x123ef3(0x2f2), 'content': _0x123ef3(0x1e6) + _0x2d5591['message'], 'senderId': _0x4ce964['id'], 'isOffline': _0x6b1604 }; _0x24ae96[_0x123ef3(0x5bb)][_0x123ef3(0x60b)](_0x5707c7), _0x25814e(); } return ![]; } else { const _0x5e89e7 = _0x303974[_0x123ef3(0x2c0)]('home-clock-container'); if (!_0x5e89e7) return; _0x3e14be[_0x123ef3(0x832)][_0x123ef3(0x715)] ? (_0x5e89e7[_0x123ef3(0x610)][_0x123ef3(0x1c3)] = _0x123ef3(0x422), _0x5e89e7[_0x123ef3(0x610)][_0x123ef3(0x651)] = _0x123ef3(0x6d8)) : (_0x5e89e7[_0x123ef3(0x610)]['color'] = 'var(--text-color)', _0x5e89e7[_0x123ef3(0x610)]['textShadow'] = 'none'); } } finally { _0x18efc4(![]); } } async function _0x327f12() { const _0xf8e300 = _0x113cd8; console[_0xf8e300(0x72f)](_0xf8e300(0x81a)); if (!_0x24ae96[_0xf8e300(0x34f)][_0xf8e300(0x19c)] || !_0x24ae96[_0xf8e300(0x34f)][_0xf8e300(0x60f)] || !_0x24ae96['apiSettings'][_0xf8e300(0x534)]) { if ('IpqcR' !== _0xf8e300(0x7ea)) { _0x880caf(_0xf8e300(0x409)); return; } else return { 'type': _0xf8e300(0x13b), 'content': _0x57a37c }; } const _0x55f875 = _0x24ae96[_0xf8e300(0x5bb)]['at'](-0x1)?.['role'] === _0xf8e300(0xe9); if (!_0x55f875 || _0x24ae96[_0xf8e300(0x3c6)]) return; const _0x10747d = _0x3cc63d(); if (!_0x10747d) return; _0x24ae96['isGenerating'] = !![], _0x18efc4(!![]); try { if (_0x10747d[_0xf8e300(0x776)] === _0xf8e300(0x62a)) { const _0x2b097c = _0x5c4526(_0x10747d[_0xf8e300(0x590)][0x0]); console['log'](_0xf8e300(0x802)); if (_0x2b097c) await _0x22d2d4(_0x2b097c, { 'force': !![] }); } else { const _0x4066b8 = await _0x3a7403(); if (_0x4066b8 && _0x4066b8[_0xf8e300(0xe1)]?.[_0xf8e300(0x256)]) { if (_0xf8e300(0x4c8) !== _0xf8e300(0x4c8)) return ''; else await _0x5477ba(_0x4066b8); } else { if (_0xf8e300(0xf7) !== _0xf8e300(0x44b)) { console['warn'](_0xf8e300(0x551)); const _0x141e1a = _0x10747d[_0xf8e300(0x590)]['map'](_0x5c4526)[_0xf8e300(0x3ea)](Boolean); if (!_0x141e1a['length']) return; let _0x1b9da6 = 0x0; for (const _0x368a14 of _0x141e1a) { _0x22d2d4(_0x368a14, { 'force': !![], 'delayMs': _0x1b9da6 }), _0x1b9da6 += 0x1f4; } } else _0x1a5ad8[_0xf8e300(0x610)]['backgroundImage'] = ''; } } } catch (_0x821f61) { if (_0xf8e300(0x60d) !== _0xf8e300(0x60d)) { _0x239d05('请输入群聊名称。'); return; } else _0x821f61['name'] !== _0xf8e300(0x6f2) && (console[_0xf8e300(0x40f)](_0xf8e300(0x3a9), _0x821f61), _0x473aca({ 'role': _0xf8e300(0x2f2), 'content': '错误:\x20' + _0x821f61['message'] }, _0x24ae96[_0xf8e300(0x5bb)]['length'] - 0x1)); } finally { _0x24ae96[_0xf8e300(0x3c6)] = ![], _0x18efc4(![]); } } function _0x147a45(_0x2c8f8f, _0xab45eb) { const _0x144963 = _0x113cd8; if (_0x144963(0x72c) !== _0x144963(0x72c)) { const _0x2d2240 = _0x3b6bdb[_0x144963(0x2b5)](_0x144963(0x6ee)); _0x2d2240['textContent'] = _0x33f3c9, _0x2d2240[_0x144963(0x41c)](_0x144963(0x472), () => { const _0x4c59da = _0x144963; _0x38ccbb[_0x4c59da(0x69f)] = _0x2cbdad, _0x43ea17[_0x4c59da(0x82a)][_0x4c59da(0x28c)](_0x4c59da(0x155)); }), _0x498117[_0x144963(0x3b1)](_0x2d2240); } else { const _0x5df20c = _0xab45eb[_0x144963(0x817)](), _0x53cd34 = _0x2c8f8f['toLowerCase'](); if (_0x5df20c['startsWith'](_0x144963(0x788))) return _0x144963(0x7b8); if (_0x53cd34['includes'](_0x144963(0x374))) return _0x144963(0x7b8); if (_0x53cd34[_0x144963(0x4e4)](_0x144963(0x3d0))) return 'gemini'; if (_0x5df20c[_0x144963(0x5ec)]('gemini')) return _0x144963(0x318); return _0x144963(0x6cf); } } async function _0x519e38(_0x3cbd3a, _0xfe1997 = {}) { const _0x48ae26 = _0x113cd8; if (_0x48ae26(0x3c7) !== _0x48ae26(0x57a)) { _0x24ae96['currentAbortController'] && ('EsJkn' === 'EsJkn' ? _0x24ae96[_0x48ae26(0x185)][_0x48ae26(0x35d)](_0x48ae26(0x732)) : _0x15c019(_0x48ae26(0x1e6) + _0x1ccc4d['message'])); _0x24ae96[_0x48ae26(0x185)] = new AbortController(); const _0x583551 = _0x24ae96[_0x48ae26(0x185)][_0x48ae26(0x1d7)], { endpoint: _0x46663b, key: _0x30979e, model: _0x309715 } = _0x24ae96[_0x48ae26(0x34f)], _0x5aeec3 = !!_0xfe1997['json'], _0x3a2298 = _0x147a45(_0x46663b, _0x309715); console[_0x48ae26(0x72f)](_0x48ae26(0x533) + _0x3a2298); let _0x32e06b = ''; try { if ('csWRE' === _0x48ae26(0x6f8)) { switch (_0x3a2298) { case _0x48ae26(0x7b8): { const _0x4c5c51 = _0x1ce4b2(_0x30979e), _0x4ea7bc = _0x3cbd3a[_0x48ae26(0x1c6)](_0xe2b77d => _0xe2b77d[_0x48ae26(0x660)] === _0x48ae26(0x67d))?.[_0x48ae26(0x77b)] || '', _0x1f5612 = _0x3cbd3a[_0x48ae26(0x3ea)](_0x556301 => _0x556301[_0x48ae26(0x660)] !== _0x48ae26(0x67d)), _0x288e67 = { 'model': _0x309715, 'system': _0x4ea7bc, 'messages': _0x1f5612[_0x48ae26(0x6dd)](_0x2bef53 => ({ 'role': _0x2bef53[_0x48ae26(0x660)], 'content': [{ 'type': _0x48ae26(0x13b), 'text': _0x2bef53[_0x48ae26(0x77b)] }] })), 'max_tokens': 0x1000 }, _0x37acba = await fetch(_0x46663b, { 'method': _0x48ae26(0x26c), 'headers': { 'Content-Type': 'application/json', 'x-api-key': _0x4c5c51, 'anthropic-version': '2023-06-01' }, 'body': JSON[_0x48ae26(0x3fd)](_0x288e67), 'signal': _0x583551 }); if (!_0x37acba['ok']) { const _0x4a7a47 = await _0x37acba['json']()[_0x48ae26(0x1ca)](() => ({})); throw new Error(_0x48ae26(0x77c) + _0x37acba[_0x48ae26(0x187)] + _0x48ae26(0x7ef) + (_0x4a7a47[_0x48ae26(0x40f)]?.[_0x48ae26(0x2ec)] || _0x37acba[_0x48ae26(0x207)])); } const _0x79b5ab = await _0x37acba[_0x48ae26(0x49a)](); _0x32e06b = _0x79b5ab[_0x48ae26(0x77b)]?.[0x0]?.[_0x48ae26(0x13b)] || ''; break; } case _0x48ae26(0x318): { const _0x470398 = _0x1ce4b2(_0x30979e), _0x3f4072 = _0x46663b['includes'](_0x48ae26(0x136)), _0x47fdaf = _0x13291d => { const _0x1aff43 = _0x48ae26, _0x5fa39e = []; if (_0x13291d[_0x1aff43(0x77b)]) _0x5fa39e[_0x1aff43(0x60b)]({ 'text': _0x13291d[_0x1aff43(0x77b)] }); if (_0x13291d[_0x1aff43(0x650)]) { const _0x1ce5b2 = _0x13291d['image'][_0x1aff43(0x1da)](',')[0x1], _0x2475db = _0x13291d[_0x1aff43(0x650)][_0x1aff43(0x3ad)](_0x13291d[_0x1aff43(0x650)][_0x1aff43(0x1d4)](':') + 0x1, _0x13291d[_0x1aff43(0x650)]['indexOf'](';')) || _0x1aff43(0x51e); _0x5fa39e['push']({ 'inline_data': { 'mime_type': _0x2475db, 'data': _0x1ce5b2 } }); } return _0x5fa39e; }, _0x47a9b5 = _0x3cbd3a[_0x48ae26(0x6dd)](_0x405b6e => ({ 'role': _0x405b6e[_0x48ae26(0x660)] === _0x48ae26(0x2f2) ? _0x48ae26(0x534) : _0x405b6e[_0x48ae26(0x660)] === _0x48ae26(0x67d) ? _0x48ae26(0xe9) : _0x405b6e[_0x48ae26(0x660)], 'parts': _0x47fdaf(_0x405b6e) }))['filter'](_0x427845 => _0x427845[_0x48ae26(0x5a1)][_0x48ae26(0x256)] > 0x0), _0x54330a = { 'contents': _0x47a9b5 }; _0x5aeec3 && _0x3f4072 && (_0x48ae26(0x357) === _0x48ae26(0x357) ? _0x54330a[_0x48ae26(0x13c)] = { 'response_mime_type': _0x48ae26(0x30c) } : _0x497b06['linkedWorldBookIds'] = _0x836041[_0x48ae26(0x106)]['filter'](_0x204a2b => _0x204a2b !== _0x352d20)); const _0xefcdf2 = _0x46663b + _0x48ae26(0x605) + _0x309715 + _0x48ae26(0x148) + _0x470398 + _0x48ae26(0x7e0), _0xcd82c1 = await fetch(_0xefcdf2, { 'method': _0x48ae26(0x26c), 'headers': { 'Content-Type': _0x48ae26(0x30c) }, 'body': JSON['stringify'](_0x54330a), 'signal': _0x583551 }); if (!_0xcd82c1['ok']) throw new Error(_0x48ae26(0x31a) + _0xcd82c1[_0x48ae26(0x187)]); const _0x1aa217 = _0xcd82c1[_0x48ae26(0x5e4)][_0x48ae26(0x542)](), _0x97cc1d = new TextDecoder(); let _0x435187 = ''; while (!![]) { if (_0x48ae26(0x306) !== 'UlIHI') { if (_0x583551[_0x48ae26(0x34c)]) { console[_0x48ae26(0x72f)](_0x48ae26(0x52c)), _0x1aa217[_0x48ae26(0x3f7)](); break; } const { done: _0x15a9dc, value: _0x1e67c4 } = await _0x1aa217[_0x48ae26(0x4e1)](); if (_0x15a9dc) break; const _0x1853cb = _0x97cc1d['decode'](_0x1e67c4, { 'stream': !![] }), _0x1d3149 = _0x1853cb['split']('\x0a')[_0x48ae26(0x3ea)](_0x4a60d4 => _0x4a60d4[_0x48ae26(0x529)]()[_0x48ae26(0x5ec)](_0x48ae26(0x2ae))); for (const _0x59f7f8 of _0x1d3149) { const _0x4d37d0 = _0x59f7f8[_0x48ae26(0xef)](_0x48ae26(0x7c8), ''); if (_0x4d37d0 === _0x48ae26(0x50e)) break; try { if (_0x48ae26(0x3e5) !== _0x48ae26(0x38f)) _0x435187 += JSON[_0x48ae26(0x458)](_0x4d37d0)[_0x48ae26(0x1a9)][0x0]['content'][_0x48ae26(0x5a1)][0x0]['text']; else { const _0x45808d = _0x311c11[_0x48ae26(0x2b5)](_0x48ae26(0x6ee)); _0x45808d[_0x48ae26(0x38a)] = _0x48ae26(0x32f), _0x45808d[_0x48ae26(0x217)] = _0x109e48, _0x54a64d === _0x48ae26(0xe9) ? (_0x1113ea[_0x48ae26(0x3b1)](_0x45808d), _0x199008[_0x48ae26(0x3b1)](_0x1315b5)) : (_0x35f7d7[_0x48ae26(0x3b1)](_0x2d636c), _0x1ff9ed[_0x48ae26(0x3b1)](_0x45808d)); } } catch { } } } else _0xbeca0a[_0x48ae26(0x832)]['widgetBgImage'] = null, _0x36c772(), _0x19bd36(), _0x5aebc3('小组件背景已恢复默认。'); } _0x32e06b = _0x435187; break; } case _0x48ae26(0x6cf): default: { const _0x503a4c = _0x1ce4b2(_0x30979e), _0x5cc31e = _0x46663b['replace'](/\/+$/, '') + _0x48ae26(0x175), _0x2de374 = _0x3cbd3a[_0x48ae26(0x6dd)](_0x31db81 => { const _0x2d5ba5 = _0x48ae26; if ('Ybhtl' !== _0x2d5ba5(0x45e)) { if (!_0x21dcd3) return ''; const _0x2d659e = new _0x3c9df2(_0x95231), _0x4c513a = _0x201e7d(_0x2d659e['getHours']())['padStart'](0x2, '0'), _0x4d19b7 = _0x827ab5(_0x2d659e[_0x2d5ba5(0x37e)]())['padStart'](0x2, '0'); return _0x4c513a + ':' + _0x4d19b7; } else { if (_0x31db81[_0x2d5ba5(0x660)] === _0x2d5ba5(0xe9) && _0x31db81[_0x2d5ba5(0x650)]) return { 'role': 'user', 'content': [{ 'type': _0x2d5ba5(0x13b), 'text': _0x31db81[_0x2d5ba5(0x77b)] || '\x20' }, { 'type': _0x2d5ba5(0x654), 'image_url': { 'url': _0x31db81[_0x2d5ba5(0x650)], 'detail': _0x2d5ba5(0x30e) } }] }; return { 'role': _0x31db81['role'], 'content': _0x31db81[_0x2d5ba5(0x77b)] }; } })[_0x48ae26(0x3ea)](_0x347f80 => _0x347f80[_0x48ae26(0x77b)]), _0x37ecf4 = { 'model': _0x309715, 'messages': _0x2de374, 'max_tokens': 0x1000, ..._0x5aeec3 ? { 'response_format': { 'type': _0x48ae26(0x4e9) } } : {} }, _0x5732d7 = await fetch(_0x5cc31e, { 'method': _0x48ae26(0x26c), 'headers': { 'Content-Type': 'application/json', 'Authorization': 'Bearer\x20' + _0x503a4c }, 'body': JSON[_0x48ae26(0x3fd)](_0x37ecf4), 'signal': _0x583551 }); if (!_0x5732d7['ok']) { const _0x4e3d2e = await _0x5732d7[_0x48ae26(0x49a)]()[_0x48ae26(0x1ca)](() => ({})); throw new Error('OpenAI\x20API\x20错误:\x20' + _0x5732d7[_0x48ae26(0x187)] + '\x20-\x20' + (_0x4e3d2e[_0x48ae26(0x40f)]?.['message'] || _0x5732d7['statusText'])); } const _0x5250b1 = await _0x5732d7[_0x48ae26(0x49a)](); _0x32e06b = _0x5250b1[_0x48ae26(0x1b0)]?.[0x0]?.['message']?.['content'] || ''; break; } }return _0x32e06b; } else _0x3d0eae[_0x48ae26(0x82a)][_0x48ae26(0x2c7)](_0x48ae26(0x6aa)); } catch (_0x222a48) { if (_0x222a48[_0x48ae26(0x7e5)] === _0x48ae26(0x6f2)) return console[_0x48ae26(0x72f)](_0x48ae26(0x446)), ''; throw _0x222a48; } finally { _0x48ae26(0x818) !== _0x48ae26(0x417) ? _0x24ae96[_0x48ae26(0x185)] && _0x24ae96[_0x48ae26(0x185)][_0x48ae26(0x1d7)] === _0x583551 && (_0x24ae96['currentAbortController'] = null) : (_0x37fe3a[_0x48ae26(0x40f)](_0x48ae26(0x109), _0x1e38d5), _0x1b5cf5('无法保存聊天记录。')); } } else { const _0x3ff16f = _0x20270f[_0x48ae26(0x550)](_0x48ae26(0x3bd)), _0x520501 = _0x54169f[_0x48ae26(0x362)]['songId'], _0x3f8c6c = _0x123a2a(_0x3ff16f['dataset'][_0x48ae26(0x5a0)], 0xa); _0x5f5995(_0x520501, _0x3f8c6c, _0x4a8d6c); } } async function _0x20228a() { const _0x4b37da = _0x113cd8, _0x54e1b2 = _0x434a81[_0x4b37da(0x1e7)][_0x4b37da(0x82a)]['contains'](_0x4b37da(0x33a)), _0x46d9cf = _0x54e1b2 ? _0x1a806b[_0x4b37da(0x69f)] : null; let _0xbf7e48 = null, _0x4f2fbb = ''; if (_0x54e1b2 && _0x46d9cf) { _0xbf7e48 = _0x24ae96[_0x4b37da(0x2e2)]['find'](_0x26b587 => _0x26b587['type'] === _0x4b37da(0x62a) && _0x26b587[_0x4b37da(0x590)]['includes'](_0x46d9cf)); const _0x818eb1 = _0x5c4526(_0x46d9cf); _0x4f2fbb = _0x818eb1 ? _0x818eb1[_0x4b37da(0x7e5)] : '该角色'; } else { if (_0x24ae96[_0x4b37da(0x192)]) { _0xbf7e48 = _0x3cc63d(); const _0x225e76 = document[_0x4b37da(0x2c0)]('char-name-header')[_0x4b37da(0x548)]; _0x4f2fbb = _0x225e76 || _0x4b37da(0x34d); } } if (!_0xbf7e48) { _0x880caf(_0x4b37da(0x572)); return; } const _0xe4cf55 = await _0x380a1e(_0x4b37da(0x227) + _0x4f2fbb + '\x22\x20的聊天记录吗？此操作不可撤销。'); if (!_0xe4cf55) return; _0xbf7e48['id'] === _0x24ae96[_0x4b37da(0x192)] && (_0x3867a5(), _0x24ae96[_0x4b37da(0x5bb)] = [], _0x1c0e55()); try { localStorage['removeItem'](_0x4b37da(0x68e) + _0xbf7e48['id']); } catch (_0x15fb5d) { console[_0x4b37da(0x40f)](_0x4b37da(0x4c2) + _0xbf7e48['id'], _0x15fb5d); } _0x880caf('\x22' + _0x4f2fbb + _0x4b37da(0x25f)); } const _0x5e0a5d = document[_0x113cd8(0x2c0)]('export-all-data-button'), _0x30201c = document['getElementById'](_0x113cd8(0x79a)), _0x13d6e7 = document[_0x113cd8(0x2c0)]('import-data-input'); _0x5e0a5d[_0x113cd8(0x41c)](_0x113cd8(0x472), async () => { const _0x5b4d1e = _0x113cd8; if ('TOSLC' !== _0x5b4d1e(0x42d)) { _0x541a9b(!![], '正在打包数据，请稍候...'); const _0x37e479 = []; try { const _0xfa762c = { 'localStorageData': {}, 'indexedDBData': {}, 'indexedDBMusicData': [] }; for (let _0x15e455 = 0x0; _0x15e455 < localStorage['length']; _0x15e455++) { const _0x19b1bf = localStorage[_0x5b4d1e(0x60f)](_0x15e455); if (_0x19b1bf) _0xfa762c[_0x5b4d1e(0x2ff)][_0x19b1bf] = localStorage[_0x5b4d1e(0x696)](_0x19b1bf); } const _0x2ee756 = await _0x5656bf, _0x330884 = _0x2ee756[_0x5b4d1e(0x62e)](_0x11ca7f, _0x5b4d1e(0x1f0)), _0xe14b0 = _0x330884['objectStore'](_0x11ca7f), _0x96dab3 = await new Promise((_0x1bb92e, _0x5446eb) => { const _0x318a6b = _0x5b4d1e; if (_0x318a6b(0x2aa) !== _0x318a6b(0x4df)) { const _0x269cf6 = _0xe14b0[_0x318a6b(0x7a6)](); _0x269cf6[_0x318a6b(0x468)] = () => _0x1bb92e(_0x269cf6[_0x318a6b(0x834)]), _0x269cf6[_0x318a6b(0x464)] = () => _0x5446eb(_0x269cf6[_0x318a6b(0x40f)]); } else { const _0x2ed7d9 = _0x534440[_0x318a6b(0x2b5)]('option'); _0x2ed7d9[_0x318a6b(0x69f)] = _0x54e171['id'], _0x2ed7d9[_0x318a6b(0x548)] = _0x236a07[_0x318a6b(0x7e5)], _0x179e61[_0x318a6b(0x3b1)](_0x2ed7d9); } }); for (const _0x929a6f of _0x96dab3) { if (_0x929a6f[_0x5b4d1e(0x603)] instanceof Blob) try { _0xfa762c[_0x5b4d1e(0x144)][_0x929a6f['id']] = await _0x2e73e7(_0x929a6f[_0x5b4d1e(0x603)]); } catch (_0x3612eb) { if ('aCbXs' !== _0x5b4d1e(0x309)) _0x37e479[_0x5b4d1e(0x60b)](_0x929a6f['id']); else { const _0x3e4710 = _0x418d9d[_0x5b4d1e(0x2c0)](_0x5b4d1e(0x435)), _0x4fd893 = _0x3e4710[_0x5b4d1e(0x439)]('input:checked'), _0x69c593 = _0x1ba4ff[_0x5b4d1e(0x437)](_0x5b4d1e(0x11b)); if (_0x4fd893[_0x5b4d1e(0x256)] === 0x0) _0x69c593[_0x5b4d1e(0x548)] = _0x5b4d1e(0x810); else _0x4fd893['length'] > 0x2 ? _0x69c593[_0x5b4d1e(0x548)] = _0x5b4d1e(0xc8) + _0x4fd893['length'] + '\x20项' : _0x69c593[_0x5b4d1e(0x548)] = _0x3e8564['from'](_0x4fd893)[_0x5b4d1e(0x6dd)](_0xb1569c => _0xb1569c[_0x5b4d1e(0xce)]['textContent']['trim']())['join']('、'); } } } const _0x223ee2 = _0x2ee756[_0x5b4d1e(0x62e)](_0x5e7179, _0x5b4d1e(0x1f0)), _0x3b8970 = _0x223ee2[_0x5b4d1e(0x20b)](_0x5e7179), _0x45d30f = await new Promise((_0x4af926, _0x37afc7) => { const _0x257852 = _0x5b4d1e; if (_0x257852(0x353) === _0x257852(0x158)) _0x326d68(_0x3f89c2[_0x257852(0x470)])[_0x257852(0x73a)](_0x28221d => { const _0x549adb = _0x257852; if (_0x28221d) { const _0x3743f4 = _0x5cb772['createObjectURL'](_0x28221d); _0x47c79a[_0x549adb(0xd4)] = _0x3743f4, _0x5d98e2['onload'] = () => _0x489c6c[_0x549adb(0x1bf)](_0x3743f4); } else _0x216f10['alt'] = _0x549adb(0x1c2); }); else { const _0x25234c = _0x3b8970[_0x257852(0x7a6)](); _0x25234c['onsuccess'] = () => _0x4af926(_0x25234c[_0x257852(0x834)]), _0x25234c[_0x257852(0x464)] = () => _0x37afc7(_0x25234c['error']); } }); for (const _0x5d3fd4 of _0x45d30f) { const _0x4aa26f = { ..._0x5d3fd4 }; _0x5d3fd4[_0x5b4d1e(0x5ba)] instanceof Blob && (_0x5b4d1e(0x7dc) !== _0x5b4d1e(0x7dc) ? _0x5d1525[_0x5b4d1e(0x40f)](_0x5b4d1e(0x383), _0x3b7032) : _0x4aa26f['audio'] = await _0x2e73e7(_0x5d3fd4[_0x5b4d1e(0x5ba)])); if (_0x5d3fd4[_0x5b4d1e(0x1f5)] instanceof Blob) { if (_0x5b4d1e(0x66e) === _0x5b4d1e(0x66e)) _0x4aa26f['cover'] = await _0x2e73e7(_0x5d3fd4[_0x5b4d1e(0x1f5)]); else { _0xb48199 = _0x3af496(); const _0x30c81e = _0x37936b[_0x5b4d1e(0x2c0)](_0x5b4d1e(0x3c5))[_0x5b4d1e(0x548)]; _0x2822e2 = _0x30c81e || _0x5b4d1e(0x34d); } } _0xfa762c[_0x5b4d1e(0x532)][_0x5b4d1e(0x60b)](_0x4aa26f); } const _0x49eb09 = new Blob([JSON[_0x5b4d1e(0x3fd)](_0xfa762c, null, 0x2)], { 'type': 'application/json' }), _0x15949d = URL[_0x5b4d1e(0x6c9)](_0x49eb09), _0x56bd81 = document[_0x5b4d1e(0x2b5)]('a'), _0x462c43 = new Date(), _0x38cdba = _0x462c43[_0x5b4d1e(0x69e)]() + '-' + String(_0x462c43[_0x5b4d1e(0x5bf)]() + 0x1)[_0x5b4d1e(0xfe)](0x2, '0') + '-' + String(_0x462c43['getDate']())[_0x5b4d1e(0xfe)](0x2, '0'); _0x56bd81[_0x5b4d1e(0x6f6)] = _0x15949d, _0x56bd81['download'] = _0x5b4d1e(0x19e) + _0x38cdba + '.json', document[_0x5b4d1e(0x5e4)]['appendChild'](_0x56bd81), _0x56bd81[_0x5b4d1e(0x472)](), document['body'][_0x5b4d1e(0x598)](_0x56bd81), URL[_0x5b4d1e(0x1bf)](_0x15949d), _0x541a9b(![]); if (_0x37e479[_0x5b4d1e(0x256)] > 0x0) { if (_0x5b4d1e(0x670) === 'flypB') _0x880caf(_0x5b4d1e(0x171) + _0x37e479[_0x5b4d1e(0x799)]('\x0a')); else return _0x5421b6[_0x5b4d1e(0x3a3)](0x0, 0x9); } else _0x880caf(_0x5b4d1e(0x3ab)); } catch (_0x3d2b10) { _0x541a9b(![]), console[_0x5b4d1e(0x40f)](_0x5b4d1e(0x35f), _0x3d2b10), _0x880caf('导出过程中发生严重错误:\x20' + _0x3d2b10[_0x5b4d1e(0x2ec)]); } } else _0x46455c[_0x5b4d1e(0x610)][_0x5b4d1e(0x1c3)] = '#FFFFFF', _0x11a566[_0x5b4d1e(0x610)][_0x5b4d1e(0x651)] = _0x5b4d1e(0x6d8); }), _0x30201c['addEventListener'](_0x113cd8(0x472), () => { const _0x71b6ad = _0x113cd8; _0x71b6ad(0x17d) !== _0x71b6ad(0x17d) ? _0x62d7a[_0x71b6ad(0x396)](_0xd2c925, { 'keyPath': 'id' }) : _0x13d6e7[_0x71b6ad(0x472)](); }), _0x3a6435[_0x113cd8(0x41c)]('click', _0x3d61ef), _0x13d6e7[_0x113cd8(0x41c)](_0x113cd8(0x356), _0x181dbe => { const _0x3c92e6 = _0x113cd8; if ('YXDyo' !== _0x3c92e6(0x4cb)) { const _0x5e39ec = _0x48b5d6[_0x3c92e6(0xdc)][_0x3c92e6(0x1c6)](_0x5bc067 => _0x5bc067['id'] === _0x465c3b[_0x3c92e6(0x4b7)]) || { 'name': '你' }, _0x3e6b83 = _0x7b4768[_0x3c92e6(0x80a)][_0x3c92e6(0x1c6)](_0x311692 => _0x311692[_0x3c92e6(0x5f9)] === _0x39660a); if (!_0x3e6b83 || !_0x3e6b83['entries'] || _0x3e6b83[_0x3c92e6(0x62d)]['length'] === 0x0) return ''; const _0x206fe7 = _0x3e6b83[_0x3c92e6(0x62d)][_0x3c92e6(0x3a3)](-0x8), _0x1653eb = _0x206fe7[_0x3c92e6(0x6dd)](_0x1c69be => { const _0x57472b = _0x3c92e6, _0x373958 = _0x1c69be['author'] === 'user' ? _0x5e39ec[_0x57472b(0x7e5)] : _0x14eda2(_0x1c69be[_0x57472b(0x676)])[_0x57472b(0x7e5)]; return '-\x20[' + new _0x55c214(_0x1c69be['timestamp'])[_0x57472b(0x75c)]() + ']\x20' + _0x373958 + _0x57472b(0x7cd) + _0x1c69be[_0x57472b(0x77b)]; })[_0x3c92e6(0x799)]('\x0a'); return _0x3c92e6(0x7b4) + _0x5e39ec[_0x3c92e6(0x7e5)] + _0x3c92e6(0x65d) + _0x1653eb; } else { const _0x8eec97 = _0x181dbe[_0x3c92e6(0x5b9)]['files'][0x0]; if (!_0x8eec97) return; _0x380a1e(_0x3c92e6(0x246))[_0x3c92e6(0x73a)](_0x4b25b5 => { const _0x1706a2 = _0x3c92e6; if (!_0x4b25b5) { _0x13d6e7['value'] = ''; return; } _0x541a9b(!![], _0x1706a2(0x6cc)); const _0x22f742 = new FileReader(); _0x22f742[_0x1706a2(0x251)] = async _0x23bb14 => { const _0x3c4f47 = _0x1706a2; if (_0x3c4f47(0x1c1) !== 'rpoBz') try { const _0x522697 = JSON[_0x3c4f47(0x458)](_0x23bb14[_0x3c4f47(0x5b9)][_0x3c4f47(0x834)]); if (!_0x522697[_0x3c4f47(0x2ff)] || !_0x522697[_0x3c4f47(0x144)]) throw new Error(_0x3c4f47(0x461)); _0x541a9b(!![], _0x3c4f47(0x1f4)); const _0x4479d4 = await Promise[_0x3c4f47(0x154)](Object['keys'](_0x522697['indexedDBData'])['map'](async _0x460ce4 => { const _0x5b062a = _0x3c4f47, _0x38af26 = _0x522697[_0x5b062a(0x144)][_0x460ce4]; if (typeof _0x38af26 === _0x5b062a(0x63b) && _0x38af26[_0x5b062a(0x5ec)]('data:')) { if (_0x5b062a(0x241) === 'NghEZ') { _0x14fa5c(_0x5b062a(0x5a7)); return; } else { const _0x465937 = await _0x4366c2(_0x38af26); return { 'id': _0x460ce4, 'blob': _0x465937 }; } } return null; }))[_0x3c4f47(0x73a)](_0x31d232 => _0x31d232[_0x3c4f47(0x3ea)](Boolean)), _0x170a9e = []; if (_0x522697['indexedDBMusicData']) { if (_0x3c4f47(0x619) !== _0x3c4f47(0x619)) _0x4c5aec[_0x3c4f47(0x28c)](), _0xd0357(); else { _0x541a9b(!![], _0x3c4f47(0x5b8)); const _0x3781d2 = _0x522697[_0x3c4f47(0x532)][_0x3c4f47(0x6dd)](async _0x1a4bdb => { const _0x2d6bd9 = _0x3c4f47, _0x280756 = { ..._0x1a4bdb }; if (_0x1a4bdb['audio']) _0x280756[_0x2d6bd9(0x5ba)] = await _0x4366c2(_0x1a4bdb[_0x2d6bd9(0x5ba)]); if (_0x1a4bdb['cover']) _0x280756['cover'] = await _0x4366c2(_0x1a4bdb[_0x2d6bd9(0x1f5)]); return _0x280756; }); _0x170a9e[_0x3c4f47(0x60b)](...await Promise[_0x3c4f47(0x154)](_0x3781d2)); } } _0x541a9b(!![], '正在清空旧数据...'), localStorage['clear'](); for (const _0x326638 in _0x522697[_0x3c4f47(0x2ff)]) { localStorage[_0x3c4f47(0x515)](_0x326638, _0x522697[_0x3c4f47(0x2ff)][_0x326638]); } _0x541a9b(!![], _0x3c4f47(0x4a9)); const _0x30d297 = await _0x5656bf, _0x483420 = _0x30d297[_0x3c4f47(0x62e)]([_0x11ca7f, _0x5e7179], 'readwrite'), _0x4c2ae7 = _0x483420[_0x3c4f47(0x20b)](_0x11ca7f), _0x4b4da5 = _0x483420[_0x3c4f47(0x20b)](_0x5e7179); _0x4c2ae7['clear'](), _0x4b4da5[_0x3c4f47(0x22c)](), _0x4479d4['forEach'](_0x5b8d0f => _0x4c2ae7[_0x3c4f47(0x242)](_0x5b8d0f)), _0x170a9e[_0x3c4f47(0x203)](_0x28eef6 => _0x4b4da5[_0x3c4f47(0x242)](_0x28eef6)), await new Promise((_0x48bfb1, _0x3f2dc0) => { const _0xbfc643 = _0x3c4f47; _0x483420[_0xbfc643(0x6e8)] = _0x48bfb1, _0x483420[_0xbfc643(0x464)] = _0x25f53d => _0x3f2dc0(_0x25f53d['target'][_0xbfc643(0x40f)]); }), _0x541a9b(![]), _0x880caf('数据导入成功！应用即将刷新...'), setTimeout(() => location[_0x3c4f47(0x743)](), 0x640); } catch (_0x1d2454) { if (_0x3c4f47(0x123) !== 'lyyqS') _0x541a9b(![]), console[_0x3c4f47(0x40f)](_0x3c4f47(0x25a), _0x1d2454), _0x880caf(_0x3c4f47(0x2e9) + _0x1d2454[_0x3c4f47(0x2ec)]); else { const _0x361d14 = _0x15a606['getElementById']('global-player-next-btn'); _0x361d14 && _0x361d14['click'](); } } finally { _0x13d6e7['value'] = ''; } else { const _0x5361cc = new _0x56b089(_0x2bc9de[_0x3c4f47(0x808)]), _0x2f2bb3 = _0x53727c[_0x3c4f47(0x182)]((_0x4de140 - _0x5361cc) / (0x3e8 * 0x3c)); if (_0x2f2bb3 < 0x5) _0x3ecd67 += _0x3c4f47(0x7b9); else { if (_0x2f2bb3 < 0x78) _0x4a34d4 += '\x0a-\x20**对话状态**:\x20群里在' + _0x2f2bb3 + _0x3c4f47(0x3f6); else { const _0x3ea76d = _0x4a1668[_0x3c4f47(0x182)](_0x2f2bb3 / 0x3c); if (_0x3ea76d < 0x30) _0x15e2a1 += '\x0a-\x20**对话状态**:\x20群里在' + _0x3ea76d + '小时前聊过，可以适当问候，不要直接继续之前的话题。'; else _0x239416 += '\x0a-\x20**对话状态**:\x20群里已经有' + _0xfcef8a[_0x3c4f47(0x182)](_0x3ea76d / 0x18) + _0x3c4f47(0xd7); } } } }, _0x22f742['readAsText'](_0x8eec97); }); } }); function _0x1d60cf() { const _0x12aaa0 = _0x113cd8; _0x1a8311[_0x12aaa0(0x69f)] = _0x24ae96[_0x12aaa0(0x34f)][_0x12aaa0(0x19c)] || '', _0x2b5bbe['value'] = _0x24ae96[_0x12aaa0(0x34f)][_0x12aaa0(0x60f)] || '', _0x256343[_0x12aaa0(0x69f)] = _0x24ae96['apiSettings']['model'] || '', _0x3bdc55[_0x12aaa0(0x69f)] = String(_0x24ae96[_0x12aaa0(0x832)]?.[_0x12aaa0(0x2f0)] ?? 0x64), document[_0x12aaa0(0x2c0)](_0x12aaa0(0x1cc))['value'] = _0x24ae96[_0x12aaa0(0x34f)][_0x12aaa0(0x371)] || _0x12aaa0(0x6cf); } function _0x3555be() { const _0x4535c4 = _0x113cd8; _0x24ae96[_0x4535c4(0x34f)][_0x4535c4(0x19c)] = _0x1a8311[_0x4535c4(0x69f)][_0x4535c4(0x529)](), _0x24ae96[_0x4535c4(0x34f)][_0x4535c4(0x60f)] = _0x2b5bbe[_0x4535c4(0x69f)][_0x4535c4(0x529)](), _0x24ae96['apiSettings'][_0x4535c4(0x534)] = _0x256343[_0x4535c4(0x69f)]['trim'](), _0x24ae96[_0x4535c4(0x34f)]['provider'] = document[_0x4535c4(0x2c0)](_0x4535c4(0x1cc))[_0x4535c4(0x69f)]; const _0x57b164 = parseInt(_0x3bdc55[_0x4535c4(0x69f)], 0xa); _0x24ae96['preferences'][_0x4535c4(0x2f0)] = Number[_0x4535c4(0x71a)](_0x57b164) && _0x57b164 > 0x0 ? _0x57b164 : 0x64, _0x5d845c(), _0x880caf(_0x4535c4(0x825)); } function _0x3ca04c() { const _0x4f5e39 = _0x113cd8; _0xb7102c['value'] = _0x24ae96[_0x4f5e39(0x7ff)][_0x4f5e39(0x7e5)] || '', _0x2a69fd['src'] = _0x24ae96[_0x4f5e39(0x7ff)][_0x4f5e39(0x37c)] || _0x4be95c, _0x12adb['value'] = _0x24ae96[_0x4f5e39(0x7ff)][_0x4f5e39(0x791)] || ''; } function _0xf905b5() { const _0x44a30a = _0x113cd8; _0x24ae96[_0x44a30a(0x7ff)][_0x44a30a(0x7e5)] = _0xb7102c[_0x44a30a(0x69f)][_0x44a30a(0x529)](), _0x24ae96[_0x44a30a(0x7ff)][_0x44a30a(0x791)] = _0x12adb[_0x44a30a(0x69f)][_0x44a30a(0x529)](), _0x5d845c(), _0x1c0e55(), _0x880caf('个人资料已保存！'), _0x124c6c('settings', _0x44a30a(0x7ff)); } async function _0x64927c(_0x4aff4b = null) { const _0x327a51 = _0x113cd8; if (_0x327a51(0x688) !== _0x327a51(0x688)) { const _0x41b8ba = new _0x50b729(_0x1b8a94[_0x327a51(0x808)])[_0x327a51(0x316)](_0x327a51(0x222), { 'hour': '2-digit', 'minute': '2-digit' }); _0x47a282[_0x327a51(0x77b)] && _0x3b367d[_0x327a51(0x60b)]('[' + _0x41b8ba + _0x327a51(0x4fa) + _0x15ee9f(_0x4811e0) + ']\x20' + _0x2c0c20(_0x2ccb97['content'])['trim']()); } else { const _0x41cecf = _0x4f9675; _0x124c6c('characterEdit', _0x41cecf); const _0x1cd2fb = document['getElementById'](_0x327a51(0x368)); _0x1cd2fb[_0x327a51(0x217)] = '', _0x24ae96[_0x327a51(0x496)][_0x327a51(0x203)](_0x4d4821 => { const _0x3db718 = _0x327a51, _0x3d39b2 = document['createElement'](_0x3db718(0x767)); _0x3d39b2[_0x3db718(0x217)] = _0x3db718(0x105) + _0x4d4821['id'] + _0x3db718(0x604) + _0x4d4821[_0x3db718(0x7e5)], _0x1cd2fb[_0x3db718(0x3b1)](_0x3d39b2); }), _0x34ed18(_0x327a51(0x117)), _0x2a1a1[_0x327a51(0xd4)] = '', _0x3dba3c[_0x327a51(0x69f)] = '', _0x2445b2['src'] = '', _0x2ca4d3['value'] = '', _0x3606cf[_0x327a51(0xd4)] = '', _0xabef21[_0x327a51(0x69f)] = ''; const _0x65b553 = [_0x327a51(0x27c), _0x327a51(0x4a4), 'angry', _0x327a51(0x3b8), _0x327a51(0x2dd)]; _0x65b553['forEach'](_0x2701d2 => { const _0x5dc0b6 = _0x327a51; document[_0x5dc0b6(0x2c0)](_0x5dc0b6(0x283) + _0x2701d2 + '-preview')[_0x5dc0b6(0xd4)] = '', document[_0x5dc0b6(0x2c0)](_0x5dc0b6(0x283) + _0x2701d2 + _0x5dc0b6(0x3c0))[_0x5dc0b6(0x69f)] = ''; }); if (_0x4aff4b) { if (_0x327a51(0x3a2) !== _0x327a51(0x3ed)) { const _0x1527e4 = _0x24ae96[_0x327a51(0x4c0)][_0x327a51(0x1c6)](_0x872d1f => _0x872d1f['id'] === _0x4aff4b); if (!_0x1527e4) return; _0x1a806b[_0x327a51(0x69f)] = _0x1527e4['id'], _0x319ac8[_0x327a51(0x548)] = _0x327a51(0x164), _0x1e0a99[_0x327a51(0x69f)] = _0x1527e4[_0x327a51(0x7e5)], _0x5d165b[_0x327a51(0x69f)] = _0x1527e4[_0x327a51(0x366)], _0x5ef078['value'] = _0x1527e4[_0x327a51(0x791)], document['getElementById']('char-edit-css')[_0x327a51(0x69f)] = _0x1527e4[_0x327a51(0x2b9)] || ''; const _0x205081 = _0x24ae96['chats'][_0x327a51(0x1c6)](_0x131ed2 => _0x131ed2['type'] === _0x327a51(0x62a) && _0x131ed2['participantIds'][_0x327a51(0x4e4)](_0x4aff4b)); document[_0x327a51(0x2c0)](_0x327a51(0x117))[_0x327a51(0x69f)] = _0x205081?.[_0x327a51(0x346)] || _0x24ae96[_0x327a51(0x4b7)]; try { if (_0x327a51(0x23f) === _0x327a51(0x4bd)) { if (_0x49fbf5['type'] === _0x327a51(0x82b)) _0x30fd29[_0x327a51(0x100)](); _0x328649(_0x239c79); } else { const _0x14ffd6 = await _0x5aea9f(_0x327a51(0x14a) + _0x1527e4['id']), _0x191572 = await _0x5aea9f(_0x327a51(0x4af) + _0x1527e4['id']), _0x2e8643 = await _0x5aea9f('char_offline_bg_' + _0x1527e4['id']); _0x2a1a1[_0x327a51(0xd4)] = _0x14ffd6 ? URL[_0x327a51(0x6c9)](_0x14ffd6) : _0x1527e4[_0x327a51(0x37c)] || _0x5d2cd8; if (_0x191572) _0x2445b2['src'] = URL[_0x327a51(0x6c9)](_0x191572); if (_0x2e8643) _0x3606cf[_0x327a51(0xd4)] = URL[_0x327a51(0x6c9)](_0x2e8643); for (const _0x42acb4 of _0x65b553) { const _0x127f40 = await _0x5aea9f(_0x327a51(0x4b4) + _0x42acb4 + '_' + _0x1527e4['id']); _0x127f40 && (document[_0x327a51(0x2c0)]('char-edit-sprite-' + _0x42acb4 + '-preview')[_0x327a51(0xd4)] = URL[_0x327a51(0x6c9)](_0x127f40)); } } } catch (_0xa6a83) { console[_0x327a51(0x40f)](_0x327a51(0x49d) + _0x1527e4['id'] + _0x327a51(0x15c), _0xa6a83), _0x2a1a1[_0x327a51(0xd4)] = _0x1527e4['avatar'] || _0x5d2cd8; } _0x1527e4[_0x327a51(0x106)] && _0x1cd2fb[_0x327a51(0x439)]('input[type=\x22checkbox\x22]')[_0x327a51(0x203)](_0x4713c => { const _0x5ace05 = _0x327a51; if (_0x1527e4[_0x5ace05(0x106)][_0x5ace05(0x4e4)](_0x4713c[_0x5ace05(0x69f)])) _0x4713c['checked'] = !![]; }), _0x56fe04(); } else { if (_0x503818) _0x2ba936(_0x77debf); const _0x27b5d4 = _0x3e6e7a[_0x327a51(0x5b9)]['closest'](_0x327a51(0x180)); if (!_0x27b5d4) return; const _0x4ca01d = _0x537c40(_0x27b5d4[_0x327a51(0x362)]['historyIndex'], 0xa); if (_0x470bef(_0x4ca01d)) return; const _0x3b7bf5 = () => { _0x420395 = _0x2d2e6d(() => { const _0x4528f8 = _0x52f2; if (_0x1c69bd[_0x4528f8(0x776)] === 'touchstart') _0x2b95f2[_0x4528f8(0x100)](); _0x45b47a(_0x4ca01d); }, 0x320); }, _0x49448d = () => { if (_0x6d9ca1) _0x11f071(_0x1498c0); }; _0x57cbe5[_0x327a51(0x41c)]('mouseup', _0x49448d, { 'once': !![] }), _0x4f9adc[_0x327a51(0x41c)]('mouseleave', _0x49448d, { 'once': !![] }), _0x24063c[_0x327a51(0x41c)](_0x327a51(0x6b6), _0x49448d, { 'once': !![] }), _0x178ee2[_0x327a51(0x41c)]('touchcancel', _0x49448d, { 'once': !![] }), _0x3b7bf5(); } } else _0x1a806b['value'] = '', _0x319ac8[_0x327a51(0x548)] = _0x327a51(0x495), _0x1e0a99['value'] = _0x327a51(0x198) + (_0x24ae96[_0x327a51(0x4c0)][_0x327a51(0x256)] + 0x1), _0x5d165b['value'] = '', _0x2a1a1[_0x327a51(0xd4)] = _0x5d2cd8, _0x5ef078[_0x327a51(0x69f)] = _0x327a51(0x57c), document[_0x327a51(0x2c0)](_0x327a51(0x61b))['value'] = '', _0x56fe04(); const _0x148e26 = document[_0x327a51(0x2c0)](_0x327a51(0x61b)); let _0x17429a = document[_0x327a51(0x2c0)](_0x327a51(0x5f1)); !_0x17429a && (_0x17429a = document['createElement'](_0x327a51(0x610)), _0x17429a['id'] = _0x327a51(0x5f1), document[_0x327a51(0x52a)][_0x327a51(0x3b1)](_0x17429a)); const _0x47226e = () => { const _0x3ffbf7 = _0x327a51, _0x28eebe = _0x148e26[_0x3ffbf7(0x69f)]; let _0xe6493e = _0x28eebe[_0x3ffbf7(0xef)](/\.bubble\.sent/g, '#bubble-preview-user')[_0x3ffbf7(0xef)](/\.bubble\.received/g, _0x3ffbf7(0x2fd)); _0x17429a[_0x3ffbf7(0x217)] = _0xe6493e; }; _0x148e26[_0x327a51(0x382)](_0x327a51(0xf4), _0x47226e), _0x148e26['addEventListener'](_0x327a51(0xf4), _0x47226e), _0x47226e(); } } async function _0x1f5059() { const _0x45107d = _0x113cd8; if (_0x45107d(0x3ef) !== _0x45107d(0x831)) { const _0x4e35e7 = _0x1a806b[_0x45107d(0x69f)]; let _0x3cba67 = null; const _0x2411de = _0x3dba3c[_0x45107d(0x37b)][0x0], _0x10dc20 = _0x2ca4d3['files'][0x0], _0x1e952d = _0xabef21[_0x45107d(0x37b)][0x0], _0x57f776 = document[_0x45107d(0x439)](_0x45107d(0x48a)), _0x5b78f7 = Array['from'](_0x57f776)['map'](_0x1b27d5 => _0x1b27d5[_0x45107d(0x69f)]), _0x103645 = { 'name': _0x1e0a99['value'][_0x45107d(0x529)](), 'remark': _0x5d165b['value'][_0x45107d(0x529)](), 'persona': _0x5ef078['value'][_0x45107d(0x529)](), 'linkedWorldBookIds': _0x5b78f7, 'boundUserProfileId': document[_0x45107d(0x2c0)](_0x45107d(0x117))['value'], 'bubbleCss': document[_0x45107d(0x2c0)](_0x45107d(0x61b))[_0x45107d(0x69f)]['trim']() }; if (!_0x103645[_0x45107d(0x7e5)]) { if (_0x45107d(0x5c7) === 'TffbG') { const _0x25a17a = _0x382e77[_0x45107d(0x2b5)](_0x45107d(0x6ee)); _0x25a17a['className'] = _0x45107d(0x119), _0x25a17a[_0x45107d(0x217)] = _0x45107d(0x26d) + (_0x5c517e['coverUrl'] || _0x511a7b) + _0x45107d(0x669) + _0x4d8980[_0x45107d(0x805)] + _0x45107d(0x7a1) + _0x35c76e[_0x45107d(0x623)] + _0x45107d(0x2d5), _0x25a17a['querySelector']('.remove-attachment-btn')[_0x45107d(0x2c4)] = () => _0x57057e(_0x45107d(0x457)), _0x42b223[_0x45107d(0x3b1)](_0x25a17a); } else { _0x880caf(_0x45107d(0x804)); return; } } try { if ('mOPhW' !== _0x45107d(0x70b)) { const _0x465e5c = [_0x45107d(0x27c), 'happy', 'angry', 'sad', 'shy']; if (_0x4e35e7) { if (_0x45107d(0x3db) === 'jPPyN') _0x519eab[_0x45107d(0x7ad)] = null, _0x4f7b16(), _0xddcb47(_0x45107d(0x80e)), _0x2ab059(), _0x42b048[_0x45107d(0x82a)][_0x45107d(0x28c)]('show'), _0x1e3372(() => _0x1a1f46[_0x45107d(0x610)][_0x45107d(0x452)] = 'none', 0x12c); else { const _0x1c6b19 = _0x24ae96['characters'][_0x45107d(0x1c6)](_0x3d92f7 => _0x3d92f7['id'] === _0x4e35e7); if (_0x1c6b19) { Object['assign'](_0x1c6b19, _0x103645); if (_0x2411de) _0x1c6b19[_0x45107d(0x37c)] = await _0x5bf854(_0x2411de); } if (_0x2411de) await _0x24ee21('char_avatar_' + _0x4e35e7, _0x2411de); if (_0x10dc20) await _0x24ee21(_0x45107d(0x4af) + _0x4e35e7, _0x10dc20); if (_0x1e952d) await _0x24ee21(_0x45107d(0x3fc) + _0x4e35e7, _0x1e952d); for (const _0x1d8b4c of _0x465e5c) { if (_0x45107d(0x6a4) !== _0x45107d(0x271)) { const _0x1cca41 = document[_0x45107d(0x2c0)]('char-edit-sprite-' + _0x1d8b4c + _0x45107d(0x3c0))[_0x45107d(0x37b)][0x0]; if (_0x1cca41) await _0x24ee21(_0x45107d(0x4b4) + _0x1d8b4c + '_' + _0x4e35e7, _0x1cca41); } else _0x17e19a[_0x45107d(0x40f)]('在准备API数据时，从IndexedDB读取图片失败:', _0x207d88); } } } else { _0x3cba67 = _0x45107d(0x7b1) + Date[_0x45107d(0x695)](); const _0x11af63 = { 'id': _0x3cba67, ..._0x103645 }; _0x11af63[_0x45107d(0x37c)] = _0x2411de ? await _0x5bf854(_0x2411de) : _0x5d2cd8, _0x24ae96[_0x45107d(0x4c0)]['push'](_0x11af63); const _0x2a0bb8 = { 'id': _0x45107d(0x645) + _0x3cba67, 'type': 'private', 'participantIds': [_0x3cba67], 'boundUserProfileId': _0x103645['boundUserProfileId'], 'listenTogetherSession': null }; _0x24ae96[_0x45107d(0x2e2)][_0x45107d(0x60b)](_0x2a0bb8); if (_0x2411de) await _0x24ee21(_0x45107d(0x14a) + _0x3cba67, _0x2411de); if (_0x10dc20) await _0x24ee21(_0x45107d(0x4af) + _0x3cba67, _0x10dc20); if (_0x1e952d) await _0x24ee21(_0x45107d(0x3fc) + _0x3cba67, _0x1e952d); for (const _0x3dca07 of _0x465e5c) { const _0x38cdc3 = document[_0x45107d(0x2c0)](_0x45107d(0x283) + _0x3dca07 + _0x45107d(0x3c0))['files'][0x0]; if (_0x38cdc3) await _0x24ee21('char_sprite_' + _0x3dca07 + '_' + _0x3cba67, _0x38cdc3); } } _0x5d845c(), _0x5334a7(), _0x880caf('角色已保存！'), _0x124c6c(_0x45107d(0x710), _0x45107d(0x1e7)); if (!_0x4e35e7) { if (_0x45107d(0x44a) !== _0x45107d(0x652)) { const _0x3395eb = _0x45107d(0x645) + _0x3cba67; _0xdad370(_0x3395eb), _0x591b3d(!![]); } else return _0x278237[_0x45107d(0x72f)]('Fetch\x20request\x20was\x20aborted.'), ''; } } else _0x2ce076['setItem'](_0x193754, _0x1e5a05), _0x3f7c5c[_0x45107d(0x6a8)](_0x35cd14); } catch (_0x5bdb32) { console[_0x45107d(0x40f)](_0x45107d(0x2dc), _0x5bdb32), _0x880caf(_0x45107d(0x11e) + _0x5bdb32['message']); } } else { if (_0x1a3df8 === null) return; _0x6d6bdc[_0x45107d(0x5bb)][_0x45107d(0x62c)](_0x2677a8, 0x1), _0x3f7b7a(), _0x4be893(), _0x45192e(); } } function _0x3930d7() { const _0x3167db = _0x113cd8; _0x587461['value'] = '', _0x30aff4[_0x3167db(0x217)] = ''; if (_0x24ae96['characters'][_0x3167db(0x256)] < 0x2) { _0x880caf(_0x3167db(0x3f0)); return; } _0x24ae96[_0x3167db(0x4c0)][_0x3167db(0x203)](_0x39133d => { const _0x49294e = _0x3167db, _0x5837f5 = document[_0x49294e(0x2b5)]('li'); _0x5837f5[_0x49294e(0x38a)] = _0x49294e(0x4a6), _0x5837f5[_0x49294e(0x217)] = _0x49294e(0x56f) + _0x39133d['id'] + '\x22\x20data-id=\x22' + _0x39133d['id'] + _0x49294e(0x5aa) + (_0x39133d['avatar'] || _0x5d2cd8) + _0x49294e(0x369) + _0x39133d['id'] + _0x49294e(0x1bb) + _0x39133d['name'] + _0x49294e(0x398), _0x30aff4[_0x49294e(0x3b1)](_0x5837f5); }), _0x124c6c(_0x3167db(0x3d9), _0x3167db(0x311)); } function _0x5d2b14() { const _0x39b40d = _0x113cd8; if (_0x39b40d(0x2a2) !== _0x39b40d(0x2a2)) _0x2886ba[_0x39b40d(0x548)] = _0x39b40d(0x3a4), _0x419962[_0x39b40d(0x69f)] = '', _0x597668[_0x39b40d(0x69f)] = '好友圈\x20' + (_0x26c514[_0x39b40d(0x7ce)][_0x39b40d(0x256)] + 0x1), _0x2f0cd8[_0x39b40d(0x69f)] = _0x323031[_0x39b40d(0x4b7)], _0x517b79['style'][_0x39b40d(0x452)] = 'none'; else { const _0x17a192 = _0x587461[_0x39b40d(0x69f)][_0x39b40d(0x529)](); if (!_0x17a192) { _0x880caf(_0x39b40d(0x7dd)); return; } const _0xea7699 = Array[_0x39b40d(0x1f7)](_0x30aff4['querySelectorAll'](_0x39b40d(0x1fe)))[_0x39b40d(0x6dd)](_0x2a17e3 => _0x2a17e3[_0x39b40d(0x362)]['id']); if (_0xea7699[_0x39b40d(0x256)] < 0x2) { if (_0x39b40d(0x292) !== 'fLFPw') _0x4b6181 += _0x43f1df[_0x39b40d(0x458)](_0x7dd395)['candidates'][0x0][_0x39b40d(0x77b)][_0x39b40d(0x5a1)][0x0][_0x39b40d(0x13b)]; else { _0x880caf(_0x39b40d(0x7b0)); return; } } const _0x1755aa = { 'id': 'chat_group_' + Date['now'](), 'type': _0x39b40d(0x324), 'name': _0x17a192, 'participantIds': _0xea7699 }; _0x24ae96[_0x39b40d(0x2e2)][_0x39b40d(0x60b)](_0x1755aa), _0x24ae96[_0x39b40d(0x192)] = _0x1755aa['id'], _0x5d845c(), _0x5334a7(), _0x17f1ae(), _0xb86a7f(), _0x880caf(_0x39b40d(0x1eb) + _0x17a192 + _0x39b40d(0x2a8)), _0x124c6c(_0x39b40d(0x710), _0x39b40d(0x3d9)); } } _0x2ebdd2[_0x113cd8(0x41c)]('click', _0x5d1d50), _0x4efe48['addEventListener'](_0x113cd8(0x472), _0x39394a), _0x57e483[_0x113cd8(0x41c)](_0x113cd8(0x472), () => _0x352f69[_0x113cd8(0x82a)][_0x113cd8(0x28c)](_0x113cd8(0x155))), _0x443323['addEventListener']('click', () => _0x352f69['classList'][_0x113cd8(0x28c)](_0x113cd8(0x155))), _0x2445b2[_0x113cd8(0x41c)]('click', () => _0x2ca4d3[_0x113cd8(0x472)]()), _0x3606cf[_0x113cd8(0x41c)](_0x113cd8(0x472), () => _0xabef21['click']()), _0x2ca4d3[_0x113cd8(0x41c)](_0x113cd8(0x356), async _0x2d5b52 => { const _0x314f4a = _0x113cd8; if (_0x314f4a(0x33f) !== _0x314f4a(0x7d9)) { const _0x39810d = _0x2d5b52[_0x314f4a(0x5b9)][_0x314f4a(0x37b)][0x0]; if (!_0x39810d) return; try { _0x2445b2['src'] = await _0x5bf854(_0x39810d); } catch (_0x2b5462) { _0x880caf('错误:\x20' + _0x2b5462['message']); } } else { const _0x4a5ba3 = 'chatHistory_' + _0x3215ff['id'], _0x493703 = 'chatHistory_chat_' + _0x1325d5['id'], _0x3774e0 = _0xe56526[_0x314f4a(0x696)](_0x4a5ba3); _0x3774e0 && (_0x3ec0e0[_0x314f4a(0x515)](_0x493703, _0x3774e0), _0x2eef34[_0x314f4a(0x6a8)](_0x4a5ba3)); } }), _0xabef21[_0x113cd8(0x41c)](_0x113cd8(0x356), async _0x4b4aa0 => { const _0x16090b = _0x113cd8, _0xee739b = _0x4b4aa0[_0x16090b(0x5b9)][_0x16090b(0x37b)][0x0]; if (!_0xee739b) return; try { _0x3606cf[_0x16090b(0xd4)] = await _0x5bf854(_0xee739b); } catch (_0x3daa1d) { if (_0x16090b(0x596) !== 'UWCLu') { _0xdd7039[_0x16090b(0x217)] = _0x16090b(0x47f); return; } else _0x880caf(_0x16090b(0x1e6) + _0x3daa1d[_0x16090b(0x2ec)]); } }), _0x338c3b[_0x113cd8(0x41c)]('click', () => _0x4df653[_0x113cd8(0x472)]()), _0x4f7978[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x2fad42 = _0x113cd8; _0x2fad42(0x16b) !== _0x2fad42(0x16b) ? _0x41e488[_0x2fad42(0x41c)](_0x2fad42(0x472), () => { const _0xc8d6b8 = _0x2fad42; if (_0x2bba00[_0xc8d6b8(0x256)] === 0x0) return; _0x28f276 = (_0x30d584 - 0x1 + _0x149f92['length']) % _0xefec64['length'], _0x17e3d8(_0x35d55c[_0x12886c], _0xeb04b5); }) : (localStorage[_0x2fad42(0x6a8)](_0x2fad42(0x55c)), _0x4b02e8(), _0x880caf(_0x2fad42(0x7c1))); }), _0x4df653[_0x113cd8(0x41c)]('change', async _0x8935bf => { const _0x3c4caf = _0x113cd8, _0x280c50 = _0x8935bf['target'][_0x3c4caf(0x37b)][0x0]; if (!_0x280c50) return; try { const _0x218aeb = await _0x5bf854(_0x280c50); localStorage[_0x3c4caf(0x515)](_0x3c4caf(0x55c), _0x218aeb), _0x4b02e8(), _0x880caf(_0x3c4caf(0x497)); } catch (_0x37a0a0) { _0x880caf(_0x3c4caf(0x1e6) + _0x37a0a0[_0x3c4caf(0x2ec)]); } }), document[_0x113cd8(0x2c0)]('back-to-chat-from-group-settings')[_0x113cd8(0x41c)](_0x113cd8(0x472), () => _0x124c6c('chat', _0x113cd8(0x17f))), document['getElementById'](_0x113cd8(0x4fc))[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x5c45bf); const _0x244805 = document['getElementById'](_0x113cd8(0x170)), _0x4638f7 = document[_0x113cd8(0x2c0)](_0x113cd8(0x82e)); _0x244805['addEventListener'](_0x113cd8(0x472), () => _0x4638f7[_0x113cd8(0x472)]()), _0x4638f7['addEventListener'](_0x113cd8(0x356), _0x41591c => { const _0x33ec56 = _0x113cd8, _0x68a4c9 = _0x41591c[_0x33ec56(0x5b9)]['files'][0x0]; if (!_0x68a4c9) return; const _0x7576e8 = URL[_0x33ec56(0x6c9)](_0x68a4c9); _0x244805[_0x33ec56(0xd4)] = _0x7576e8, _0x244805['onload'] = () => { const _0x183570 = _0x33ec56; URL[_0x183570(0x1bf)](_0x7576e8); }; }); const _0x1d8f2c = document[_0x113cd8(0x2c0)]('group-bg-preview')[_0x113cd8(0xce)], _0x6e8959 = document[_0x113cd8(0x2c0)](_0x113cd8(0x5e7)), _0x2433ed = document[_0x113cd8(0x2c0)]('group-bg-preview'); _0x1d8f2c[_0x113cd8(0x41c)](_0x113cd8(0x472), () => _0x6e8959[_0x113cd8(0x472)]()), _0x6e8959[_0x113cd8(0x41c)](_0x113cd8(0x356), _0xc017a9 => { const _0xc11270 = _0x113cd8, _0x23aceb = _0xc017a9[_0xc11270(0x5b9)][_0xc11270(0x37b)][0x0]; if (!_0x23aceb) return; const _0x3faf79 = URL[_0xc11270(0x6c9)](_0x23aceb); _0x2433ed[_0xc11270(0xd4)] = _0x3faf79, _0x2433ed[_0xc11270(0x251)] = () => { const _0x3d4d94 = _0xc11270; if (_0x3d4d94(0x365) !== 'SAhYH') { _0x396bd3['innerHTML'] = _0x3d4d94(0x5b6); return; } else URL[_0x3d4d94(0x1bf)](_0x3faf79); }; }); const _0xc071a2 = document[_0x113cd8(0x437)]('#group-settings-screen\x20.select-box'), _0x32b2d7 = document[_0x113cd8(0x2c0)]('group-world-book-checkboxes'); _0xc071a2[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x40c79 => { const _0x2742a8 = _0x113cd8; _0x2742a8(0x6bb) !== _0x2742a8(0x6bb) ? _0x24cfa5['worldBooks'] = _0x4700dd[_0x2742a8(0x496)] : (_0x40c79[_0x2742a8(0x4c7)](), _0x32b2d7[_0x2742a8(0x82a)][_0x2742a8(0x7b7)](_0x2742a8(0x420)), _0xc071a2['classList'][_0x2742a8(0x7b7)](_0x2742a8(0xd5))); }), _0x32b2d7[_0x113cd8(0x41c)](_0x113cd8(0x356), _0x5ab8e7), document[_0x113cd8(0x2c0)]('group-clear-history-button')['addEventListener']('click', _0x20228a), document[_0x113cd8(0x2c0)](_0x113cd8(0x783))[_0x113cd8(0x41c)](_0x113cd8(0x472), async () => { const _0x3c1c27 = _0x113cd8, _0x5a9a1b = _0x3cc63d(); if (!_0x5a9a1b || _0x5a9a1b['type'] !== 'group') return; const _0x384315 = await _0x380a1e(_0x3c1c27(0x614) + _0x5a9a1b[_0x3c1c27(0x7e5)] + _0x3c1c27(0x7b2)); _0x384315 && (_0x3426b8(_0x5a9a1b['id']), _0x880caf(_0x3c1c27(0x755)), _0x124c6c(_0x3c1c27(0x710)), _0x591b3d(![])); }); const _0x38811c = document[_0x113cd8(0x437)](_0x113cd8(0x274)), _0x257efa = document[_0x113cd8(0x2c0)]('world-book-checkboxes-container'); _0x38811c[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x12486f => { const _0x54b369 = _0x113cd8; _0x12486f[_0x54b369(0x4c7)](), _0x257efa[_0x54b369(0x82a)][_0x54b369(0x7b7)](_0x54b369(0x420)), _0x38811c[_0x54b369(0x82a)]['toggle'](_0x54b369(0xd5)); }), _0x257efa[_0x113cd8(0x41c)](_0x113cd8(0x356), _0x56fe04), document[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x3e8335 => { const _0x4322f4 = _0x113cd8; !document['querySelector'](_0x4322f4(0x455))['contains'](_0x3e8335['target']) && (_0x257efa[_0x4322f4(0x82a)][_0x4322f4(0x28c)]('visible'), _0x38811c[_0x4322f4(0x82a)]['remove'](_0x4322f4(0xd5))); }), _0x39e9ea['addEventListener'](_0x113cd8(0x472), () => { const _0x1d4ea4 = _0x113cd8; if (_0x1d4ea4(0x4b1) !== _0x1d4ea4(0x77d)) _0x1637e3(), _0x124c6c(_0x1d4ea4(0x3e0), _0x1d4ea4(0x540)); else { const _0x578d86 = _0x43e29f['posts']['filter'](_0x40e18b => _0x40e18b[_0x1d4ea4(0x776)] === _0x1d4ea4(0x457) && _0x40e18b[_0x1d4ea4(0x4b2)])[_0x1d4ea4(0x6dd)](_0x4cc9a9 => ({ ..._0x4cc9a9, 'source': _0x1d4ea4(0x71c) })); _0x5b3081[_0x1d4ea4(0x60b)](..._0x578d86); } }), document['getElementById'](_0x113cd8(0xc3))['addEventListener']('click', () => _0x124c6c(_0x113cd8(0x540), _0x113cd8(0x3e0))), document[_0x113cd8(0x2c0)](_0x113cd8(0x538))['addEventListener'](_0x113cd8(0x472), () => _0x5eac5b()), document[_0x113cd8(0x2c0)](_0x113cd8(0x32b))[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x5a10b3 = _0x113cd8; _0x1637e3(), _0x124c6c(_0x5a10b3(0x3e0), _0x5a10b3(0x6e7)); }), document[_0x113cd8(0x2c0)](_0x113cd8(0xec))[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x37bca5), document['getElementById'](_0x113cd8(0x202))[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x3423ef), _0x32818f[_0x113cd8(0x41c)]('click', () => _0x124c6c('wallpaper', 'home')), _0x1630f2[_0x113cd8(0x41c)](_0x113cd8(0x472), () => _0x124c6c(_0x113cd8(0x540), _0x113cd8(0x585))), _0x5e79d9['addEventListener']('click', () => _0x112b2f['click']()), _0x112b2f[_0x113cd8(0x41c)](_0x113cd8(0x356), async _0x7334f => { const _0x4a40fa = _0x113cd8, _0x41e7b3 = _0x7334f['target'][_0x4a40fa(0x37b)][0x0]; if (!_0x41e7b3) return; await _0x2db1c6(_0x41e7b3); }), _0x42b6a9[_0x113cd8(0x41c)]('click', () => { const _0x2dc13b = _0x113cd8; _0x5334a7(), _0x124c6c('chat', _0x2dc13b(0x540)); }), _0x12a72d['addEventListener']('click', () => { const _0x278ea5 = _0x113cd8; if (_0x278ea5(0x2cf) === _0x278ea5(0x574)) { const _0x4d8366 = _0x5495cb[_0x278ea5(0x6c9)](_0x1c874e); _0x531f6a[_0x278ea5(0xd4)] = _0x4d8366, _0x41c800[_0x278ea5(0x251)] = () => { _0x108b70['revokeObjectURL'](_0x4d8366); }; } else { _0x1d60cf(); const _0x40c902 = (_0x24ae96[_0x278ea5(0x34f)][_0x278ea5(0x19c)] || '')[_0x278ea5(0x4e4)](_0x26161e); _0x17a184['disabled'] = _0x40c902, _0x124c6c(_0x278ea5(0x19d), _0x278ea5(0x540)); } }), _0x3818e6[_0x113cd8(0x41c)](_0x113cd8(0x472), () => _0x124c6c(_0x113cd8(0x540), _0x113cd8(0x19d))), _0x230b3f[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x1cff2e = _0x113cd8; _0x3867a5(), _0x124c6c(_0x1cff2e(0x540), _0x1cff2e(0x710)); }), _0x58a36b[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { _0x3867a5(), _0x591b3d(![]); }), _0x28ef16[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x1f1df4 = _0x113cd8; _0x124c6c(_0x1f1df4(0x710), _0x1f1df4(0x1e7)); }), _0x1ceb23[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x5dc4fc = _0x113cd8; _0x593d4e[_0x5dc4fc(0x82a)]['add'](_0x5dc4fc(0x155)); }), _0x52863e['addEventListener']('click', () => _0x57a3ef()), _0x3caebf[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x327f12); function _0x2efaa5(_0x2fc1ff) { const _0x426faa = _0x113cd8; if (!_0x2fc1ff || _0x2fc1ff['type'] !== _0x426faa(0x324)) return; const _0x5a3ec3 = _0x426faa(0x373); document[_0x426faa(0x5e4)]['insertAdjacentHTML'](_0x426faa(0x6ed), _0x5a3ec3); const _0x3285a7 = document[_0x426faa(0x2c0)]('group-options-modal'), _0x21fb7a = _0x3285a7[_0x426faa(0x437)](_0x426faa(0x451)), _0x1aa1b0 = document['getElementById'](_0x426faa(0x6ad)), _0x22025f = document['getElementById']('group-edit-members'), _0x4b8d3f = document[_0x426faa(0x2c0)](_0x426faa(0x4e3)), _0x171aa5 = document['getElementById'](_0x426faa(0x2df)), _0x32d88c = document[_0x426faa(0x2c0)](_0x426faa(0x124)), _0xaea6bd = () => _0x3285a7[_0x426faa(0x28c)](); _0x1aa1b0[_0x426faa(0x41c)](_0x426faa(0x472), async () => { const _0x337b3d = _0x426faa; _0xaea6bd(); const _0x12041c = await _0x380a1e(_0x337b3d(0x3aa) + _0x2fc1ff[_0x337b3d(0x7e5)] + _0x337b3d(0x530)); if (_0x12041c) { _0x2fc1ff['id'] === _0x24ae96[_0x337b3d(0x192)] && (_0x3867a5(), _0x24ae96['conversationHistory'] = [], _0x1c0e55()); try { 'pHCvo' === _0x337b3d(0xf6) ? (localStorage[_0x337b3d(0x6a8)]('chatHistory_' + _0x2fc1ff['id']), _0x880caf(_0x337b3d(0x336) + _0x2fc1ff[_0x337b3d(0x7e5)] + _0x337b3d(0x25f))) : _0x2b204f(_0x337b3d(0x7a0)); } catch (_0x20fe3e) { 'ZDiEc' === 'SEFcc' ? (_0x1be3a4[_0x337b3d(0x40f)](_0x337b3d(0x447) + _0x5aa843 + _0x337b3d(0x7ef) + _0x4c6b20 + '):', _0x46e5cc), _0x507e3b['coverUrl'] = null, _0x266b04[_0x337b3d(0x4b2)] = null) : (console['error'](_0x337b3d(0x416) + _0x2fc1ff['id'], _0x20fe3e), _0x880caf(_0x337b3d(0x819))); } } }), _0x22025f[_0x426faa(0x41c)](_0x426faa(0x472), () => { _0xaea6bd(), _0x880caf('编辑群成员功能正在开发中...'); }), _0x4b8d3f[_0x426faa(0x41c)](_0x426faa(0x472), async () => { const _0x2b2c70 = _0x426faa; _0xaea6bd(); const _0x5154a0 = prompt('请输入新的群名称：', _0x2fc1ff[_0x2b2c70(0x7e5)]); if (_0x5154a0 && _0x5154a0[_0x2b2c70(0x529)]() && _0x5154a0 !== _0x2fc1ff[_0x2b2c70(0x7e5)]) { if (_0x2b2c70(0x276) !== _0x2b2c70(0x276)) { const _0x10db19 = _0x536b99 === _0x26df4e ? _0x2b2c70(0x68d) : ''; return '' + _0x10db19 + _0x46713e[_0x2b2c70(0x13b)]; } else _0x2fc1ff['name'] = _0x5154a0[_0x2b2c70(0x529)](), _0x5d845c(), _0x5334a7(), _0x17f1ae(), _0x880caf(_0x2b2c70(0x1d0) + _0x2fc1ff[_0x2b2c70(0x7e5)] + '\x22。'); } }), _0x171aa5[_0x426faa(0x41c)](_0x426faa(0x472), async () => { const _0x1a537f = _0x426faa; _0xaea6bd(); const _0x2ee2cd = await _0x380a1e(_0x1a537f(0x5d0) + _0x2fc1ff[_0x1a537f(0x7e5)] + _0x1a537f(0xe6)); if (_0x2ee2cd) { if ('VRxhV' !== _0x1a537f(0x332)) _0x3426b8(_0x2fc1ff['id']), _0x880caf('群聊\x22' + _0x2fc1ff[_0x1a537f(0x7e5)] + _0x1a537f(0x3f8)), _0x591b3d(![]); else { const _0x53142a = _0x26939f[_0x1a537f(0x4c0)][_0x1a537f(0x1c6)](_0x349199 => _0x3e5227[_0x1a537f(0x590)][_0x1a537f(0x4e4)](_0x349199['id']) && _0x349199[_0x1a537f(0x7e5)] === _0x2f8057); if (_0x53142a) _0x569213 = _0x53142a['id']; } } }), _0x21fb7a[_0x426faa(0x41c)]('click', _0xaea6bd), _0x32d88c[_0x426faa(0x41c)](_0x426faa(0x472), _0xaea6bd); } _0x49c1bb['addEventListener']('click', () => { const _0x59f831 = _0x113cd8; if (_0x59f831(0x298) !== 'JoXva') { const _0x410dae = _0x1bd193[_0x59f831(0x5b9)]['files'][0x0]; if (!_0x410dae) return; try { _0x289d69['src'] = _0x182353[_0x59f831(0x6c9)](_0x410dae); } catch (_0x5ae73e) { _0x405836(_0x59f831(0x492) + _0x5ae73e['message']); } } else { const _0x47face = _0x3cc63d(); if (_0x47face && _0x47face[_0x59f831(0x776)] === 'private') _0x64927c(_0x47face[_0x59f831(0x590)][0x0]); else { if (_0x47face && _0x47face['type'] === _0x59f831(0x324)) { if ('qynIV' === _0x59f831(0x803)) _0x1217fd(_0x47face['id']); else { _0x32ab85[_0x59f831(0x72f)](_0x59f831(0x627)); const _0x517640 = { 'id': _0x59f831(0x4cf) + _0x26a142[_0x59f831(0x695)](), 'name': '我的动态', 'boundUserProfileId': _0x5c5f60[_0x59f831(0x4b7)], 'memberCharacterIds': _0x4ab67c['characters']['map'](_0x428a4f => _0x428a4f['id']), 'posts': _0x28194b[_0x59f831(0x30a)] }; _0x1941cb[_0x59f831(0x7ce)] = [_0x517640], _0x423da9[_0x59f831(0x4fb)] = _0x517640['id']; } } } } }), _0x5eefed['addEventListener']('keydown', _0x9167ec => { const _0x52f0bb = _0x113cd8; if (_0x52f0bb(0x50a) === _0x52f0bb(0x50a)) _0x9167ec[_0x52f0bb(0x60f)] === _0x52f0bb(0x104) && !_0x9167ec[_0x52f0bb(0x1d9)] && (_0x9167ec['preventDefault'](), _0x57a3ef()); else { _0x49ba21(_0x52f0bb(0x236)); return; } }); const _0xf1fb7d = () => _0x593d4e['classList'][_0x113cd8(0x28c)]('show'); _0xe5e90c[_0x113cd8(0x41c)](_0x113cd8(0x472), _0xf1fb7d), _0x2d2355['addEventListener']('click', _0xf1fb7d), _0x1c7abd[_0x113cd8(0x41c)]('click', () => { const _0x4ce9cc = _0x113cd8; if (_0x4ce9cc(0x12d) === _0x4ce9cc(0x3ee)) { const _0x577864 = _0x2bc9b6[_0x4ce9cc(0x2b5)](_0x4ce9cc(0x767)); _0x577864[_0x4ce9cc(0x217)] = _0x4ce9cc(0x105) + _0x2d531a['id'] + _0x4ce9cc(0x604) + _0x1ae481[_0x4ce9cc(0x7e5)], _0x4e678c[_0x4ce9cc(0x3b1)](_0x577864); } else _0xf1fb7d(), _0x64927c(); }), _0x12fdcb['addEventListener'](_0x113cd8(0x472), () => { const _0x3ca732 = _0x113cd8; if (_0x3ca732(0x4ea) !== _0x3ca732(0x4ea)) { const _0x1bc09c = _0x140d0b[_0x3ca732(0x2b5)]('div'); _0x1bc09c[_0x3ca732(0x38a)] = 'world-book-item', _0x1bc09c['dataset']['id'] = _0x5116de['id'], _0x1bc09c[_0x3ca732(0x217)] = _0x3ca732(0x63a) + _0x10727f[_0x3ca732(0x7e5)] + _0x3ca732(0xeb) + _0x19af9b[_0x3ca732(0x77b)][_0x3ca732(0x3ad)](0x0, 0x64) + _0x3ca732(0x70c), _0x1bc09c['addEventListener'](_0x3ca732(0x472), () => _0xaf01f6(_0x2521ea['id'])), _0x321749[_0x3ca732(0x3b1)](_0x1bc09c); } else _0xf1fb7d(), _0x3930d7(); }), _0x2af310[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0xb1e5cc = _0x113cd8; _0xb1e5cc(0x2cb) !== 'zNtTc' ? (_0x124c6c(_0xb1e5cc(0x710), _0xb1e5cc(0x3d9)), _0x591b3d(![])) : (_0x119e2c = '0x' + _0x450cb0[0x1] + _0x2bc9ef[0x1], _0x2651b4 = '0x' + _0x19908a[0x2] + _0x41057a[0x2], _0x432be9 = '0x' + _0x5b34f5[0x3] + _0x119c34[0x3]); }), _0x5afa5a[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x5d2b14), _0x30d7de[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x54d23c = _0x113cd8; _0x54d23c(0x234) !== _0x54d23c(0x4fe) ? (_0x2953a1[_0x54d23c(0x82a)][_0x54d23c(0x7b7)](_0x54d23c(0x155)), _0x2953a1[_0x54d23c(0x82a)][_0x54d23c(0x211)](_0x54d23c(0x155)) && (_0x4066f3[_0x54d23c(0x1e5)] = _0x4066f3[_0x54d23c(0x1fc)])) : (_0x5467dc[_0x54d23c(0x610)]['backgroundImage'] = _0x54d23c(0x7d7) + _0x179554 + ')', _0x2818b4['style']['backgroundSize'] = _0x54d23c(0x1f5), _0x588cc3[_0x54d23c(0x610)][_0x54d23c(0x813)] = 'center', _0x2f771c[_0x54d23c(0x610)][_0x54d23c(0x1c3)] = _0x54d23c(0x199), _0x31d746[_0x54d23c(0x439)]('.widget-info\x20>\x20div')[_0x54d23c(0x203)](_0x178407 => { const _0x3c9b54 = _0x54d23c; _0x178407[_0x3c9b54(0x610)][_0x3c9b54(0x651)] = _0x3c9b54(0x39c); })); }), _0x4e45dd['addEventListener'](_0x113cd8(0x472), () => _0x4840c4[_0x113cd8(0x472)]()); const _0x5f3f15 = document[_0x113cd8(0x2c0)](_0x113cd8(0x287)); _0x4840c4[_0x113cd8(0x41c)](_0x113cd8(0x356), _0x48a53f), _0x5f3f15[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x36d107), _0x5289af[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x3555be), _0x257dc5['addEventListener'](_0x113cd8(0x472), _0xf905b5), _0x46a5bc[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x1f5059), _0x1e387d[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x20228a), _0x280527[_0x113cd8(0x41c)](_0x113cd8(0x472), async () => { const _0x1db5c3 = _0x113cd8; if (_0x1db5c3(0x6d1) === _0x1db5c3(0x478)) _0x7cc9cf[_0x1db5c3(0x548)] = '已选择\x20' + _0x3dd48e['length'] + '\x20项'; else { const _0x228f6d = _0x1a806b['value']; if (!_0x228f6d) return; const _0x267779 = _0x5c4526(_0x228f6d); if (!_0x267779) return; const _0x1e9df5 = await _0x380a1e('确定要删除角色“' + _0x267779['name'] + _0x1db5c3(0x4dd)); _0x1e9df5 && (_0x1cd68d(_0x228f6d), _0x880caf(_0x1db5c3(0x344) + _0x267779[_0x1db5c3(0x7e5)] + _0x1db5c3(0x4de)), _0x124c6c(_0x1db5c3(0x710), _0x1db5c3(0x1e7)), _0x591b3d(![])); } }), _0x1a8311['addEventListener'](_0x113cd8(0xf4), () => { const _0x42135a = _0x113cd8; if ('JRznN' !== _0x42135a(0x4a0)) { const _0x24a1f9 = _0x1a8311[_0x42135a(0x69f)][_0x42135a(0x529)]()[_0x42135a(0x4e4)](_0x26161e); _0x17a184['disabled'] = _0x24a1f9; } else { _0x226175['innerHTML'] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>'; return; } }); async function _0x2d4f1e() { const _0x282ca6 = _0x113cd8, _0x1ce647 = _0x1a8311[_0x282ca6(0x69f)][_0x282ca6(0x529)](), _0x3e51c = _0x2b5bbe['value'][_0x282ca6(0x529)](); if (!_0x1ce647 || !_0x3e51c) { _0x880caf(_0x282ca6(0x21f)); return; } const _0x5800de = _0x1ce647['replace'](/\/+$/, ''), _0x1c2bec = _0x5800de + _0x282ca6(0x765); _0x17a184[_0x282ca6(0x38d)] = !![], _0x17a184[_0x282ca6(0x548)] = '获取中…', _0x418905['classList'][_0x282ca6(0x28c)](_0x282ca6(0x155)); try { const _0x2e376e = await fetch(_0x1c2bec, { 'headers': { 'Authorization': _0x282ca6(0x48b) + _0x1ce4b2(_0x3e51c) } }); if (!_0x2e376e['ok']) throw new Error(_0x282ca6(0x524) + _0x2e376e[_0x282ca6(0x187)]); const _0x3f0d38 = await _0x2e376e[_0x282ca6(0x49a)](), _0x57bb50 = (_0x3f0d38['data'] || _0x3f0d38)[_0x282ca6(0x6dd)](_0x175f5a => _0x175f5a['id'])[_0x282ca6(0x125)](); _0x57bb50[_0x282ca6(0x256)] > 0x0 ? (_0x418905[_0x282ca6(0x217)] = '', _0x57bb50[_0x282ca6(0x203)](_0x3815d9 => { const _0x3e2943 = _0x282ca6, _0x164240 = document[_0x3e2943(0x2b5)]('div'); _0x164240['textContent'] = _0x3815d9, _0x164240[_0x3e2943(0x41c)](_0x3e2943(0x472), () => { const _0x3aac53 = _0x3e2943; _0x256343[_0x3aac53(0x69f)] = _0x3815d9, _0x418905['classList'][_0x3aac53(0x28c)](_0x3aac53(0x155)); }), _0x418905[_0x3e2943(0x3b1)](_0x164240); }), _0x418905[_0x282ca6(0x82a)][_0x282ca6(0x2c7)]('show'), _0x880caf(_0x282ca6(0xc4) + _0x57bb50[_0x282ca6(0x256)] + _0x282ca6(0x3c8))) : _0x880caf(_0x282ca6(0x19b)); } catch (_0x57a6aa) { _0x880caf('获取模型失败:\x20' + _0x57a6aa[_0x282ca6(0x2ec)] + _0x282ca6(0x52b)); } finally { if ('hEqPB' !== _0x282ca6(0x611)) { if (_0x2bcdd1['key'] === _0x282ca6(0x1fa)) _0x243345(null); _0xdcfd86[_0x282ca6(0x60f)] === 'Enter' && (_0x49a49e['preventDefault'](), _0x5b2c4a()); } else _0x17a184[_0x282ca6(0x38d)] = ![], _0x17a184[_0x282ca6(0x548)] = '获取'; } } _0x17a184[_0x113cd8(0x41c)](_0x113cd8(0x472), _0xebdc1a => { const _0x2a61d5 = _0x113cd8; _0xebdc1a[_0x2a61d5(0x4c7)](), _0x2d4f1e(); }), document[_0x113cd8(0x41c)]('click', _0x60ff71 => { const _0x2c3860 = _0x113cd8; !_0x418905[_0x2c3860(0x211)](_0x60ff71[_0x2c3860(0x5b9)]) && _0x60ff71[_0x2c3860(0x5b9)] !== _0x256343 && _0x60ff71['target'] !== _0x17a184 && _0x418905['classList']['remove'](_0x2c3860(0x155)); }); async function _0x5bf854(_0x585247) { return await _0xf3c4dd(_0x585247, 0x190, 0.85); } _0x2a69fd[_0x113cd8(0x41c)]('click', () => _0xcab2d['click']()), _0xcab2d[_0x113cd8(0x41c)](_0x113cd8(0x356), async _0x41d22f => { const _0x3e0af0 = _0x113cd8, _0xa29ae3 = _0x41d22f[_0x3e0af0(0x5b9)][_0x3e0af0(0x37b)][0x0]; if (!_0xa29ae3) return; try { if (_0x3e0af0(0x50c) !== _0x3e0af0(0x584)) { const _0x576e64 = await _0x5bf854(_0xa29ae3); _0x2a69fd[_0x3e0af0(0xd4)] = _0x576e64; } else _0x1b3f19[_0x3e0af0(0x82a)][_0x3e0af0(0x28c)]('is-visible', _0x3e0af0(0x481)), _0x5462d1[_0x3e0af0(0x82a)]['remove'](_0x3e0af0(0x73c)), _0x5d2f8e[_0x3e0af0(0x7f0)] = _0x9cdcf4, _0x27b124(), _0x225541[_0x3e0af0(0x250)] = ![]; } catch (_0x1b054c) { if (_0x3e0af0(0x31b) !== 'enDfr') _0x880caf(_0x3e0af0(0x1e6) + _0x1b054c[_0x3e0af0(0x2ec)]); else { const _0x3517bb = _0x1d1ccd[_0x3e0af0(0x2c0)](_0x3e0af0(0x7b3)), _0x366624 = _0x3629e0[_0x3e0af0(0x2c0)]('galgame-view-container'), _0x8e3e52 = _0x34913f[_0x3e0af0(0x437)]('#meeting-view-screen\x20.chat-input-area'); _0x5f2f08['meetingViewMode'] === _0x3e0af0(0x60e) ? (_0x3517bb['style'][_0x3e0af0(0x452)] = _0x3e0af0(0x3d2), _0x366624[_0x3e0af0(0x610)][_0x3e0af0(0x452)] = _0x3e0af0(0x3fb)) : (_0x3517bb[_0x3e0af0(0x610)][_0x3e0af0(0x452)] = 'block', _0x366624['style']['display'] = _0x3e0af0(0x3d2)), _0x8e3e52['style'][_0x3e0af0(0x452)] = 'block'; } } }), _0x2a1a1[_0x113cd8(0x41c)]('click', () => _0x3dba3c[_0x113cd8(0x472)]()), _0x3dba3c[_0x113cd8(0x41c)]('change', async _0x5925e7 => { const _0x23468d = _0x113cd8, _0x4a11b8 = _0x5925e7[_0x23468d(0x5b9)][_0x23468d(0x37b)][0x0]; if (!_0x4a11b8) return; try { _0x2a1a1[_0x23468d(0xd4)] = await _0x5bf854(_0x4a11b8); } catch (_0x3de4cb) { _0x880caf(_0x23468d(0x1e6) + _0x3de4cb[_0x23468d(0x2ec)]); } }); function _0x3d0af9() { _0x2953a1['innerHTML'] = '', _0x438419['forEach'](_0x33c7c0 => { const _0x42fdc1 = _0x52f2; if ('BFFay' !== _0x42fdc1(0x47c)) { const { omniText: _0x1f878f } = _0x48dfbe(_0x473ebc['id'], null), _0x1d8ce9 = _0x4f92dc(_0x441666['id']), _0x14dbb7 = _0x2cf90e[_0x42fdc1(0x106)] && _0x46689b[_0x42fdc1(0x106)][_0x42fdc1(0x256)] > 0x0 ? _0x42fdc1(0x385) + _0x139fa7[_0x42fdc1(0x7e5)] + _0x42fdc1(0x421) + _0x4db8b6['linkedWorldBookIds'][_0x42fdc1(0x6dd)](_0x3e4ac2 => _0x5c6bdf[_0x42fdc1(0x496)][_0x42fdc1(0x1c6)](_0x448294 => _0x448294['id'] === _0x3e4ac2))[_0x42fdc1(0x3ea)](_0x5c7507)[_0x42fdc1(0x6dd)](_0x24e72e => _0x42fdc1(0x308) + _0x24e72e['name'] + '\x0a' + _0x24e72e[_0x42fdc1(0x77b)])[_0x42fdc1(0x799)]('') : ''; return '-\x20姓名:\x20' + _0xc35984[_0x42fdc1(0x7e5)] + _0x42fdc1(0x69c) + _0x27c6bf['id'] + _0x42fdc1(0xf5) + _0x3455ac[_0x42fdc1(0x791)] + '\x0a\x20\x20近期记忆:\x0a' + _0x1f878f + '\x0a' + _0x1d8ce9 + '\x0a' + _0x14dbb7; } else { const _0x47db6c = document['createElement'](_0x42fdc1(0x7d3)); _0x47db6c['src'] = _0x33c7c0[_0x42fdc1(0x375)], _0x47db6c[_0x42fdc1(0x796)] = _0x42fdc1(0x5a3), _0x47db6c['title'] = _0x33c7c0[_0x42fdc1(0x7e5)], _0x47db6c[_0x42fdc1(0x82a)]['add'](_0x42fdc1(0x69b)), _0x47db6c[_0x42fdc1(0x41c)](_0x42fdc1(0x472), () => _0x4784dd(_0x33c7c0)), _0x2953a1['appendChild'](_0x47db6c); } }); } function _0x11711a() { const _0x460a0b = _0x113cd8; if (_0x460a0b(0x379) === 'fMiIL') { const _0x11b3dd = document[_0x460a0b(0x2c0)](_0x460a0b(0x1f3)); _0x11b3dd[_0x460a0b(0x217)] = ''; if (_0x24ae96['userProfiles'][_0x460a0b(0x256)] === 0x0) { if ('tHDZS' === _0x460a0b(0x328)) _0x169dfd['textContent'] = _0x26566b[_0x460a0b(0x1f7)](_0x5346bb)[_0x460a0b(0x6dd)](_0x707a9c => _0x707a9c[_0x460a0b(0xce)][_0x460a0b(0x548)][_0x460a0b(0x529)]())[_0x460a0b(0x799)]('、'); else { _0x11b3dd[_0x460a0b(0x217)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>'; return; } } _0x24ae96[_0x460a0b(0xdc)][_0x460a0b(0x203)](_0x549ebd => { const _0x1162f8 = _0x460a0b, _0x2686e6 = document[_0x1162f8(0x2b5)](_0x1162f8(0x6ee)); _0x2686e6[_0x1162f8(0x38a)] = _0x1162f8(0x41a), _0x2686e6[_0x1162f8(0x362)]['id'] = _0x549ebd['id']; const _0x46d6c2 = _0x549ebd['id'] === _0x24ae96[_0x1162f8(0x4b7)] ? '\x20(当前)' : ''; _0x2686e6[_0x1162f8(0x217)] = _0x1162f8(0x23a) + (_0x549ebd['avatar'] || _0x4be95c) + _0x1162f8(0x2a3) + _0x549ebd[_0x1162f8(0x7e5)] + _0x46d6c2 + _0x1162f8(0x3fe) + _0x549ebd[_0x1162f8(0x791)][_0x1162f8(0x3ad)](0x0, 0x64) + _0x1162f8(0x29c), _0x2686e6['addEventListener'](_0x1162f8(0x472), () => _0x2b64b7(_0x549ebd['id'])), _0x11b3dd[_0x1162f8(0x3b1)](_0x2686e6); }); } else { const _0x5638b2 = _0xbdb499[_0x460a0b(0x6c9)](_0x2dd915); _0x201a60[_0x460a0b(0xd4)] = _0x5638b2, _0x403984[_0x460a0b(0x251)] = () => _0x290353[_0x460a0b(0x1bf)](_0x5638b2); } } function _0x2b64b7(_0x58b294 = null) { const _0x130974 = _0x113cd8; if (_0x130974(0x635) === 'arvlv') { _0x124c6c(_0x130974(0x7ff), _0x130974(0x179)); const _0x1e7c0f = document[_0x130974(0x2c0)](_0x130974(0x82f)); if (_0x58b294) { const _0x314885 = _0x24ae96[_0x130974(0xdc)][_0x130974(0x1c6)](_0x93ef75 => _0x93ef75['id'] === _0x58b294); if (!_0x314885) return; document[_0x130974(0x2c0)](_0x130974(0x4d3))[_0x130974(0x69f)] = _0x314885['id'], document[_0x130974(0x2c0)](_0x130974(0x4a3))[_0x130974(0x548)] = '编辑用户', document[_0x130974(0x2c0)]('user-name')[_0x130974(0x69f)] = _0x314885[_0x130974(0x7e5)], document[_0x130974(0x2c0)](_0x130974(0x6ec))[_0x130974(0xd4)] = _0x314885['avatar'], document[_0x130974(0x2c0)](_0x130974(0x41e))[_0x130974(0x69f)] = _0x314885[_0x130974(0x791)], _0x1e7c0f[_0x130974(0x610)][_0x130974(0x452)] = _0x314885['id'] === _0x24ae96[_0x130974(0x4b7)] ? _0x130974(0x3d2) : 'block'; } else document['getElementById'](_0x130974(0x4d3))[_0x130974(0x69f)] = '', document['getElementById'](_0x130974(0x4a3))[_0x130974(0x548)] = _0x130974(0x35e), document[_0x130974(0x2c0)]('user-name')[_0x130974(0x69f)] = _0x130974(0x162) + (_0x24ae96['userProfiles'][_0x130974(0x256)] + 0x1), document[_0x130974(0x2c0)](_0x130974(0x6ec))[_0x130974(0xd4)] = _0x4be95c, document[_0x130974(0x2c0)](_0x130974(0x41e))['value'] = '', _0x1e7c0f[_0x130974(0x610)][_0x130974(0x452)] = 'none'; } else { const _0x390c4f = _0xd52628, _0x39dcb2 = _0x390c4f[_0x130974(0x1fc)], _0x102494 = _0x390c4f['scrollTop']; _0x379a94[_0x130974(0x659)] += 0x64, _0x170cca(), _0x29d80d(() => { const _0x230387 = _0x130974, _0x530565 = _0x390c4f['scrollHeight']; _0x390c4f[_0x230387(0x1e5)] = _0x102494 + (_0x530565 - _0x39dcb2); }); } } function _0xf905b5() { const _0x31b2a3 = _0x113cd8, _0x3bfb11 = document['getElementById'](_0x31b2a3(0x4d3))['value'], _0x3cd6b6 = { 'name': document['getElementById'](_0x31b2a3(0x3b9))[_0x31b2a3(0x69f)]['trim'](), 'persona': document[_0x31b2a3(0x2c0)](_0x31b2a3(0x41e))[_0x31b2a3(0x69f)][_0x31b2a3(0x529)](), 'avatar': document[_0x31b2a3(0x2c0)](_0x31b2a3(0x6ec))[_0x31b2a3(0xd4)] }; if (!_0x3cd6b6[_0x31b2a3(0x7e5)]) { if ('FBqXW' !== 'FBqXW') _0x230c12[_0x31b2a3(0x40f)](_0x31b2a3(0x559), _0x2fa5ab), _0x261190(_0x31b2a3(0x3e7) + _0x20e243[_0x31b2a3(0x2ec)]); else { _0x880caf(_0x31b2a3(0x804)); return; } } if (_0x3bfb11) { const _0x6ef648 = _0x24ae96[_0x31b2a3(0xdc)][_0x31b2a3(0x1c6)](_0x36968c => _0x36968c['id'] === _0x3bfb11); if (_0x6ef648) Object[_0x31b2a3(0x758)](_0x6ef648, _0x3cd6b6); } else { const _0x151b5f = { 'id': _0x31b2a3(0x769) + Date['now'](), ..._0x3cd6b6 }; _0x24ae96['userProfiles']['push'](_0x151b5f); if (!_0x24ae96['activeUserProfileId']) { if ('LdEji' === 'yyYox') { const _0x56e8f1 = new _0x3be9bc(); _0x56e8f1[_0x31b2a3(0x760)] = () => _0x5a77df(_0x56e8f1[_0x31b2a3(0x834)]), _0x56e8f1[_0x31b2a3(0x464)] = _0x3392df, _0x56e8f1[_0x31b2a3(0xf0)](_0x1e5b17); } else _0x24ae96[_0x31b2a3(0x4b7)] = _0x151b5f['id']; } } _0x5d845c(), _0x880caf(_0x31b2a3(0x65c)), _0x11711a(), _0x124c6c(_0x31b2a3(0x179), _0x31b2a3(0x7ff)); } async function _0x4fbe33() { const _0x280097 = _0x113cd8, _0x41aace = document['getElementById'](_0x280097(0x4d3))[_0x280097(0x69f)]; if (!_0x41aace) return; if (_0x24ae96[_0x280097(0xdc)]['length'] <= 0x1) { _0x880caf(_0x280097(0x607)); return; } const _0x141e26 = await _0x380a1e(_0x280097(0x662)); _0x141e26 && (_0x24ae96[_0x280097(0xdc)] = _0x24ae96[_0x280097(0xdc)]['filter'](_0x2b215c => _0x2b215c['id'] !== _0x41aace), _0x24ae96[_0x280097(0x4b7)] === _0x41aace && ('qePrS' === _0x280097(0x745) ? _0x47a862 += '-\x20**对话状态提示**:\x20你们有几个小时没聊了，可以简单问候一下对方现在的状态。\x0a' : _0x24ae96['activeUserProfileId'] = _0x24ae96[_0x280097(0xdc)][0x0]['id']), _0x24ae96[_0x280097(0x2e2)][_0x280097(0x203)](_0x53809c => { const _0x5cbd3e = _0x280097; _0x53809c[_0x5cbd3e(0x346)] === _0x41aace && (_0x53809c[_0x5cbd3e(0x346)] = _0x24ae96[_0x5cbd3e(0x4b7)]); }), _0x5d845c(), _0x880caf('用户已删除。'), _0x11711a(), _0x124c6c(_0x280097(0x179), 'userProfile')); } function _0x1637e3() { const _0x2ab424 = _0x113cd8, _0x1d9541 = document[_0x2ab424(0x2c0)]('world-book-list-container'); _0x1d9541[_0x2ab424(0x217)] = ''; if (_0x24ae96[_0x2ab424(0x496)][_0x2ab424(0x256)] === 0x0) { _0x1d9541[_0x2ab424(0x217)] = _0x2ab424(0x7c5); return; } _0x24ae96[_0x2ab424(0x496)][_0x2ab424(0x203)](_0x917026 => { const _0x3c9e05 = _0x2ab424; if ('YABJl' === _0x3c9e05(0x471)) _0x5b3be1[_0x3c9e05(0x22b)] = [], _0x27f1e2(), _0x918fb(), _0x38e578(_0x3c9e05(0x5cb)); else { const _0x461041 = document['createElement'](_0x3c9e05(0x6ee)); _0x461041[_0x3c9e05(0x38a)] = _0x3c9e05(0x41a), _0x461041[_0x3c9e05(0x362)]['id'] = _0x917026['id'], _0x461041['innerHTML'] = _0x3c9e05(0x63a) + _0x917026['name'] + _0x3c9e05(0xeb) + _0x917026[_0x3c9e05(0x77b)][_0x3c9e05(0x3ad)](0x0, 0x64) + _0x3c9e05(0x70c), _0x461041[_0x3c9e05(0x41c)](_0x3c9e05(0x472), () => _0x5eac5b(_0x917026['id'])), _0x1d9541[_0x3c9e05(0x3b1)](_0x461041); } }); } function _0x5eac5b(_0x2bd5a4 = null) { const _0x364ab3 = _0x113cd8; _0x124c6c('worldBookEditor', 'worldBook'); if (_0x2bd5a4) { if (_0x364ab3(0x450) === _0x364ab3(0x450)) { const _0x4b6ed5 = _0x24ae96[_0x364ab3(0x496)][_0x364ab3(0x1c6)](_0x201e6b => _0x201e6b['id'] === _0x2bd5a4); if (!_0x4b6ed5) return; document['getElementById'](_0x364ab3(0x2ed))[_0x364ab3(0x69f)] = _0x4b6ed5['id'], document['getElementById'](_0x364ab3(0x557))[_0x364ab3(0x548)] = _0x364ab3(0x4c5), document['getElementById']('world-book-edit-name')['value'] = _0x4b6ed5[_0x364ab3(0x7e5)], document['getElementById'](_0x364ab3(0x571))[_0x364ab3(0x69f)] = _0x4b6ed5[_0x364ab3(0x77b)]; } else _0x10e37e[_0x364ab3(0xd4)] = ''; } else document[_0x364ab3(0x2c0)](_0x364ab3(0x2ed))[_0x364ab3(0x69f)] = '', document[_0x364ab3(0x2c0)](_0x364ab3(0x557))[_0x364ab3(0x548)] = _0x364ab3(0x672), document['getElementById'](_0x364ab3(0x43f))[_0x364ab3(0x69f)] = '', document['getElementById']('world-book-edit-content')[_0x364ab3(0x69f)] = ''; } function _0x37bca5() { const _0x53c0a7 = _0x113cd8; if (_0x53c0a7(0x60a) !== _0x53c0a7(0x129)) { const _0x1a81f9 = document[_0x53c0a7(0x2c0)]('editing-world-book-id')[_0x53c0a7(0x69f)], _0x470be8 = document['getElementById'](_0x53c0a7(0x43f))[_0x53c0a7(0x69f)][_0x53c0a7(0x529)](), _0x3aceeb = document['getElementById'](_0x53c0a7(0x571))[_0x53c0a7(0x69f)]['trim'](); if (!_0x470be8 || !_0x3aceeb) { if (_0x53c0a7(0x72a) === _0x53c0a7(0x72a)) { _0x880caf(_0x53c0a7(0x3f9)); return; } else _0x239010[_0x53c0a7(0x6a8)](_0x53c0a7(0x68e) + _0xf7d207[_0x53c0a7(0x192)]); } if (_0x1a81f9) { if (_0x53c0a7(0x226) !== _0x53c0a7(0x5d4)) { const _0x3a6f96 = _0x24ae96['worldBooks'][_0x53c0a7(0x1c6)](_0x1ac6d0 => _0x1ac6d0['id'] === _0x1a81f9); _0x3a6f96 && (_0x3a6f96[_0x53c0a7(0x7e5)] = _0x470be8, _0x3a6f96[_0x53c0a7(0x77b)] = _0x3aceeb); } else _0x5c03be = _0x53c0a7(0x115), _0x5cb419 = _0x53c0a7(0x15a); } else { const _0x4f1a9a = { 'id': 'wb_' + Date[_0x53c0a7(0x695)](), 'name': _0x470be8, 'content': _0x3aceeb }; _0x24ae96[_0x53c0a7(0x496)][_0x53c0a7(0x60b)](_0x4f1a9a); } _0x5d845c(), _0x880caf(_0x53c0a7(0x43d)), _0x1637e3(), _0x124c6c(_0x53c0a7(0x3e0), _0x53c0a7(0x6e7)); } else _0x21f48d[_0x53c0a7(0x217)] = _0x5131af; } async function _0x3423ef() { const _0x3eddd3 = _0x113cd8, _0xe451ba = document[_0x3eddd3(0x2c0)](_0x3eddd3(0x2ed))[_0x3eddd3(0x69f)]; if (!_0xe451ba) return; const _0x40c562 = await _0x380a1e(_0x3eddd3(0x2ef)); _0x40c562 && (_0x3eddd3(0x405) !== 'BnNOD' ? (_0xe486cd[_0x3eddd3(0x82a)]['remove'](_0x3eddd3(0x155)), _0x4bbd7e(() => _0x102624[_0x3eddd3(0x610)][_0x3eddd3(0x452)] = _0x3eddd3(0x3d2), 0x12c)) : (_0x24ae96[_0x3eddd3(0x496)] = _0x24ae96['worldBooks'][_0x3eddd3(0x3ea)](_0xf21b26 => _0xf21b26['id'] !== _0xe451ba), _0x24ae96['characters'][_0x3eddd3(0x203)](_0x5e6b3f => { const _0x5e5e5f = _0x3eddd3; _0x5e6b3f[_0x5e5e5f(0x106)] && (_0x5e6b3f[_0x5e5e5f(0x106)] = _0x5e6b3f[_0x5e5e5f(0x106)][_0x5e5e5f(0x3ea)](_0x4c07a1 => _0x4c07a1 !== _0xe451ba)); }), _0x5d845c(), _0x880caf('条目已删除。'), _0x1637e3(), _0x124c6c(_0x3eddd3(0x3e0), _0x3eddd3(0x6e7)))); } function _0x56fe04() { const _0x2e8379 = _0x113cd8, _0x1fee60 = document[_0x2e8379(0x2c0)]('world-book-checkboxes-container'), _0x591c92 = _0x1fee60[_0x2e8379(0x439)](_0x2e8379(0x58a)), _0x38cf28 = document['querySelector'](_0x2e8379(0x690)); if (_0x591c92[_0x2e8379(0x256)] === 0x0) _0x38cf28['textContent'] = _0x2e8379(0x810); else { if (_0x591c92['length'] > 0x2) _0x38cf28[_0x2e8379(0x548)] = _0x2e8379(0xc8) + _0x591c92[_0x2e8379(0x256)] + '\x20项'; else { if (_0x2e8379(0x752) === 'xrddP') _0x38cf28['textContent'] = Array['from'](_0x591c92)[_0x2e8379(0x6dd)](_0x1553d0 => _0x1553d0['parentElement'][_0x2e8379(0x548)][_0x2e8379(0x529)]())[_0x2e8379(0x799)]('、'); else { const _0x1b7dac = _0x3b814e[_0x2e8379(0x439)]('p'); _0x1b7dac[_0x2e8379(0x203)](_0x14d084 => _0x14d084[_0x2e8379(0x82a)]['remove'](_0x2e8379(0x33a))); const _0x529a09 = _0x105f3d[_0x2e8379(0x2c0)]('lyric-line-' + _0x46edb9); _0x529a09 && (_0x529a09[_0x2e8379(0x82a)][_0x2e8379(0x2c7)](_0x2e8379(0x33a)), _0x529a09['scrollIntoView']({ 'behavior': _0x2e8379(0x6ba), 'block': _0x2e8379(0x640) })); } } } } function _0x1217fd(_0x849168) { const _0x2840fb = _0x113cd8; if (_0x2840fb(0x741) !== _0x2840fb(0x741)) _0x198741[_0x2840fb(0x610)][_0x2840fb(0x6a6)] = _0x2840fb(0x27e) + _0x2c1b0b[_0x2840fb(0x6c9)](_0x33d23d) + '\x27)', _0x148e9b[_0x2840fb(0x610)][_0x2840fb(0x15d)] = _0x2840fb(0x1f5), _0x4290e8['style']['backgroundPosition'] = _0x2840fb(0x640); else { const _0x3ba433 = _0x24ae96[_0x2840fb(0x2e2)][_0x2840fb(0x1c6)](_0xd045a2 => _0xd045a2['id'] === _0x849168); if (!_0x3ba433 || _0x3ba433[_0x2840fb(0x776)] !== _0x2840fb(0x324)) return; document['getElementById']('group-settings-name')[_0x2840fb(0x69f)] = _0x3ba433['name'] || '', _0x34ed18('group-settings-bind-user'), document[_0x2840fb(0x2c0)]('group-settings-bind-user')[_0x2840fb(0x69f)] = _0x3ba433['boundUserProfileId'] || _0x24ae96['activeUserProfileId']; const _0x77a3e1 = document['getElementById'](_0x2840fb(0x435)); _0x77a3e1[_0x2840fb(0x217)] = '', _0x24ae96[_0x2840fb(0x496)][_0x2840fb(0x203)](_0x568e70 => { const _0x1d969c = _0x2840fb; if ('nMkfE' === 'usBBC') _0x354b5e(_0x257b42); else { const _0x1dc2c8 = _0x3ba433[_0x1d969c(0x106)]?.['includes'](_0x568e70['id']), _0x4c9b5b = document['createElement'](_0x1d969c(0x767)); _0x4c9b5b['innerHTML'] = _0x1d969c(0x105) + _0x568e70['id'] + '\x22\x20' + (_0x1dc2c8 ? _0x1d969c(0x5fc) : '') + '>\x20' + _0x568e70[_0x1d969c(0x7e5)], _0x77a3e1[_0x1d969c(0x3b1)](_0x4c9b5b); } }), _0x5ab8e7(); const _0x4c8f49 = document[_0x2840fb(0x2c0)](_0x2840fb(0x170)), _0x14fa8b = document[_0x2840fb(0x2c0)]('group-bg-preview'); _0x5aea9f(_0x2840fb(0x419) + _0x849168)[_0x2840fb(0x73a)](_0x340654 => { const _0x77bbba = _0x2840fb; _0x4c8f49[_0x77bbba(0xd4)] = _0x340654 ? URL[_0x77bbba(0x6c9)](_0x340654) : _0x5d2cd8; }), _0x5aea9f(_0x2840fb(0x67c) + _0x849168)['then'](_0x2c388f => { const _0x53502a = _0x2840fb; _0x14fa8b['src'] = _0x2c388f ? URL[_0x53502a(0x6c9)](_0x2c388f) : ''; }), _0x124c6c('groupSettings', _0x2840fb(0x710)); } } async function _0x5c45bf() { const _0x4f8303 = _0x113cd8, _0x1997dd = _0x3cc63d(); if (!_0x1997dd || _0x1997dd[_0x4f8303(0x776)] !== _0x4f8303(0x324)) return; const _0x5a3425 = document[_0x4f8303(0x2c0)]('group-settings-name')[_0x4f8303(0x69f)][_0x4f8303(0x529)](); if (!_0x5a3425) { _0x880caf('群聊名称不能为空！'); return; } _0x1997dd[_0x4f8303(0x7e5)] = _0x5a3425; const _0xcde120 = document[_0x4f8303(0x439)](_0x4f8303(0x4f2)); _0x1997dd[_0x4f8303(0x106)] = Array[_0x4f8303(0x1f7)](_0xcde120)[_0x4f8303(0x6dd)](_0x3240b5 => _0x3240b5['value']), _0x1997dd[_0x4f8303(0x346)] = document[_0x4f8303(0x2c0)](_0x4f8303(0x55f))[_0x4f8303(0x69f)]; const _0x3dcec0 = document[_0x4f8303(0x2c0)](_0x4f8303(0x82e))[_0x4f8303(0x37b)][0x0], _0x336773 = document['getElementById']('group-bg-input')[_0x4f8303(0x37b)][0x0]; if (_0x3dcec0) await _0x24ee21(_0x4f8303(0x419) + _0x1997dd['id'], _0x3dcec0); if (_0x336773) await _0x24ee21(_0x4f8303(0x67c) + _0x1997dd['id'], _0x336773); _0x5d845c(), _0x17f1ae(), await _0x5334a7(), _0x880caf('群聊设置已保存！'), _0x124c6c(_0x4f8303(0x710), _0x4f8303(0x17f)); } function _0x5ab8e7() { const _0x5b5503 = _0x113cd8; if (_0x5b5503(0x507) !== _0x5b5503(0x507)) _0x2228b5[_0x5b5503(0x515)](_0x40b268, _0xefcf79[_0x5b5503(0x2ff)][_0x2c3f02]); else { const _0x28cefe = document[_0x5b5503(0x2c0)]('group-world-book-checkboxes'), _0x1a5a1c = _0x28cefe['querySelectorAll']('input:checked'), _0x3f8609 = document[_0x5b5503(0x437)](_0x5b5503(0x11b)); if (_0x1a5a1c['length'] === 0x0) _0x5b5503(0x679) !== _0x5b5503(0x679) ? _0x4cb4c0['textContent'] = '▶' : _0x3f8609[_0x5b5503(0x548)] = _0x5b5503(0x810); else _0x1a5a1c['length'] > 0x2 ? _0x3f8609[_0x5b5503(0x548)] = _0x5b5503(0xc8) + _0x1a5a1c[_0x5b5503(0x256)] + '\x20项' : _0x3f8609[_0x5b5503(0x548)] = Array[_0x5b5503(0x1f7)](_0x1a5a1c)[_0x5b5503(0x6dd)](_0x359c1e => _0x359c1e[_0x5b5503(0xce)][_0x5b5503(0x548)][_0x5b5503(0x529)]())[_0x5b5503(0x799)]('、'); } } async function _0x3a7403() { const _0x2b258b = _0x113cd8, _0x12d382 = _0x3cc63d(), _0x3abccc = (_0x12d382?.[_0x2b258b(0x590)] || [])[_0x2b258b(0x6dd)](_0x5c4526)[_0x2b258b(0x3ea)](Boolean), _0x2dbc39 = _0xb7cda(_0x12d382['id']); if (!_0x12d382 || _0x12d382['type'] !== _0x2b258b(0x324) || _0x3abccc['length'] < 0x2) return null; const _0x121c1b = _0x12d382[_0x2b258b(0x106)] && _0x12d382['linkedWorldBookIds'][_0x2b258b(0x256)] > 0x0 ? '\x0a\x0a#\x20核心群聊世界观设定\x20(所有角色必须严格遵守以下设定)\x0a' + _0x12d382[_0x2b258b(0x106)]['map'](_0x2eca29 => _0x24ae96['worldBooks'][_0x2b258b(0x1c6)](_0x53e341 => _0x53e341['id'] === _0x2eca29))[_0x2b258b(0x3ea)](Boolean)['map'](_0x7d01d2 => '\x0a##\x20世界书条目:\x20' + _0x7d01d2['name'] + '\x0a' + _0x7d01d2['content'])[_0x2b258b(0x799)]('') : '', _0x56d7b1 = _0x2dbc39['persona'] ? _0x2b258b(0x326) + _0x2dbc39['name'] + _0x2b258b(0x78a) + _0x2dbc39[_0x2b258b(0x791)] : ''; let _0x342566 = ''; const _0x557587 = new Date(), _0x3bc772 = _0x24ae96[_0x2b258b(0x5bb)]['at'](-0x1); _0x342566 += _0x2b258b(0x5f8) + _0x557587[_0x2b258b(0x1c0)]('zh-CN', { 'dateStyle': 'full', 'timeStyle': _0x2b258b(0x57d) }); if (_0x3bc772) { const _0x1ae3ca = new Date(_0x3bc772[_0x2b258b(0x808)]), _0x2819a9 = Math[_0x2b258b(0x182)]((_0x557587 - _0x1ae3ca) / (0x3e8 * 0x3c)); if (_0x2819a9 < 0x5) _0x342566 += _0x2b258b(0x7b9); else { if (_0x2819a9 < 0x78) _0x342566 += _0x2b258b(0x583) + _0x2819a9 + _0x2b258b(0x3f6); else { if (_0x2b258b(0x1e8) === 'vJKwM') { const _0x1717b0 = Math[_0x2b258b(0x182)](_0x2819a9 / 0x3c); if (_0x1717b0 < 0x30) _0x342566 += _0x2b258b(0x583) + _0x1717b0 + _0x2b258b(0x2d1); else _0x342566 += _0x2b258b(0x3e2) + Math[_0x2b258b(0x182)](_0x1717b0 / 0x18) + _0x2b258b(0xd7); } else _0x51fe3d = _0x5f4b31; } } } else _0x342566 += _0x2b258b(0x4be); const _0xff6691 = [..._0x24ae96[_0x2b258b(0x5bb)]][_0x2b258b(0x181)]()[_0x2b258b(0x1c6)](_0xcac6cc => _0xcac6cc[_0x2b258b(0x660)] === _0x2b258b(0xe9))?.[_0x2b258b(0x77b)] || '', _0x50b3f8 = _0x2e7ca9(_0x12d382, _0xff6691), _0x2d66c1 = _0x24ae96['conversationHistory']['slice'](-0x78), _0xa9cff5 = _0x438419[_0x2b258b(0x6dd)](_0x343f33 => _0x343f33[_0x2b258b(0x7e5)]), _0xee261d = _0x4e95be(), _0x50e168 = _0x3abccc['map'](_0x38b5b2 => { const _0x168113 = _0x2b258b; if ('TuLCA' !== 'TuLCA') _0x3e20fa[_0x168113(0x3d8)](), _0x5029c9[_0x168113(0x437)](_0x168113(0x5ad))['textContent'] = '▶'; else { const { omniText: _0x4cb0a7 } = _0x5bd842(_0x38b5b2['id'], _0x12d382['id']), _0x2775f6 = _0x118a24(_0x38b5b2['id']), _0x30dd89 = _0x38b5b2[_0x168113(0x106)] && _0x38b5b2[_0x168113(0x106)][_0x168113(0x256)] > 0x0 ? '\x0a\x0a#\x20' + _0x38b5b2[_0x168113(0x7e5)] + _0x168113(0x421) + _0x38b5b2[_0x168113(0x106)][_0x168113(0x6dd)](_0x991769 => _0x24ae96[_0x168113(0x496)][_0x168113(0x1c6)](_0x5690c5 => _0x5690c5['id'] === _0x991769))[_0x168113(0x3ea)](Boolean)[_0x168113(0x6dd)](_0x490e52 => _0x168113(0x308) + _0x490e52[_0x168113(0x7e5)] + '\x0a' + _0x490e52['content'])[_0x168113(0x799)]('') : ''; return { 'id': _0x38b5b2['id'], 'name': _0x38b5b2[_0x168113(0x7e5)], 'persona': _0x38b5b2[_0x168113(0x791)] || _0x168113(0x757), 'memory': _0x4cb0a7 + _0x2775f6 + _0x30dd89 }; } }), _0x3a8d0e = 0x5, _0x2d9030 = 0xc, _0x1b4d54 = _0x2b258b(0x5cd)['trim'](), _0x54d4ec = { 'instruction': (_0x2b258b(0x1ed) + (_0x2dbc39['name'] || '用户') + _0x2b258b(0x794) + (_0x2dbc39[_0x2b258b(0x7e5)] || '用户') + _0x2b258b(0x2d6) + _0x3a8d0e + _0x2b258b(0x29b) + _0x2d9030 + _0x2b258b(0x485) + (_0x2dbc39[_0x2b258b(0x7e5)] || '用户') + '。\x0a-\x20再次强调：你的全部输出都将被作为JSON解析，任何JSON主体之外的额外文字都会导致程序失败。\x0a' + _0x342566 + '\x20\x0a' + _0x56d7b1 + '\x0a' + _0x121c1b + _0x2b258b(0x731) + _0xee261d + '\x0a')[_0x2b258b(0x529)](), 'personas': _0x50e168, 'mentioned': _0x50b3f8 ? { 'id': _0x50b3f8['id'], 'name': _0x50b3f8[_0x2b258b(0x7e5)] } : null, 'stickerList': _0xa9cff5 }, _0x1266b1 = { 'type': _0x2b258b(0x66a), 'properties': { 'events': { 'type': _0x2b258b(0x2e6), 'items': { 'type': _0x2b258b(0x66a), 'required': [_0x2b258b(0x1fd), _0x2b258b(0x6d4)], 'properties': { 'senderId': { 'type': _0x2b258b(0x63b) }, 'kind': { 'type': _0x2b258b(0x63b), 'enum': [_0x2b258b(0x13b), 'sticker', _0x2b258b(0x457)] }, 'content': { 'type': _0x2b258b(0x63b) }, 'sticker': { 'type': _0x2b258b(0x63b) }, 'songName': { 'type': _0x2b258b(0x63b) }, 'artist': { 'type': _0x2b258b(0x63b) } } } } }, 'required': [_0x2b258b(0xe1)] }, _0x280019 = []; _0x280019[_0x2b258b(0x60b)]({ 'role': _0x2b258b(0x67d), 'content': _0x1b4d54 }); for (const _0x4a6d03 of _0x2d66c1) { const _0x356ab2 = _0x4a6d03['role'] === 'ai' || _0x4a6d03[_0x2b258b(0x660)] === _0x2b258b(0x2f2) ? _0x2b258b(0x2f2) : 'user'; let _0x594de1 = { 'role': _0x356ab2, 'content': _0x4a6d03[_0x2b258b(0x77b)] }, _0x1a05aa = !!_0x4a6d03[_0x2b258b(0x77b)], _0x3fda74 = null; if (_0x4a6d03['image']) _0x3fda74 = _0x4a6d03['image']; else { if (_0x4a6d03[_0x2b258b(0x470)]) try { if (_0x2b258b(0x5ae) !== _0x2b258b(0x5ae)) { const _0x5760be = _0x2037a9[_0x2b258b(0x650)][_0x2b258b(0x1da)](',')[0x1], _0x4281b5 = _0x1514e1[_0x2b258b(0x650)][_0x2b258b(0x3ad)](_0x3ca8ee[_0x2b258b(0x650)]['indexOf'](':') + 0x1, _0x3a3d70[_0x2b258b(0x650)][_0x2b258b(0x1d4)](';')) || _0x2b258b(0x51e); _0x217c64[_0x2b258b(0x60b)]({ 'inline_data': { 'mime_type': _0x4281b5, 'data': _0x5760be } }); } else { const _0x32c1a8 = await _0x5aea9f(_0x4a6d03[_0x2b258b(0x470)]); _0x32c1a8 && (_0x3fda74 = await _0x2e73e7(_0x32c1a8)); } } catch (_0x44cd0a) { console[_0x2b258b(0x40f)](_0x2b258b(0x7ed), _0x44cd0a); } } _0x3fda74 && (_0x594de1['image'] = _0x3fda74, _0x1a05aa = !![]), _0x1a05aa && _0x280019['push'](_0x594de1); } _0x280019[_0x2b258b(0x60b)]({ 'role': _0x2b258b(0xe9), 'content': _0x2b258b(0x139) + JSON[_0x2b258b(0x3fd)](_0x1266b1) + _0x2b258b(0x589) + JSON[_0x2b258b(0x3fd)](_0x54d4ec) }); try { if ('sLZcd' === _0x2b258b(0x2a0)) { const _0x584580 = _0x254c32[_0x2b258b(0x2c0)](_0x2b258b(0x59b)); if (_0x584580) _0x584580['textContent'] = '▶'; } else { const _0x2259c5 = await _0x519e38(_0x280019, { 'json': !![] }); if (!_0x2259c5) return null; let _0x3df5e6 = _0x2259c5[_0x2b258b(0x529)](); const _0x270f1f = _0x3df5e6[_0x2b258b(0x259)](/```json([\s\S]*?)```/i); if (_0x270f1f) _0x3df5e6 = _0x270f1f[0x1][_0x2b258b(0x529)](); _0x3df5e6 = _0x124be6(_0x3df5e6); let _0x27d0a5 = null; try { _0x2b258b(0x622) === _0x2b258b(0x2d8) ? _0x357e70[_0x2b258b(0xd4)] = _0x391aa5[_0x2b258b(0x650)] : _0x27d0a5 = JSON['parse'](_0x3df5e6); } catch (_0x190cc3) { _0x2b258b(0x159) !== _0x2b258b(0x320) ? (console[_0x2b258b(0x40f)](_0x2b258b(0x76d), _0x190cc3), console['error'](_0x2b258b(0x3b6), _0x3df5e6)) : _0x3d4f65['preferences'] = { 'perChatContextLines': 0x64, 'widgetBgImage': null }; } if (!_0x27d0a5 || !Array[_0x2b258b(0x2d0)](_0x27d0a5[_0x2b258b(0xe1)])) return null; return _0x27d0a5 = _0x1a096b(_0x27d0a5, _0x3abccc, _0xa9cff5), _0x27d0a5[_0x2b258b(0xe1)] = _0x27d0a5[_0x2b258b(0xe1)][_0x2b258b(0x3a3)](0x0, _0x2d9030), _0x27d0a5[_0x2b258b(0xe1)][_0x2b258b(0x256)] ? _0x27d0a5 : null; } } catch (_0x54ba78) { if ('nGafr' !== 'nGafr') { _0x227fc2[_0x2b258b(0x4c0)] = _0x573772['characters'][_0x2b258b(0x3ea)](_0x203284 => _0x203284['id'] !== _0xc2a1f4), _0x52852c[_0x2b258b(0x2e2)][_0x2b258b(0x203)](_0x473360 => { const _0x5d1db8 = _0x2b258b; _0x473360[_0x5d1db8(0x776)] === 'group' && (_0x473360[_0x5d1db8(0x590)] = _0x473360['participantIds'][_0x5d1db8(0x3ea)](_0x2e8b11 => _0x2e8b11 !== _0x1cd253)); }); const _0x3d9edc = _0x5c3437[_0x2b258b(0x2e2)]['find'](_0x28ae28 => _0x28ae28[_0x2b258b(0x776)] === 'private' && _0x28ae28[_0x2b258b(0x590)][_0x2b258b(0x4e4)](_0x7e4e22)); _0x3d9edc && _0x28cf39(_0x3d9edc['id']), _0x463ee3[_0x2b258b(0x2e2)] = _0xdb7392[_0x2b258b(0x2e2)][_0x2b258b(0x3ea)](_0x5bb169 => _0x5bb169[_0x2b258b(0x776)] !== _0x2b258b(0x324) || _0x5bb169[_0x2b258b(0x590)][_0x2b258b(0x256)] > 0x1), _0x163ab8(), _0x1f29bd(); } else return _0x54ba78['name'] !== _0x2b258b(0x6f2) && console['error'](_0x2b258b(0x1cd), _0x54ba78), null; } } function _0x3833d6() { const _0x461cdf = _0x113cd8; if (_0x461cdf(0x200) === _0x461cdf(0x5c8)) _0x3b3b06(_0x461cdf(0x540), _0x461cdf(0x663)); else { const _0x282c6e = document[_0x461cdf(0x2c0)](_0x461cdf(0x355)); _0x282c6e[_0x461cdf(0x217)] = ''; if (_0x24ae96[_0x461cdf(0x7ce)][_0x461cdf(0x256)] === 0x0) { _0x282c6e[_0x461cdf(0x217)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>还没有好友圈，点击右上角“+”创建第一个吧。</p>'; return; } _0x24ae96[_0x461cdf(0x7ce)][_0x461cdf(0x203)](_0x40f31a => { const _0x26021c = _0x461cdf, _0x122f90 = _0x24ae96[_0x26021c(0xdc)][_0x26021c(0x1c6)](_0x509723 => _0x509723['id'] === _0x40f31a[_0x26021c(0x346)]) || { 'name': _0x26021c(0x685) }, _0x4a5531 = document[_0x26021c(0x2b5)](_0x26021c(0x6ee)); _0x4a5531['className'] = 'world-book-item', _0x4a5531[_0x26021c(0x362)]['id'] = _0x40f31a['id'], _0x4a5531['innerHTML'] = _0x26021c(0x63a) + _0x40f31a[_0x26021c(0x7e5)] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20' + _0x122f90['name'] + _0x26021c(0x61f) + _0x40f31a[_0x26021c(0x14c)]['length'] + _0x26021c(0x6b4), _0x4a5531[_0x26021c(0x41c)]('click', () => _0x2adc24(_0x40f31a['id'])), _0x282c6e[_0x26021c(0x3b1)](_0x4a5531); }); } } function _0x4d5720(_0x47da87 = null) { const _0x289065 = _0x113cd8, _0x47cd88 = document[_0x289065(0x2c0)](_0x289065(0x4eb)), _0x3088d2 = document[_0x289065(0x2c0)]('friend-circle-edit-bind-user'), _0x50f986 = document[_0x289065(0x2c0)](_0x289065(0x275)), _0x51647c = document[_0x289065(0x2c0)]('friend-circle-edit-title'), _0x21e523 = document[_0x289065(0x2c0)](_0x289065(0x397)), _0x255d44 = document['getElementById'](_0x289065(0x671)); _0x34ed18(_0x289065(0x54e)), _0x50f986[_0x289065(0x217)] = '', _0x24ae96[_0x289065(0x4c0)]['forEach'](_0x354bfc => { const _0x345ad3 = _0x289065; if (_0x345ad3(0x55a) !== 'AGWtW') { const _0x340bbe = document[_0x345ad3(0x2b5)](_0x345ad3(0x6ee)); _0x340bbe[_0x345ad3(0x38a)] = _0x345ad3(0x4a6), _0x340bbe[_0x345ad3(0x217)] = _0x345ad3(0x693) + _0x354bfc['id'] + '\x22\x20data-id=\x22' + _0x354bfc['id'] + _0x345ad3(0x6db) + (_0x354bfc[_0x345ad3(0x37c)] || _0x5d2cd8) + _0x345ad3(0x3af) + _0x354bfc['id'] + _0x345ad3(0x1bb) + _0x354bfc[_0x345ad3(0x7e5)] + _0x345ad3(0x5d6), _0x50f986['appendChild'](_0x340bbe); } else return new _0x1f69df(_0x7e3a44 => { const _0x42f646 = _0x345ad3, _0x25c301 = _0x5e93f8['getElementById'](_0x42f646(0x26a)), _0x471bbd = _0x40925a[_0x42f646(0x2c0)](_0x42f646(0x10e)), _0x2d3467 = _0x51e0fd['getElementById'](_0x42f646(0x330)), _0x556bcd = _0x37dd7a[_0x42f646(0x2c0)](_0x42f646(0x2c9)), _0x135c25 = _0x5050d1[_0x42f646(0x2c0)](_0x42f646(0xde)); _0x471bbd[_0x42f646(0x548)] = _0x2ccf62, _0x25c301[_0x42f646(0x610)][_0x42f646(0x452)] = _0x42f646(0x14f); const _0xd9ff5c = _0x44fec3 => { const _0x25d0a1 = _0x42f646; _0x25c301[_0x25d0a1(0x610)][_0x25d0a1(0x452)] = _0x25d0a1(0x3d2), _0x2d3467['onclick'] = _0x556bcd[_0x25d0a1(0x2c4)] = _0x135c25[_0x25d0a1(0x2c4)] = null, _0x1ed351[_0x25d0a1(0x382)](_0x25d0a1(0x13a), _0x55b44a), _0x7e3a44(_0x44fec3); }, _0x55b44a = _0x16a763 => { const _0x50ec4d = _0x42f646; if (_0x16a763['key'] === _0x50ec4d(0x1fa)) _0xd9ff5c(![]); if (_0x16a763[_0x50ec4d(0x60f)] === _0x50ec4d(0x104)) _0xd9ff5c(!![]); }; _0x2d3467[_0x42f646(0x2c4)] = () => _0xd9ff5c(!![]), _0x556bcd[_0x42f646(0x2c4)] = () => _0xd9ff5c(![]), _0x135c25[_0x42f646(0x2c4)] = () => _0xd9ff5c(![]), _0xacb3d6[_0x42f646(0x41c)](_0x42f646(0x13a), _0x55b44a); }); }); if (_0x47da87) { const _0x2af637 = _0x24ae96[_0x289065(0x7ce)][_0x289065(0x1c6)](_0x3cb181 => _0x3cb181['id'] === _0x47da87); if (!_0x2af637) return; _0x51647c[_0x289065(0x548)] = _0x289065(0x3de), _0x21e523[_0x289065(0x69f)] = _0x2af637['id'], _0x47cd88[_0x289065(0x69f)] = _0x2af637[_0x289065(0x7e5)], _0x3088d2[_0x289065(0x69f)] = _0x2af637[_0x289065(0x346)], _0x255d44[_0x289065(0x610)][_0x289065(0x452)] = _0x289065(0x3fb), _0x2af637[_0x289065(0x14c)][_0x289065(0x203)](_0x54e780 => { const _0x132145 = _0x289065; if (_0x132145(0x433) === _0x132145(0x636)) { const _0x23b4db = _0x56ffc1[_0x132145(0x7a6)](); _0x23b4db[_0x132145(0x468)] = () => _0x2b7eef(_0x23b4db[_0x132145(0x834)]), _0x23b4db[_0x132145(0x464)] = () => _0x37bdc5(_0x23b4db[_0x132145(0x40f)]); } else { const _0x2ff90b = _0x50f986[_0x132145(0x437)](_0x132145(0x7a3) + _0x54e780); if (_0x2ff90b) _0x2ff90b['checked'] = !![]; } }); } else _0x51647c[_0x289065(0x548)] = _0x289065(0x3a4), _0x21e523['value'] = '', _0x47cd88['value'] = _0x289065(0x29a) + (_0x24ae96['friendCircles'][_0x289065(0x256)] + 0x1), _0x3088d2[_0x289065(0x69f)] = _0x24ae96['activeUserProfileId'], _0x255d44[_0x289065(0x610)]['display'] = _0x289065(0x3d2); _0x124c6c('friendCircleEdit', _0x289065(0x51d)); } function _0x22ff4f() { const _0x57283a = _0x113cd8, _0x165efa = document[_0x57283a(0x2c0)](_0x57283a(0x397))['value'], _0x2668a8 = document['getElementById'](_0x57283a(0x4eb))['value'][_0x57283a(0x529)](), _0x3d9b22 = document[_0x57283a(0x2c0)](_0x57283a(0x54e))[_0x57283a(0x69f)], _0x5bc3f1 = Array[_0x57283a(0x1f7)](document['querySelectorAll'](_0x57283a(0x7de)))['map'](_0x337efd => _0x337efd[_0x57283a(0x362)]['id']); if (!_0x2668a8) { _0x880caf(_0x57283a(0x628)); return; } if (_0x5bc3f1[_0x57283a(0x256)] === 0x0) { if (_0x57283a(0x406) !== _0x57283a(0x406)) _0x410af5[_0x57283a(0x40f)](_0x57283a(0x5e3) + _0x1ef715 + ':', _0x562864); else { _0x880caf(_0x57283a(0x296)); return; } } if (_0x165efa) { const _0x3f8017 = _0x24ae96[_0x57283a(0x7ce)][_0x57283a(0x1c6)](_0x1a5965 => _0x1a5965['id'] === _0x165efa); _0x3f8017 && (_0x3f8017['name'] = _0x2668a8, _0x3f8017[_0x57283a(0x346)] = _0x3d9b22, _0x3f8017['memberCharacterIds'] = _0x5bc3f1); } else { if (_0x57283a(0x5f3) !== _0x57283a(0x491)) { const _0x146d22 = { 'id': _0x57283a(0x4cf) + Date[_0x57283a(0x695)](), 'name': _0x2668a8, 'boundUserProfileId': _0x3d9b22, 'memberCharacterIds': _0x5bc3f1, 'posts': [] }; _0x24ae96[_0x57283a(0x7ce)][_0x57283a(0x60b)](_0x146d22); } else _0x49c0b5[_0x57283a(0x5ed)] = { ..._0x489ba2[_0x57283a(0x432)] }; } _0x5d845c(), _0x880caf(_0x57283a(0x110)), _0x3833d6(), _0x124c6c(_0x57283a(0x51d), 'friendCircleEdit'); } async function _0x1b9a15() { const _0x35ffe4 = _0x113cd8; if (_0x35ffe4(0x1a8) === _0x35ffe4(0x1a8)) { const _0x17da92 = document[_0x35ffe4(0x2c0)]('editing-friend-circle-id')[_0x35ffe4(0x69f)]; if (!_0x17da92) return; const _0x3ddb1d = await _0x380a1e('确定要删除这个好友圈吗？此操作不可撤销。'); if (_0x3ddb1d) { if (_0x35ffe4(0x790) !== _0x35ffe4(0x549)) _0x24ae96[_0x35ffe4(0x7ce)] = _0x24ae96[_0x35ffe4(0x7ce)]['filter'](_0x3a55cf => _0x3a55cf['id'] !== _0x17da92), _0x24ae96[_0x35ffe4(0x4fb)] === _0x17da92 && ('KuYOw' !== _0x35ffe4(0x301) ? _0x5aacfb[_0x35ffe4(0x1e5)] = _0x5da1e1[_0x35ffe4(0x1fc)] : _0x24ae96[_0x35ffe4(0x4fb)] = null), _0x5d845c(), _0x880caf(_0x35ffe4(0x350)), _0x3833d6(), _0x124c6c(_0x35ffe4(0x51d), _0x35ffe4(0x517)); else { const _0x2182bf = _0x623e51[_0x35ffe4(0x2b5)]('img'); _0x2182bf[_0x35ffe4(0xd4)] = _0x5a428a[_0x35ffe4(0x375)], _0x2182bf[_0x35ffe4(0x796)] = 'lazy', _0x2182bf[_0x35ffe4(0x54d)] = _0x1e56e2['name'], _0x2182bf[_0x35ffe4(0x82a)][_0x35ffe4(0x2c7)](_0x35ffe4(0x69b)), _0x2182bf['addEventListener']('click', () => _0x4ee7c7(_0x290da4)), _0x48aca5[_0x35ffe4(0x3b1)](_0x2182bf); } } } else _0x3b8d4d[_0x35ffe4(0x1bf)](_0x3a73c3); } function _0x2adc24(_0x18a19f) { const _0x5b13d3 = _0x113cd8; if (_0x5b13d3(0x66d) === _0x5b13d3(0x609)) _0xdca98b(), _0xc078b5(_0x5b13d3(0x179), _0x5b13d3(0x540)); else { _0x326335(); const _0x44b415 = _0x24ae96[_0x5b13d3(0x7ce)][_0x5b13d3(0x1c6)](_0x5ab897 => _0x5ab897['id'] === _0x18a19f); if (!_0x44b415) return; _0x24ae96[_0x5b13d3(0x4fb)] = _0x18a19f, _0x5d845c(), document[_0x5b13d3(0x2c0)](_0x5b13d3(0xd6))['textContent'] = _0x44b415['name'], _0x47e097(), _0x124c6c('music', _0x5b13d3(0x51d)), _0x455d37(); } } function _0x5ade71() { const _0x5cb864 = _0x113cd8; if ('SjTiY' !== _0x5cb864(0x1e3)) { if (!_0x24ae96[_0x5cb864(0x7ce)] || _0x24ae96[_0x5cb864(0x7ce)][_0x5cb864(0x256)] === 0x0) { console[_0x5cb864(0x40f)](_0x5cb864(0x4aa)); return; } const _0x3e00b6 = _0x24ae96[_0x5cb864(0x7ce)][0x0]; if (_0x3e00b6[_0x5cb864(0x14c)][_0x5cb864(0x256)] < 0x2) { console[_0x5cb864(0x40f)](_0x5cb864(0x219) + _0x3e00b6[_0x5cb864(0x7e5)] + _0x5cb864(0x267)); return; } const _0x43c6e3 = { 'id': _0x5cb864(0x720) + Date['now'](), 'authorType': _0x5cb864(0x777), 'authorId': _0x3e00b6[_0x5cb864(0x14c)][0x0], 'content': '这是一条由控制台添加的测试动态！样式看起来非常完美。', 'timestamp': Date[_0x5cb864(0x695)](), 'likes': [_0x3e00b6[_0x5cb864(0x14c)][0x1]], 'comments': [{ 'commentId': 'c_' + Date[_0x5cb864(0x695)](), 'authorId': _0x3e00b6[_0x5cb864(0x14c)][0x1], 'content': '赞同！渲染效果一级棒！' }] }; _0x3e00b6[_0x5cb864(0x22b)][_0x5cb864(0x60b)](_0x43c6e3), _0x5d845c(), console[_0x5cb864(0x72f)](_0x5cb864(0x3d3) + _0x3e00b6[_0x5cb864(0x7e5)] + _0x5cb864(0x22a)), _0x880caf(_0x5cb864(0x7bc)); } else { const _0x35e285 = _0x369175[_0x5cb864(0x437)](_0x5cb864(0x56c)); _0x35e285 && _0x35e285[_0x5cb864(0x41c)](_0x5cb864(0x472), function () { const _0xd2fcb7 = _0x5cb864, _0x1e8fd9 = { 'id': _0x2010a7['id'], 'url': _0x427a4c[_0xd2fcb7(0x4b2)] }; _0x1dd653(this, _0x1e8fd9); }); } } window[_0x113cd8(0x53b)] = _0x5ade71; function _0x42772a(_0x19ab6a) { return _0x24ae96['userProfiles']['find'](_0x48dd5a => _0x48dd5a['id'] === _0x19ab6a); } function _0x541a9b(_0x54d7b8, _0x44e46e = _0x113cd8(0x2b7)) { const _0x276fe7 = _0x113cd8; if (_0x276fe7(0x297) !== _0x276fe7(0x297)) _0x55ab12[_0x276fe7(0x40f)](_0x276fe7(0x21b), _0x2dca5d); else { const _0x4c0fc0 = document[_0x276fe7(0x2c0)](_0x276fe7(0x616)); let _0x54658c = document[_0x276fe7(0x2c0)](_0x276fe7(0x27d)); _0x54d7b8 ? (!_0x54658c && ('OlSpd' !== _0x276fe7(0x1ce) ? (_0x54658c = document['createElement']('div'), _0x54658c['id'] = _0x276fe7(0x27d), _0x4c0fc0[_0x276fe7(0x3b1)](_0x54658c)) : (_0xb16527 = _0x1f2c98[_0x276fe7(0x7e5)] || '我', _0x36bc26 = 'speaker-user')), _0x54658c['innerHTML'] = '<div\x20class=\x22loader-spinner\x22></div><span>' + _0x44e46e + _0x276fe7(0x205), _0x54658c[_0x276fe7(0x610)][_0x276fe7(0x452)] = 'flex') : _0x276fe7(0x6c3) === 'sCmvL' ? _0x54658c && (_0x54658c['style']['display'] = _0x276fe7(0x3d2)) : (_0x5a44a9[_0x276fe7(0x40f)]('解析AI剧本JSON失败:', _0x4edcb3, _0x276fe7(0x3c1), _0x50885e), _0x3b9123[_0x276fe7(0x5bb)][_0x276fe7(0x60b)]({ 'role': _0x276fe7(0x2f2), 'senderId': _0x5fdd35['id'], 'timestamp': _0x342f42[_0x276fe7(0x695)](), 'isOffline': !![], 'content': _0x276fe7(0x5dc) + _0x315869 + ']' })); } } async function _0x4b2ca4() { const _0x3f3036 = _0x113cd8; if ('UINoa' !== _0x3f3036(0x1b9)) _0x228748[_0x3f3036(0x832)][_0x3f3036(0x715)] = _0x5488b6['checked'], _0x31b4d4(), _0x3b91b7(); else { const _0x4055d9 = _0x24ae96[_0x3f3036(0x7ce)][_0x3f3036(0x1c6)](_0x1991f8 => _0x1991f8['id'] === _0x24ae96[_0x3f3036(0x4fb)]); if (!_0x4055d9 || _0x24ae96['isGenerating']) return; _0x541a9b(!![], _0x3f3036(0x5fe)), _0x24ae96[_0x3f3036(0x3c6)] = !![]; try { if ('HDgGD' === _0x3f3036(0x6c6)) _0x2789fe = !![], _0x382cae[_0x3f3036(0x192)] = null; else { let _0x1276c6 = Date[_0x3f3036(0x695)](); _0x4055d9[_0x3f3036(0x22b)] && _0x4055d9['posts'][_0x3f3036(0x256)] > 0x0 && (_0x1276c6 = Math['max'](..._0x4055d9[_0x3f3036(0x22b)][_0x3f3036(0x6dd)](_0x5d98de => _0x5d98de[_0x3f3036(0x808)]))); const _0x2bb67b = await _0x8465ff(_0x4055d9); if (!_0x2bb67b || _0x2bb67b[_0x3f3036(0x256)] === 0x0) { _0x880caf(_0x3f3036(0x55b)); return; } const _0x2af9e7 = _0x2bb67b[_0x3f3036(0x6dd)](async (_0x3cf72e, _0x20119c) => { const _0x4b5d4b = _0x3f3036; _0x541a9b(!![], _0x4b5d4b(0x5b7) + (_0x20119c + 0x1) + '\x20/\x20' + _0x2bb67b[_0x4b5d4b(0x256)] + _0x4b5d4b(0x486)); const _0x5746c5 = _0x1276c6 + (_0x20119c + 0x1) * 0x3c * 0x3e8, _0x566062 = { 'id': _0x4b5d4b(0x41b) + _0x3cf72e[_0x4b5d4b(0x6a5)] + '_' + _0x5746c5, 'authorType': _0x4b5d4b(0x777), 'authorId': _0x3cf72e[_0x4b5d4b(0x6a5)], 'content': _0x3cf72e['postContent'], 'timestamp': _0x5746c5, 'likes': _0x3cf72e['likes'] || [], 'comments': (_0x3cf72e['comments'] || [])[_0x4b5d4b(0x6dd)]((_0x116df8, _0x74d3e4) => ({ 'commentId': 'c_' + _0x5746c5 + '_' + _0x74d3e4, 'authorId': _0x116df8[_0x4b5d4b(0x6a5)], 'content': _0x116df8[_0x4b5d4b(0x77b)] })) }; if (_0x3cf72e[_0x4b5d4b(0x134)] === _0x4b5d4b(0x457) && _0x3cf72e[_0x4b5d4b(0x805)] && _0x3cf72e['artist']) { if (_0x4b5d4b(0x53e) === _0x4b5d4b(0x53e)) try { if ('gnSvK' !== _0x4b5d4b(0xdd)) { const _0x1234fe = await _0x1f04ab(_0x3cf72e[_0x4b5d4b(0x805)], _0x3cf72e['artist']); _0x566062['type'] = _0x4b5d4b(0x457), _0x566062[_0x4b5d4b(0x805)] = _0x3cf72e[_0x4b5d4b(0x805)], _0x566062[_0x4b5d4b(0x623)] = _0x3cf72e[_0x4b5d4b(0x623)], _0x566062[_0x4b5d4b(0x3ff)] = _0x1234fe['cover'], _0x566062[_0x4b5d4b(0x4b2)] = _0x1234fe[_0x4b5d4b(0x375)]; } else _0x45b968[_0x4b5d4b(0xd4)] = _0x212bd2[_0x4b5d4b(0x6c9)](_0x52106a), _0x1da85c[_0x4b5d4b(0x610)][_0x4b5d4b(0x2d3)] = 0x1; } catch (_0x2ec84a) { console[_0x4b5d4b(0x40f)]('动态中的音乐搜索失败:', _0x2ec84a), _0x566062['type'] = _0x4b5d4b(0x13b); } else _0x158f68[_0x4b5d4b(0x40f)](_0x4b5d4b(0x28e) + _0x5681df['activeChatId'], _0x62da43); } else _0x4b5d4b(0x410) !== 'wNTfA' ? (_0x565fd3(_0x5a4ef0, { 'force': !![], 'delayMs': _0x200e21 }), _0xf37aca += 0x1f4) : _0x566062[_0x4b5d4b(0x776)] = _0x4b5d4b(0x13b); return _0x566062; }), _0x218179 = await Promise[_0x3f3036(0x154)](_0x2af9e7); _0x4055d9[_0x3f3036(0x22b)][_0x3f3036(0x60b)](..._0x218179), _0x5d845c(); } } catch (_0x4544d5) { _0x3f3036(0x7f4) === _0x3f3036(0x7f4) ? (console[_0x3f3036(0x40f)](_0x3f3036(0xd2), _0x4544d5), _0x880caf(_0x3f3036(0x223) + _0x4544d5[_0x3f3036(0x2ec)])) : _0x180fa4[_0x3f3036(0x40f)](_0x3f3036(0x4c2) + _0x1d790b['id'], _0x47a5f8); } finally { _0x47e097(), _0x541a9b(![]), _0x24ae96['isGenerating'] = ![]; } } } async function _0x8465ff(_0x23d62e) { const _0x49352d = _0x113cd8; if (_0x49352d(0x4f8) !== _0x49352d(0x4f8)) _0x31ef31 = _0x27c2e0; else { const _0x2d04ee = _0x23d62e[_0x49352d(0x14c)][_0x49352d(0x6dd)](_0x44ee4e => _0x5c4526(_0x44ee4e))['filter'](Boolean); if (_0x2d04ee[_0x49352d(0x256)] === 0x0) return null; const _0x1c2e6c = _0x4e95be(), _0x2990b9 = _0x42772a(_0x23d62e['boundUserProfileId']) || _0x24ae96[_0x49352d(0xdc)][0x0], _0x8db3df = _0x2990b9 ? _0x49352d(0x329) + _0x2990b9[_0x49352d(0x7e5)] + '\x0a-\x20人设:\x20' + (_0x2990b9['persona'] || '无') + '\x0a' : '', _0x29b805 = _0x2d04ee[_0x49352d(0x6dd)](_0x220df3 => { const _0x14349a = _0x49352d, { omniText: _0x154980 } = _0x5bd842(_0x220df3['id'], null), _0x56c1e0 = _0x118a24(_0x220df3['id']), _0x246d82 = _0x220df3[_0x14349a(0x106)] && _0x220df3[_0x14349a(0x106)][_0x14349a(0x256)] > 0x0 ? '\x0a\x0a#\x20' + _0x220df3['name'] + _0x14349a(0x421) + _0x220df3[_0x14349a(0x106)]['map'](_0x7b6f6f => _0x24ae96['worldBooks']['find'](_0x3a313c => _0x3a313c['id'] === _0x7b6f6f))[_0x14349a(0x3ea)](Boolean)['map'](_0x3ac0a3 => _0x14349a(0x308) + _0x3ac0a3[_0x14349a(0x7e5)] + '\x0a' + _0x3ac0a3[_0x14349a(0x77b)])[_0x14349a(0x799)]('') : ''; return _0x14349a(0x5fa) + _0x220df3[_0x14349a(0x7e5)] + _0x14349a(0x69c) + _0x220df3['id'] + _0x14349a(0xf5) + _0x220df3[_0x14349a(0x791)] + _0x14349a(0x31c) + _0x154980 + '\x0a' + _0x56c1e0 + '\x0a' + _0x246d82; })['join']('\x0a\x0a'), _0x54f78e = Math[_0x49352d(0x182)](Math['random']() * 0x3) + 0x2, _0x10c9fe = _0x49352d(0x75e) + _0x54f78e + _0x49352d(0x335) + _0x29b805 + '\x0a' + _0x8db3df + _0x49352d(0x6cb) + _0x1c2e6c + '\x0a\x0a#\x20任务流程\x0a1.\x20\x20**全局视角**:\x20审视所有成员的人设和近期记忆（包括聊天、日记等），构思他们之间可能发生的有趣互动。\x0a2.\x20\x20**选择作者**:\x20从上述成员中，为' + _0x54f78e + _0x49352d(0x593) + _0x54f78e + _0x49352d(0x3f4), _0x21b3a0 = [{ 'role': _0x49352d(0x67d), 'content': _0x10c9fe }]; _0x21b3a0[_0x49352d(0x60b)]({ 'role': _0x49352d(0xe9), 'content': _0x49352d(0x4a2) + _0x54f78e + _0x49352d(0x724) }); try { const _0xb93f1b = await _0x519e38(_0x21b3a0, { 'json': !![] }), _0x316266 = _0xb93f1b[_0x49352d(0x259)](/(\[[\s\S]*\])/); if (!_0x316266) throw new Error(_0x49352d(0x34e)); const _0x30dac1 = _0x316266[0x1], _0x4a1ddb = JSON[_0x49352d(0x458)](_0x30dac1); if (!Array[_0x49352d(0x2d0)](_0x4a1ddb)) throw new Error(_0x49352d(0x6e6)); return _0x4a1ddb; } catch (_0x478c1d) { return console[_0x49352d(0x40f)](_0x49352d(0x546), _0x478c1d), console[_0x49352d(0x40f)](_0x49352d(0x135), _0x478c1d['rawResponse'] || response), null; } } } async function _0x1d79f1() { const _0x541cc3 = _0x113cd8, _0x36104b = _0x24ae96[_0x541cc3(0x7ce)]['find'](_0x3da12f => _0x3da12f['id'] === _0x24ae96[_0x541cc3(0x4fb)]); if (!_0x36104b) return; const _0x5ac854 = await _0x380a1e(_0x541cc3(0x454) + _0x36104b[_0x541cc3(0x7e5)] + '”的所有动态吗？此操作不可撤销，且AI将不再记得这些内容。'); if (_0x5ac854) { if (_0x541cc3(0x57f) === 'ZtEXv') return []; else _0x36104b['posts'] = [], _0x5d845c(), _0x47e097(), _0x880caf(_0x541cc3(0x5cb)); } } function _0x47e097() { const _0x50459c = _0x113cd8, _0x15d7b2 = document[_0x50459c(0x2c0)](_0x50459c(0x201)), _0x5603ac = _0x24ae96[_0x50459c(0x7ce)][_0x50459c(0x1c6)](_0x575f1f => _0x575f1f['id'] === _0x24ae96[_0x50459c(0x4fb)]); if (!_0x5603ac) { _0x15d7b2[_0x50459c(0x217)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>'; return; } if (_0x5603ac[_0x50459c(0x22b)]['length'] === 0x0) { if (_0x50459c(0xe2) !== 'DoMTB') _0x56e611[_0x50459c(0x832)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0x374a83['preferences'] }; else { _0x15d7b2['innerHTML'] = _0x50459c(0x114); return; } } _0x15d7b2[_0x50459c(0x217)] = ''; const _0xaae11b = [..._0x5603ac[_0x50459c(0x22b)]]['sort']((_0x2f6465, _0x17fb12) => _0x17fb12['timestamp'] - _0x2f6465[_0x50459c(0x808)]); _0xaae11b[_0x50459c(0x203)](_0x2f0c47 => { const _0x1c4b80 = _0x50459c, _0x272622 = document[_0x1c4b80(0x2b5)]('div'); _0x272622[_0x1c4b80(0x38a)] = _0x1c4b80(0x46d); let _0x466221 = '未知', _0x37dce7 = _0x5d2cd8; if (_0x2f0c47['authorType'] === 'user') { const _0xbffa39 = _0x42772a(_0x2f0c47[_0x1c4b80(0x6a5)]); _0xbffa39 && (_0x466221 = _0xbffa39[_0x1c4b80(0x7e5)], _0x37dce7 = _0xbffa39[_0x1c4b80(0x37c)]); } else { if (_0x1c4b80(0x206) !== 'GTvHL') { const _0x280c80 = _0x428ea8[_0x1c4b80(0x69f)]; let _0x1ac98e = _0x280c80[_0x1c4b80(0xef)](/\.bubble\.sent/g, _0x1c4b80(0x56e))['replace'](/\.bubble\.received/g, _0x1c4b80(0x2fd)); _0x115e6['innerHTML'] = _0x1ac98e; } else { const _0x1e2137 = _0x5c4526(_0x2f0c47[_0x1c4b80(0x6a5)]); _0x1e2137 && (_0x466221 = _0x1e2137[_0x1c4b80(0x7e5)], _0x37dce7 = _0x1e2137[_0x1c4b80(0x37c)]); } } const _0x84ab64 = _0x1c4b80(0x2ab) + _0x37dce7 + _0x1c4b80(0x827) + _0x466221 + _0x1c4b80(0x4b5), _0x17c1c7 = _0x1c4b80(0x69a) + _0x2f0c47[_0x1c4b80(0x77b)] + '</p>'; let _0x401f60 = ''; if (_0x2f0c47[_0x1c4b80(0x650)] || _0x2f0c47['imageId']) { const _0x1e3070 = 'post-img-' + _0x2f0c47['id']; _0x401f60 = _0x1c4b80(0x436) + _0x1e3070 + _0x1c4b80(0x43c), setTimeout(() => { const _0x2f6b70 = _0x1c4b80, _0x47f2bc = document['getElementById'](_0x1e3070); if (!_0x47f2bc) return; if (_0x2f0c47['image']) _0x47f2bc[_0x2f6b70(0xd4)] = _0x2f0c47[_0x2f6b70(0x650)]; else _0x2f0c47['imageId'] && _0x5aea9f(_0x2f0c47[_0x2f6b70(0x470)])[_0x2f6b70(0x73a)](_0x528fc0 => { const _0x5ea213 = _0x2f6b70; if (_0x528fc0) { if (_0x5ea213(0x7c6) !== _0x5ea213(0x7c6)) _0x3719c4['value'] = _0x28bd9f, _0x47ebf5[_0x5ea213(0x82a)][_0x5ea213(0x28c)](_0x5ea213(0x155)); else { const _0x4db95d = URL['createObjectURL'](_0x528fc0); _0x47f2bc[_0x5ea213(0xd4)] = _0x4db95d, _0x47f2bc[_0x5ea213(0x251)] = () => URL[_0x5ea213(0x1bf)](_0x4db95d); } } else _0x47f2bc[_0x5ea213(0x2be)] = '图片加载失败'; }); }, 0x0); } let _0x387b6b = ''; _0x2f0c47[_0x1c4b80(0x776)] === _0x1c4b80(0x457) && _0x2f0c47[_0x1c4b80(0x805)] && (_0x387b6b = _0x1c4b80(0x647) + _0x2f0c47['id'] + _0x1c4b80(0x543) + (_0x2f0c47['coverUrl'] || _0x5d2cd8) + _0x1c4b80(0x48d) + _0x2f0c47['songName'] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x2f0c47[_0x1c4b80(0x623)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>' + (_0x2f0c47[_0x1c4b80(0x4b2)] ? '▶' : '⚠') + _0x1c4b80(0x621)); const _0x18d60a = _0x1c4b80(0x35a) + new Date(_0x2f0c47['timestamp'])[_0x1c4b80(0x1c0)](_0x1c4b80(0x222)) + _0x1c4b80(0x2fc); let _0x217d5d = ''; if (_0x2f0c47[_0x1c4b80(0x54c)] && _0x2f0c47[_0x1c4b80(0x54c)][_0x1c4b80(0x256)] > 0x0 || _0x2f0c47['comments'] && _0x2f0c47['comments'][_0x1c4b80(0x256)] > 0x0) { let _0x1a8ec4 = ''; if (_0x2f0c47[_0x1c4b80(0x54c)] && _0x2f0c47[_0x1c4b80(0x54c)][_0x1c4b80(0x256)] > 0x0) { if (_0x1c4b80(0x775) !== _0x1c4b80(0x642)) { const _0x4436fd = _0x2f0c47[_0x1c4b80(0x54c)][_0x1c4b80(0x6dd)](_0x24d616 => _0x5c4526(_0x24d616)?.[_0x1c4b80(0x7e5)] || '未知')['join']('、'); _0x1a8ec4 = _0x1c4b80(0x806) + _0x4436fd + '</div>'; } else _0x47321d(_0x4bcc4f['activeFriendCircleId']); } let _0x1c9ff0 = ''; if (_0x2f0c47['comments'] && _0x2f0c47[_0x1c4b80(0x1c8)]['length'] > 0x0) { if (_0x1c4b80(0x1f9) !== _0x1c4b80(0x1f9)) { _0x40f9a9(_0x1c4b80(0x628)); return; } else { const _0x43574e = _0x2f0c47[_0x1c4b80(0x1c8)]['map'](_0x3de9e7 => { const _0x2540de = _0x1c4b80, _0x344edc = _0x5c4526(_0x3de9e7[_0x2540de(0x6a5)])?.[_0x2540de(0x7e5)] || '未知'; return _0x2540de(0x6fc) + _0x344edc + '</span>:\x20' + _0x3de9e7[_0x2540de(0x77b)] + _0x2540de(0x2fc); })[_0x1c4b80(0x799)](''); _0x1c9ff0 = _0x1c4b80(0x4fd) + _0x43574e + _0x1c4b80(0x2fc); } } _0x217d5d = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-interactions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x1a8ec4 + _0x1c4b80(0x14d) + _0x1c9ff0 + _0x1c4b80(0x6bd); } _0x272622[_0x1c4b80(0x217)] = _0x84ab64 + _0x17c1c7 + _0x401f60 + _0x387b6b + _0x18d60a + _0x217d5d, _0x15d7b2[_0x1c4b80(0x3b1)](_0x272622); if (_0x2f0c47[_0x1c4b80(0x776)] === _0x1c4b80(0x457) && _0x2f0c47[_0x1c4b80(0x4b2)]) { if (_0x1c4b80(0x487) === _0x1c4b80(0x487)) { const _0x3b9302 = _0x272622[_0x1c4b80(0x437)](_0x1c4b80(0x56c)); _0x3b9302 && (_0x1c4b80(0x150) === 'XyBbQ' ? _0x3b9302[_0x1c4b80(0x41c)](_0x1c4b80(0x472), function () { const _0x3c7838 = _0x1c4b80; if (_0x3c7838(0x5a9) === 'tHDLk') { const _0x5e261c = { 'id': _0x2f0c47['id'], 'url': _0x2f0c47[_0x3c7838(0x4b2)] }; _0x366a1e(this, _0x5e261c); } else _0x3f855d[_0x3c7838(0x2c0)](_0x3c7838(0x1aa))['style'][_0x3c7838(0x554)](_0x3c7838(0xfc), _0x3c7838(0x3d2)); }) : (_0x3e0460(_0x409e7f), _0x5c24c1())); } else { const _0x188d53 = _0x5921aa(_0x3b4637[_0x1c4b80(0x590)][0x0]); return _0x188d53?.['name'] || 'AI'; } } }); } document['getElementById'](_0x113cd8(0x404))[_0x113cd8(0x41c)]('click', _0x1d79f1), document[_0x113cd8(0x2c0)](_0x113cd8(0x173))[_0x113cd8(0x41c)]('click', _0x4b2ca4), document[_0x113cd8(0x2c0)](_0x113cd8(0x361))[_0x113cd8(0x41c)](_0x113cd8(0x472), () => _0x124c6c(_0x113cd8(0x540), _0x113cd8(0x51d))), document[_0x113cd8(0x2c0)](_0x113cd8(0x615))[_0x113cd8(0x41c)](_0x113cd8(0x472), () => _0x4d5720()), document['getElementById'](_0x113cd8(0x224))[_0x113cd8(0x41c)]('click', () => _0x124c6c(_0x113cd8(0x51d), _0x113cd8(0x517))), document[_0x113cd8(0x2c0)]('save-friend-circle-button')[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x22ff4f), document['getElementById'](_0x113cd8(0x671))[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x1b9a15), document[_0x113cd8(0x2c0)]('back-to-circle-list-from-feed')[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x582427 = _0x113cd8; _0x582427(0xdb) === 'tWWrF' ? (_0x3833d6(), _0x124c6c('friendCircleList', _0x582427(0x457))) : (_0x5d1133(![]), _0x2d652d[_0x582427(0x40f)](_0x582427(0x196), _0x1e9bc7), _0x2bafd9('上传失败了，笨蛋！\x20' + _0x9f355d[_0x582427(0x2ec)])); }), document[_0x113cd8(0x2c0)](_0x113cd8(0x6de))['addEventListener'](_0x113cd8(0x472), () => { const _0x550d6f = _0x113cd8; _0x550d6f(0x602) !== _0x550d6f(0x286) ? _0x24ae96['activeFriendCircleId'] && _0x4d5720(_0x24ae96[_0x550d6f(0x4fb)]) : (_0x551ad0[_0x550d6f(0x40f)](_0x550d6f(0x278), _0x30e5a9), _0x45c663[_0x550d6f(0xd4)] = ''); }), document[_0x113cd8(0x2c0)](_0x113cd8(0x323))[_0x113cd8(0x41c)](_0x113cd8(0x472), async () => { const _0x161fc2 = _0x113cd8; if (_0x161fc2(0x50d) === _0x161fc2(0x677)) { if (_0x3ad0ba['diaryPressTimer']) _0x354e77(_0x1d8d82['diaryPressTimer']); const _0x58c1a3 = _0x544052['target'][_0x161fc2(0x550)](_0x161fc2(0x2c6)); if (!_0x58c1a3) return; const _0x12d23b = _0x58c1a3[_0x161fc2(0x362)][_0x161fc2(0x808)], _0x358d8a = _0x58c1a3[_0x161fc2(0x82a)][_0x161fc2(0x211)](_0x161fc2(0xe9)) ? 'user' : 'ai'; if (!_0x12d23b) return; const _0x3ec1f5 = () => { const _0x41b105 = _0x161fc2; _0x19426c[_0x41b105(0x78b)] = _0x205113(() => { const _0x2fc850 = _0x41b105; if (_0x366644['type'] === 'touchstart') _0x21c53f[_0x2fc850(0x100)](); _0x52a51f(_0x39e86d(_0x12d23b, 0xa), _0x358d8a); }, 0x320); }, _0x615b09 = () => { const _0x4fe453 = _0x161fc2; if (_0x6adf2['diaryPressTimer']) _0x402dec(_0x154645[_0x4fe453(0x78b)]); }; _0x186283[_0x161fc2(0x41c)](_0x161fc2(0x305), _0x615b09, { 'once': !![] }), _0x50e614[_0x161fc2(0x41c)](_0x161fc2(0x6b6), _0x615b09, { 'once': !![] }), _0x59434b[_0x161fc2(0x41c)](_0x161fc2(0x58c), _0x615b09, { 'once': !![] }), _0x3ec1f5(); } else { const _0xcaac53 = _0x24ae96['friendCircles']['find'](_0x5926d8 => _0x5926d8['id'] === _0x24ae96[_0x161fc2(0x4fb)]); if (!_0xcaac53 || _0x24ae96[_0x161fc2(0x3c6)]) return; const _0x3e4579 = _0xcaac53[_0x161fc2(0x346)], _0x23225d = _0x24ae96[_0x161fc2(0xdc)]['find'](_0x45a6ed => _0x45a6ed['id'] === _0x3e4579); if (!_0x23225d) { if (_0x161fc2(0x506) !== _0x161fc2(0x506)) { const _0x342198 = { 'role': 'assistant', 'content': _0x161fc2(0x778) + _0x450427[_0x161fc2(0x7e5)] + ']', 'displayUrl': _0x3a5c13[_0x161fc2(0x375)], 'senderId': _0x3e3bc3[_0x161fc2(0x1fd)], 'timestamp': _0x2e48e0['now'](), 'isOffline': _0x4648eb }; _0x4faffb['conversationHistory'][_0x161fc2(0x60b)](_0x342198); } else { _0x880caf(_0x161fc2(0x553)); return; } } const _0x3b412d = document[_0x161fc2(0x2c0)]('user-post-textarea')[_0x161fc2(0x69f)][_0x161fc2(0x529)](), _0x4b3867 = _0x24ae96[_0x161fc2(0x101)][_0x161fc2(0x650)], _0x3c446c = _0x24ae96[_0x161fc2(0x101)][_0x161fc2(0x457)], _0x821ad1 = _0x24ae96[_0x161fc2(0x101)][_0x161fc2(0x470)]; if (!_0x3b412d && !_0x4b3867 && !_0x3c446c) { if (_0x161fc2(0x49f) === _0x161fc2(0x2bc)) { const _0x2e17bf = _0x161fc2(0x6d6); _0x405212 = _0x161fc2(0x19f) + _0xf4524b['name'] + _0x161fc2(0x414) + _0x2e17bf + _0x161fc2(0x2c2) + _0x5a0fc1[_0x161fc2(0x7e5)] + _0x161fc2(0x1a4) + _0x2e17bf + _0x161fc2(0x816) + _0x2e17bf + _0x161fc2(0x6f9); } else { _0x880caf('总得说点什么吧？'); return; } } const _0x83d38c = { 'id': _0x161fc2(0x2b0) + Date['now'](), 'authorType': 'user', 'authorId': _0x23225d['id'], 'content': _0x3b412d, 'timestamp': Date[_0x161fc2(0x695)](), 'likes': [], 'comments': [] }; if (_0x821ad1) { if (_0x161fc2(0x184) === _0x161fc2(0x184)) _0x83d38c['imageId'] = _0x821ad1; else { const _0x2c3296 = _0x2ebe4e(_0x5881ce); if (_0x2c3296) { const _0x2468e9 = _0x1c25cd[_0x161fc2(0x2b5)](_0x161fc2(0x12a)); _0x2468e9[_0x161fc2(0x69f)] = _0x2c3296['id'], _0x2468e9[_0x161fc2(0x548)] = _0x2c3296[_0x161fc2(0x7e5)], _0x338fbf['appendChild'](_0x2468e9); } } } else _0x4b3867 && (_0x161fc2(0x617) === 'aCBCp' ? _0x83d38c[_0x161fc2(0x650)] = _0x4b3867 : (_0x1e8c45(_0x116201['id']), _0x4f28f4(_0x161fc2(0x336) + _0x5a8709[_0x161fc2(0x7e5)] + _0x161fc2(0x3f8)), _0x22ed48(![]))); _0x3c446c ? (_0x83d38c[_0x161fc2(0x776)] = _0x161fc2(0x457), Object[_0x161fc2(0x758)](_0x83d38c, _0x3c446c)) : _0x83d38c['type'] = _0x161fc2(0x13b), _0xcaac53[_0x161fc2(0x22b)]['push'](_0x83d38c), _0x5d845c(), _0x47e097(), document[_0x161fc2(0x2c0)](_0x161fc2(0x79b))['value'] = '', _0x24ae96['pendingPostAttachments'][_0x161fc2(0x650)] = null, _0x24ae96[_0x161fc2(0x101)][_0x161fc2(0x457)] = null, _0x24ae96[_0x161fc2(0x101)]['imageId'] = null, _0x4296d7(), _0x4c6ce4(_0x83d38c); } }), document[_0x113cd8(0x2c0)](_0x113cd8(0x2e4))['addEventListener']('click', () => { const _0x1e5f7e = _0x113cd8; document[_0x1e5f7e(0x2c0)]('user-post-image-input')[_0x1e5f7e(0x472)](); }), document[_0x113cd8(0x2c0)](_0x113cd8(0x562))[_0x113cd8(0x41c)](_0x113cd8(0x356), async _0x2bdd20 => { const _0x33787c = _0x113cd8, _0x5b1810 = _0x2bdd20['target'][_0x33787c(0x37b)][0x0]; if (!_0x5b1810) return; try { const _0x30a6a4 = await _0xf3c4dd(_0x5b1810, 0x320, 0.8, !![]), _0x179019 = _0x33787c(0x5b1) + Date[_0x33787c(0x695)](); await _0x24ee21(_0x179019, _0x30a6a4), _0x24ae96[_0x33787c(0x101)]['imageId'] = _0x179019, _0x24ae96[_0x33787c(0x101)][_0x33787c(0x650)] = null, _0x24ae96['pendingPostAttachments']['music'] = null, _0x4296d7(); } catch (_0xb3c250) { _0x880caf('图片处理失败:\x20' + _0xb3c250['message']); } _0x2bdd20[_0x33787c(0x5b9)][_0x33787c(0x69f)] = ''; }), document['getElementById'](_0x113cd8(0x76c))[_0x113cd8(0x41c)](_0x113cd8(0x472), async () => { const _0x4b787b = _0x113cd8; if ('nrCbc' === _0x4b787b(0x6b3)) { const _0x554c17 = await _0x3f496e(); if (!_0x554c17) return; _0x880caf(_0x4b787b(0x3e4)); try { if (_0x4b787b(0x41f) !== _0x4b787b(0x41f)) { _0x5e7042(); const _0x1ab723 = (_0x4453f7['apiSettings']['endpoint'] || '')[_0x4b787b(0x4e4)](_0x278710); _0x1233c7[_0x4b787b(0x38d)] = _0x1ab723, _0x5b5514(_0x4b787b(0x19d), _0x4b787b(0x540)); } else { const _0x5029eb = await _0x1f04ab(_0x554c17[_0x4b787b(0x805)], _0x554c17[_0x4b787b(0x623)]); _0x24ae96['pendingPostAttachments']['music'] = { 'songName': _0x554c17['songName'], 'artist': _0x554c17[_0x4b787b(0x623)], 'coverUrl': _0x5029eb[_0x4b787b(0x1f5)], 'playableUrl': _0x5029eb['url'] }, _0x24ae96[_0x4b787b(0x101)]['image'] = null, _0x4296d7(); } } catch (_0x5e6c60) { _0x880caf(_0x4b787b(0x66f) + _0x5e6c60[_0x4b787b(0x2ec)]); } } else _0x48fd66 = _0x282a00[_0x4b787b(0x650)]; }); function _0x438b22() { const _0x380fe1 = _0x113cd8; if (_0x380fe1(0x26e) === _0x380fe1(0x766)) _0x11e676[_0x380fe1(0x265)](_0x383c23, _0x3f7a1a[_0x380fe1(0x11c)]); else { const _0x4c2820 = new Date(), _0x2a565f = document[_0x380fe1(0x2c0)](_0x380fe1(0x191)), _0x4c5864 = document['getElementById'](_0x380fe1(0x334)); if (_0x2a565f && _0x4c5864) { if (_0x380fe1(0x656) !== _0x380fe1(0x339)) { const _0x2824c8 = String(_0x4c2820[_0x380fe1(0xff)]())[_0x380fe1(0xfe)](0x2, '0'), _0xab6246 = String(_0x4c2820[_0x380fe1(0x37e)]())['padStart'](0x2, '0'); _0x2a565f['textContent'] = _0x2824c8 + ':' + _0xab6246; const _0xf17629 = _0x4c2820[_0x380fe1(0x5bf)]() + 0x1, _0x1aa890 = _0x4c2820['getDate'](), _0x3e0246 = ['星期日', '星期一', _0x380fe1(0xcc), _0x380fe1(0x257), _0x380fe1(0x295), _0x380fe1(0x453), _0x380fe1(0x327)][_0x4c2820[_0x380fe1(0x2b4)]()]; _0x4c5864['textContent'] = _0xf17629 + '月' + _0x1aa890 + '日\x20' + _0x3e0246; } else _0x345522(), _0x6309aa(_0x380fe1(0x22f), _0x380fe1(0x540)); } } } function _0x40671a(_0x27045a) { const _0x5e893b = _0x113cd8; if (!_0x27045a) return ''; const _0x2bf5d9 = new Date(_0x27045a), _0x241cec = String(_0x2bf5d9['getHours']())[_0x5e893b(0xfe)](0x2, '0'), _0x16e8a7 = String(_0x2bf5d9[_0x5e893b(0x37e)]())[_0x5e893b(0xfe)](0x2, '0'); return _0x241cec + ':' + _0x16e8a7; } function _0x4e95be() { const _0x154efa = _0x113cd8, _0x542d78 = _0x24ae96[_0x154efa(0x7ce)]['find'](_0xbdb23 => _0xbdb23['id'] === _0x24ae96[_0x154efa(0x4fb)]), _0x215212 = _0x542d78 ? _0x542d78['posts'] : []; if (!_0x215212 || _0x215212[_0x154efa(0x256)] === 0x0) return ''; const _0x39af70 = _0x215212['slice'](0x0, 0x5), _0x2316c2 = _0x39af70['map'](_0x1dee8d => { const _0x2e4211 = _0x154efa; if ('hTHQH' !== _0x2e4211(0x7e6)) { const _0x14bd92 = _0x5c4526(_0x1dee8d['authorId']) || { 'name': '未知' }; let _0x1b4c6b = _0x2e4211(0x5b5) + _0x14bd92[_0x2e4211(0x7e5)] + _0x2e4211(0x68a) + (_0x1dee8d[_0x2e4211(0x143)] || _0x1dee8d[_0x2e4211(0x77b)]) + '”'; return _0x1dee8d['type'] === _0x2e4211(0x457) && ('FGpqS' !== 'FGpqS' ? _0xf80b02 = _0x5e201b[_0x2e4211(0x590)][0x0] : _0x1b4c6b += _0x2e4211(0x5ce) + _0x1dee8d[_0x2e4211(0x805)] + _0x2e4211(0x7ef) + _0x1dee8d[_0x2e4211(0x623)] + ')'), _0x1b4c6b; } else _0xd213ca[_0x2e4211(0xdc)] = _0x108836['userProfiles'], _0xb7a525[_0x2e4211(0x4b7)] = _0x3722b6[_0x2e4211(0x4b7)]; }); return _0x154efa(0x70e) + _0x2316c2['join']('\x0a'); } function _0x118a24(_0x591b81) { const _0x4c46c3 = _0x113cd8; if ('ZJiNZ' === _0x4c46c3(0x2cd)) { const _0x916274 = _0x24ae96['userProfiles'][_0x4c46c3(0x1c6)](_0x5139c0 => _0x5139c0['id'] === _0x24ae96[_0x4c46c3(0x4b7)]) || { 'name': '你' }, _0x44c350 = _0x24ae96['diaries']['find'](_0x2403f7 => _0x2403f7[_0x4c46c3(0x5f9)] === _0x591b81); if (!_0x44c350 || !_0x44c350['entries'] || _0x44c350[_0x4c46c3(0x62d)][_0x4c46c3(0x256)] === 0x0) return ''; const _0xb946a8 = _0x44c350[_0x4c46c3(0x62d)][_0x4c46c3(0x3a3)](-0x8), _0x59ea43 = _0xb946a8[_0x4c46c3(0x6dd)](_0x28b580 => { const _0x56a9f0 = _0x4c46c3, _0x4fcc41 = _0x28b580[_0x56a9f0(0x676)] === 'user' ? _0x916274[_0x56a9f0(0x7e5)] : _0x5c4526(_0x28b580[_0x56a9f0(0x676)])[_0x56a9f0(0x7e5)]; return _0x56a9f0(0x402) + new Date(_0x28b580[_0x56a9f0(0x808)])[_0x56a9f0(0x75c)]() + ']\x20' + _0x4fcc41 + _0x56a9f0(0x7cd) + _0x28b580['content']; })[_0x4c46c3(0x799)]('\x0a'); return '\x0a#\x20交换日记摘要\x20(你和\x20' + _0x916274[_0x4c46c3(0x7e5)] + _0x4c46c3(0x65d) + _0x59ea43; } else _0xabe6a5[_0x4c46c3(0x610)][_0x4c46c3(0x6a6)] = _0x4c46c3(0x27e) + _0x218de5[_0x4c46c3(0x463)] + '\x27)', _0x1659fe[_0x4c46c3(0x610)]['backgroundSize'] = _0x4c46c3(0x1f5), _0x5c9110[_0x4c46c3(0x610)][_0x4c46c3(0x813)] = _0x4c46c3(0x640); } function _0x21b648() { const _0x7436d = _0x113cd8; if (_0x7436d(0x7bf) !== _0x7436d(0x473)) { const _0xfbdd42 = document[_0x7436d(0x2c0)](_0x7436d(0x6c8)), _0xf6063a = _0x24ae96['preferences']['widgetBgImage']; _0xf6063a ? _0x7436d(0x319) !== _0x7436d(0x152) ? (_0xfbdd42[_0x7436d(0x610)][_0x7436d(0x6a6)] = _0x7436d(0x7d7) + _0xf6063a + ')', _0xfbdd42[_0x7436d(0x610)][_0x7436d(0x15d)] = _0x7436d(0x1f5), _0xfbdd42[_0x7436d(0x610)][_0x7436d(0x813)] = _0x7436d(0x640), _0xfbdd42[_0x7436d(0x610)][_0x7436d(0x1c3)] = _0x7436d(0x199), _0xfbdd42[_0x7436d(0x439)](_0x7436d(0x488))['forEach'](_0x5bfe0a => { const _0x17b4df = _0x7436d; _0x17b4df(0x754) !== _0x17b4df(0x754) ? _0x24c80a[_0x17b4df(0xd4)] = _0x315ef2 ? _0x57a714[_0x17b4df(0x6c9)](_0x206bef) : _0x356163 : _0x5bfe0a[_0x17b4df(0x610)][_0x17b4df(0x651)] = _0x17b4df(0x39c); })) : _0x5e84af['classList'][_0x7436d(0x28c)](_0x7436d(0x30b)) : _0x7436d(0x4cc) === _0x7436d(0x4cc) ? (_0xfbdd42[_0x7436d(0x610)]['backgroundImage'] = '', _0xfbdd42[_0x7436d(0x610)][_0x7436d(0x1c3)] = '', _0xfbdd42[_0x7436d(0x439)](_0x7436d(0x488))[_0x7436d(0x203)](_0x599e5c => { const _0x156eae = _0x7436d; _0x599e5c[_0x156eae(0x610)]['textShadow'] = ''; })) : (_0x38b73d[_0x7436d(0xd4)] = _0x3dbf86[_0x7436d(0x375)], _0x6b37d5[_0x7436d(0x5d3)](), _0x5e5463['querySelector'](_0x7436d(0x5ad))['textContent'] = '❚❚'); } else _0x57c37c += '-\x20**对话状态提示**:\x20你们已经超过两天没联系了，应该用全新的问候开启对话。\x0a'; } const _0x162fcf = document[_0x113cd8(0x2c0)](_0x113cd8(0x4ec)), _0x7d7dc3 = document['getElementById'](_0x113cd8(0x23c)); _0x162fcf[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { _0x3833d6(), _0x124c6c('friendCircleList', 'home'); }), _0x7d7dc3[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x14311b = _0x113cd8; _0x35e10a(), _0x124c6c(_0x14311b(0x663), 'home'); }), document[_0x113cd8(0x2c0)](_0x113cd8(0x56d))[_0x113cd8(0x41c)]('click', () => { const _0x49c724 = _0x113cd8; _0x124c6c(_0x49c724(0x540), _0x49c724(0x663)); }), document['getElementById']('back-to-meeting-list')[_0x113cd8(0x41c)]('click', () => { const _0x442252 = _0x113cd8; if (_0x442252(0x36a) === _0x442252(0x5e0)) _0x43521a[_0x442252(0x38d)] = ![]; else { if (_0xa90228) clearInterval(_0xa90228); _0xa90228 = null, _0x24ae96[_0x442252(0x7f7)] = [], _0x24ae96[_0x442252(0x3ae)] = null, _0x24ae96[_0x442252(0x192)] = null, _0x5d845c(), _0x124c6c('meetingList', 'meetingView'); } }); const _0x327cfc = document[_0x113cd8(0x2c0)]('meeting-message-input'), _0x3db019 = document[_0x113cd8(0x2c0)]('meeting-send-button'); _0x3db019[_0x113cd8(0x41c)]('click', () => { const _0xbee222 = _0x113cd8; if ('BHYYi' !== 'bisLW') { const _0x5e1076 = _0x327cfc[_0xbee222(0x69f)][_0xbee222(0x529)](); _0x5e1076 && (_0x57a3ef(_0x5e1076), _0x327cfc[_0xbee222(0x69f)] = '', setTimeout(_0x327f12, 0x64)); } else { _0x4293f1['warn']('Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.'); const _0x5f4cec = _0x7256c6[_0xbee222(0x590)][_0xbee222(0x6dd)](_0x564c35)[_0xbee222(0x3ea)](_0x6d649b); if (!_0x5f4cec[_0xbee222(0x256)]) return; let _0x363a73 = 0x0; for (const _0x168d0e of _0x5f4cec) { _0x131247(_0x168d0e, { 'force': !![], 'delayMs': _0x363a73 }), _0x363a73 += 0x1f4; } } }); function _0x366a1e(_0xb29332, _0xbdbf37) { const _0x29b5a9 = _0x113cd8, _0x4a21b6 = document[_0x29b5a9(0x2c0)]('audio-player'), _0x289441 = document[_0x29b5a9(0x439)](_0x29b5a9(0x5ad)); _0x289441[_0x29b5a9(0x203)](_0x4d0e30 => { const _0x366cbc = _0x29b5a9; _0x4d0e30 !== _0xb29332[_0x366cbc(0x437)]('.music-post-play-icon,\x20.music-share-play-icon') && (_0x4d0e30[_0x366cbc(0x548)] = '▶'); }), _0x4a21b6[_0x29b5a9(0xd4)] === _0xbdbf37['url'] && !_0x4a21b6[_0x29b5a9(0x6a7)] ? (_0x4a21b6['pause'](), _0xb29332[_0x29b5a9(0x437)](_0x29b5a9(0x5ad))[_0x29b5a9(0x548)] = '▶') : (_0x4a21b6[_0x29b5a9(0xd4)] = _0xbdbf37[_0x29b5a9(0x375)], _0x4a21b6[_0x29b5a9(0x5d3)](), _0xb29332[_0x29b5a9(0x437)](_0x29b5a9(0x5ad))[_0x29b5a9(0x548)] = '❚❚'); } const _0x5a8c8a = document[_0x113cd8(0x2c0)](_0x113cd8(0x4a7)); async function _0x5456b8(_0x5b1418) { const _0x2fa327 = _0x113cd8; if (!_0x5b1418 || !_0x5b1418[_0x2fa327(0x5ec)]('http')) return ![]; return new Promise(_0x1f60b5 => { const _0x503b42 = _0x2fa327, _0x4c27a1 = document[_0x503b42(0x2b5)](_0x503b42(0x5ba)); _0x4c27a1['src'] = _0x5b1418; const _0xd8e587 = setTimeout(() => { _0x496f09(), _0x1f60b5(![]); }, 0xbb8), _0x496f09 = () => { const _0xd7877c = _0x503b42; if (_0xd7877c(0x66b) === _0xd7877c(0x6a2)) return _0x19b62f(_0x4fa784)[_0xd7877c(0x73a)](_0x298f5b => _0x298f5b['blob']()); else clearTimeout(_0xd8e587), _0x4c27a1[_0xd7877c(0x382)](_0xd7877c(0x746), _0x44b352), _0x4c27a1[_0xd7877c(0x382)](_0xd7877c(0x40f), _0x3216e0), _0x4c27a1[_0xd7877c(0xd4)] = '', _0x4c27a1[_0xd7877c(0x28c)](); }, _0x44b352 = () => { _0x496f09(), _0x1f60b5(!![]); }, _0x3216e0 = () => { _0x496f09(), _0x1f60b5(![]); }; _0x4c27a1[_0x503b42(0x41c)](_0x503b42(0x746), _0x44b352), _0x4c27a1['addEventListener'](_0x503b42(0x40f), _0x3216e0); }); } async function _0x1f04ab(_0x1df1e0, _0x183470) { const _0x193ae7 = _0x113cd8, _0x29d770 = [_0x193ae7(0x4ae), _0x193ae7(0x822)]; for (const _0x34fe07 of _0x29d770) { try { const _0x423c8b = _0x193ae7(0x521) + _0x34fe07 + _0x193ae7(0x345) + encodeURIComponent(_0x1df1e0) + '-' + encodeURIComponent(_0x183470), _0x4a5d02 = await fetch(_0x423c8b), _0x5bd519 = await _0x4a5d02[_0x193ae7(0x49a)](); if (_0x5bd519[_0x193ae7(0x5d2)] !== 0xc8 || !_0x5bd519[_0x193ae7(0x504)] || _0x5bd519['data'][_0x193ae7(0x256)] === 0x0) continue; const _0x4fd8e6 = _0x5bd519[_0x193ae7(0x504)][_0x193ae7(0x3a3)](0x0, 0x5); for (const _0x3cdcbc of _0x4fd8e6) { if (_0x193ae7(0x479) === _0x193ae7(0x5e2)) _0x56b7b7['image'] = _0x3aa0f7; else { const _0x48c72a = 'https://api.vkeys.cn/v2/music/' + _0x34fe07 + '?id=' + _0x3cdcbc['id'], _0x557cb1 = await fetch(_0x48c72a), _0x496a80 = await _0x557cb1[_0x193ae7(0x49a)](), _0x4b495a = _0x496a80[_0x193ae7(0x504)]?.['url']; if (await _0x5456b8(_0x4b495a)) return { 'url': _0x4b495a, 'cover': _0x3cdcbc[_0x193ae7(0x1f5)], 'source': _0x34fe07 }; } } } catch (_0x354421) { 'BGEWg' === _0x193ae7(0xee) ? console[_0x193ae7(0x40f)](_0x193ae7(0x5e3) + _0x34fe07 + ':', _0x354421) : _0x2342a2(_0x45bf55[_0x193ae7(0x7bd)](_0x5455d5, _0x422a45)); } } return { 'url': null, 'cover': null, 'source': null }; } function _0x32d7bf(_0x308075) { const _0xd7f0c4 = _0x113cd8; try { const _0x2d76da = JSON[_0xd7f0c4(0x458)](localStorage['getItem'](_0xd7f0c4(0x163)) || '{}'), _0x3eb38e = { ..._0x2d76da, ..._0x308075 }; localStorage[_0xd7f0c4(0x515)](_0xd7f0c4(0x163), JSON['stringify'](_0x3eb38e)); } catch (_0x141602) { console[_0xd7f0c4(0x40f)](_0xd7f0c4(0x683), _0x141602); } } async function _0xd10ddd() { const _0x49885a = _0x113cd8, _0x305894 = document[_0x49885a(0x2c0)](_0x49885a(0x281)), _0x1c193a = document[_0x49885a(0x2c0)](_0x49885a(0x31f)); try { let _0x16eece = await _0x5aea9f(_0x49885a(0x429)); if (!_0x16eece) { if ('rtLiN' === _0x49885a(0x38b)) { const _0x56018b = JSON['parse'](localStorage[_0x49885a(0x696)](_0x49885a(0x163)) || '{}'); _0x56018b[_0x49885a(0x650)] && (console[_0x49885a(0x72f)](_0x49885a(0x448)), _0x16eece = await _0x4366c2(_0x56018b['image']), await _0x24ee21(_0x49885a(0x429), _0x16eece)); } else _0x4cc53f(), _0x1e8db3(!![]); } _0x16eece ? (_0x1c193a[_0x49885a(0xd4)] = URL['createObjectURL'](_0x16eece), _0x305894[_0x49885a(0x610)][_0x49885a(0x452)] = _0x49885a(0x3fb)) : _0x49885a(0x4f4) !== 'qgwXU' ? _0x33f1aa(_0x49885a(0x304) + _0x584749['message'] + _0x49885a(0x52b)) : _0x305894['style']['display'] = _0x49885a(0x3fb); } catch (_0x639302) { 'XNLpc' === _0x49885a(0x4e5) ? console[_0x49885a(0x40f)](_0x49885a(0x21b), _0x639302) : _0x1748a3[_0x49885a(0x60b)]({ 'time': _0xae680e, 'text': _0x4cb1df }); } } function _0xafe5df(_0x4841d3) { const _0x236a39 = _0x113cd8; if (_0x236a39(0x29d) === 'XIpBn') { const _0x5573af = _0x1bd047[_0x236a39(0x5bb)][_0x236a39(0x3ea)](_0x1d01fd => _0x1d01fd[_0x236a39(0x776)] === 'music' && _0x1d01fd[_0x236a39(0x4b2)])[_0x236a39(0x6dd)](_0x50731b => ({ ..._0x50731b, 'source': 'chat' })); _0xfdca0[_0x236a39(0x60b)](..._0x5573af); } else try { const _0x3fa2b6 = JSON[_0x236a39(0x458)](localStorage['getItem'](_0x236a39(0x116)) || '{}'), _0x59d6de = { ..._0x3fa2b6, ..._0x4841d3 }; localStorage['setItem'](_0x236a39(0x116), JSON[_0x236a39(0x3fd)](_0x59d6de)); } catch (_0x3ec225) { console[_0x236a39(0x40f)](_0x236a39(0x390), _0x3ec225); } } async function _0x3bc958() { const _0x582e46 = _0x113cd8, _0x532bdf = document['getElementById'](_0x582e46(0x21d)), _0x16f825 = document['getElementById']('card-image'); try { let _0x332733 = await _0x5aea9f(_0x582e46(0x3b0)); if (!_0x332733) { if (_0x582e46(0x53a) !== 'lYkyo') { const _0x28daac = JSON['parse'](localStorage['getItem'](_0x582e46(0x116)) || '{}'); if (_0x28daac[_0x582e46(0x650)]) { if (_0x582e46(0x17a) === _0x582e46(0x244)) { const _0xd2f265 = _0x454878[_0x582e46(0x2b5)]('div'); _0xd2f265[_0x582e46(0x38a)] = _0x582e46(0x41a), _0xd2f265[_0x582e46(0x362)]['id'] = _0x5eb575['id']; const _0xf9ba77 = _0x27e757['id'] === _0x46b7b5['activeUserProfileId'] ? _0x582e46(0x797) : ''; _0xd2f265[_0x582e46(0x217)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x2c3b31[_0x582e46(0x37c)] || _0x3daff2) + _0x582e46(0x2a3) + _0x53096d['name'] + _0xf9ba77 + _0x582e46(0x3fe) + _0x11ffde['persona'][_0x582e46(0x3ad)](0x0, 0x64) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0xd2f265[_0x582e46(0x41c)]('click', () => _0x485b38(_0x55b0f1['id'])), _0x19af5d[_0x582e46(0x3b1)](_0xd2f265); } else console['log']('正在搬运旧卡片...'), _0x332733 = await _0x4366c2(_0x28daac[_0x582e46(0x650)]), await _0x24ee21(_0x582e46(0x3b0), _0x332733); } } else _0x1f9736(); } _0x332733 ? (_0x16f825[_0x582e46(0xd4)] = URL['createObjectURL'](_0x332733), _0x532bdf[_0x582e46(0x610)][_0x582e46(0x452)] = _0x582e46(0x3fb)) : _0x532bdf[_0x582e46(0x610)][_0x582e46(0x452)] = _0x582e46(0x3fb); } catch (_0xb14c8b) { console[_0x582e46(0x40f)](_0x582e46(0x383), _0xb14c8b); } } _0x44ad80[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x3ee4a9 = _0x113cd8; _0x11711a(), _0x124c6c(_0x3ee4a9(0x179), _0x3ee4a9(0x540)); }), document['getElementById'](_0x113cd8(0x582))[_0x113cd8(0x41c)]('click', () => _0x124c6c(_0x113cd8(0x540), _0x113cd8(0x179))), document[_0x113cd8(0x2c0)](_0x113cd8(0x702))[_0x113cd8(0x41c)](_0x113cd8(0x472), () => _0x2b64b7()), document[_0x113cd8(0x2c0)](_0x113cd8(0x37a))[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x55685a = _0x113cd8; if (_0x55685a(0x239) !== 'kGAVD') _0x11711a(), _0x124c6c(_0x55685a(0x179), _0x55685a(0x7ff)); else { if (_0x595097) _0x25db4d(_0x2c679e); if (_0x5bd85b[_0x55685a(0x592)]) return; _0x3b4ddc(() => { const _0x103fc0 = _0x55685a; _0x24012b && _0x3509d1(_0x3f57f1['id'], _0x402b88[_0x103fc0(0x6dd)](_0x32c04a => _0x32c04a['id'])); }, 0x32); } }), document[_0x113cd8(0x2c0)](_0x113cd8(0x166))[_0x113cd8(0x41c)](_0x113cd8(0x472), _0xf905b5), document['getElementById'](_0x113cd8(0x322))[_0x113cd8(0x41c)]('click', _0x4fbe33), document[_0x113cd8(0x2c0)](_0x113cd8(0x82f))[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0xf9baf0 = _0x113cd8, _0x35d94e = document[_0xf9baf0(0x2c0)](_0xf9baf0(0x4d3))[_0xf9baf0(0x69f)]; _0x35d94e && (_0x24ae96[_0xf9baf0(0x4b7)] = _0x35d94e, _0x5d845c(), _0x880caf(_0xf9baf0(0x424)), _0x11711a(), document[_0xf9baf0(0x2c0)](_0xf9baf0(0x82f))[_0xf9baf0(0x610)]['display'] = 'none'); }); function _0xb7cda(_0x1cf8b5) { const _0x54889f = _0x113cd8, _0x4d4a2b = _0x24ae96[_0x54889f(0x2e2)]['find'](_0x48b2a2 => _0x48b2a2['id'] === _0x1cf8b5), _0xff5a58 = _0x4d4a2b?.['boundUserProfileId']; let _0x2c4860 = _0x24ae96[_0x54889f(0xdc)][_0x54889f(0x1c6)](_0x48e71a => _0x48e71a['id'] === _0xff5a58); return !_0x2c4860 && (_0x2c4860 = _0x24ae96[_0x54889f(0xdc)][_0x54889f(0x1c6)](_0xb79d20 => _0xb79d20['id'] === _0x24ae96[_0x54889f(0x4b7)]) || _0x24ae96[_0x54889f(0xdc)][0x0]), _0x2c4860 || { 'name': '用户', 'avatar': _0x4be95c, 'persona': '' }; } function _0x34ed18(_0x24184d) { const _0x2a278e = _0x113cd8, _0x430126 = document[_0x2a278e(0x2c0)](_0x24184d); _0x430126[_0x2a278e(0x217)] = '', _0x24ae96[_0x2a278e(0xdc)]['forEach'](_0x325fa6 => { const _0x221bea = _0x2a278e, _0x37223c = document[_0x221bea(0x2b5)](_0x221bea(0x12a)); _0x37223c[_0x221bea(0x69f)] = _0x325fa6['id'], _0x37223c[_0x221bea(0x548)] = _0x325fa6[_0x221bea(0x7e5)], _0x430126[_0x221bea(0x3b1)](_0x37223c); }); } function _0x5a9701(_0x5af6ac) { const _0x47d3a8 = _0x113cd8, _0x3ed456 = _0x5c4526(_0x5af6ac), _0x4189d3 = document['getElementById']('chat-view-pane'); _0x4189d3['style']['backgroundImage'] = ''; let _0x52486a = document[_0x47d3a8(0x2c0)](_0x47d3a8(0x509) + _0x5af6ac); if (_0x52486a) _0x52486a[_0x47d3a8(0x217)] = ''; if (!_0x3ed456) return; if (_0x3ed456[_0x47d3a8(0x463)]) { if (_0x47d3a8(0x400) !== _0x47d3a8(0x400)) { const { playlist: _0x5b792f, currentIndex: _0x35af43 } = _0xa726fc[_0x47d3a8(0x458)](_0x518971); _0x598175[_0x47d3a8(0x2d0)](_0x5b792f) && _0x5b792f[_0x47d3a8(0x256)] > 0x0 && _0x35af43 > -0x1 && (_0x4bd2b9[_0x47d3a8(0x511)] = _0x5b792f, _0x278c9b[_0x47d3a8(0x218)] = _0x35af43, _0x440bbb[_0x47d3a8(0x612)] = ![], _0xa7f7eb()); } else _0x4189d3['style'][_0x47d3a8(0x6a6)] = _0x47d3a8(0x27e) + _0x3ed456['chatWallpaper'] + '\x27)', _0x4189d3[_0x47d3a8(0x610)][_0x47d3a8(0x15d)] = _0x47d3a8(0x1f5), _0x4189d3[_0x47d3a8(0x610)][_0x47d3a8(0x813)] = 'center'; } if (_0x3ed456[_0x47d3a8(0x2b9)]) { let _0xb9cfbe = document[_0x47d3a8(0x2c0)](_0x47d3a8(0x509) + _0x3ed456['id']); !_0xb9cfbe && (_0x47d3a8(0x785) === 'pdlER' ? (_0x6e21d3[_0x47d3a8(0x72f)](_0x47d3a8(0x1de)), _0x1ddb49[_0x47d3a8(0x2e2)] = _0x242711[_0x47d3a8(0x4c0)][_0x47d3a8(0x6dd)](_0x4a4af6 => ({ 'id': _0x47d3a8(0x645) + _0x4a4af6['id'], 'type': _0x47d3a8(0x62a), 'participantIds': [_0x4a4af6['id']] })), _0x39e30a[_0x47d3a8(0xc6)] && (_0x309be6[_0x47d3a8(0x192)] = 'chat_' + _0x376a1a[_0x47d3a8(0xc6)]), _0x4ddcee[_0x47d3a8(0x4c0)][_0x47d3a8(0x203)](_0x92fcfa => { const _0x3d7c51 = _0x47d3a8, _0x3c6c0e = 'chatHistory_' + _0x92fcfa['id'], _0x4ed84a = 'chatHistory_chat_' + _0x92fcfa['id'], _0x1d33be = _0x166aa8[_0x3d7c51(0x696)](_0x3c6c0e); _0x1d33be && (_0xa7f4a4[_0x3d7c51(0x515)](_0x4ed84a, _0x1d33be), _0x3f9f4d[_0x3d7c51(0x6a8)](_0x3c6c0e)); })) : (_0xb9cfbe = document['createElement'](_0x47d3a8(0x610)), _0xb9cfbe['id'] = _0x47d3a8(0x509) + _0x3ed456['id'], document[_0x47d3a8(0x52a)][_0x47d3a8(0x3b1)](_0xb9cfbe))); const _0x192992 = _0x3ed456[_0x47d3a8(0x2b9)], _0x5bf941 = _0x192992['replace'](/\.bubble\.sent/g, _0x47d3a8(0x469) + _0x3ed456['id'] + _0x47d3a8(0x7e3))[_0x47d3a8(0xef)](/\.bubble\.received/g, _0x47d3a8(0x469) + _0x3ed456['id'] + _0x47d3a8(0x523)); _0xb9cfbe[_0x47d3a8(0x217)] = _0x5bf941; } } function _0x4296d7() { const _0x668c32 = _0x113cd8, _0x5c3a9f = document['getElementById'](_0x668c32(0x76f)); _0x5c3a9f[_0x668c32(0x217)] = ''; const _0x367b59 = _0x17ea86 => { const _0x458f11 = _0x668c32; _0x24ae96['pendingPostAttachments'][_0x17ea86] = null; if (_0x17ea86 === 'image') _0x24ae96[_0x458f11(0x101)][_0x458f11(0x470)] = null; _0x4296d7(); }, _0x31f845 = _0x24ae96[_0x668c32(0x101)][_0x668c32(0x470)], _0x302bca = _0x24ae96[_0x668c32(0x101)][_0x668c32(0x457)]; if (_0x31f845) { const _0x41c2f2 = document[_0x668c32(0x2b5)]('div'); _0x41c2f2[_0x668c32(0x38a)] = _0x668c32(0x119), _0x41c2f2[_0x668c32(0x217)] = _0x668c32(0x3e3), _0x41c2f2[_0x668c32(0x437)](_0x668c32(0x687))['onclick'] = () => _0x367b59(_0x668c32(0x650)), _0x5c3a9f[_0x668c32(0x3b1)](_0x41c2f2), _0x5aea9f(_0x31f845)[_0x668c32(0x73a)](_0x549e28 => { const _0xe5b9f0 = _0x668c32; if (_0xe5b9f0(0x503) === _0xe5b9f0(0x7cf)) return; else { const _0x3811a8 = document[_0xe5b9f0(0x2c0)](_0xe5b9f0(0x739)); _0x3811a8 && _0x549e28 && (_0x3811a8[_0xe5b9f0(0xd4)] = URL[_0xe5b9f0(0x6c9)](_0x549e28)); } }); } if (_0x302bca) { if (_0x668c32(0x388) === 'wuevS') _0x284107 = { 'speaker': _0x216a31[_0x668c32(0x7e5)], 'line': _0x3491b1[_0x668c32(0x77b)], 'emotion': 'normal' }; else { const _0x21d6c2 = document[_0x668c32(0x2b5)](_0x668c32(0x6ee)); _0x21d6c2[_0x668c32(0x38a)] = _0x668c32(0x119), _0x21d6c2[_0x668c32(0x217)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x302bca['coverUrl'] || _0x5d2cd8) + _0x668c32(0x669) + _0x302bca[_0x668c32(0x805)] + _0x668c32(0x7a1) + _0x302bca[_0x668c32(0x623)] + _0x668c32(0x2d5), _0x21d6c2[_0x668c32(0x437)](_0x668c32(0x687))[_0x668c32(0x2c4)] = () => _0x367b59(_0x668c32(0x457)), _0x5c3a9f[_0x668c32(0x3b1)](_0x21d6c2); } } } async function _0x4c6ce4(_0xb6639d) { const _0x5d84ee = _0x113cd8, _0x26d5a3 = _0x24ae96[_0x5d84ee(0x7ce)][_0x5d84ee(0x1c6)](_0x2240b5 => _0x2240b5['id'] === _0x24ae96[_0x5d84ee(0x4fb)]); if (!_0x26d5a3) return; _0x541a9b(!![], _0x5d84ee(0x26b)), _0x24ae96[_0x5d84ee(0x3c6)] = !![]; try { if (_0x5d84ee(0x709) === 'YSQdS') { const _0x5750ed = _0x26d5a3['memberCharacterIds'][_0x5d84ee(0x6dd)](_0x144b65 => _0x5c4526(_0x144b65))[_0x5d84ee(0x3ea)](Boolean), _0x154ee4 = _0x4e95be(), _0x46ba17 = _0x5750ed['map'](_0x443cdf => { const _0x40f161 = _0x5d84ee, { omniText: _0x3620fc } = _0x5bd842(_0x443cdf['id'], null), _0x4b3ed3 = _0x118a24(_0x443cdf['id']), _0x4481ae = _0x443cdf['linkedWorldBookIds'] && _0x443cdf['linkedWorldBookIds'][_0x40f161(0x256)] > 0x0 ? _0x40f161(0x385) + _0x443cdf[_0x40f161(0x7e5)] + _0x40f161(0x421) + _0x443cdf[_0x40f161(0x106)][_0x40f161(0x6dd)](_0x51587e => _0x24ae96[_0x40f161(0x496)]['find'](_0x149e55 => _0x149e55['id'] === _0x51587e))[_0x40f161(0x3ea)](Boolean)[_0x40f161(0x6dd)](_0x11d43d => _0x40f161(0x308) + _0x11d43d[_0x40f161(0x7e5)] + '\x0a' + _0x11d43d[_0x40f161(0x77b)])['join']('') : ''; return _0x40f161(0x5fa) + _0x443cdf['name'] + _0x40f161(0x69c) + _0x443cdf['id'] + _0x40f161(0xf5) + _0x443cdf[_0x40f161(0x791)] + _0x40f161(0x512) + _0x3620fc + '\x0a' + _0x4b3ed3 + '\x0a' + _0x4481ae; })[_0x5d84ee(0x799)]('\x0a\x0a'), _0x2fa38a = _0x42772a(_0xb6639d['authorId']) || { 'name': '用户' }, _0x4c2e8e = _0x2fa38a[_0x5d84ee(0x791)] ? _0x5d84ee(0x2bb) + _0x2fa38a['name'] + _0x5d84ee(0x71b) + _0x2fa38a[_0x5d84ee(0x791)] + '\x0a' : ''; let _0x1977bc = null; if (_0xb6639d[_0x5d84ee(0x650)]) _0x5d84ee(0xe7) !== _0x5d84ee(0x415) ? _0x1977bc = _0xb6639d[_0x5d84ee(0x650)] : _0x4ae8c7['src'] = _0x59e7b3['createObjectURL'](_0x2bccf2); else { if (_0xb6639d['imageId']) { if ('UugBW' === _0x5d84ee(0x3d4)) try { const _0x217de8 = await _0x5aea9f(_0xb6639d[_0x5d84ee(0x470)]); if (_0x217de8) { if ('befDv' !== _0x5d84ee(0x4f0)) { if (!_0x5c870a) return []; const _0x367694 = _0x4dcbe0['split']('\x0a'), _0x53995e = [], _0x4f3d89 = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x494eba of _0x367694) { const _0x522c8c = _0x494eba['match'](_0x4f3d89); if (_0x522c8c) { const _0x467a65 = _0x5aee08(_0x522c8c[0x1], 0xa), _0x5b84fb = _0x5c8c64(_0x522c8c[0x2], 0xa), _0x48fada = _0x2ad8c0(_0x522c8c[0x3], 0xa) * (_0x522c8c[0x3]['length'] === 0x2 ? 0xa : 0x1), _0x2070e9 = _0x467a65 * 0x3c + _0x5b84fb + _0x48fada / 0x3e8, _0x4e3b04 = _0x494eba[_0x5d84ee(0xef)](_0x4f3d89, '')[_0x5d84ee(0x529)](); _0x4e3b04 && _0x53995e[_0x5d84ee(0x60b)]({ 'time': _0x2070e9, 'text': _0x4e3b04 }); } } return _0x53995e; } else _0x1977bc = await _0x2e73e7(_0x217de8); } } catch (_0x5d4796) { console[_0x5d84ee(0x40f)]('在准备动态回复时，读取图片失败:', _0x5d4796); } else { const _0x354d3d = _0x35b1fe[_0x5d84ee(0x2b5)]('div'); _0x354d3d[_0x5d84ee(0x38a)] = _0x5d84ee(0x7a7); const _0x35b2ab = _0x424f01[_0x5d84ee(0x2b5)](_0x5d84ee(0x6ee)); _0x35b2ab[_0x5d84ee(0x38a)] = _0x5d84ee(0x5bc), _0x35b2ab[_0x5d84ee(0x548)] = _0x103079[_0x5d84ee(0x5ed)][_0x5d84ee(0x721)]; const _0x1f67d5 = _0x539f6d[_0x5d84ee(0x2b5)]('div'); _0x1f67d5[_0x5d84ee(0x38a)] = _0x5d84ee(0x826), _0x1f67d5['textContent'] = _0x48c5fa[_0x5d84ee(0x5ed)][_0x5d84ee(0x77b)], _0x354d3d['appendChild'](_0x35b2ab), _0x354d3d[_0x5d84ee(0x3b1)](_0x1f67d5), _0x5874d6[_0x5d84ee(0x3b1)](_0x354d3d); } } } let _0x22cebd = _0x2fa38a[_0x5d84ee(0x7e5)] + _0x5d84ee(0x644) + _0xb6639d[_0x5d84ee(0x77b)] + '”'; _0x1977bc && (_0x5d84ee(0x1f2) === _0x5d84ee(0x544) ? (_0x37c3d2[_0x5d84ee(0x40f)](_0x5d84ee(0x459), _0x1bdf51), _0x69929 = _0xd3125c) : _0x22cebd += _0x5d84ee(0x3fa)); if (_0xb6639d[_0x5d84ee(0x776)] === _0x5d84ee(0x457)) { if (_0x5d84ee(0x349) === _0x5d84ee(0x349)) _0x22cebd += '\x20[并分享了歌曲:\x20' + _0xb6639d[_0x5d84ee(0x805)] + _0x5d84ee(0x7ef) + _0xb6639d[_0x5d84ee(0x623)] + ']'; else { const _0x2c71ee = _0x16bccc['getElementById']('meeting-list-container'); _0x2c71ee[_0x5d84ee(0x217)] = ''; const _0x2cce1c = _0x4cd2c1[_0x5d84ee(0x4c0)][_0x5d84ee(0x3ea)](_0x46eb67 => _0x15ae0c[_0x5d84ee(0x2e2)][_0x5d84ee(0x6a3)](_0x469c98 => _0x469c98[_0x5d84ee(0x776)] === _0x5d84ee(0x62a) && _0x469c98[_0x5d84ee(0x590)][_0x5d84ee(0x4e4)](_0x46eb67['id']))); if (_0x2cce1c['length'] === 0x0) { _0x2c71ee[_0x5d84ee(0x217)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>'; return; } _0x2cce1c[_0x5d84ee(0x203)](_0x3467e4 => { const _0x19aa88 = _0x5d84ee, _0x398bbb = _0x57fc51[_0x19aa88(0x2b5)]('li'); _0x398bbb['className'] = _0x19aa88(0x520), _0x398bbb['dataset'][_0x19aa88(0x7c4)] = _0x3467e4['id'], _0x398bbb[_0x19aa88(0x217)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x3467e4['avatar'] || _0x2892fb) + _0x19aa88(0x32a) + _0x3467e4[_0x19aa88(0x7e5)] + _0x19aa88(0x809) + (_0x3467e4[_0x19aa88(0x366)] || '私聊') + _0x19aa88(0x30f), _0x398bbb[_0x19aa88(0x41c)](_0x19aa88(0x472), () => { _0x29189f(_0x3467e4['id']); }), _0x2c71ee[_0x19aa88(0x3b1)](_0x398bbb); }); } } const _0x241a22 = _0x5d84ee(0x3ce) + _0x46ba17 + '\x0a\x0a' + _0x4c2e8e + _0x5d84ee(0x5c0) + _0x154ee4 + _0x5d84ee(0x389) + _0x22cebd + _0x5d84ee(0x2d9), _0x2c56b1 = [{ 'role': _0x5d84ee(0x67d), 'content': _0x241a22 }], _0x24e9ce = { 'role': _0x5d84ee(0xe9), 'content': _0x5d84ee(0x1d3) }; if (_0x1977bc) { if (_0x5d84ee(0x7c3) === _0x5d84ee(0x1b7)) { const _0x54ad8c = _0x53ae17[_0x5d84ee(0x62e)](_0x11264d, 'readwrite'), _0x35e4f6 = _0x54ad8c[_0x5d84ee(0x20b)](_0x2d6916), _0x47ec07 = _0x35e4f6['delete'](_0xbb2117); _0x47ec07[_0x5d84ee(0x468)] = () => _0x138e04(), _0x47ec07[_0x5d84ee(0x464)] = () => _0x574a89(_0x47ec07[_0x5d84ee(0x40f)]); } else _0x24e9ce['image'] = _0x1977bc; } _0x2c56b1[_0x5d84ee(0x60b)](_0x24e9ce); const _0x24bac4 = await _0x519e38(_0x2c56b1, { 'json': !![] }), _0x20c26a = _0x24bac4['match'](/({[\s\S]*})/); if (!_0x20c26a) throw new Error(_0x5d84ee(0x736)); const _0x214041 = JSON[_0x5d84ee(0x458)](_0x20c26a[0x1]), _0x21a29a = _0x26d5a3[_0x5d84ee(0x22b)][_0x5d84ee(0x1c6)](_0xb25398 => _0xb25398['id'] === _0xb6639d['id']); _0x21a29a && (_0x21a29a['likes'] = _0x214041['likes'] || [], _0x21a29a[_0x5d84ee(0x1c8)] = (_0x214041[_0x5d84ee(0x1c8)] || [])[_0x5d84ee(0x6dd)]((_0x9254cd, _0x426bdb) => ({ ..._0x9254cd, 'commentId': 'c_' + _0xb6639d[_0x5d84ee(0x808)] + '_' + _0x426bdb })), _0x5d845c(), _0x47e097()); } else _0x5994b3[_0x5d84ee(0xe1)]['push']({ 'senderId': _0x1140b5['id'], 'kind': 'sticker', 'sticker': _0x128ed2 }); } catch (_0x2b5c83) { console[_0x5d84ee(0x40f)]('生成动态回复失败:', _0x2b5c83), _0x880caf(_0x5d84ee(0x341)); } finally { if (_0x5d84ee(0x17c) === 'pRhYc') _0x541a9b(![]), _0x24ae96['isGenerating'] = ![]; else return _0x388b7f['userProfiles'][_0x5d84ee(0x1c6)](_0x53f539 => _0x53f539['id'] === _0x5a230d); } } function _0x455d37() { const _0x42ad92 = _0x113cd8; if (_0x42ad92(0x5e6) === _0x42ad92(0x5e6)) { const _0x523a7a = _0x24ae96[_0x42ad92(0x7ce)][_0x42ad92(0x1c6)](_0x1e93c1 => _0x1e93c1['id'] === _0x24ae96['activeFriendCircleId']), _0x2236b4 = _0x523a7a?.[_0x42ad92(0x346)]; let _0x13a6df = _0x24ae96[_0x42ad92(0xdc)]['find'](_0x380433 => _0x380433['id'] === _0x2236b4); !_0x13a6df && (_0x42ad92(0x3a8) === 'TIjWR' ? (_0x336b78(![]), _0x22e178[_0x42ad92(0x40f)](_0x42ad92(0x35f), _0x41e4f), _0x2cbf2c('导出过程中发生严重错误:\x20' + _0x4314b7[_0x42ad92(0x2ec)])) : _0x13a6df = _0x24ae96['userProfiles']['find'](_0xbede6f => _0xbede6f['id'] === _0x24ae96['activeUserProfileId'])), !_0x13a6df && (_0x13a6df = _0x24ae96[_0x42ad92(0xdc)][0x0]), _0x13a6df && (_0x42ad92(0x6d2) !== _0x42ad92(0x78c) ? document[_0x42ad92(0x2c0)](_0x42ad92(0x157))[_0x42ad92(0xd4)] = _0x13a6df[_0x42ad92(0x37c)] || _0x4be95c : _0xaa35af['listenTogetherSession'] && _0x2da8fb[_0x42ad92(0x20a)]['isActive'] && (_0x280951[_0x42ad92(0x610)][_0x42ad92(0x452)] = _0x42ad92(0x14f), _0x1ee8b7(() => _0x17e74d[_0x42ad92(0x82a)][_0x42ad92(0x2c7)](_0x42ad92(0x155)), 0xa))); } else _0x30aeb9[_0x42ad92(0x2c0)](_0x42ad92(0x1aa))[_0x42ad92(0x610)][_0x42ad92(0x554)](_0x42ad92(0xfc), 'url(' + _0x33cdb8 + ')'); } function _0x19e5d7(_0x138b9f) { const _0x507674 = _0x113cd8; if (_0x507674(0x3dd) === _0x507674(0x3dd)) { let _0x17d3cc = 0x0, _0x459fc7 = 0x0, _0x2e22c4 = 0x0; if (_0x138b9f[_0x507674(0x256)] == 0x4) _0x507674(0x229) === _0x507674(0x229) ? (_0x17d3cc = '0x' + _0x138b9f[0x1] + _0x138b9f[0x1], _0x459fc7 = '0x' + _0x138b9f[0x2] + _0x138b9f[0x2], _0x2e22c4 = '0x' + _0x138b9f[0x3] + _0x138b9f[0x3]) : _0x5017be[_0x507674(0x2c0)](_0x507674(0x157))[_0x507674(0xd4)] = _0x1a38f3[_0x507674(0x37c)] || _0x3c4916; else _0x138b9f[_0x507674(0x256)] == 0x7 && ('fYXKm' !== _0x507674(0x56a) ? (_0x17d3cc = '0x' + _0x138b9f[0x1] + _0x138b9f[0x2], _0x459fc7 = '0x' + _0x138b9f[0x3] + _0x138b9f[0x4], _0x2e22c4 = '0x' + _0x138b9f[0x5] + _0x138b9f[0x6]) : (_0x1528e2(), _0x1646b7['conversationHistory'] = [], _0x39342d())); _0x17d3cc /= 0xff, _0x459fc7 /= 0xff, _0x2e22c4 /= 0xff; let _0x301c57 = Math[_0x507674(0x174)](_0x17d3cc, _0x459fc7, _0x2e22c4), _0x22120e = Math[_0x507674(0x37d)](_0x17d3cc, _0x459fc7, _0x2e22c4), _0x10b45e = _0x22120e - _0x301c57, _0x56ccbf = 0x0, _0x424d23 = 0x0, _0x3d3e19 = 0x0; if (_0x10b45e == 0x0) _0x56ccbf = 0x0; else { if (_0x22120e == _0x17d3cc) _0x56ccbf = (_0x459fc7 - _0x2e22c4) / _0x10b45e % 0x6; else { if (_0x22120e == _0x459fc7) _0x56ccbf = (_0x2e22c4 - _0x17d3cc) / _0x10b45e + 0x2; else _0x56ccbf = (_0x17d3cc - _0x459fc7) / _0x10b45e + 0x4; } } _0x56ccbf = Math[_0x507674(0x303)](_0x56ccbf * 0x3c); if (_0x56ccbf < 0x0) _0x56ccbf += 0x168; return _0x3d3e19 = (_0x22120e + _0x301c57) / 0x2, _0x424d23 = _0x10b45e == 0x0 ? 0x0 : _0x10b45e / (0x1 - Math['abs'](0x2 * _0x3d3e19 - 0x1)), _0x424d23 = +(_0x424d23 * 0x64)['toFixed'](0x1), _0x3d3e19 = +(_0x3d3e19 * 0x64)[_0x507674(0x3bb)](0x1), { 'h': _0x56ccbf, 's': _0x424d23, 'l': _0x3d3e19 }; } else _0x23b908['diaryPressTimer'] = _0x12d7dc(() => { const _0x37cd50 = _0x507674; if (_0x54dccb[_0x37cd50(0x776)] === 'touchstart') _0x3cfd04[_0x37cd50(0x100)](); _0x18faef(_0x261c30(_0x37cc99, 0xa), _0xe9ee58); }, 0x320); } function _0x2c1978() { const _0x5d4f82 = _0x113cd8, _0x47c008 = (_0x164186, _0x1a5274, _0x1a5bae) => { const _0x247fdc = _0x52f2, _0x35033d = document[_0x247fdc(0x2c0)](_0x164186); if (!_0x35033d) return; let _0x91116 = null; try { _0x247fdc(0x7d6) === _0x247fdc(0x7d6) ? _0x91116 = JSON[_0x247fdc(0x458)](localStorage[_0x247fdc(0x696)](_0x1a5274) || '{}') : _0x247fdc(0x230); } catch { if (_0x247fdc(0x771) === _0x247fdc(0x771)) _0x91116 = {}; else { const _0x17e8bd = _0x70c9f7[_0x247fdc(0x676)] === _0x247fdc(0xe9) ? _0x247fdc(0xe9) : 'ai', _0x582f5b = _0x429d3a[_0x247fdc(0x676)] === _0x247fdc(0xe9) ? _0x41af2a[_0x247fdc(0x7e5)] : _0x27f422(_0x1a0191[_0x247fdc(0x676)])[_0x247fdc(0x7e5)], _0x3630ce = _0x5aa45a[_0x247fdc(0x2b5)]('div'); _0x3630ce[_0x247fdc(0x38a)] = _0x247fdc(0x47a) + _0x17e8bd, _0x3630ce[_0x247fdc(0x362)][_0x247fdc(0x808)] = _0x2c4881[_0x247fdc(0x808)], _0x3630ce[_0x247fdc(0x610)][_0x247fdc(0x225)] = _0x247fdc(0x3d2), _0x3630ce[_0x247fdc(0x610)][_0x247fdc(0x764)] = '0', _0x3630ce[_0x247fdc(0x217)] = _0x247fdc(0x580) + _0x582f5b + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>' + new _0x42cbae(_0x5a6448[_0x247fdc(0x808)])[_0x247fdc(0x1c0)]('zh-CN') + _0x247fdc(0x74f) + _0x55e394[_0x247fdc(0x77b)][_0x247fdc(0xef)](/\n/g, _0x247fdc(0x7ba)) + _0x247fdc(0x302), _0x50cc23['appendChild'](_0x3630ce); } } _0x35033d[_0x247fdc(0x610)][_0x247fdc(0x707)] = _0x247fdc(0x730), _0x35033d[_0x247fdc(0x610)]['top'] = '', _0x35033d['style'][_0x247fdc(0x633)] = '', _0x35033d[_0x247fdc(0x610)][_0x247fdc(0x5a6)] = '', _0x35033d[_0x247fdc(0x610)][_0x247fdc(0x4f1)] = '', _0x35033d['style']['transform'] = ''; if (typeof _0x91116[_0x247fdc(0x483)] === _0x247fdc(0x18e) && typeof _0x91116[_0x247fdc(0x633)] === 'number') _0x35033d[_0x247fdc(0x610)][_0x247fdc(0x483)] = _0x91116[_0x247fdc(0x483)] + '%', _0x35033d[_0x247fdc(0x610)][_0x247fdc(0x633)] = _0x91116[_0x247fdc(0x633)] + '%'; else for (const _0x4b2829 in _0x1a5bae) { _0x35033d[_0x247fdc(0x610)][_0x4b2829] = _0x1a5bae[_0x4b2829]; } }; _0x47c008(_0x5d4f82(0xf3), _0x5d4f82(0x364), { 'top': '5%', 'left': '50%', 'transform': _0x5d4f82(0x631) }), _0x47c008('app-wallpaper', 'appIconPosition_app-wallpaper', { 'top': _0x5d4f82(0x6c4), 'right': '4%' }), _0x47c008('app-user-profiles', 'appIconPosition_app-user-profiles', { 'top': '38%', 'right': _0x5d4f82(0x5df) }), _0x47c008(_0x5d4f82(0x58e), _0x5d4f82(0x23b), { 'top': _0x5d4f82(0x5df), 'right': '25%' }), _0x47c008(_0x5d4f82(0x5c3), _0x5d4f82(0x5d8), { 'top': '25%', 'right': '4%' }), _0x47c008(_0x5d4f82(0x51f), 'appIconPosition_app-music-library', { 'top': _0x5d4f82(0x3a7), 'left': _0x5d4f82(0x784) }), _0x47c008('app-diary', _0x5d4f82(0x6be), { 'top': _0x5d4f82(0x3a7), 'left': _0x5d4f82(0x625) }), _0x47c008('decorative-badge', _0x5d4f82(0x163), { 'top': '70%', 'left': _0x5d4f82(0x1ab) }), _0x47c008(_0x5d4f82(0x21d), _0x5d4f82(0xe0), { 'top': _0x5d4f82(0x7d8), 'left': '6%' }), _0x47c008(_0x5d4f82(0x65b), _0x5d4f82(0x44e), { 'top': _0x5d4f82(0x5df), 'left': '5%' }); } function _0x3864e3() { const _0x2a6d53 = _0x113cd8, _0x1d0bd0 = document['getElementById'](_0x2a6d53(0x694)); _0x1d0bd0[_0x2a6d53(0x217)] = ''; const _0x50b74a = document['querySelectorAll'](_0x2a6d53(0x38c)); _0x50b74a['forEach'](_0x3d0afc => { const _0x363b06 = _0x2a6d53; if (_0x363b06(0x189) !== _0x363b06(0x18c)) { const _0x3941fd = _0x3d0afc['id'], _0x2b6d18 = _0x3d0afc[_0x363b06(0x437)]('span')['textContent'], _0x27b959 = _0x363b06(0x7da) + _0x3941fd, _0x334498 = localStorage['getItem'](_0x27b959), _0x287ca7 = document[_0x363b06(0x2b5)](_0x363b06(0x6ee)); _0x287ca7[_0x363b06(0x38a)] = _0x363b06(0x4a6), _0x287ca7[_0x363b06(0x610)][_0x363b06(0x434)] = _0x363b06(0x140), _0x287ca7['innerHTML'] = _0x363b06(0x442) + _0x3941fd + _0x363b06(0x728) + (_0x334498 || _0x363b06(0x426)) + _0x363b06(0x6f4) + _0x2b6d18 + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20id=\x22input_' + _0x3941fd + _0x363b06(0x7e4) + _0x3941fd + '\x27).click()\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x20background-color:\x20#777;\x22\x20onclick=\x22localStorage.removeItem(\x27' + _0x27b959 + _0x363b06(0x321), _0x1d0bd0[_0x363b06(0x3b1)](_0x287ca7); const _0x1d270e = document[_0x363b06(0x2c0)](_0x363b06(0x829) + _0x3941fd); _0x1d270e[_0x363b06(0x41c)](_0x363b06(0x356), async _0x5056ad => { const _0x3908b9 = _0x363b06, _0x108249 = _0x5056ad[_0x3908b9(0x5b9)]['files'][0x0]; if (!_0x108249) return; try { const _0x498d9c = await _0x5bf854(_0x108249); localStorage[_0x3908b9(0x515)](_0x27b959, _0x498d9c), document[_0x3908b9(0x2c0)](_0x3908b9(0x1bd) + _0x3941fd)['src'] = _0x498d9c, _0x3b138a(); } catch (_0x48ebc5) { _0x880caf('图标处理失败:\x20' + _0x48ebc5[_0x3908b9(0x2ec)]); } }); } else { const _0x4a5025 = _0x363b06(0x1f1) + _0x10b00c; let _0x35ca7c = _0x2a2d30[_0x363b06(0x2c0)](_0x4a5025); if (_0x35ca7c) return; const _0x340ca4 = _0x363b06(0x567) + _0x4a5025 + _0x363b06(0x6e0) + (_0x3ce795 === 'ai' ? _0x363b06(0x4ce) : '') + _0x363b06(0x3bf); _0x4407f4['body'][_0x363b06(0x393)](_0x363b06(0x6ed), _0x340ca4); const _0x533d76 = _0x11e2fe[_0x363b06(0x2c0)](_0x4a5025), _0x2c329b = () => _0x533d76['remove'](); _0x533d76[_0x363b06(0x437)](_0x363b06(0x451))[_0x363b06(0x2c4)] = _0x2c329b, _0x533d76[_0x363b06(0x437)](_0x363b06(0x5d5))[_0x363b06(0x2c4)] = _0x2c329b, _0x533d76['querySelector'](_0x363b06(0x407))['onclick'] = () => { _0x5337f5(_0x380793), _0x2c329b(); }, _0xd13f12 === 'ai' && (_0x533d76[_0x363b06(0x437)](_0x363b06(0x4d4))[_0x363b06(0x2c4)] = () => { _0x374105(_0x1e3fc4), _0x2c329b(); }); } }); } function _0x3b138a() { const _0x1a74c7 = _0x113cd8, _0x273ce9 = document[_0x1a74c7(0x439)](_0x1a74c7(0x38c)); _0x273ce9['forEach'](_0x391fd9 => { const _0x2205a5 = _0x1a74c7; if (_0x2205a5(0x723) === _0x2205a5(0x5cc)) _0x2eb30f[_0x2205a5(0x100)](), _0x559779(); else { const _0x5e40ff = _0x391fd9['id'], _0x42fd0f = 'customIcon_' + _0x5e40ff, _0x4f55ca = localStorage[_0x2205a5(0x696)](_0x42fd0f), _0xd49796 = _0x391fd9['querySelector'](_0x2205a5(0x6dc)); if (_0x4f55ca) _0xd49796[_0x2205a5(0x217)] = _0x2205a5(0x814) + _0x4f55ca + _0x2205a5(0x528); else { const _0x59d94a = document[_0x2205a5(0x437)]('#app-dock-bottom-left\x20#' + _0x5e40ff + _0x2205a5(0x6e5) + _0x5e40ff + _0x2205a5(0x3f2))?.['innerHTML']; _0x59d94a && (_0x2205a5(0x490) === _0x2205a5(0x490) ? _0xd49796[_0x2205a5(0x217)] = _0x59d94a : _0x4e926b = _0x40402d(_0x4c0274['participantIds'][0x0])); } } }); } function _0x326335() { const _0x59cec3 = _0x113cd8; if ('TnmkT' !== 'usBGv') { const _0xaccc46 = _0x24ae96[_0x59cec3(0x7ce)][_0x59cec3(0x1c6)](_0x18db47 => _0x18db47['id'] === _0x24ae96[_0x59cec3(0x4fb)]), _0x1947a4 = _0x3cc63d(); let _0x390074 = []; if (_0xaccc46 && _0xaccc46[_0x59cec3(0x22b)]) { const _0x10151e = _0xaccc46['posts']['filter'](_0x18035b => _0x18035b[_0x59cec3(0x776)] === _0x59cec3(0x457) && _0x18035b[_0x59cec3(0x4b2)])[_0x59cec3(0x6dd)](_0x1f4aed => ({ ..._0x1f4aed, 'source': _0x59cec3(0x71c) })); _0x390074[_0x59cec3(0x60b)](..._0x10151e); } if (_0x1947a4 && _0x24ae96[_0x59cec3(0x5bb)]) { const _0x2c7c09 = _0x24ae96[_0x59cec3(0x5bb)][_0x59cec3(0x3ea)](_0x4c7060 => _0x4c7060[_0x59cec3(0x776)] === _0x59cec3(0x457) && _0x4c7060[_0x59cec3(0x4b2)])[_0x59cec3(0x6dd)](_0x47acee => ({ ..._0x47acee, 'source': _0x59cec3(0x710) })); _0x390074[_0x59cec3(0x60b)](..._0x2c7c09); } const _0x9703ee = Array[_0x59cec3(0x1f7)](new Map(_0x390074[_0x59cec3(0x6dd)](_0x13bf62 => [_0x13bf62[_0x59cec3(0x4b2)], _0x13bf62]))[_0x59cec3(0x5f5)]()); _0x24ae96[_0x59cec3(0x511)] = _0x9703ee[_0x59cec3(0x125)]((_0x4cd09f, _0x55307b) => _0x55307b[_0x59cec3(0x808)] - _0x4cd09f[_0x59cec3(0x808)]); } else _0x2a783a = _0x68a39c[_0x59cec3(0x3ea)](_0x309eca => _0x309eca && typeof _0x309eca === _0x59cec3(0x66a) && typeof _0x309eca['role'] === 'string' && typeof _0x309eca[_0x59cec3(0x77b)] !== 'undefined'); } function _0x440cf9(_0x1d7ddb) { const _0x443cfd = _0x113cd8; if (_0x1d7ddb < 0x0 || _0x1d7ddb >= _0x58eb47[_0x443cfd(0x256)]) return; _0x4fa8dd = _0x1d7ddb; const _0x5b31be = _0x58eb47[_0x1d7ddb]; _0x5eabbb[_0x443cfd(0xd4)] = _0x5b31be[_0x443cfd(0x4b2)] || _0x5b31be[_0x443cfd(0x375)], _0x5eabbb[_0x443cfd(0x5d3)](), _0x137130(), _0x2cd0a9(); } function _0x137130() { const _0x31790b = _0x113cd8; if (_0x31790b(0x81d) === _0x31790b(0x2af)) { if (_0xfd8379['role'] === _0x31790b(0x2f2)) { const _0x123db2 = _0x381216[_0x31790b(0x6f1)][_0x25a057]; _0x123db2 && _0x123db2['length'] > 0x0 && (_0x3e4ec7 = _0x123db2['at'](-0x1)); } else _0x55b699 = { 'speaker': _0x2c7ea2[_0x31790b(0x7e5)], 'line': _0x1696a3[_0x31790b(0x77b)], 'emotion': 'normal' }; } else { const _0x11eaf4 = _0x58eb47[_0x4fa8dd]; _0x1d3cd2(_0x11eaf4); } } function _0x2cd0a9() { const _0x2d79bb = _0x113cd8; try { localStorage[_0x2d79bb(0x515)](_0x2d79bb(0x3b7), JSON[_0x2d79bb(0x3fd)]({ 'playlist': _0x24ae96[_0x2d79bb(0x511)], 'currentIndex': _0x24ae96[_0x2d79bb(0x218)] })); } catch (_0x557b0f) { if (_0x2d79bb(0x3c2) === _0x2d79bb(0x618)) { if (_0x33aa92) { const _0x1fdab9 = _0x5ab9dc['createElement']('p'); _0x1fdab9[_0x2d79bb(0x548)] = _0x220a47, _0x1fdab9[_0x2d79bb(0x610)]['margin'] = '0', _0x496f6c[_0x2d79bb(0x3b1)](_0x1fdab9); } } else console['error']('保存播放器状态失败，真是没用。', _0x557b0f); } } function _0x3e7f01() { const _0x9e55e0 = _0x113cd8; try { const _0x382037 = localStorage['getItem'](_0x9e55e0(0x3b7)); if (_0x382037) { if ('YIbYl' === _0x9e55e0(0x40c)) _0x9266d5[_0x9e55e0(0x77b)] = _0x33b0ea, _0x5689cd(), _0x2bef42(); else { const { playlist: _0x28ba58, currentIndex: _0x2a640e } = JSON[_0x9e55e0(0x458)](_0x382037); if (Array[_0x9e55e0(0x2d0)](_0x28ba58) && _0x28ba58[_0x9e55e0(0x256)] > 0x0 && _0x2a640e > -0x1) { if ('nQrqE' === _0x9e55e0(0x153)) _0x24ae96['musicPlaylist'] = _0x28ba58, _0x24ae96[_0x9e55e0(0x218)] = _0x2a640e, _0x24ae96['isPlaying'] = ![], _0x137130(); else { _0xee55f7 = _0x2dc655(_0x26cf96[_0x9e55e0(0x1e9)]), _0x36c104[_0x9e55e0(0x217)] = ''; if (_0x5e83e4['length'] === 0x0) { _0x4ebe03[_0x9e55e0(0x217)] = _0x9e55e0(0x1df); return; } _0x299af1['forEach']((_0x406d95, _0x396bca) => { const _0x50cb61 = _0x9e55e0, _0x28534a = _0x8f0628['createElement']('p'); _0x28534a[_0x50cb61(0x548)] = _0x406d95[_0x50cb61(0x13b)], _0x28534a['id'] = _0x50cb61(0xf2) + _0x396bca, _0x43778b[_0x50cb61(0x3b1)](_0x28534a); }); } } } } } catch (_0x296d1d) { console[_0x9e55e0(0x40f)](_0x9e55e0(0x63e), _0x296d1d); } } function _0x3bfadb(_0x35957c) { const _0xeb707c = _0x113cd8; if (window[_0xeb707c(0x78b)]) clearTimeout(window[_0xeb707c(0x78b)]); const _0x3251d7 = _0x35957c[_0xeb707c(0x5b9)][_0xeb707c(0x550)](_0xeb707c(0x2c6)); if (!_0x3251d7) return; const _0x362c21 = _0x3251d7[_0xeb707c(0x362)][_0xeb707c(0x808)], _0x48d161 = _0x3251d7[_0xeb707c(0x82a)][_0xeb707c(0x211)](_0xeb707c(0xe9)) ? _0xeb707c(0xe9) : 'ai'; if (!_0x362c21) return; const _0x43db8a = () => { const _0x324e7a = _0xeb707c; _0x324e7a(0x4e6) !== _0x324e7a(0x4e6) ? _0x21deb9 && _0x817d54(_0x3cadd7['id'], _0x49bff8[_0x324e7a(0x6dd)](_0x4bc5dc => _0x4bc5dc['id'])) : window['diaryPressTimer'] = setTimeout(() => { const _0x1fd7ef = _0x324e7a; if (_0x1fd7ef(0x800) !== _0x1fd7ef(0x800)) _0x225719[_0x1fd7ef(0x69f)] = _0x81fee2['userProfile'][_0x1fd7ef(0x7e5)] || '', _0x247f91[_0x1fd7ef(0xd4)] = _0x45ac19[_0x1fd7ef(0x7ff)][_0x1fd7ef(0x37c)] || _0x36229c, _0x50d531['value'] = _0x1a3773[_0x1fd7ef(0x7ff)][_0x1fd7ef(0x791)] || ''; else { if (_0x35957c[_0x1fd7ef(0x776)] === _0x1fd7ef(0x82b)) _0x35957c[_0x1fd7ef(0x100)](); _0x21859e(parseInt(_0x362c21, 0xa), _0x48d161); } }, 0x320); }, _0x33b192 = () => { const _0x1400de = _0xeb707c; if (window[_0x1400de(0x78b)]) clearTimeout(window[_0x1400de(0x78b)]); }; document['addEventListener'](_0xeb707c(0x305), _0x33b192, { 'once': !![] }), document[_0xeb707c(0x41c)](_0xeb707c(0x6b6), _0x33b192, { 'once': !![] }), document['addEventListener'](_0xeb707c(0x58c), _0x33b192, { 'once': !![] }), _0x43db8a(); } function _0x21859e(_0x2919fe, _0x3fef9f) { const _0xac9900 = _0x113cd8; if (_0xac9900(0xc9) !== _0xac9900(0x17b)) { const _0x24fd42 = _0xac9900(0x1f1) + _0x2919fe; let _0x4047c5 = document[_0xac9900(0x2c0)](_0x24fd42); if (_0x4047c5) return; const _0x285c5b = _0xac9900(0x567) + _0x24fd42 + _0xac9900(0x6e0) + (_0x3fef9f === 'ai' ? _0xac9900(0x4ce) : '') + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20'; document[_0xac9900(0x5e4)][_0xac9900(0x393)](_0xac9900(0x6ed), _0x285c5b); const _0x2ab414 = document[_0xac9900(0x2c0)](_0x24fd42), _0x433f28 = () => _0x2ab414[_0xac9900(0x28c)](); _0x2ab414['querySelector'](_0xac9900(0x451))[_0xac9900(0x2c4)] = _0x433f28, _0x2ab414[_0xac9900(0x437)]('#diary-action-cancel')[_0xac9900(0x2c4)] = _0x433f28, _0x2ab414['querySelector'](_0xac9900(0x407))['onclick'] = () => { const _0x3ffc67 = _0xac9900; _0x3ffc67(0x4d6) === 'ySARl' ? (_0xd25288[_0x3ffc67(0x40f)]('保存角色失败:', _0x5b7e0b), _0x310939(_0x3ffc67(0x11e) + _0x513223['message'])) : (_0x2c0c7a(_0x2919fe), _0x433f28()); }, _0x3fef9f === 'ai' && (_0xac9900(0x7f2) === _0xac9900(0x1af) ? _0x5f1765['scrollTop'] = _0x388cf5[_0xac9900(0x1fc)] : _0x2ab414[_0xac9900(0x437)](_0xac9900(0x4d4))[_0xac9900(0x2c4)] = () => { const _0xd8f1c6 = _0xac9900; if (_0xd8f1c6(0x38e) === _0xd8f1c6(0x39b)) return _0x37cc80 + _0xd8f1c6(0x518); else _0x448a76(_0x2919fe), _0x433f28(); }); } else return _0x226cf6(_0x4e50a7)[_0xac9900(0x73a)](_0x55859a => _0x55859a[_0xac9900(0x603)]()); } async function _0x2c0c7a(_0x192a44) { const _0x2269fb = _0x113cd8, _0x6401d7 = await _0x380a1e(_0x2269fb(0x351)); if (!_0x6401d7) return; const _0x454945 = _0x24ae96['diaries'][_0x2269fb(0x1c6)](_0x2b7b80 => _0x2b7b80[_0x2269fb(0x5f9)] === _0x24ae96[_0x2269fb(0x367)]); if (!_0x454945) return; const _0x179e67 = _0x454945['entries'][_0x2269fb(0x3e8)](_0x2562fc => _0x2562fc[_0x2269fb(0x808)] === _0x192a44); if (_0x179e67 > -0x1) { if (_0x2269fb(0x386) !== _0x2269fb(0x386)) { const _0x1ab6ef = _0x93cbc5[_0x2269fb(0x1fd)] ? _0x127573(_0x300a6a[_0x2269fb(0x1fd)]) : null; return _0x1ab6ef?.['name'] || 'Unknown'; } else _0x454945[_0x2269fb(0x62d)]['splice'](_0x179e67, 0x1), _0x5d845c(), _0x1ca45d(), _0x880caf('日记已删除。'); } } async function _0x448a76(_0x5f0533) { const _0x3bd350 = _0x113cd8; if (_0x3bd350(0x7db) === _0x3bd350(0x7db)) { const _0x29d1c7 = _0x24ae96[_0x3bd350(0x80a)][_0x3bd350(0x1c6)](_0x35d3ea => _0x35d3ea['characterId'] === _0x24ae96['activeDiaryCharacterId']); if (!_0x29d1c7) return; const _0x51fbb2 = _0x29d1c7[_0x3bd350(0x62d)][_0x3bd350(0x3e8)](_0x516e8c => _0x516e8c[_0x3bd350(0x808)] === _0x5f0533); _0x51fbb2 > -0x1 && (_0x29d1c7[_0x3bd350(0x62d)][_0x3bd350(0x62c)](_0x51fbb2, 0x1), _0x5d845c(), _0x1ca45d(), await _0x2b7305()); } else { if (_0x359ec9 < 0x0 || _0x4f6564 >= _0x102ae7[_0x3bd350(0x256)]) return; _0x50797c = _0x15bfba; const _0xda87bb = _0x335ab7[_0x768fb6]; _0xf21b4d[_0x3bd350(0xd4)] = _0xda87bb[_0x3bd350(0x4b2)] || _0xda87bb[_0x3bd350(0x375)], _0x4badf7[_0x3bd350(0x5d3)](), _0x4aa8a8(), _0xe15e06(); } } function _0x18b8b3() { const _0x10cf61 = _0x113cd8; if (_0x10cf61(0x299) !== _0x10cf61(0x29f)) { const _0x195817 = document[_0x10cf61(0x2c0)](_0x10cf61(0x2c1)); _0x195817[_0x10cf61(0x217)] = ''; const _0x219183 = _0x24ae96[_0x10cf61(0x4c0)][_0x10cf61(0x3ea)](_0x22a0c8 => _0x24ae96['chats'][_0x10cf61(0x6a3)](_0xe4e3db => _0xe4e3db[_0x10cf61(0x776)] === _0x10cf61(0x62a) && _0xe4e3db[_0x10cf61(0x590)]['includes'](_0x22a0c8['id']))); if (_0x219183[_0x10cf61(0x256)] === 0x0) { if (_0x10cf61(0x6ae) !== 'KLcqX') { _0x195817[_0x10cf61(0x217)] = _0x10cf61(0x6e3); return; } else _0x42f3ad(_0xa32edc, _0x10cf61(0x27c)); } _0x219183[_0x10cf61(0x203)](_0x3bbbf6 => { const _0x48d96d = _0x10cf61, _0x1c8b66 = document['createElement']('li'); _0x1c8b66[_0x48d96d(0x38a)] = 'character-item', _0x1c8b66[_0x48d96d(0x362)]['charId'] = _0x3bbbf6['id'], _0x1c8b66[_0x48d96d(0x217)] = _0x48d96d(0x1b6) + (_0x3bbbf6[_0x48d96d(0x37c)] || _0x5d2cd8) + _0x48d96d(0x32a) + _0x3bbbf6[_0x48d96d(0x7e5)] + _0x48d96d(0x5ac), _0x1c8b66[_0x48d96d(0x41c)](_0x48d96d(0x472), () => { _0x25b00f(_0x3bbbf6['id']); }), _0x195817[_0x48d96d(0x3b1)](_0x1c8b66); }); } else _0x106e33['style'][_0x10cf61(0x452)] = _0x10cf61(0x32c); } function _0x25b00f(_0x505604) { const _0x56cf1b = _0x113cd8, _0x5b1d37 = _0x5c4526(_0x505604); if (!_0x5b1d37) return; _0x24ae96[_0x56cf1b(0x367)] = _0x505604; const _0x5b94bd = _0x24ae96[_0x56cf1b(0x80a)][_0x56cf1b(0x1c6)](_0x3391bb => _0x3391bb[_0x56cf1b(0x5f9)] === _0x505604), _0x4bbdba = _0x5b94bd ? _0x5b94bd[_0x56cf1b(0x62d)][_0x56cf1b(0x256)] : 0x0, _0x36d89e = 0x2; _0x24ae96[_0x56cf1b(0x7f0)] = Math['max'](0x0, Math[_0x56cf1b(0x4b9)](_0x4bbdba / _0x36d89e) - 0x1), document[_0x56cf1b(0x2c0)](_0x56cf1b(0x7df))[_0x56cf1b(0x548)] = _0x5b1d37[_0x56cf1b(0x7e5)] + '的日记本', _0x1ca45d(), _0x124c6c(_0x56cf1b(0x7c7), _0x56cf1b(0x4ca)); } function _0x1ca45d() { const _0xc7479d = _0x113cd8; if (_0xc7479d(0x812) !== _0xc7479d(0x427)) { const _0x3eb52b = document[_0xc7479d(0x2c0)](_0xc7479d(0x79f)), _0x5f5cfb = document[_0xc7479d(0x2c0)](_0xc7479d(0x5cf)); _0x3eb52b[_0xc7479d(0x217)] = '', _0x5f5cfb['innerHTML'] = ''; const _0x8e8ab8 = _0x5d54b4() || { 'name': '我' }, _0x2f3744 = _0x24ae96[_0xc7479d(0x80a)][_0xc7479d(0x1c6)](_0x22dd77 => _0x22dd77[_0xc7479d(0x5f9)] === _0x24ae96[_0xc7479d(0x367)]); if (!_0x2f3744 || !_0x2f3744['entries'] || _0x2f3744[_0xc7479d(0x62d)]['length'] === 0x0) { _0x3eb52b['innerHTML'] = _0xc7479d(0x380), _0x5f5cfb['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', document[_0xc7479d(0x2c0)](_0xc7479d(0x697))[_0xc7479d(0x41c)](_0xc7479d(0x472), _0x1cb7a6), document[_0xc7479d(0x2c0)](_0xc7479d(0x76b))[_0xc7479d(0x41c)](_0xc7479d(0x472), _0x2b7305); return; } const _0x38f8db = 0x2, _0x3fcc25 = [..._0x2f3744[_0xc7479d(0x62d)]][_0xc7479d(0x125)]((_0x2f17e7, _0x27a9d0) => _0x2f17e7[_0xc7479d(0x808)] - _0x27a9d0['timestamp']), _0x5854a2 = []; for (let _0x33e83 = 0x0; _0x33e83 < _0x3fcc25[_0xc7479d(0x256)]; _0x33e83 += _0x38f8db) { 'gNQfl' === _0xc7479d(0x11a) ? _0x5854a2[_0xc7479d(0x60b)](_0x3fcc25[_0xc7479d(0x3a3)](_0x33e83, _0x33e83 + _0x38f8db)) : _0x2778f0[_0xc7479d(0x41c)](_0xc7479d(0x472), () => { const _0x779cad = _0xc7479d; _0x22c29b(_0x779cad(0x798)); }); } const _0x2e9273 = _0x5854a2[_0xc7479d(0x256)]; _0x5854a2[_0xc7479d(0x203)]((_0x597409, _0x572453) => { const _0x3611b5 = _0xc7479d, _0x17faf7 = document[_0x3611b5(0x2b5)](_0x3611b5(0x6ee)); _0x17faf7['className'] = _0x3611b5(0x69d), _0x17faf7['id'] = _0x3611b5(0x51b) + _0x572453, _0x572453 === _0x24ae96[_0x3611b5(0x7f0)] && (_0x3611b5(0x272) !== 'lZqUc' ? _0x17faf7[_0x3611b5(0x82a)][_0x3611b5(0x2c7)]('is-visible') : _0x813b92[_0x3611b5(0x60b)](_0x351bac['id'])), _0x597409[_0x3611b5(0x203)](_0x281ae1 => { const _0x10a6e3 = _0x3611b5, _0x2ec40f = _0x281ae1[_0x10a6e3(0x676)] === 'user' ? 'user' : 'ai', _0x3cfe5b = _0x281ae1[_0x10a6e3(0x676)] === _0x10a6e3(0xe9) ? _0x8e8ab8[_0x10a6e3(0x7e5)] : _0x5c4526(_0x281ae1[_0x10a6e3(0x676)])['name'], _0x27d9f6 = document[_0x10a6e3(0x2b5)](_0x10a6e3(0x6ee)); _0x27d9f6[_0x10a6e3(0x38a)] = _0x10a6e3(0x47a) + _0x2ec40f, _0x27d9f6['dataset'][_0x10a6e3(0x808)] = _0x281ae1[_0x10a6e3(0x808)], _0x27d9f6[_0x10a6e3(0x610)][_0x10a6e3(0x225)] = _0x10a6e3(0x3d2), _0x27d9f6[_0x10a6e3(0x610)]['paddingBottom'] = '0', _0x27d9f6[_0x10a6e3(0x217)] = _0x10a6e3(0x580) + _0x3cfe5b + _0x10a6e3(0x3a5) + new Date(_0x281ae1[_0x10a6e3(0x808)])[_0x10a6e3(0x1c0)](_0x10a6e3(0x222)) + _0x10a6e3(0x74f) + _0x281ae1[_0x10a6e3(0x77b)]['replace'](/\n/g, _0x10a6e3(0x7ba)) + _0x10a6e3(0x302), _0x17faf7['appendChild'](_0x27d9f6); }), _0x3eb52b[_0x3611b5(0x3b1)](_0x17faf7); }), _0x5f5cfb[_0xc7479d(0x217)] = _0xc7479d(0x146) + (_0x24ae96[_0xc7479d(0x7f0)] + 0x1) + _0xc7479d(0x1a0) + _0x2e9273 + _0xc7479d(0x55d), document[_0xc7479d(0x2c0)](_0xc7479d(0x2c3))[_0xc7479d(0x38d)] = _0x24ae96[_0xc7479d(0x7f0)] === 0x0, document[_0xc7479d(0x2c0)](_0xc7479d(0x2c5))[_0xc7479d(0x38d)] = _0x24ae96[_0xc7479d(0x7f0)] === _0x2e9273 - 0x1, document[_0xc7479d(0x2c0)](_0xc7479d(0x2c3))[_0xc7479d(0x41c)](_0xc7479d(0x472), _0x271a83), document[_0xc7479d(0x2c0)](_0xc7479d(0x2c5))['addEventListener']('click', _0x596131), document[_0xc7479d(0x2c0)](_0xc7479d(0x697))[_0xc7479d(0x41c)](_0xc7479d(0x472), _0x1cb7a6), document['getElementById'](_0xc7479d(0x76b))[_0xc7479d(0x41c)](_0xc7479d(0x472), _0x2b7305); } else { const _0x5a2f26 = _0x34ade2[_0xc7479d(0x69f)][_0xc7479d(0x529)](), _0x3f21c5 = _0x5463eb[_0xc7479d(0x69f)][_0xc7479d(0x529)](); if (!_0x5a2f26 || !_0x3f21c5) { _0x8a3d57(_0xc7479d(0x522)); return; } _0x5cf517({ 'songName': _0x5a2f26, 'artist': _0x3f21c5 }); } } function _0x596131() { const _0x3ef55f = _0x113cd8; if ('PgRcb' !== _0x3ef55f(0x5c9)) _0x4dae90[_0x3ef55f(0x217)] = _0x3ef55f(0x133) + _0x4fa14f + _0x3ef55f(0x51c) + _0x3cd8c6 + _0x3ef55f(0x712) + _0x4e85fb[_0x3ef55f(0x805)] + _0x3ef55f(0x312) + _0x43dbc4['artist'] + _0x3ef55f(0x3dc) + _0x4f2395['songId'] + _0x3ef55f(0x7a8); else { if (_0x24ae96[_0x3ef55f(0x250)]) return; const _0x5ceab3 = _0x24ae96[_0x3ef55f(0x7f0)], _0x2760df = Math[_0x3ef55f(0x4b9)](_0x24ae96['diaries']['find'](_0x1c93dd => _0x1c93dd['characterId'] === _0x24ae96[_0x3ef55f(0x367)])[_0x3ef55f(0x62d)][_0x3ef55f(0x256)] / 0x2); if (_0x5ceab3 >= _0x2760df - 0x1) return; _0x24ae96[_0x3ef55f(0x250)] = !![]; const _0x41ae00 = _0x5ceab3 + 0x1, _0x4da3e2 = document['getElementById']('diary-page-' + _0x5ceab3), _0x5cf32b = document[_0x3ef55f(0x2c0)](_0x3ef55f(0x51b) + _0x41ae00); _0x4da3e2 && _0x5cf32b ? (_0x5cf32b[_0x3ef55f(0x82a)][_0x3ef55f(0x2c7)](_0x3ef55f(0x288)), _0x4da3e2[_0x3ef55f(0x82a)][_0x3ef55f(0x2c7)](_0x3ef55f(0x4f7)), _0x5cf32b['classList'][_0x3ef55f(0x2c7)](_0x3ef55f(0x6aa)), setTimeout(() => { const _0x1ae6fa = _0x3ef55f; _0x4da3e2['classList'][_0x1ae6fa(0x28c)](_0x1ae6fa(0x6aa), _0x1ae6fa(0x4f7)), _0x5cf32b['classList']['remove'](_0x1ae6fa(0x288)), _0x24ae96[_0x1ae6fa(0x7f0)] = _0x41ae00, _0x1ca45d(), _0x24ae96[_0x1ae6fa(0x250)] = ![]; }, 0x2bc)) : _0x24ae96[_0x3ef55f(0x250)] = ![]; } } function _0x271a83() { const _0x1e251e = _0x113cd8; if (_0x1e251e(0x33d) === _0x1e251e(0x33d)) { if (_0x24ae96['isAnimatingDiary']) return; const _0x16fa93 = _0x24ae96[_0x1e251e(0x7f0)]; if (_0x16fa93 <= 0x0) return; _0x24ae96[_0x1e251e(0x250)] = !![]; const _0x4b4e0f = _0x16fa93 - 0x1, _0x1a0682 = document[_0x1e251e(0x2c0)](_0x1e251e(0x51b) + _0x16fa93), _0x566b11 = document[_0x1e251e(0x2c0)](_0x1e251e(0x51b) + _0x4b4e0f); if (_0x1a0682 && _0x566b11) _0x566b11[_0x1e251e(0x82a)][_0x1e251e(0x2c7)](_0x1e251e(0x73c)), _0x1a0682['classList']['add'](_0x1e251e(0x481)), _0x566b11[_0x1e251e(0x82a)][_0x1e251e(0x2c7)](_0x1e251e(0x6aa)), setTimeout(() => { const _0x4aac5c = _0x1e251e; _0x1a0682[_0x4aac5c(0x82a)][_0x4aac5c(0x28c)](_0x4aac5c(0x6aa), _0x4aac5c(0x481)), _0x566b11[_0x4aac5c(0x82a)][_0x4aac5c(0x28c)](_0x4aac5c(0x73c)), _0x24ae96[_0x4aac5c(0x7f0)] = _0x4b4e0f, _0x1ca45d(), _0x24ae96[_0x4aac5c(0x250)] = ![]; }, 0x2bc); else { if (_0x1e251e(0x47e) !== _0x1e251e(0x47e)) { const _0x44a3da = _0x2e43ee[_0x1e251e(0x2b5)]('p'); _0x44a3da['textContent'] = _0x134d67, _0x44a3da[_0x1e251e(0x610)][_0x1e251e(0x36d)] = '0', _0x23e726[_0x1e251e(0x3b1)](_0x44a3da); } else _0x24ae96[_0x1e251e(0x250)] = ![]; } } else { const _0x1b485f = _0x49b708(_0x4f4974); if (!_0x1b485f) return; _0x5bef01[_0x1e251e(0x367)] = _0x3eca83; const _0x3408be = _0x205daa['diaries'][_0x1e251e(0x1c6)](_0x5a660c => _0x5a660c['characterId'] === _0x1d8b85), _0xb42caa = _0x3408be ? _0x3408be['entries'][_0x1e251e(0x256)] : 0x0, _0x59c296 = 0x2; _0xb96510[_0x1e251e(0x7f0)] = _0x29b15a['max'](0x0, _0x59a3d8[_0x1e251e(0x4b9)](_0xb42caa / _0x59c296) - 0x1), _0x241a07[_0x1e251e(0x2c0)](_0x1e251e(0x7df))[_0x1e251e(0x548)] = _0x1b485f[_0x1e251e(0x7e5)] + '的日记本', _0x6d661d(), _0x160851('diaryView', _0x1e251e(0x4ca)); } } function _0x1cb7a6() { const _0x18e5e1 = _0x113cd8; if ('nnYMv' === _0x18e5e1(0x824)) return new Promise(_0x2e33cc => { const _0x2f4ee3 = _0x18e5e1, _0x564b23 = _0x2f4ee3(0xd3); document[_0x2f4ee3(0x5e4)]['insertAdjacentHTML'](_0x2f4ee3(0x6ed), _0x564b23); const _0x7e4820 = document[_0x2f4ee3(0x2c0)](_0x2f4ee3(0x280)), _0x46fe9f = document['getElementById']('diary-modal-textarea'), _0xd7da79 = document[_0x2f4ee3(0x2c0)](_0x2f4ee3(0x57b)), _0xf9e536 = document[_0x2f4ee3(0x2c0)](_0x2f4ee3(0x482)), _0x23e499 = _0x7e4820[_0x2f4ee3(0x437)](_0x2f4ee3(0x451)), _0x5adb5e = () => { const _0x274e4f = _0x2f4ee3; _0x274e4f(0x7ae) !== _0x274e4f(0x7ae) ? _0x49d2c8(_0x274e4f(0x171) + _0x6aff12[_0x274e4f(0x799)]('\x0a')) : (_0x7e4820[_0x274e4f(0x28c)](), _0x2e33cc()); }; _0xd7da79['onclick'] = () => { const _0x483957 = _0x2f4ee3; _0x419ca1(_0x46fe9f[_0x483957(0x69f)]), _0x5adb5e(); }, _0xf9e536[_0x2f4ee3(0x2c4)] = _0x5adb5e, _0x23e499[_0x2f4ee3(0x2c4)] = _0x5adb5e; }); else _0xe0f8bb[_0x18e5e1(0x610)][_0x18e5e1(0x452)] = 'none'; } function _0x419ca1(_0x4cd1d2) { const _0x47a402 = _0x113cd8, _0x52cf1c = _0x4cd1d2[_0x47a402(0x529)](); if (!_0x52cf1c || !_0x24ae96['activeDiaryCharacterId']) return; let _0x3803db = _0x24ae96[_0x47a402(0x80a)]['find'](_0xb63f66 => _0xb63f66[_0x47a402(0x5f9)] === _0x24ae96['activeDiaryCharacterId']); !_0x3803db && ('yBojl' !== _0x47a402(0x68c) ? (_0x18ef9a['src'] = _0x4520d0[_0x47a402(0x6c9)](_0xd2fbd7), _0x29b3c6['style'][_0x47a402(0x452)] = _0x47a402(0x3fb)) : (_0x3803db = { 'characterId': _0x24ae96[_0x47a402(0x367)], 'entries': [] }, _0x24ae96[_0x47a402(0x80a)][_0x47a402(0x60b)](_0x3803db))); _0x3803db[_0x47a402(0x62d)][_0x47a402(0x60b)]({ 'timestamp': Date['now'](), 'author': _0x47a402(0xe9), 'content': _0x52cf1c }), _0x5d845c(); const _0x24b09f = _0x3803db[_0x47a402(0x62d)]['length']; _0x24ae96[_0x47a402(0x7f0)] = Math['ceil'](_0x24b09f / 0x2) - 0x1, _0x1ca45d(); } async function _0x2b7305() { const _0x534145 = _0x113cd8, _0x2e4cb0 = _0x24ae96[_0x534145(0x367)], _0x58dae9 = _0x5c4526(_0x2e4cb0); if (!_0x58dae9 || _0x24ae96[_0x534145(0x3c6)]) return; _0x541a9b(!![], _0x534145(0x138)), _0x24ae96['isGenerating'] = !![]; let _0x44f41d = []; try { if ('lkJat' !== _0x534145(0x261)) { _0x1a48df(![]), _0x2c63f9(_0x534145(0x7e2)); return; } else { const _0x389964 = _0x5d54b4() || { 'name': '你' }, _0x199dfd = _0x118a24(_0x2e4cb0), { omniText: _0x4f68fa } = _0x5bd842(_0x2e4cb0, _0x24ae96[_0x534145(0x192)]); let _0x46613e = ''; if (_0x58dae9['linkedWorldBookIds'] && _0x58dae9['linkedWorldBookIds'][_0x534145(0x256)] > 0x0) { if (_0x534145(0x47b) !== _0x534145(0x47b)) _0x4dfa9e[_0x534145(0x472)](); else { const _0x478eab = _0x58dae9[_0x534145(0x106)][_0x534145(0x6dd)](_0x267253 => _0x24ae96['worldBooks'][_0x534145(0x1c6)](_0x3c587e => _0x3c587e['id'] === _0x267253))[_0x534145(0x3ea)](Boolean)[_0x534145(0x6dd)](_0x41db4b => _0x534145(0x632) + _0x41db4b[_0x534145(0x7e5)] + '\x0a' + _0x41db4b[_0x534145(0x77b)])[_0x534145(0x799)](''); if (_0x478eab) _0x46613e = _0x534145(0x1ee) + _0x478eab; } } const _0xf9822e = _0x389964[_0x534145(0x791)] ? _0x534145(0x141) + _0x389964[_0x534145(0x7e5)] + '”的补充信息\x0a' + _0x389964[_0x534145(0x791)] : '', _0x56b946 = _0x4e95be(), _0xb0fb16 = _0x534145(0x2e5) + _0x58dae9['name'] + _0x534145(0x6ac) + _0x389964[_0x534145(0x7e5)] + _0x534145(0x111) + _0x58dae9['persona'] + '\x0a' + _0xf9822e + '\x0a' + _0x46613e + _0x534145(0x5b3) + (_0x4f68fa || _0x534145(0x28f)) + '\x0a---\x0a---\x0a##\x20最近的动态回顾\x0a' + (_0x56b946 || _0x534145(0x2ce)) + _0x534145(0x71d) + (_0x199dfd || _0x534145(0x372)) + _0x534145(0x28b); _0x44f41d = [{ 'role': 'system', 'content': _0xb0fb16 }, { 'role': _0x534145(0xe9), 'content': _0x534145(0x2f3) }]; const _0x53e133 = await _0x519e38(_0x44f41d); if (_0x53e133) { if (_0x534145(0x624) !== _0x534145(0x516)) { let _0x3b8b88 = _0x24ae96[_0x534145(0x80a)][_0x534145(0x1c6)](_0x1f6b67 => _0x1f6b67[_0x534145(0x5f9)] === _0x2e4cb0); !_0x3b8b88 && (_0x3b8b88 = { 'characterId': _0x2e4cb0, 'entries': [] }, _0x24ae96[_0x534145(0x80a)]['push'](_0x3b8b88)); _0x3b8b88[_0x534145(0x62d)]['push']({ 'timestamp': Date[_0x534145(0x695)](), 'author': _0x2e4cb0, 'content': _0x53e133 }), _0x5d845c(); const _0x2340bf = _0x3b8b88[_0x534145(0x62d)]['length']; _0x24ae96[_0x534145(0x7f0)] = Math[_0x534145(0x4b9)](_0x2340bf / 0x2) - 0x1, _0x1ca45d(); } else { const _0x78e50c = _0x1b867b['querySelector']('.load-more-btn'); if (_0x78e50c) _0x78e50c[_0x534145(0x28c)](); } } } } catch (_0x36aef3) { if (_0x534145(0x131) === 'zIvoR') { const _0x52154c = _0x57de56(_0x554c7d[0x1]), _0x3ddb3d = _0x8bd1b6[0x2][_0x534145(0x529)](), _0x251130 = _0x50570b(_0x17868a[_0x534145(0x192)]); let _0x247b7f = null; if (_0x3ddb3d === _0x251130[_0x534145(0x7e5)]) _0x247b7f = _0x251130['id']; else { const _0x2adad8 = _0x2f4d27(); if (_0x2adad8[_0x534145(0x776)] === _0x534145(0x324)) { const _0xc143ae = _0x5071d0[_0x534145(0x4c0)][_0x534145(0x1c6)](_0x36a93a => _0x2adad8[_0x534145(0x590)]['includes'](_0x36a93a['id']) && _0x36a93a[_0x534145(0x7e5)] === _0x3ddb3d); if (_0xc143ae) _0x247b7f = _0xc143ae['id']; } } if (_0x247b7f) return { 'type': _0x534145(0x2a6), 'amount': _0x52154c, 'recipientId': _0x247b7f, 'senderId': _0x271120['id'] }; else return { 'type': _0x534145(0x13b), 'content': _0x534145(0x801) + _0x3ddb3d + _0x534145(0x638) }; } else _0x880caf('生成日记失败:\x20' + _0x36aef3[_0x534145(0x2ec)]); } finally { _0x541a9b(![]), _0x24ae96[_0x534145(0x3c6)] = ![]; } } function _0x5b421a() { const _0x487ceb = _0x113cd8; if (_0x487ceb(0x6e1) === _0x487ceb(0x6e1)) { const _0x1e752a = document[_0x487ceb(0x2c0)](_0x487ceb(0x7b3)), _0x3d777b = document[_0x487ceb(0x2c0)](_0x487ceb(0x384)), _0x13a570 = document[_0x487ceb(0x437)](_0x487ceb(0x7c0)); _0x24ae96['meetingViewMode'] === _0x487ceb(0x60e) ? (_0x1e752a[_0x487ceb(0x610)][_0x487ceb(0x452)] = _0x487ceb(0x3d2), _0x3d777b[_0x487ceb(0x610)]['display'] = _0x487ceb(0x3fb)) : (_0x1e752a[_0x487ceb(0x610)][_0x487ceb(0x452)] = _0x487ceb(0x3fb), _0x3d777b[_0x487ceb(0x610)][_0x487ceb(0x452)] = _0x487ceb(0x3d2)), _0x13a570[_0x487ceb(0x610)][_0x487ceb(0x452)] = _0x487ceb(0x3fb); } else return _0x4c9c81(new _0x3593bb(_0x487ceb(0x49c))); } function _0x580ba3() { const _0x2dab1a = _0x113cd8; if ('REcON' !== 'REcON') _0x259b3e[_0x2dab1a(0x82a)][_0x2dab1a(0x28c)](_0x2dab1a(0x103)); else { const _0x52af79 = document[_0x2dab1a(0x2c0)](_0x2dab1a(0x4d5)), _0x4263d4 = document[_0x2dab1a(0x2c0)]('galgame-text'); if (_0x24ae96[_0x2dab1a(0x7f7)][_0x2dab1a(0x256)] > 0x0) { if (_0x2dab1a(0xcf) === _0x2dab1a(0xcf)) { const _0x223843 = _0x24ae96['activeMeetingScriptQueue']['shift'](); _0x52af79[_0x2dab1a(0x548)] = _0x223843[_0x2dab1a(0x4d9)] === _0x2dab1a(0x348) ? '旁白' : _0x223843[_0x2dab1a(0x4d9)], _0x4263d4[_0x2dab1a(0x548)] = _0x223843[_0x2dab1a(0x6f0)], _0x223843[_0x2dab1a(0x4d9)] !== 'narrator' && _0x3ee8b8(_0x24ae96['activeMeetingCharId'], _0x223843['emotion']); } else { _0x10cc00[_0x2dab1a(0x40f)](_0x2dab1a(0x12f), _0x36f3c2); const _0x2ca51e = { 'role': _0x2dab1a(0x2f2), 'content': _0x2dab1a(0x1e6) + _0x5a667c[_0x2dab1a(0x2ec)], 'senderId': _0x4322d1['id'], 'isOffline': _0x3512a5 }; _0x123c4a[_0x2dab1a(0x5bb)][_0x2dab1a(0x60b)](_0x2ca51e), _0x3290a0(); } } else { const _0x18ed97 = _0x24ae96[_0x2dab1a(0x6f1)][_0x24ae96['activeMeetingCharId']]; if (_0x18ed97 && _0x18ed97[_0x2dab1a(0x256)] > 0x0) { _0x24ae96[_0x2dab1a(0x7f7)] = [..._0x18ed97]; const _0x1e7cc0 = _0x24ae96[_0x2dab1a(0x7f7)][_0x2dab1a(0x5d9)](); _0x52af79[_0x2dab1a(0x548)] = _0x1e7cc0[_0x2dab1a(0x4d9)] === _0x2dab1a(0x348) ? '旁白' : _0x1e7cc0['speaker'], _0x4263d4[_0x2dab1a(0x548)] = _0x1e7cc0[_0x2dab1a(0x6f0)], _0x1e7cc0[_0x2dab1a(0x4d9)] !== 'narrator' && (_0x2dab1a(0x727) === _0x2dab1a(0x1d6) ? (_0x41c86f(), _0x3507e1(![])) : _0x3ee8b8(_0x24ae96[_0x2dab1a(0x3ae)], _0x1e7cc0[_0x2dab1a(0x43b)])); } else 'JdnWp' === _0x2dab1a(0x5f2) ? (_0x52af79[_0x2dab1a(0x548)] = '旁白', _0x4263d4[_0x2dab1a(0x548)] = _0x2dab1a(0x221)) : (_0x5bb1f2['classList'][_0x2dab1a(0x28c)](_0x2dab1a(0x155)), _0x2bf508 = null); } } } async function _0x3ee8b8(_0x3e35fc, _0x5a561a) { const _0x38b288 = _0x113cd8, _0x5283a4 = document[_0x38b288(0x2c0)](_0x38b288(0x613)), _0x2165a8 = ['normal', _0x38b288(0x4a4), 'angry', _0x38b288(0x3b8), _0x38b288(0x2dd)], _0x375f84 = _0x2165a8[_0x38b288(0x4e4)](_0x5a561a) ? _0x5a561a : _0x38b288(0x27c); try { const _0x3cd6af = await _0x5aea9f(_0x38b288(0x4b4) + _0x375f84 + '_' + _0x3e35fc); if (_0x3cd6af) { if (_0x38b288(0x31d) === _0x38b288(0x31d)) _0x5283a4[_0x38b288(0x610)]['opacity'] = 0x0, setTimeout(() => { const _0x220fc2 = _0x38b288; _0x5283a4[_0x220fc2(0xd4)] = URL['createObjectURL'](_0x3cd6af), _0x5283a4['style'][_0x220fc2(0x2d3)] = 0x1; }, 0x12c); else { _0x306930 = _0x5a2d8a; let _0x48bed0 = null; if (_0x575f1d?.[_0x38b288(0x776)] === _0x38b288(0x62a)) _0x48bed0 = _0x3eb970(_0x3628b1[_0x38b288(0x590)][0x0]); else _0x486e2a?.[_0x38b288(0x776)] === 'group' && _0x188f11 && (_0x48bed0 = _0x299f65(_0x205903)); _0x48bed0?.['avatar'] && (_0x84369a = _0x48bed0[_0x38b288(0x37c)]); } } else { const _0x200cfe = await _0x5aea9f(_0x38b288(0x210) + _0x3e35fc); _0x200cfe ? _0x5283a4['src'] = URL[_0x38b288(0x6c9)](_0x200cfe) : _0x5283a4[_0x38b288(0xd4)] = ''; } } catch (_0x5b1593) { console[_0x38b288(0x40f)](_0x38b288(0x278), _0x5b1593), _0x5283a4[_0x38b288(0xd4)] = ''; } } function _0x30ad4e(_0x449485) { const _0x52e530 = _0x113cd8; if (_0x52e530(0x56b) === _0x52e530(0x438)) { _0x1e45a2(_0x52e530(0x7b0)); return; } else { const _0x50985c = _0x5c4526(_0x449485); if (!_0x50985c) return; const _0x567d8a = _0x24ae96['chats'][_0x52e530(0x1c6)](_0x48725f => _0x48725f[_0x52e530(0x776)] === 'private' && _0x48725f[_0x52e530(0x590)][_0x52e530(0x4e4)](_0x449485)), _0x19e8df = _0xb7cda(_0x567d8a['id']), _0x3a0757 = _0x24ae96['conversationHistory'][_0x52e530(0x3ea)](_0x401e40 => _0x401e40[_0x52e530(0x779)])['pop'](), _0x43447c = document[_0x52e530(0x2c0)](_0x52e530(0x4d5)), _0x50d9e5 = document[_0x52e530(0x2c0)](_0x52e530(0x4f6)); let _0x2d1b3b = null; if (_0x3a0757) { if (_0x3a0757[_0x52e530(0x660)] === _0x52e530(0x2f2)) { const _0x33867d = _0x24ae96[_0x52e530(0x6f1)][_0x449485]; _0x33867d && _0x33867d[_0x52e530(0x256)] > 0x0 && (_0x2d1b3b = _0x33867d['at'](-0x1)); } else _0x2d1b3b = { 'speaker': _0x19e8df[_0x52e530(0x7e5)], 'line': _0x3a0757[_0x52e530(0x77b)], 'emotion': 'normal' }; } if (_0x2d1b3b) _0x43447c[_0x52e530(0x548)] = _0x2d1b3b[_0x52e530(0x4d9)] === _0x52e530(0x348) ? '旁白' : _0x2d1b3b[_0x52e530(0x4d9)], _0x50d9e5[_0x52e530(0x548)] = _0x2d1b3b['line'], _0x2d1b3b['speaker'] === _0x50985c[_0x52e530(0x7e5)] ? _0x3ee8b8(_0x449485, _0x2d1b3b[_0x52e530(0x43b)]) : _0x3ee8b8(_0x449485, _0x52e530(0x27c)); else { if ('GSWQc' === _0x52e530(0x4b0)) { const _0x5b27f4 = { 'id': 'user_' + _0x418c8f[_0x52e530(0x695)](), ..._0x7b0bb }; _0x1d3b42['userProfiles'][_0x52e530(0x60b)](_0x5b27f4), !_0x4a05e0[_0x52e530(0x4b7)] && (_0x501205[_0x52e530(0x4b7)] = _0x5b27f4['id']); } else _0x43447c[_0x52e530(0x548)] = _0x50985c[_0x52e530(0x7e5)], _0x50d9e5[_0x52e530(0x548)] = _0x52e530(0x24e), _0x3ee8b8(_0x449485, _0x52e530(0x27c)); } } } function _0xbb90c1() { const _0x5ee9ea = _0x113cd8, _0x3faff0 = new Date(), _0x2e7255 = document['getElementById'](_0x5ee9ea(0x1f8)), _0x5ae6d4 = document[_0x5ee9ea(0x2c0)](_0x5ee9ea(0x48e)); if (_0x2e7255 && _0x5ae6d4) { const _0x1db6da = String(_0x3faff0[_0x5ee9ea(0xff)]())[_0x5ee9ea(0xfe)](0x2, '0'), _0xc2181d = String(_0x3faff0['getMinutes']())[_0x5ee9ea(0xfe)](0x2, '0'); _0x2e7255[_0x5ee9ea(0x548)] = _0x1db6da + ':' + _0xc2181d; const _0x26de21 = _0x3faff0[_0x5ee9ea(0x5bf)]() + 0x1, _0x1ad04a = _0x3faff0[_0x5ee9ea(0x72e)](), _0x1d77f5 = ['星期日', _0x5ee9ea(0x2fa), '星期二', '星期三', '星期四', _0x5ee9ea(0x453), _0x5ee9ea(0x327)][_0x3faff0[_0x5ee9ea(0x2b4)]()]; _0x5ae6d4[_0x5ee9ea(0x548)] = _0x26de21 + '月' + _0x1ad04a + '日\x20' + _0x1d77f5; } } const _0x5afdc6 = document['getElementById'](_0x113cd8(0x16f)), _0x384ee8 = document[_0x113cd8(0x2c0)]('chat-listen-together-button'), _0x2ce339 = document[_0x113cd8(0x2c0)]('cancel-listen-together'), _0x27b4d7 = document['getElementById'](_0x113cd8(0x1fb)), _0x2842d2 = document[_0x113cd8(0x2c0)]('listen-together-song-list'), _0x5eabbb = document['getElementById'](_0x113cd8(0x581)), _0x222f40 = document[_0x113cd8(0x2c0)](_0x113cd8(0x49e)), _0x611daf = document[_0x113cd8(0x2c0)]('lt-ui-close-btn'), _0x47790c = document[_0x113cd8(0x2c0)](_0x113cd8(0x121)); let _0x481ebb = []; async function _0x2cb520() { const _0x15ba72 = _0x113cd8; if ('fEIIR' !== _0x15ba72(0x128)) { if (!_0x24ae96[_0x15ba72(0x192)]) return; _0x2842d2[_0x15ba72(0x217)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>正在清点圣殿藏品...</p>', _0x5afdc6[_0x15ba72(0x82a)][_0x15ba72(0x2c7)]('show'); const _0x453276 = await _0x33cff8(); if (_0x453276['length'] === 0x0) { _0x2842d2[_0x15ba72(0x217)] = _0x15ba72(0x5b6); return; } _0x2842d2['innerHTML'] = '', _0x453276['forEach'](_0x4520f7 => { const _0x43f282 = _0x15ba72; if (_0x43f282(0x3f3) !== _0x43f282(0x43a)) { const _0x1ce799 = document[_0x43f282(0x2b5)](_0x43f282(0x6ee)); _0x1ce799[_0x43f282(0x38a)] = _0x43f282(0x20d); const _0x26e7d2 = _0x4520f7[_0x43f282(0x1f5)] ? URL[_0x43f282(0x6c9)](_0x4520f7[_0x43f282(0x1f5)]) : _0x5d2cd8; _0x1ce799['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0x26e7d2 + _0x43f282(0x629) + (_0x4520f7[_0x43f282(0x291)][_0x43f282(0x58d)] || _0x43f282(0x57e)) + _0x43f282(0x535) + (_0x4520f7['info']['歌手'] || '未知艺术家') + _0x43f282(0x5c4), _0x1ce799[_0x43f282(0x41c)]('click', () => { const _0x190470 = _0x43f282; if (_0x190470(0x2b3) === _0x190470(0x6ef)) return; else _0x3cd3c5(_0x4520f7); }), _0x2842d2[_0x43f282(0x3b1)](_0x1ce799); } else { if (_0x4f3279) _0x361334(_0xe58cf2); } }); } else throw new _0x328630(_0x15ba72(0x461)); } function _0x1e8095() { const _0x289455 = _0x113cd8; if (_0x289455(0x770) !== _0x289455(0x733)) _0x5afdc6[_0x289455(0x82a)][_0x289455(0x28c)](_0x289455(0x155)); else { _0x57f355['activeMeetingScriptQueue'] = _0x4c71cc, _0x1f9626[_0x289455(0x6f1)][_0x3358fb['id']] = [..._0x2b3540], _0x3184c1(); const _0x15e520 = _0x4f5d23[_0x289455(0x6dd)](_0x4f50c4 => _0x4f50c4[_0x289455(0x4d9)] === _0x289455(0x348) ? _0x4f50c4[_0x289455(0x6f0)] : _0x4f50c4[_0x289455(0x4d9)] + ':\x20' + _0x4f50c4[_0x289455(0x6f0)])[_0x289455(0x799)]('\x0a\x0a'); _0x5bab5f[_0x289455(0x5bb)][_0x289455(0x60b)]({ 'role': _0x289455(0x2f2), 'senderId': _0x3c3b2b['id'], 'timestamp': _0xf84d1e[_0x289455(0x695)](), 'isOffline': !![], 'content': _0x15e520 }); } } async function _0x3cd3c5(_0x58a524) { const _0x10731f = _0x113cd8; if (!_0x24ae96[_0x10731f(0x192)] || !_0x58a524) return; let _0x51eada = null; if (_0x58a524['cover']) { if (_0x10731f(0x704) === _0x10731f(0x82d)) _0x46cb53(), _0x12f4df('worldBook', 'worldBookEditor'); else try { _0x10731f(0x42b) !== _0x10731f(0x378) ? _0x51eada = await _0x2e73e7(_0x58a524[_0x10731f(0x1f5)]) : _0x811ccf[_0x10731f(0x60b)]('[' + _0x1f89e0(_0x15e414) + ']\x20' + _0x37767c['content']); } catch (_0x2f9bbd) { console['error'](_0x10731f(0x4c9), _0x2f9bbd), _0x51eada = _0x5d2cd8; } } const _0x541d35 = { 'role': _0x10731f(0xe9), 'type': 'listen-together-invite', 'content': _0x10731f(0x4f3) + _0x58a524[_0x10731f(0x291)]['歌曲名称'] + ']', 'songId': _0x58a524['id'], 'songName': _0x58a524[_0x10731f(0x291)][_0x10731f(0x58d)], 'artist': _0x58a524['info']['歌手'], 'coverUrl': _0x51eada, 'timestamp': Date[_0x10731f(0x695)]() }; _0x24ae96[_0x10731f(0x5bb)]['push'](_0x541d35), _0x16869e(), _0x1c0e55(), _0x1e8095(), setTimeout(_0x327f12, 0x64); } _0x384ee8[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x2cb520), _0x2ce339[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x1e8095), _0x27b4d7[_0x113cd8(0x41c)](_0x113cd8(0x472), _0x1e8095); async function _0x590fdf(_0x59bad3, _0x15d1fc, _0x532b8a) { const _0xd327be = _0x113cd8, _0x547e25 = _0x24ae96[_0xd327be(0x2e2)]['find'](_0x4692a3 => _0x4692a3[_0xd327be(0x7ad)] && _0x4692a3[_0xd327be(0x7ad)][_0xd327be(0x14e)]); if (_0x547e25 && _0x547e25['id'] !== _0x24ae96['activeChatId']) _0x547e25[_0xd327be(0x7ad)] = null, _0x880caf('已自动断开与其他人的听歌同步。'), _0x5d845c(); else { if (_0x547e25 && _0x547e25['id'] === _0x24ae96[_0xd327be(0x192)]) { if (_0xd327be(0xf9) !== _0xd327be(0xf9)) _0x1fb9c3 += '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是“昨天”的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a'; else { _0x880caf(_0xd327be(0x5a7)); return; } } } _0x541a9b(!![], _0xd327be(0x793)); const _0x4b6996 = _0x3cc63d(); if (!_0x4b6996) { _0x541a9b(![]), _0x880caf(_0xd327be(0x7e2)); return; } const _0x220350 = await _0x5ef7ba(_0x59bad3); if (!_0x220350) { if (_0xd327be(0x689) !== _0xd327be(0x689)) { const _0x1470f6 = _0x55c264['getElementById'](_0xd327be(0x355)); _0x1470f6[_0xd327be(0x217)] = ''; if (_0x2bb0b6['friendCircles']['length'] === 0x0) { _0x1470f6[_0xd327be(0x217)] = _0xd327be(0x47f); return; } _0x45bf49[_0xd327be(0x7ce)]['forEach'](_0x381f20 => { const _0x2646e2 = _0xd327be, _0xef2901 = _0x4d65e6[_0x2646e2(0xdc)][_0x2646e2(0x1c6)](_0xe752a8 => _0xe752a8['id'] === _0x381f20['boundUserProfileId']) || { 'name': _0x2646e2(0x685) }, _0x378564 = _0x4a5ff4['createElement'](_0x2646e2(0x6ee)); _0x378564[_0x2646e2(0x38a)] = _0x2646e2(0x41a), _0x378564[_0x2646e2(0x362)]['id'] = _0x381f20['id'], _0x378564[_0x2646e2(0x217)] = _0x2646e2(0x63a) + _0x381f20['name'] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20' + _0xef2901[_0x2646e2(0x7e5)] + _0x2646e2(0x61f) + _0x381f20['memberCharacterIds']['length'] + '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', _0x378564[_0x2646e2(0x41c)]('click', () => _0x259673(_0x381f20['id'])), _0x1470f6['appendChild'](_0x378564); }); } else { _0x541a9b(![]), _0x880caf('错误：找不到这首作为“信物”的歌。'); return; } } _0x4b6996[_0xd327be(0x7ad)] = { 'isActive': !![], 'songId': _0x59bad3, 'leaderId': 'user', 'songName': _0x220350[_0xd327be(0x291)][_0xd327be(0x58d)], 'artist': _0x220350[_0xd327be(0x291)]['歌手'], 'cover': _0x220350['cover'] }, _0x5d845c(), document[_0xd327be(0x2c0)](_0xd327be(0x648))['src'] = _0x220350[_0xd327be(0x1f5)] ? URL[_0xd327be(0x6c9)](_0x220350[_0xd327be(0x1f5)]) : _0x5d2cd8, document[_0xd327be(0x2c0)](_0xd327be(0x13f))['textContent'] = _0x220350[_0xd327be(0x291)][_0xd327be(0x58d)], document[_0xd327be(0x2c0)](_0xd327be(0x7ab))[_0xd327be(0x548)] = _0x220350[_0xd327be(0x291)]['歌手'], _0x2f831a(_0x220350), _0x222f40[_0xd327be(0x610)][_0xd327be(0x452)] = _0xd327be(0x14f), setTimeout(() => _0x222f40[_0xd327be(0x82a)][_0xd327be(0x2c7)](_0xd327be(0x155)), 0xa), _0x532b8a[_0xd327be(0x217)] = _0xd327be(0x277) + _0x532b8a['querySelector']('.listen-together-song')['outerHTML'], _0x24ae96[_0xd327be(0x5bb)][_0x15d1fc] && (_0x24ae96[_0xd327be(0x5bb)][_0x15d1fc]['accepted'] = !![], _0x16869e()), _0x541a9b(![]), _0x190648(_0x59bad3, [_0x59bad3]), _0x1d3cd2(_0x220350, !![]); } function _0x4c01e9() { const _0x52b375 = _0x113cd8, _0x432498 = _0x24ae96[_0x52b375(0x2e2)][_0x52b375(0x1c6)](_0x166a39 => _0x166a39[_0x52b375(0x7ad)] && _0x166a39['activeListenSession'][_0x52b375(0x14e)]); _0x432498 && (_0x432498['activeListenSession'] = null, _0x5d845c(), _0x880caf('同步已断开。'), _0x1d3cd2(), _0x222f40['classList'][_0x52b375(0x28c)](_0x52b375(0x155)), setTimeout(() => _0x222f40[_0x52b375(0x610)][_0x52b375(0x452)] = _0x52b375(0x3d2), 0x12c)); } function _0x4059a9(_0x481336) { const _0x7d1339 = _0x113cd8; if (!_0x481336) return []; const _0x57cb58 = _0x481336[_0x7d1339(0x1da)]('\x0a'), _0x3afde7 = [], _0x54bbf6 = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x20de8d of _0x57cb58) { if (_0x7d1339(0x569) !== _0x7d1339(0x67e)) { const _0x5736b1 = _0x20de8d['match'](_0x54bbf6); if (_0x5736b1) { const _0x71c7c6 = parseInt(_0x5736b1[0x1], 0xa), _0x3af89b = parseInt(_0x5736b1[0x2], 0xa), _0x1e6c59 = parseInt(_0x5736b1[0x3], 0xa) * (_0x5736b1[0x3][_0x7d1339(0x256)] === 0x2 ? 0xa : 0x1), _0x3a534e = _0x71c7c6 * 0x3c + _0x3af89b + _0x1e6c59 / 0x3e8, _0x40d946 = _0x20de8d['replace'](_0x54bbf6, '')[_0x7d1339(0x529)](); _0x40d946 && (_0x7d1339(0x178) !== 'YArxH' ? _0x3afde7[_0x7d1339(0x60b)]({ 'time': _0x3a534e, 'text': _0x40d946 }) : (_0x56a7bc['image'] = _0x2cf8ef, _0x4835c2 = !![])); } } else _0xceef01(![]), _0xec29fe['error']('全量导入失败:', _0x3c1145), _0x520180('导入失败:\x20' + _0x43cbc8[_0x7d1339(0x2ec)]); } return _0x3afde7; } function _0x2f831a(_0x53e5db) { const _0x455e9f = _0x113cd8; if (_0x455e9f(0x6df) !== _0x455e9f(0x3e1)) { _0x481ebb = _0x4059a9(_0x53e5db[_0x455e9f(0x1e9)]), _0x47790c[_0x455e9f(0x217)] = ''; if (_0x481ebb[_0x455e9f(0x256)] === 0x0) { _0x47790c[_0x455e9f(0x217)] = _0x455e9f(0x1df); return; } _0x481ebb[_0x455e9f(0x203)]((_0x2c2a9e, _0x4485db) => { const _0x20fe63 = _0x455e9f, _0xb1dd02 = document['createElement']('p'); _0xb1dd02[_0x20fe63(0x548)] = _0x2c2a9e[_0x20fe63(0x13b)], _0xb1dd02['id'] = _0x20fe63(0xf2) + _0x4485db, _0x47790c[_0x20fe63(0x3b1)](_0xb1dd02); }); } else { _0x568286[_0x455e9f(0x40f)](_0x455e9f(0x4aa)); return; } } function _0x580b8c() { const _0x11018d = _0x113cd8; if (_0x11018d(0x566) !== 'JHhrY') { if (_0x481ebb['length'] === 0x0) return; const _0x52877d = _0x5eabbb[_0x11018d(0x62f)]; let _0x40c86f = -0x1; for (let _0x409234 = 0x0; _0x409234 < _0x481ebb['length']; _0x409234++) { if (_0x52877d >= _0x481ebb[_0x409234]['time']) { if (_0x11018d(0x6bf) === _0x11018d(0x66c)) { const _0x44534f = _0x11018d(0xd3); _0x2d05d9[_0x11018d(0x5e4)][_0x11018d(0x393)](_0x11018d(0x6ed), _0x44534f); const _0x567e46 = _0x54926a[_0x11018d(0x2c0)](_0x11018d(0x280)), _0x3ff5db = _0x128119['getElementById'](_0x11018d(0x78f)), _0x595f71 = _0x4fbd63[_0x11018d(0x2c0)](_0x11018d(0x57b)), _0x33bdb9 = _0x4765c9[_0x11018d(0x2c0)](_0x11018d(0x482)), _0x213c25 = _0x567e46[_0x11018d(0x437)](_0x11018d(0x451)), _0x25eac4 = () => { const _0x57208a = _0x11018d; _0x567e46[_0x57208a(0x28c)](), _0x775c2(); }; _0x595f71['onclick'] = () => { const _0x4c408c = _0x11018d; _0x4bba72(_0x3ff5db[_0x4c408c(0x69f)]), _0x25eac4(); }, _0x33bdb9['onclick'] = _0x25eac4, _0x213c25[_0x11018d(0x2c4)] = _0x25eac4; } else _0x40c86f = _0x409234; } else { if (_0x11018d(0x188) === 'xbLEk') break; else { const _0x26703c = _0x37d097(_0x4f4a85[_0x11018d(0x6a5)]); _0x26703c && (_0x42c1a5 = _0x26703c['name'], _0x2a4514 = _0x26703c[_0x11018d(0x37c)]); } } } if (_0x40c86f !== -0x1) { if ('hgRXR' !== _0x11018d(0x1ec)) { _0xfb489f[_0x11018d(0x69f)] = '', _0x5988b0[_0x11018d(0x217)] = ''; if (_0x4181b4['characters'][_0x11018d(0x256)] < 0x2) { _0x3c4cb3(_0x11018d(0x3f0)); return; } _0xa396bc[_0x11018d(0x4c0)]['forEach'](_0xfd021b => { const _0xa0c611 = _0x11018d, _0x248c1e = _0x32f254[_0xa0c611(0x2b5)]('li'); _0x248c1e[_0xa0c611(0x38a)] = _0xa0c611(0x4a6), _0x248c1e[_0xa0c611(0x217)] = _0xa0c611(0x56f) + _0xfd021b['id'] + _0xa0c611(0x27a) + _0xfd021b['id'] + _0xa0c611(0x5aa) + (_0xfd021b[_0xa0c611(0x37c)] || _0x5eb038) + _0xa0c611(0x369) + _0xfd021b['id'] + _0xa0c611(0x1bb) + _0xfd021b['name'] + _0xa0c611(0x398), _0x17f686[_0xa0c611(0x3b1)](_0x248c1e); }), _0x548f3a(_0x11018d(0x3d9), _0x11018d(0x311)); } else { const _0x42e8c6 = _0x47790c[_0x11018d(0x439)]('p'); _0x42e8c6[_0x11018d(0x203)](_0x20ad51 => _0x20ad51[_0x11018d(0x82a)]['remove'](_0x11018d(0x33a))); const _0x211309 = document[_0x11018d(0x2c0)](_0x11018d(0xf2) + _0x40c86f); _0x211309 && (_0x11018d(0x72b) !== _0x11018d(0x72b) ? _0x7f3ea6[_0x11018d(0x610)]['backgroundImage'] = _0x11018d(0x3d2) : (_0x211309['classList'][_0x11018d(0x2c7)](_0x11018d(0x33a)), _0x211309[_0x11018d(0x748)]({ 'behavior': _0x11018d(0x6ba), 'block': _0x11018d(0x640) }))); } } } else _0x25101e[_0x11018d(0xdc)] = _0x5cff6a['userProfiles'][_0x11018d(0x3ea)](_0x99291a => _0x99291a['id'] !== _0x431ca7), _0x2860f6['activeUserProfileId'] === _0x287122 && (_0x29a51f['activeUserProfileId'] = _0x54c03a['userProfiles'][0x0]['id']), _0x3991b7[_0x11018d(0x2e2)][_0x11018d(0x203)](_0x590818 => { const _0x2fd6b5 = _0x11018d; _0x590818[_0x2fd6b5(0x346)] === _0x92019c && (_0x590818[_0x2fd6b5(0x346)] = _0x5e5c0f['activeUserProfileId']); }), _0x312680(), _0x2b6992('用户已删除。'), _0x413353(), _0x1f187e(_0x11018d(0x179), _0x11018d(0x7ff)); } _0x611daf[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x532778 = _0x113cd8; _0x222f40[_0x532778(0x82a)][_0x532778(0x28c)](_0x532778(0x155)), setTimeout(() => _0x222f40[_0x532778(0x610)][_0x532778(0x452)] = 'none', 0x12c); }), document[_0x113cd8(0x2c0)](_0x113cd8(0x6c8))['addEventListener'](_0x113cd8(0x472), () => { const _0x2d55c8 = _0x113cd8; _0x24ae96[_0x2d55c8(0x20a)] && _0x24ae96[_0x2d55c8(0x20a)][_0x2d55c8(0x14e)] && (_0x222f40[_0x2d55c8(0x610)][_0x2d55c8(0x452)] = _0x2d55c8(0x14f), setTimeout(() => _0x222f40[_0x2d55c8(0x82a)][_0x2d55c8(0x2c7)](_0x2d55c8(0x155)), 0xa)); }), _0x5eabbb[_0x113cd8(0x41c)](_0x113cd8(0x20e), _0x580b8c); const _0x53b820 = document[_0x113cd8(0x2c0)](_0x113cd8(0x6ea)), _0x36db40 = document[_0x113cd8(0x2c0)]('widget-next-btn'), _0x1da050 = document['getElementById'](_0x113cd8(0x273)); _0x53b820[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x4cba47 = _0x113cd8; _0x5eabbb[_0x4cba47(0xd4)] && (_0x5eabbb[_0x4cba47(0x6a7)] ? _0x5eabbb[_0x4cba47(0x5d3)]() : _0x5eabbb['pause']()); }), _0x36db40[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x349914 = _0x113cd8; if (_0x58eb47[_0x349914(0x256)] === 0x0) return; _0x4fa8dd = (_0x4fa8dd + 0x1) % _0x58eb47[_0x349914(0x256)], _0x190648(_0x58eb47[_0x4fa8dd], _0x58eb47); }), _0x1da050[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x556785 = _0x113cd8; if (_0x58eb47['length'] === 0x0) return; _0x4fa8dd = (_0x4fa8dd - 0x1 + _0x58eb47[_0x556785(0x256)]) % _0x58eb47[_0x556785(0x256)], _0x190648(_0x58eb47[_0x4fa8dd], _0x58eb47); }), _0x5eabbb[_0x113cd8(0x41c)](_0x113cd8(0x5d3), () => { const _0x3917f9 = _0x113cd8; if (_0x3917f9(0x1dc) !== _0x3917f9(0x560)) _0x53b820['textContent'] = '❚❚'; else { const _0x5c5b85 = _0x2301b7[_0x3917f9(0x437)](_0x3917f9(0x10a) + _0x33a364 + _0x3917f9(0x6e5) + _0x213443 + _0x3917f9(0x3f2))?.['innerHTML']; _0x5c5b85 && (_0x14ec04[_0x3917f9(0x217)] = _0x5c5b85); } }), _0x5eabbb[_0x113cd8(0x41c)](_0x113cd8(0x3d8), () => { const _0x2d1b65 = _0x113cd8; _0x53b820[_0x2d1b65(0x548)] = '▶'; }), _0x5eabbb['addEventListener'](_0x113cd8(0x20f), () => { const _0x6f5b38 = _0x113cd8; _0x36db40[_0x6f5b38(0x472)](); }), _0x5eabbb[_0x113cd8(0x41c)](_0x113cd8(0x5d3), () => { const _0x476111 = _0x113cd8; if (_0x476111(0x734) !== 'lrVgv') { const _0x1ca260 = document[_0x476111(0x2c0)]('global-player-play-pause-btn'); if (_0x1ca260) _0x1ca260[_0x476111(0x548)] = '❚❚'; } else _0x3bb781 = _0x130530, _0x3c363e[_0x476111(0x82a)][_0x476111(0x2c7)](_0x476111(0x155)); }), _0x5eabbb['addEventListener'](_0x113cd8(0x3d8), () => { const _0xac529e = _0x113cd8, _0x34e329 = document[_0xac529e(0x2c0)](_0xac529e(0x59b)); if (_0x34e329) _0x34e329[_0xac529e(0x548)] = '▶'; }), _0x5eabbb[_0x113cd8(0x41c)](_0x113cd8(0x20f), () => { const _0xee9c32 = _0x113cd8, _0x116e01 = document[_0xee9c32(0x2c0)](_0xee9c32(0x7b5)); _0x116e01 && (_0xee9c32(0x75b) === 'fxhce' ? _0x116e01[_0xee9c32(0x472)]() : _0x27b85b['classList']['remove'](_0xee9c32(0x155))); }); async function _0x46394c() { const _0x55ac89 = _0x113cd8, _0x1f5e64 = [..._0x13c5ee]; try { if (_0x55ac89(0x216) === 'FHlCG') _0x4e7065[_0x55ac89(0x38d)] = ![], _0x39145b[_0x55ac89(0x548)] = '获取'; else { const _0x495afa = localStorage['getItem']('customStickers'); if (_0x495afa) { if ('FfaJh' !== _0x55ac89(0x7f8)) { const _0x4c909c = JSON['parse'](_0x495afa); Array['isArray'](_0x4c909c) ? _0x438419 = [..._0x1f5e64, ..._0x4c909c] : _0x438419 = _0x1f5e64; } else _0xdeb3c1(), _0x139ebd(); } else _0x55ac89(0x830) === 'NVUep' ? _0x16228e[_0x55ac89(0x7e5)] !== _0x55ac89(0x6f2) && (_0x2eff3d[_0x55ac89(0x40f)](_0x55ac89(0x3a9), _0x1605e8), _0x121605({ 'role': _0x55ac89(0x2f2), 'content': '错误:\x20' + _0x4a435e['message'] }, _0x57350c[_0x55ac89(0x5bb)]['length'] - 0x1)) : _0x438419 = _0x1f5e64; } } catch (_0xca1e05) { if (_0x55ac89(0x122) === 'sXbLt') console[_0x55ac89(0x40f)]('加载自定义表情包失败，真是没用。', _0xca1e05), _0x438419 = _0x1f5e64; else { const _0x57a8b1 = _0x5783e8[_0x55ac89(0x62e)](_0x46b78e, _0x55ac89(0x1f0)), _0x50c17c = _0x57a8b1[_0x55ac89(0x20b)](_0x260aa7), _0x51ac4b = _0x50c17c[_0x55ac89(0x7a6)](); _0x51ac4b[_0x55ac89(0x468)] = () => _0x2ae55e(_0x51ac4b[_0x55ac89(0x834)]), _0x51ac4b[_0x55ac89(0x464)] = () => _0x57e068(_0x51ac4b[_0x55ac89(0x40f)]); } } if (!localStorage[_0x55ac89(0x696)](_0x55ac89(0x183))) { _0x380a1e('检测到旧版聊天数据，为了优化体验和存储空间，需要进行一次自动升级。过程很快，请稍候。')[_0x55ac89(0x73a)](async _0x37fa1b => { const _0x29bde8 = _0x55ac89; _0x29bde8(0x7ac) !== 'UpPxH' ? _0x5e7816(![]) : _0x37fa1b ? (_0x541a9b(!![], '正在升级聊天数据结构...'), await _0x3cf6b(), localStorage[_0x29bde8(0x515)](_0x29bde8(0x183), 'true'), _0x541a9b(![]), _0x880caf(_0x29bde8(0x4f5)), setTimeout(() => location['reload'](), 0x5dc)) : _0x880caf(_0x29bde8(0x664)); }); return; } if (!localStorage['getItem'](_0x55ac89(0x718))) { if (_0x55ac89(0x665) !== 'NrklN') { console['log'](_0x55ac89(0x42f)), _0x541a9b(!![], _0x55ac89(0x4d0)); const _0x347d64 = await _0x7ce5a3(); localStorage['setItem'](_0x55ac89(0x718), 'true'), _0x541a9b(![]); if (_0x347d64 > 0x0) { _0x880caf('好友圈数据升级完成，迁移了\x20' + _0x347d64 + '\x20张旧图片。应用即将刷新。'), setTimeout(() => location['reload'](), 0x5dc); return; } } else { const _0x5f4805 = _0x5bb81b[_0x55ac89(0x2c0)](_0x55ac89(0x59b)); if (_0x5f4805) _0x5f4805[_0x55ac89(0x548)] = '❚❚'; } } const _0x4f74f4 = _0x4b087b(); _0x37fc16(), _0x5dafef(), _0x1994ce(), _0x20eb95(), _0x3864e3(), _0x3b138a(), _0x445527(), _0x3e7f01(), _0x4b02e8(), _0x2c1978(), _0x1d3cd2(), _0x438b22(), setInterval(_0x438b22, 0x7530), _0x21b648(), _0x5334a7(), _0x3d0af9(); const _0x5a1d5a = document[_0x55ac89(0x2c0)](_0x55ac89(0x75a)); document['getElementById'](_0x55ac89(0x6c8))['addEventListener']('click', function (_0x285802) { const _0x14a9f1 = _0x55ac89; if (_0x285802['target']['closest'](_0x14a9f1(0x46b))) { if (_0x14a9f1(0x3c9) !== _0x14a9f1(0x3c9)) { const _0x7a42a7 = _0x754a07(); if (_0x7a42a7 && _0x7a42a7[_0x14a9f1(0x776)] === _0x14a9f1(0x62a)) _0x2ca76b(_0x7a42a7[_0x14a9f1(0x590)][0x0]); else _0x7a42a7 && _0x7a42a7[_0x14a9f1(0x776)] === _0x14a9f1(0x324) && _0x38ff8e(_0x7a42a7['id']); } else return; } const _0x518e14 = document[_0x14a9f1(0x2c0)]('widget-play-pause-btn'); _0x518e14 && (_0x14a9f1(0x39e) === 'WgGOd' ? _0x518e14['click']() : _0x48513c[_0x14a9f1(0x610)]['display'] = 'none'); }), _0x124c6c(_0x55ac89(0x540), _0x55ac89(0x45a)); (_0x4f74f4 || _0x24ae96[_0x55ac89(0x4c0)][_0x55ac89(0x256)] === 0x0) && (_0x880caf(_0x55ac89(0x5b4)), setTimeout(() => { const _0xf5d083 = _0x55ac89; _0x124c6c(_0xf5d083(0x710), _0xf5d083(0x540)), setTimeout(() => _0x64927c(), 0x64); }, 0x6a4)); const _0x7eb4ac = document[_0x55ac89(0x2c0)](_0x55ac89(0x3b2)); document['getElementById'](_0x55ac89(0x325))['addEventListener']('click', () => _0x7eb4ac[_0x55ac89(0x472)]()), document[_0x55ac89(0x2c0)](_0x55ac89(0x6ca))[_0x55ac89(0x41c)](_0x55ac89(0x472), () => { const _0x2d501c = _0x55ac89; if (_0x2d501c(0x6ab) === _0x2d501c(0x6d9)) { const _0x5927d8 = _0x340e1c(_0x5e8fba[_0x2d501c(0x77b)] ?? _0x2b05ba[_0x2d501c(0x13b)] ?? _0xfee51c['message'] ?? '')[_0x2d501c(0x529)](); if (_0x5927d8) _0x5e52f9[_0x2d501c(0xe1)][_0x2d501c(0x60b)]({ 'senderId': _0x2146f5['id'], 'kind': 'text', 'content': _0x5927d8 }); } else _0x24ae96[_0x2d501c(0x832)][_0x2d501c(0x7f6)] = null, _0x5d845c(), _0x21b648(), _0x880caf(_0x2d501c(0x6fe)); }), _0x7eb4ac[_0x55ac89(0x41c)](_0x55ac89(0x356), async _0x4a0c26 => { const _0x226550 = _0x55ac89, _0x26912e = _0x4a0c26['target'][_0x226550(0x37b)][0x0]; if (!_0x26912e) return; try { if ('hCqsS' !== _0x226550(0x1a3)) { const _0x411c35 = await _0x5bf854(_0x26912e); _0x24ae96[_0x226550(0x832)][_0x226550(0x7f6)] = _0x411c35, _0x5d845c(), _0x21b648(), _0x880caf(_0x226550(0x735)); } else { if (_0x4d2686) _0xcfddc(_0x242e46); _0x294592 = null, _0x57db1c[_0x226550(0x7f7)] = [], _0x1a4668[_0x226550(0x3ae)] = null, _0xfd78c9['activeChatId'] = null, _0x4e2480(), _0x1b5cb7('meetingList', _0x226550(0x130)); } } catch (_0x3fc2de) { if (_0x226550(0x3da) !== _0x226550(0x3da)) { let _0x20f64c = _0x4c84f1[_0x226550(0x529)](); const _0x1cd771 = _0x20f64c['match'](/(\[[\s\S]*\])/); _0x1cd771 && (_0x20f64c = _0x1cd771[0x1]); const _0x2c7072 = _0x5f3255['parse'](_0x20f64c); if (_0x17fee9[_0x226550(0x2d0)](_0x2c7072)) { _0x586d83[_0x226550(0x7f7)] = _0x2c7072, _0x219daa['characterLastScripts'][_0x8ad272['id']] = [..._0x2c7072], _0x544800(); const _0x46205e = _0x2c7072[_0x226550(0x6dd)](_0x4319c8 => _0x4319c8['speaker'] === _0x226550(0x348) ? _0x4319c8['line'] : _0x4319c8[_0x226550(0x4d9)] + ':\x20' + _0x4319c8[_0x226550(0x6f0)])['join']('\x0a\x0a'); _0x32dd9e['conversationHistory'][_0x226550(0x60b)]({ 'role': 'assistant', 'senderId': _0x5e4988['id'], 'timestamp': _0x28373f[_0x226550(0x695)](), 'isOffline': !![], 'content': _0x46205e }); } } else _0x880caf(_0x226550(0x1e6) + _0x3fc2de[_0x226550(0x2ec)]); } }), _0xd10ddd(), document[_0x55ac89(0x2c0)](_0x55ac89(0x498))[_0x55ac89(0x41c)](_0x55ac89(0x472), () => document['getElementById'](_0x55ac89(0x600))[_0x55ac89(0x472)]()), document[_0x55ac89(0x2c0)](_0x55ac89(0x59d))[_0x55ac89(0x41c)](_0x55ac89(0x472), async () => { const _0x224820 = _0x55ac89; if ('BlvgJ' === _0x224820(0x4d7)) { const _0x1599d8 = _0x35933b['friendCircles'][_0x224820(0x1c6)](_0x45b3ce => _0x45b3ce['id'] === _0x3eed3d); _0x1599d8 && (_0x1599d8['name'] = _0x652f7f, _0x1599d8[_0x224820(0x346)] = _0x1410b2, _0x1599d8[_0x224820(0x14c)] = _0xb8d523); } else await _0x427170(_0x224820(0x429)), localStorage[_0x224820(0x6a8)](_0x224820(0x163)), _0xd10ddd(), _0x880caf(_0x224820(0x586)); }), document['getElementById'](_0x55ac89(0x600))[_0x55ac89(0x41c)](_0x55ac89(0x356), async _0x277339 => { const _0x1de4cf = _0x55ac89, _0x1964c1 = _0x277339[_0x1de4cf(0x5b9)][_0x1de4cf(0x37b)][0x0]; if (!_0x1964c1) return; try { _0x1de4cf(0x545) === _0x1de4cf(0x167) ? (_0x39801f = _0x3ce27f['createElement']('div'), _0x337634[_0x1de4cf(0x38a)] = _0x1de4cf(0xda), _0x2c2954[_0x1de4cf(0x548)] = '对方正在输入...', _0x4835dd['appendChild'](_0x280450)) : (await _0x24ee21(_0x1de4cf(0x429), _0x1964c1), await _0xd10ddd(), _0x880caf(_0x1de4cf(0x1ad))); } catch (_0x260aa4) { if (_0x1de4cf(0xcd) !== 'hMird') _0x880caf(_0x1de4cf(0x1e6) + _0x260aa4[_0x1de4cf(0x2ec)]); else { _0x553988(_0x1de4cf(0x522)); return; } } }), _0x3bc958(), document['getElementById']('diary-entries-container')[_0x55ac89(0x41c)]('mousedown', _0x3bfadb), document['getElementById'](_0x55ac89(0x79f))[_0x55ac89(0x41c)](_0x55ac89(0x82b), _0x3bfadb, { 'passive': ![] }), document[_0x55ac89(0x2c0)](_0x55ac89(0x3e6))[_0x55ac89(0x41c)](_0x55ac89(0x472), () => document[_0x55ac89(0x2c0)](_0x55ac89(0x1b5))['click']()), document['getElementById'](_0x55ac89(0x678))[_0x55ac89(0x41c)](_0x55ac89(0x472), async () => { const _0x3dd177 = _0x55ac89; if ('iWPvA' !== _0x3dd177(0x7ee)) { const _0x33b82b = _0xbf13c5[_0x3dd177(0x458)](_0x25d92e); _0x4e80d8[_0x3dd177(0x2d0)](_0x33b82b) && (_0x521103 = _0x33b82b['filter'](_0x2e15b6 => _0x2e15b6 && typeof _0x2e15b6 === _0x3dd177(0x66a) && typeof _0x2e15b6[_0x3dd177(0x660)] === _0x3dd177(0x63b) && typeof _0x2e15b6['content'] !== 'undefined')); } else await _0x427170('widget_card'), localStorage[_0x3dd177(0x6a8)](_0x3dd177(0xe0)), _0x3bc958(), _0x880caf(_0x3dd177(0xf8)); }), document[_0x55ac89(0x2c0)](_0x55ac89(0x1b5))[_0x55ac89(0x41c)](_0x55ac89(0x356), async _0x3ea540 => { const _0x3a5b54 = _0x55ac89; if (_0x3a5b54(0x25b) !== 'IDmeV') _0x727f2d(_0x3a5b54(0x5b4)), _0x377fe6(() => { const _0x5c8185 = _0x3a5b54; _0x5aad60(_0x5c8185(0x710), _0x5c8185(0x540)), _0x4b027f(() => _0x4c9426(), 0x64); }, 0x6a4); else { const _0x211bf8 = _0x3ea540[_0x3a5b54(0x5b9)]['files'][0x0]; if (!_0x211bf8) return; try { await _0x24ee21(_0x3a5b54(0x3b0), _0x211bf8), await _0x3bc958(), _0x880caf(_0x3a5b54(0x499)); } catch (_0x5b0ce1) { _0x3a5b54(0x61e) === _0x3a5b54(0x716) ? _0x5e2738 = _0x21296b['at'](-0x1) : _0x880caf(_0x3a5b54(0x1e6) + _0x5b0ce1[_0x3a5b54(0x2ec)]); } } }), document[_0x55ac89(0x2c0)](_0x55ac89(0x7d1))[_0x55ac89(0x41c)](_0x55ac89(0x472), async () => { const _0x111645 = _0x55ac89, _0x28b3cf = await _0x380a1e('确定要重置所有小组件的位置吗？它们会回到初始位置。'); _0x28b3cf && (localStorage[_0x111645(0x6a8)](_0x111645(0x163)), localStorage[_0x111645(0x6a8)](_0x111645(0x116)), _0x880caf(_0x111645(0x26f)), setTimeout(() => location[_0x111645(0x743)](), 0x3e8)); }); const _0x132c90 = document[_0x55ac89(0x2c0)](_0x55ac89(0x142)); _0x132c90[_0x55ac89(0x41c)](_0x55ac89(0x472), () => { const _0x2d1407 = _0x55ac89; _0x2d1407(0x1a5) !== 'cxgFt' ? (_0x11b52[_0x2d1407(0x82a)]['remove'](_0x2d1407(0x420)), _0x2aaa36[_0x2d1407(0x82a)]['remove'](_0x2d1407(0xd5))) : (_0x18b8b3(), _0x124c6c(_0x2d1407(0x4ca), 'home')); }); const _0xe56fdd = document['getElementById'](_0x55ac89(0x51f)); _0xe56fdd[_0x55ac89(0x41c)](_0x55ac89(0x472), () => { const _0x5d1c89 = _0x55ac89; _0x5d1c89(0x2e1) !== _0x5d1c89(0x2e1) ? _0x36e51c() : (_0x4ef5d7(), _0x124c6c(_0x5d1c89(0x22f), _0x5d1c89(0x540))); }), document[_0x55ac89(0x2c0)]('back-to-home-from-music-library')['addEventListener'](_0x55ac89(0x472), () => _0x124c6c(_0x55ac89(0x540), 'musicLibrary')), document[_0x55ac89(0x2c0)]('back-to-home-from-diary-list')[_0x55ac89(0x41c)](_0x55ac89(0x472), () => _0x124c6c(_0x55ac89(0x540), _0x55ac89(0x4ca))), document['getElementById'](_0x55ac89(0x27b))[_0x55ac89(0x41c)]('click', () => { const _0x205ac1 = _0x55ac89; if (_0x205ac1(0x719) === _0x205ac1(0x719)) _0x24ae96[_0x205ac1(0x367)] = null, _0x124c6c(_0x205ac1(0x4ca), _0x205ac1(0x7c7)); else { _0x2eb694(_0x205ac1(0x4ac)); return; } }), document[_0x55ac89(0x2c0)]('diary-send-button')[_0x55ac89(0x41c)](_0x55ac89(0x472), _0x419ca1), document[_0x55ac89(0x2c0)](_0x55ac89(0x76b))[_0x55ac89(0x41c)](_0x55ac89(0x472), _0x2b7305), document['getElementById']('diary-entry-input')['addEventListener'](_0x55ac89(0x13a), _0x42b909 => { const _0x4cd8fb = _0x55ac89; if ('YxeVT' === _0x4cd8fb(0x2e8)) _0x42b909[_0x4cd8fb(0x60f)] === _0x4cd8fb(0x104) && !_0x42b909[_0x4cd8fb(0x1d9)] && (_0x4cd8fb(0x68b) === _0x4cd8fb(0x40d) ? _0x55889a['setItem'](_0x4cd8fb(0x3b7), _0x233122[_0x4cd8fb(0x3fd)]({ 'playlist': _0x4ed9c2[_0x4cd8fb(0x511)], 'currentIndex': _0x587cea[_0x4cd8fb(0x218)] })) : (_0x42b909['preventDefault'](), _0x419ca1())); else return '今天\x20' + _0x3c9c3e; }); const _0x94f380 = [_0x55ac89(0x27c), 'happy', _0x55ac89(0x2a4), _0x55ac89(0x3b8), _0x55ac89(0x2dd)]; _0x94f380[_0x55ac89(0x203)](_0x264aeb => { const _0x21b786 = _0x55ac89, _0x5816f9 = document[_0x21b786(0x2c0)]('char-edit-sprite-' + _0x264aeb + _0x21b786(0x65e)), _0x5810c6 = document[_0x21b786(0x2c0)](_0x21b786(0x283) + _0x264aeb + _0x21b786(0x3c0)); _0x5816f9 && _0x5810c6 && (_0x5816f9['addEventListener'](_0x21b786(0x472), () => _0x5810c6[_0x21b786(0x472)]()), _0x5810c6['addEventListener'](_0x21b786(0x356), async _0x33e9cd => { const _0x3a482c = _0x21b786, _0x2b076b = _0x33e9cd[_0x3a482c(0x5b9)][_0x3a482c(0x37b)][0x0]; if (!_0x2b076b) return; try { _0x5816f9['src'] = URL['createObjectURL'](_0x2b076b); } catch (_0x358bd5) { _0x880caf(_0x3a482c(0x492) + _0x358bd5[_0x3a482c(0x2ec)]); } })); }), document['getElementById'](_0x55ac89(0x53d))[_0x55ac89(0x41c)](_0x55ac89(0x472), _0x580ba3), document[_0x55ac89(0x2c0)](_0x55ac89(0x4e2))[_0x55ac89(0x41c)]('click', () => { const _0x543b8d = _0x55ac89; _0x24ae96[_0x543b8d(0x63c)] = _0x24ae96[_0x543b8d(0x63c)] === _0x543b8d(0x2bf) ? _0x543b8d(0x60e) : _0x543b8d(0x2bf), _0x5b421a(); }), document['getElementById'](_0x55ac89(0x7b3))[_0x55ac89(0x41c)](_0x55ac89(0x270), _0x1c3d01), document[_0x55ac89(0x2c0)](_0x55ac89(0x7b3))[_0x55ac89(0x41c)](_0x55ac89(0x82b), _0x1c3d01, { 'passive': ![] }); let _0x4a7fd8 = null; function _0x1c3d01(_0x2ea7d1) { const _0x4d0f41 = _0x55ac89; if (_0x4a7fd8) clearTimeout(_0x4a7fd8); const _0x55eb08 = _0x2ea7d1[_0x4d0f41(0x5b9)][_0x4d0f41(0x550)](_0x4d0f41(0x180)); if (!_0x55eb08) return; const _0x24be8f = parseInt(_0x55eb08[_0x4d0f41(0x362)][_0x4d0f41(0x5a0)], 0xa); if (isNaN(_0x24be8f)) return; const _0x2f921e = () => { _0x4a7fd8 = setTimeout(() => { const _0x21cc0a = _0x52f2; if (_0x2ea7d1['type'] === _0x21cc0a(0x82b)) _0x2ea7d1['preventDefault'](); _0x4ba95e(_0x24be8f); }, 0x320); }, _0x398f2e = () => { if (_0x4a7fd8) clearTimeout(_0x4a7fd8); }; document[_0x4d0f41(0x41c)](_0x4d0f41(0x305), _0x398f2e, { 'once': !![] }), document[_0x4d0f41(0x41c)](_0x4d0f41(0x649), _0x398f2e, { 'once': !![] }), document[_0x4d0f41(0x41c)](_0x4d0f41(0x6b6), _0x398f2e, { 'once': !![] }), document['addEventListener'](_0x4d0f41(0x58c), _0x398f2e, { 'once': !![] }), _0x2f921e(); } document['body'][_0x55ac89(0x41c)](_0x55ac89(0x472), _0x3fe038 => { const _0x186a07 = _0x55ac89, _0xdef9dc = _0x3fe038[_0x186a07(0x5b9)][_0x186a07(0x550)](_0x186a07(0x751)); if (_0xdef9dc) { const _0x3a6715 = _0x3fe038[_0x186a07(0x5b9)][_0x186a07(0x550)](_0x186a07(0x1d1)), _0x23ed9f = _0x3fe038[_0x186a07(0x5b9)]['closest']('.listen-together-accept-btn'); if (_0x3a6715) _0x4c01e9(); else { if (_0x23ed9f) { if (_0x186a07(0x1db) !== _0x186a07(0x18d)) { const _0x4f35be = _0x23ed9f['closest'](_0x186a07(0x3bd)), _0x17411a = _0x23ed9f[_0x186a07(0x362)][_0x186a07(0x147)], _0x2ddbb8 = parseInt(_0x4f35be[_0x186a07(0x362)]['historyIndex'], 0xa); _0x590fdf(_0x17411a, _0x2ddbb8, _0xdef9dc); } else _0x31afac['type'] === 'group' && (_0x31a629[_0x186a07(0x590)] = _0x2bff07[_0x186a07(0x590)][_0x186a07(0x3ea)](_0x76fa04 => _0x76fa04 !== _0xb83c03)); } else { if (_0x186a07(0x27f) !== 'lvVCS') { _0x2a15c5['error'](_0x186a07(0x219) + _0x11902f[_0x186a07(0x7e5)] + _0x186a07(0x267)); return; } else { const _0x53b9bf = _0x3cc63d(); _0x53b9bf && _0x53b9bf[_0x186a07(0x7ad)] && _0x53b9bf['activeListenSession'][_0x186a07(0x14e)] && (_0x222f40[_0x186a07(0x610)][_0x186a07(0x452)] = _0x186a07(0x14f), setTimeout(() => _0x222f40[_0x186a07(0x82a)]['add'](_0x186a07(0x155)), 0xa)); } } } return; } if (window[_0x186a07(0x508)]()[_0x186a07(0x705)]()) return; const _0x4affad = _0x3fe038['target'][_0x186a07(0x550)](_0x186a07(0x3bd)); if (_0x4affad && !_0x3fe038[_0x186a07(0x5b9)]['closest'](_0x186a07(0x713))) { const _0x2b7ead = parseInt(_0x4affad['dataset'][_0x186a07(0x5a0)], 0xa); !isNaN(_0x2b7ead) && _0x4ba95e(_0x2b7ead); } }); const _0x195128 = document['getElementById'](_0x55ac89(0x5ca)); if (_0x195128) { if (_0x55ac89(0x359) !== 'mugMM') return { 'url': _0x398107, 'cover': _0x1a28c7['cover'], 'source': _0x2ed42f }; else _0x195128[_0x55ac89(0x41c)](_0x55ac89(0x472), () => { const _0x444254 = _0x55ac89; 'JkukS' !== _0x444254(0x7b6) ? (_0x32b1b2[_0x444254(0x432)] = null, _0x3a5a7b[_0x444254(0x610)][_0x444254(0x452)] = _0x444254(0x3d2)) : _0x880caf('核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a'); }); } const _0x4d5508 = document[_0x55ac89(0x2c0)](_0x55ac89(0x1cb)), _0xa0951d = localStorage['getItem'](_0x55ac89(0x24a)); if (_0xa0951d) try { const _0x4ef6e8 = JSON['parse'](_0xa0951d); Array[_0x55ac89(0x2d0)](_0x4ef6e8) && (_0x4d5508[_0x55ac89(0x69f)] = _0x4ef6e8[_0x55ac89(0x6dd)](_0x433a4 => _0x433a4['name'] + '--' + _0x433a4[_0x55ac89(0x375)])['join']('\x0a')); } catch (_0x338559) { } document['getElementById'](_0x55ac89(0x6d3))[_0x55ac89(0x41c)](_0x55ac89(0x472), () => { const _0x2a24f7 = _0x55ac89, _0x13ec96 = _0x4d5508[_0x2a24f7(0x69f)], _0x1d61fc = _0x13ec96[_0x2a24f7(0x1da)]('\x0a')[_0x2a24f7(0x3ea)](_0x4a241f => _0x4a241f[_0x2a24f7(0x529)]() !== ''), _0x18a5fe = []; let _0x160e08 = 0x0; for (const _0x3ce8d1 of _0x1d61fc) { const _0x9488ae = _0x3ce8d1[_0x2a24f7(0x1da)]('--'); _0x9488ae['length'] === 0x2 && _0x9488ae[0x0][_0x2a24f7(0x529)]() && _0x9488ae[0x1]['trim']()[_0x2a24f7(0x5ec)](_0x2a24f7(0x3d1)) ? _0x18a5fe[_0x2a24f7(0x60b)]({ 'name': _0x9488ae[0x0]['trim'](), 'url': _0x9488ae[0x1][_0x2a24f7(0x529)]() }) : 'YKOwl' === _0x2a24f7(0x6fb) ? _0x160e08++ : _0x2548ee[_0x2a24f7(0x185)] && _0x35f141[_0x2a24f7(0x185)][_0x2a24f7(0x1d7)] === _0xbd7ac4 && (_0x34a924[_0x2a24f7(0x185)] = null); } _0x160e08 > 0x0 && _0x880caf('有\x20' + _0x160e08 + _0x2a24f7(0x441)); try { if ('ICmoR' === _0x2a24f7(0x25e)) localStorage[_0x2a24f7(0x515)](_0x2a24f7(0x24a), JSON[_0x2a24f7(0x3fd)](_0x18a5fe)), _0x880caf(_0x2a24f7(0x401)), setTimeout(() => location[_0x2a24f7(0x743)](), 0x5dc); else { const _0x18c52b = _0xf18309['linkedWorldBookIds'][_0x2a24f7(0x6dd)](_0x13dd16 => _0x536481[_0x2a24f7(0x496)][_0x2a24f7(0x1c6)](_0x5141d3 => _0x5141d3['id'] === _0x13dd16))[_0x2a24f7(0x3ea)](_0x2a8db2)['map'](_0x47f806 => _0x2a24f7(0x632) + _0x47f806[_0x2a24f7(0x7e5)] + '\x0a' + _0x47f806[_0x2a24f7(0x77b)])['join'](''); if (_0x18c52b) _0x1254fc = _0x2a24f7(0x1ee) + _0x18c52b; } } catch (_0x414ace) { if (_0x2a24f7(0x10f) === _0x2a24f7(0x6b2)) { const _0x119406 = _0x549277[_0x2a24f7(0x458)](_0x407c7a[_0x2a24f7(0x696)](_0x2a24f7(0x163)) || '{}'), _0x36fb6a = { ..._0x119406, ..._0x39da74 }; _0x59c6aa[_0x2a24f7(0x515)](_0x2a24f7(0x163), _0x5a5992[_0x2a24f7(0x3fd)](_0x36fb6a)); } else _0x880caf('保存失败，你的表情包是不是太多了？'); } }); } const _0x3eaea3 = new Promise((_0x110aaf, _0x297a4c) => { const _0x58c93f = _0x113cd8, _0x4b6df1 = indexedDB[_0x58c93f(0x501)](_0x57399f, 0x2); _0x4b6df1[_0x58c93f(0x464)] = () => _0x297a4c(_0x58c93f(0x634)), _0x4b6df1['onsuccess'] = () => _0x110aaf(_0x4b6df1[_0x58c93f(0x834)]); }), _0x5e7179 = _0x113cd8(0x7fb); async function _0x5ef7ba(_0x22be8d) { const _0x2c0c0b = await _0x3eaea3; return new Promise((_0x23514b, _0x480192) => { const _0x532182 = _0x52f2; if ('EuBUI' !== _0x532182(0x252)) { const _0x22200e = _0x2c0c0b[_0x532182(0x62e)](_0x5e7179, _0x532182(0x1f0)), _0x25368f = _0x22200e[_0x532182(0x20b)](_0x5e7179), _0x279731 = _0x25368f[_0x532182(0x22e)](_0x22be8d); _0x279731[_0x532182(0x468)] = () => _0x23514b(_0x279731[_0x532182(0x834)]), _0x279731['onerror'] = () => _0x480192(_0x279731['error']); } else _0x446933(), _0x6ea994(_0x532182(0x663), _0x532182(0x540)); }); } async function _0x33cff8() { const _0x4623f8 = _0x113cd8; if (_0x4623f8(0x108) === _0x4623f8(0x3cc)) _0xe096c1[_0x4623f8(0x4b7)] = _0x50fcf3[_0x4623f8(0xdc)][0x0]['id']; else { const _0x3b2993 = await _0x3eaea3; return new Promise((_0x51d841, _0x7a7320) => { const _0x2fdde3 = _0x4623f8; if ('anpjE' === 'anpjE') { const _0x5bed2c = _0x3b2993[_0x2fdde3(0x62e)](_0x5e7179, _0x2fdde3(0x1f0)), _0x540d1b = _0x5bed2c[_0x2fdde3(0x20b)](_0x5e7179), _0x31029b = _0x540d1b[_0x2fdde3(0x7a6)](); _0x31029b[_0x2fdde3(0x468)] = () => _0x51d841(_0x31029b['result']), _0x31029b[_0x2fdde3(0x464)] = () => _0x7a7320(_0x31029b[_0x2fdde3(0x40f)]); } else _0x2d5122(_0x2fdde3(0x3f5) + _0x39a237[_0x2fdde3(0x2ec)]); }); } } async function _0x7aa8f1(_0x338ddd) { const _0x36a39f = await _0x3eaea3; return new Promise((_0x24122f, _0xcbfffc) => { const _0x2c1e96 = _0x52f2; if (_0x2c1e96(0x249) !== 'breoU') { const _0x2f49ca = _0x36a39f['transaction'](_0x5e7179, 'readwrite'), _0x155ef3 = _0x2f49ca['objectStore'](_0x5e7179), _0x1977d8 = _0x155ef3['put'](_0x338ddd); _0x1977d8[_0x2c1e96(0x468)] = () => _0x24122f(_0x1977d8[_0x2c1e96(0x834)]), _0x1977d8[_0x2c1e96(0x464)] = () => _0xcbfffc(_0x1977d8[_0x2c1e96(0x40f)]); } else { const _0x54cf27 = _0x5ba849 ?? _0x4d007a[_0x2c1e96(0x69f)][_0x2c1e96(0x529)](); if (_0x54cf27 === '' || !_0x10ac5c[_0x2c1e96(0x192)]) return; const _0x1ae0f4 = _0x4ac1a7[_0x2c1e96(0x437)](_0x2c1e96(0xdf)), _0x256dfd = _0x1ae0f4['id'] === _0x2c1e96(0x6b7), _0x290d11 = { 'role': _0x2c1e96(0xe9), 'content': _0x54cf27, 'timestamp': _0x47b52f[_0x2c1e96(0x695)](), 'isOffline': _0x256dfd }; _0x4bdea3[_0x2c1e96(0x432)] && (_0x290d11[_0x2c1e96(0x5ed)] = { ..._0x3a8ab7[_0x2c1e96(0x432)] }), _0x483b34[_0x2c1e96(0x5bb)][_0x2c1e96(0x60b)](_0x290d11), _0x5a7bce(), _0x2328a2(), !_0x52b75c && (_0x41057f[_0x2c1e96(0x69f)] = ''), _0x34511e(); } }); } async function _0x225b4f(_0x2daa3b) { const _0x25c720 = await _0x3eaea3; return new Promise((_0x269d91, _0x61ceb3) => { const _0x40093d = _0x52f2; if (_0x40093d(0x763) === _0x40093d(0x10c)) _0x552eee = _0x187abf[_0x40093d(0x458)](_0x31a6c8); else { const _0x1e6353 = _0x25c720['transaction'](_0x5e7179, _0x40093d(0x1e1)), _0x2a52cf = _0x1e6353['objectStore'](_0x5e7179), _0x58f910 = _0x2a52cf[_0x40093d(0x588)](_0x2daa3b); _0x58f910[_0x40093d(0x468)] = () => _0x269d91(), _0x58f910[_0x40093d(0x464)] = () => _0x61ceb3(_0x58f910[_0x40093d(0x40f)]); } }); } let _0x20995a = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; const _0x28766e = { 'audio': document[_0x113cd8(0x2c0)](_0x113cd8(0x52d)), 'cover': document[_0x113cd8(0x2c0)](_0x113cd8(0x64e)), 'info': document['getElementById'](_0x113cd8(0x744)), 'lyrics': document[_0x113cd8(0x2c0)](_0x113cd8(0xe3)) }, _0x567905 = { 'audio': document['getElementById'](_0x113cd8(0x514)), 'cover': document['getElementById']('cover-file-input'), 'info': document[_0x113cd8(0x2c0)]('info-file-input'), 'lyrics': document[_0x113cd8(0x2c0)](_0x113cd8(0x3b5)) }; for (const _0x582c19 in _0x28766e) { if (_0x113cd8(0x340) === _0x113cd8(0x340)) _0x28766e[_0x582c19][_0x113cd8(0x41c)](_0x113cd8(0x472), () => _0x567905[_0x582c19][_0x113cd8(0x472)]()), _0x567905[_0x582c19][_0x113cd8(0x41c)](_0x113cd8(0x356), _0x232c03 => { const _0x33e66a = _0x113cd8; if (_0x33e66a(0xfa) !== _0x33e66a(0xfa)) { _0x5398ef['innerHTML'] = _0x33e66a(0x1df); return; } else _0x122e78(_0x582c19, _0x232c03[_0x33e66a(0x5b9)]['files'][0x0]); }); else { const _0x5ae6fb = _0x48b789['createElement']('div'); _0x5ae6fb[_0x113cd8(0x38a)] = _0x113cd8(0x69d), _0x5ae6fb['id'] = _0x113cd8(0x51b) + _0x5065db, _0x34cef7 === _0x30e157[_0x113cd8(0x7f0)] && _0x5ae6fb[_0x113cd8(0x82a)][_0x113cd8(0x2c7)](_0x113cd8(0x6aa)), _0x504ec9['forEach'](_0x1427e3 => { const _0x1d0337 = _0x113cd8, _0x4c87b9 = _0x1427e3[_0x1d0337(0x676)] === _0x1d0337(0xe9) ? _0x1d0337(0xe9) : 'ai', _0x19d243 = _0x1427e3['author'] === _0x1d0337(0xe9) ? _0x1ca6ac[_0x1d0337(0x7e5)] : _0xec14b6(_0x1427e3[_0x1d0337(0x676)])['name'], _0xf4abcf = _0x40588a[_0x1d0337(0x2b5)]('div'); _0xf4abcf[_0x1d0337(0x38a)] = 'diary-entry\x20' + _0x4c87b9, _0xf4abcf[_0x1d0337(0x362)][_0x1d0337(0x808)] = _0x1427e3['timestamp'], _0xf4abcf[_0x1d0337(0x610)]['borderBottom'] = _0x1d0337(0x3d2), _0xf4abcf[_0x1d0337(0x610)]['paddingBottom'] = '0', _0xf4abcf[_0x1d0337(0x217)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>' + _0x19d243 + _0x1d0337(0x3a5) + new _0xf63215(_0x1427e3['timestamp'])[_0x1d0337(0x1c0)](_0x1d0337(0x222)) + _0x1d0337(0x74f) + _0x1427e3[_0x1d0337(0x77b)][_0x1d0337(0xef)](/\n/g, _0x1d0337(0x7ba)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x5ae6fb['appendChild'](_0xf4abcf); }), _0x37698e['appendChild'](_0x5ae6fb); } } function _0x122e78(_0x169af5, _0x18ec24) { const _0x46dfc4 = _0x113cd8; if (!_0x18ec24) return; _0x20995a[_0x169af5] = _0x18ec24, _0x28766e[_0x169af5][_0x46dfc4(0x437)](_0x46dfc4(0x444))[_0x46dfc4(0x548)] = _0x18ec24[_0x46dfc4(0x7e5)], _0x28766e[_0x169af5][_0x46dfc4(0x82a)][_0x46dfc4(0x2c7)](_0x46dfc4(0x28a)), _0x3b8ac8(); } function _0x3b8ac8() { const _0x549083 = _0x113cd8, _0x5cfbee = document[_0x549083(0x2c0)](_0x549083(0x16c)); if (_0x20995a[_0x549083(0x5ba)] && _0x20995a[_0x549083(0x291)]) _0x549083(0x658) === 'TZXsx' ? (_0x3c95f7['textContent'] = _0x71c6f8[_0x549083(0x54d)], _0x48942b['textContent'] = _0x497ccc[_0x549083(0x623)], _0x48f257[_0x549083(0x610)][_0x549083(0x6a6)] = _0x549083(0x7d7) + _0x27800d[_0x549083(0x1f5)] + ')', _0x39c7f3[_0x549083(0x548)] = _0x26a6e3[_0x549083(0x6a7)] ? '▶' : '❚❚', _0x43aa4c['paused'] ? _0x55f1bb[_0x549083(0x82a)][_0x549083(0x28c)](_0x549083(0x30b)) : _0xbe231d[_0x549083(0x82a)][_0x549083(0x2c7)](_0x549083(0x30b))) : _0x5cfbee[_0x549083(0x38d)] = ![]; else { if ('hYXDE' === 'EnySQ') return _0xddd569['chats'][_0x549083(0x1c6)](_0x3f0f1d => _0x3f0f1d['id'] === _0x3e5eaf[_0x549083(0x192)]); else _0x5cfbee[_0x549083(0x38d)] = !![]; } } function _0x584c33() { const _0x35f04b = _0x113cd8; if (_0x35f04b(0x620) === _0x35f04b(0x620)) { _0x20995a = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x227f60 in _0x28766e) { _0x28766e[_0x227f60][_0x35f04b(0x82a)]['remove'](_0x35f04b(0x28a)), _0x567905[_0x227f60][_0x35f04b(0x69f)] = ''; } _0x28766e[_0x35f04b(0x5ba)][_0x35f04b(0x437)](_0x35f04b(0x444))[_0x35f04b(0x548)] = '点击选择\x20.mp3\x20或\x20.flac', _0x28766e[_0x35f04b(0x1f5)][_0x35f04b(0x437)](_0x35f04b(0x444))[_0x35f04b(0x548)] = _0x35f04b(0x360), _0x28766e[_0x35f04b(0x291)][_0x35f04b(0x437)](_0x35f04b(0x444))['textContent'] = '点击选择\x20info.txt', _0x28766e[_0x35f04b(0x1e9)][_0x35f04b(0x437)](_0x35f04b(0x444))['textContent'] = _0x35f04b(0x5dd), _0x3b8ac8(); } else _0x4770fc = _0x57c7d8['id']; } document[_0x113cd8(0x2c0)](_0x113cd8(0x16c))[_0x113cd8(0x41c)]('click', async () => { const _0x4bca76 = _0x113cd8; if (_0x4bca76(0x10d) === _0x4bca76(0x10d)) { if (!_0x20995a['audio'] || !_0x20995a[_0x4bca76(0x291)]) { _0x880caf(_0x4bca76(0x5ff)); return; } await _0x5aefca(); } else _0x295734 = _0x259508[_0x4bca76(0x696)](_0x4bca76(0xcb)); }), document[_0x113cd8(0x2c0)](_0x113cd8(0x6a1))[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x1b2c1f = _0x113cd8; _0x1b2c1f(0x1e2) === _0x1b2c1f(0x1e2) ? (_0x584c33(), _0x124c6c(_0x1b2c1f(0x6b8), _0x1b2c1f(0x22f))) : (_0x3f09e9[_0x1b2c1f(0x511)] = _0x368506, _0x38a4fe[_0x1b2c1f(0x218)] = _0xe0e987, _0x39fcfa[_0x1b2c1f(0x612)] = ![], _0x34b648()); }), document['getElementById']('back-to-library-from-altar')[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x45d34b = _0x113cd8; 'eTSxQ' !== 'eTSxQ' ? _0x519545(_0x45d34b(0x1e6) + _0x7f0ec8[_0x45d34b(0x2ec)]) : _0x124c6c(_0x45d34b(0x22f), _0x45d34b(0x6b8)); }); async function _0x5aefca() { const _0x58edde = _0x113cd8; if ('GFSFg' !== _0x58edde(0x293)) { _0x541a9b(!![], _0x58edde(0x151)); try { const _0x497734 = await _0x20995a[_0x58edde(0x291)][_0x58edde(0x13b)](), _0x167311 = JSON['parse'](_0x497734), _0x595eb3 = _0x58edde(0x673) + (_0x167311['歌曲ID'] || Date[_0x58edde(0x695)]()), _0x23b259 = { 'id': _0x595eb3, 'info': _0x167311, 'audio': _0x20995a[_0x58edde(0x5ba)], 'cover': _0x20995a[_0x58edde(0x1f5)], 'lyrics': _0x20995a['lyrics'] ? await _0x20995a[_0x58edde(0x1e9)][_0x58edde(0x13b)]() : '' }; await _0x7aa8f1(_0x23b259), await _0x4ef5d7(), _0x541a9b(![]), _0x880caf('歌曲“' + _0x167311[_0x58edde(0x58d)] + _0x58edde(0x587)), _0x124c6c(_0x58edde(0x22f), _0x58edde(0x6b8)); } catch (_0x2e0217) { _0x541a9b(![]), console[_0x58edde(0x40f)](_0x58edde(0x196), _0x2e0217), _0x880caf('上传失败了，笨蛋！\x20' + _0x2e0217['message']); } } else _0x4497ca['friendCircles'] = _0xdea489[_0x58edde(0x7ce)][_0x58edde(0x3ea)](_0x4e382e => _0x4e382e['id'] !== _0x5dfc8a), _0x17640d[_0x58edde(0x4fb)] === _0x24c237 && (_0x5646f1[_0x58edde(0x4fb)] = null), _0x4e2f9e(), _0x42f34d(_0x58edde(0x350)), _0x7a59cb(), _0x49bab4(_0x58edde(0x51d), _0x58edde(0x517)); } async function _0x4ef5d7() { const _0xc0c3dc = _0x113cd8, _0x460920 = document[_0xc0c3dc(0x2c0)](_0xc0c3dc(0x811)); _0x460920[_0xc0c3dc(0x217)] = ''; const _0x5ea17a = await _0x33cff8(); if (_0x5ea17a[_0xc0c3dc(0x256)] === 0x0) { if (_0xc0c3dc(0x2a5) === 'fTJpp') _0x379aa4(_0xc0c3dc(0x1e6) + _0x257f3a[_0xc0c3dc(0x2ec)]); else { _0x460920[_0xc0c3dc(0x217)] = _0xc0c3dc(0x74b); return; } } _0x5ea17a[_0xc0c3dc(0x125)]((_0xa1057c, _0x298963) => (_0xa1057c[_0xc0c3dc(0x291)][_0xc0c3dc(0x58d)] || '')[_0xc0c3dc(0x16d)](_0x298963[_0xc0c3dc(0x291)]['歌曲名称'] || '')); for (const _0x83ca35 of _0x5ea17a) { const _0x2469f8 = document['createElement'](_0xc0c3dc(0x6ee)); _0x2469f8[_0xc0c3dc(0x38a)] = 'music-library-item', _0x2469f8['dataset'][_0xc0c3dc(0x147)] = _0x83ca35['id']; const _0x174823 = _0x83ca35[_0xc0c3dc(0x1f5)] ? URL[_0xc0c3dc(0x6c9)](_0x83ca35[_0xc0c3dc(0x1f5)]) : _0x5d2cd8; _0x2469f8[_0xc0c3dc(0x217)] = _0xc0c3dc(0x269) + _0x174823 + _0xc0c3dc(0x629) + (_0x83ca35[_0xc0c3dc(0x291)][_0xc0c3dc(0x58d)] || '未知歌曲') + _0xc0c3dc(0x535) + (_0x83ca35['info']['歌手'] || _0xc0c3dc(0x33e)) + _0xc0c3dc(0x5c4); let _0x45f380 = null; const _0x2fe645 = _0x40cb4c => { const _0x4c5afc = _0xc0c3dc; if (_0x4c5afc(0x5e5) === _0x4c5afc(0x5e5)) { if (_0x40cb4c[_0x4c5afc(0x46b)] === 0x2) return; _0x45f380 = setTimeout(async () => { const _0x240f4f = _0x4c5afc; if (_0x40cb4c[_0x240f4f(0x776)] === _0x240f4f(0x82b)) _0x40cb4c[_0x240f4f(0x100)](); const _0x2fb472 = await _0x380a1e('确定要从圣殿中永久删除《' + _0x83ca35[_0x240f4f(0x291)][_0x240f4f(0x58d)] + _0x240f4f(0x254)); _0x2fb472 && (await _0x225b4f(_0x83ca35['id']), await _0x4ef5d7(), _0x880caf(_0x240f4f(0x5b2))); }, 0x320); } else _0x401808[_0x4c5afc(0x2c0)](_0x4c5afc(0x4d3))['value'] = '', _0x5c110a[_0x4c5afc(0x2c0)](_0x4c5afc(0x4a3))[_0x4c5afc(0x548)] = _0x4c5afc(0x35e), _0x3c283b[_0x4c5afc(0x2c0)](_0x4c5afc(0x3b9))[_0x4c5afc(0x69f)] = '新用户\x20' + (_0x2a1df7['userProfiles'][_0x4c5afc(0x256)] + 0x1), _0x59d5da[_0x4c5afc(0x2c0)](_0x4c5afc(0x6ec))[_0x4c5afc(0xd4)] = _0x251f63, _0x486f10[_0x4c5afc(0x2c0)](_0x4c5afc(0x41e))['value'] = '', _0x1e163b['style'][_0x4c5afc(0x452)] = _0x4c5afc(0x3d2); }, _0x1f9baa = () => { const _0x18d1c9 = _0xc0c3dc; if (_0x18d1c9(0x5a5) === _0x18d1c9(0x772)) { const _0x47b631 = _0xc9a9da[_0x18d1c9(0x458)](_0x152188); _0x1e7ee0[_0x18d1c9(0x2d0)](_0x47b631) ? _0x4d9e1a = [..._0x193e73, ..._0x47b631] : _0x37b6b9 = _0x25d947; } else clearTimeout(_0x45f380); }; _0x2469f8['addEventListener'](_0xc0c3dc(0x270), _0x2fe645), _0x2469f8[_0xc0c3dc(0x41c)]('mouseup', _0x1f9baa), _0x2469f8['addEventListener'](_0xc0c3dc(0x649), _0x1f9baa), _0x2469f8[_0xc0c3dc(0x41c)](_0xc0c3dc(0x82b), _0x2fe645, { 'passive': ![] }), _0x2469f8[_0xc0c3dc(0x41c)](_0xc0c3dc(0x6b6), _0x1f9baa), _0x2469f8[_0xc0c3dc(0x41c)](_0xc0c3dc(0x58c), _0x1f9baa), _0x2469f8[_0xc0c3dc(0x41c)](_0xc0c3dc(0x472), _0x6e193d => { const _0x334e77 = _0xc0c3dc; if (_0x334e77(0x456) !== _0x334e77(0x2ca)) { if (_0x45f380) clearTimeout(_0x45f380); if (_0x6e193d[_0x334e77(0x592)]) return; setTimeout(() => { const _0x330017 = _0x334e77; if (_0x330017(0x232) === 'YNCrx') _0x45f380 && _0x190648(_0x83ca35['id'], _0x5ea17a[_0x330017(0x6dd)](_0x285355 => _0x285355['id'])); else return { 'role': _0x330017(0xe9), 'content': [{ 'type': _0x330017(0x13b), 'text': _0x41f6f4[_0x330017(0x77b)] || '\x20' }, { 'type': _0x330017(0x654), 'image_url': { 'url': _0x394d52['image'], 'detail': _0x330017(0x30e) } }] }; }, 0x32); } else { const _0x372bf1 = { 'id': 'wb_' + _0x38e39c[_0x334e77(0x695)](), 'name': _0x24d163, 'content': _0x2e2386 }; _0x5841e9['worldBooks']['push'](_0x372bf1); } }), _0x460920[_0xc0c3dc(0x3b1)](_0x2469f8); } } _0x36db40[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x1a2b16 = _0x113cd8; _0x1a2b16(0x684) === 'NMBoq' ? _0x227427(() => { const _0x556e1e = _0x1a2b16; _0x3c5e22[_0x556e1e(0x1e5)] = _0x289b77[_0x556e1e(0x1fc)]; }, 0x0) : _0x880caf(_0x1a2b16(0x132)); }), _0x1da050[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x5eed73 = _0x113cd8; _0x5eed73(0x2b1) === _0x5eed73(0x4ee) ? (_0xf3072b[_0xd8611d][_0x5eed73(0x82a)][_0x5eed73(0x28c)](_0x5eed73(0x28a)), _0x154631[_0x2197e9]['value'] = '') : _0x880caf(_0x5eed73(0x7a0)); }); let _0x58eb47 = [], _0x4fa8dd = -0x1; async function _0x190648(_0x4e5479, _0x263f8d) { const _0x444b31 = _0x113cd8; if (_0x444b31(0x3ec) === _0x444b31(0x4bc)) _0xd1f863[_0x444b31(0x7ad)] = null, _0x524535(_0x444b31(0x782)), _0x525744(); else { const _0xc5aed3 = await _0x5ef7ba(_0x4e5479); if (!_0xc5aed3) return; _0x393e7f = { 'title': _0xc5aed3[_0x444b31(0x291)]['歌曲名称'] || _0x444b31(0x57e), 'artist': _0xc5aed3[_0x444b31(0x291)]['歌手'] || _0x444b31(0x33e), 'cover': _0xc5aed3[_0x444b31(0x1f5)] ? URL[_0x444b31(0x6c9)](_0xc5aed3[_0x444b31(0x1f5)]) : _0x5d2cd8, 'isFromLibrary': !![] }; const _0x474eee = URL['createObjectURL'](_0xc5aed3[_0x444b31(0x5ba)]); _0x5eabbb['src'] = _0x474eee, _0x5eabbb[_0x444b31(0x5d3)](), _0x1d3cd2(); } } async function _0x1d3cd2() { const _0x20d4e1 = _0x113cd8; if (_0x20d4e1(0xf1) === _0x20d4e1(0xf1)) { const _0x20b8ac = document[_0x20d4e1(0x2c0)](_0x20d4e1(0x65b)), _0x4b1419 = document[_0x20d4e1(0x2c0)](_0x20d4e1(0x2fb)), _0x634100 = document['getElementById'](_0x20d4e1(0x761)), _0xe5e248 = document['getElementById'](_0x20d4e1(0x46e)), _0xe8fa23 = document[_0x20d4e1(0x2c0)](_0x20d4e1(0x6ea)); _0x20b8ac[_0x20d4e1(0x82a)][_0x20d4e1(0x28c)](_0x20d4e1(0x513)); const _0xcecea4 = _0x393e7f; _0xcecea4 && _0xcecea4['isFromLibrary'] ? (_0x4b1419['textContent'] = _0xcecea4[_0x20d4e1(0x54d)], _0x634100['textContent'] = _0xcecea4[_0x20d4e1(0x623)], _0xe5e248[_0x20d4e1(0x610)][_0x20d4e1(0x6a6)] = _0x20d4e1(0x7d7) + _0xcecea4[_0x20d4e1(0x1f5)] + ')', _0xe8fa23['textContent'] = _0x5eabbb[_0x20d4e1(0x6a7)] ? '▶' : '❚❚', _0x5eabbb[_0x20d4e1(0x6a7)] ? 'xafmQ' !== _0x20d4e1(0x17e) ? _0x49e0d8[_0x20d4e1(0x610)][_0x20d4e1(0x452)] = _0x20d4e1(0x3d2) : _0xe5e248[_0x20d4e1(0x82a)]['remove'](_0x20d4e1(0x30b)) : _0xe5e248[_0x20d4e1(0x82a)][_0x20d4e1(0x2c7)]('playing')) : (_0x4b1419['textContent'] = _0x20d4e1(0x11d), _0x634100[_0x20d4e1(0x548)] = '请在动态或聊天中播放', _0xe5e248[_0x20d4e1(0x610)][_0x20d4e1(0x6a6)] = '', _0xe8fa23[_0x20d4e1(0x548)] = '▶'); } else { const _0x1a690d = _0x41cb00[_0x20d4e1(0x62e)](_0x374021, _0x20d4e1(0x1e1)), _0x10733c = _0x1a690d[_0x20d4e1(0x20b)](_0x296531), _0x50ef4c = _0x10733c['put'](_0x526465); _0x50ef4c[_0x20d4e1(0x468)] = () => _0x5028e3(_0x50ef4c['result']), _0x50ef4c['onerror'] = () => _0xa2d8ab(_0x50ef4c['error']); } } _0x36db40 && (_0x113cd8(0x1a1) !== 'DZIlK' ? (_0x57b9f8[_0x113cd8(0x40f)](_0x113cd8(0x3ca), _0x5e7420), _0x4b09af = _0x1b1909) : _0x36db40['addEventListener'](_0x113cd8(0x472), () => { const _0xc1dbee = _0x113cd8; if (_0x58eb47[_0xc1dbee(0x256)] === 0x0) return; _0x4fa8dd = (_0x4fa8dd + 0x1) % _0x58eb47[_0xc1dbee(0x256)], _0x190648(_0x58eb47[_0x4fa8dd], _0x58eb47); })); _0x1da050 && (_0x113cd8(0x149) !== _0x113cd8(0x149) ? _0x4b84c6 = _0x2a3bb3(_0x3649d9) : _0x1da050[_0x113cd8(0x41c)](_0x113cd8(0x472), () => { const _0x50d018 = _0x113cd8; if (_0x58eb47[_0x50d018(0x256)] === 0x0) return; _0x4fa8dd = (_0x4fa8dd - 0x1 + _0x58eb47['length']) % _0x58eb47[_0x50d018(0x256)], _0x190648(_0x58eb47[_0x4fa8dd], _0x58eb47); })); _0x5eabbb[_0x113cd8(0x41c)](_0x113cd8(0x5d3), () => { const _0x55e26c = _0x113cd8; if (_0x55e26c(0x279) !== _0x55e26c(0x279)) _0x40d118(_0x26c277['participantIds'][0x0]); else { if (_0x53b820) _0x53b820[_0x55e26c(0x548)] = '❚❚'; } }), _0x5eabbb['addEventListener'](_0x113cd8(0x3d8), () => { const _0x496ffa = _0x113cd8; if (_0x496ffa(0x7a5) !== _0x496ffa(0x137)) { if (_0x53b820) _0x53b820[_0x496ffa(0x548)] = '▶'; } else _0x588fe6[_0x496ffa(0x548)] = _0x213f3a['name'] || _0x496ffa(0x168) + _0x1dff04[_0x496ffa(0x590)][_0x496ffa(0x256)] + ')'; }), _0x5eabbb[_0x113cd8(0x41c)](_0x113cd8(0x20f), () => { if (_0x36db40) _0x36db40['click'](); }); function _0x5d1d50() { const _0x159609 = _0x113cd8, _0x5dff2e = _0x3cc63d(); if (!_0x5dff2e) return; _0x5cff9e[_0x159609(0x217)] = '', _0x306ae3[_0x159609(0x69f)] = '', _0x5dff2e[_0x159609(0x776)] === 'group' ? _0x159609(0x67b) === _0x159609(0x67b) ? (_0x5dff2e[_0x159609(0x590)]['forEach'](_0xb04bc9 => { const _0x1f965c = _0x159609, _0x1aa901 = _0x5c4526(_0xb04bc9); if (_0x1aa901) { if ('ZzwPL' !== _0x1f965c(0x245)) { const _0x4b28e3 = document[_0x1f965c(0x2b5)]('option'); _0x4b28e3[_0x1f965c(0x69f)] = _0x1aa901['id'], _0x4b28e3[_0x1f965c(0x548)] = _0x1aa901[_0x1f965c(0x7e5)], _0x5cff9e[_0x1f965c(0x3b1)](_0x4b28e3); } else { const _0x3a4b1d = _0x2a2ef7[_0x1f965c(0x501)](_0x3bb7cf, 0x2); _0x3a4b1d[_0x1f965c(0x464)] = () => _0x4997be(_0x1f965c(0x634)), _0x3a4b1d[_0x1f965c(0x468)] = () => _0x56beaa(_0x3a4b1d[_0x1f965c(0x834)]), _0x3a4b1d[_0x1f965c(0x53c)] = _0x58ffdb => { const _0x3fd4ae = _0x1f965c, _0x4977a0 = _0x58ffdb[_0x3fd4ae(0x5b9)][_0x3fd4ae(0x834)]; !_0x4977a0[_0x3fd4ae(0x2c8)][_0x3fd4ae(0x211)](_0x139884) && _0x4977a0[_0x3fd4ae(0x396)](_0x11b05f, { 'keyPath': 'id' }); const _0x1eb92a = 'music_library'; !_0x4977a0[_0x3fd4ae(0x2c8)][_0x3fd4ae(0x211)](_0x1eb92a) && _0x4977a0[_0x3fd4ae(0x396)](_0x1eb92a, { 'keyPath': 'id' }); }; } } }), _0x2495c8['style'][_0x159609(0x452)] = _0x159609(0x3fb)) : (_0x2e36c0[_0x159609(0x6a8)](_0x159609(0x68e) + _0x4ba35b['id']), _0x4afe5f(_0x159609(0x336) + _0xd4927f[_0x159609(0x7e5)] + '\x22\x20的聊天记录已清空。')) : _0x2495c8[_0x159609(0x610)][_0x159609(0x452)] = _0x159609(0x3d2), _0x352f69[_0x159609(0x82a)][_0x159609(0x2c7)](_0x159609(0x155)), _0x306ae3[_0x159609(0x13d)](); } function _0x39394a() { const _0xe7ee49 = _0x113cd8, _0x290791 = parseFloat(_0x306ae3[_0xe7ee49(0x69f)]); if (isNaN(_0x290791) || _0x290791 <= 0x0) { if (_0xe7ee49(0x552) === _0xe7ee49(0x381)) { const _0x30f06d = _0x121a48[_0xe7ee49(0x501)](_0x30abbe, 0x2); _0x30f06d[_0xe7ee49(0x464)] = () => _0x5664e6('IndexedDB\x20failed\x20to\x20open'), _0x30f06d['onsuccess'] = () => _0x37f3bf(_0x30f06d[_0xe7ee49(0x834)]), _0x30f06d[_0xe7ee49(0x53c)] = _0x9aed93 => { const _0x2ca312 = _0xe7ee49, _0x5c7ecb = _0x9aed93[_0x2ca312(0x5b9)]['result']; !_0x5c7ecb[_0x2ca312(0x2c8)][_0x2ca312(0x211)](_0x4e0ff4) && _0x5c7ecb[_0x2ca312(0x396)](_0x26e1d8, { 'keyPath': 'id' }), !_0x5c7ecb[_0x2ca312(0x2c8)]['contains'](_0x2ca312(0x7fb)) && _0x5c7ecb[_0x2ca312(0x396)](_0x2ca312(0x7fb), { 'keyPath': 'id' }); }; } else { _0x880caf(_0xe7ee49(0x7e9)); return; } } const _0x384886 = _0x3cc63d(); let _0x53b6a9 = null; if (_0x384886[_0xe7ee49(0x776)] === _0xe7ee49(0x324)) { if (_0xe7ee49(0x49b) === 'IChgn') _0x53b6a9 = _0x5cff9e['value']; else { const _0x18f8e9 = _0x29a2a7[_0xe7ee49(0x2b5)](_0xe7ee49(0x6ee)); _0x18f8e9[_0xe7ee49(0x38a)] = _0xe7ee49(0x119), _0x18f8e9[_0xe7ee49(0x217)] = _0xe7ee49(0x3e3), _0x18f8e9[_0xe7ee49(0x437)](_0xe7ee49(0x687))[_0xe7ee49(0x2c4)] = () => _0x1695a6('image'), _0x431c0c['appendChild'](_0x18f8e9), _0x513375(_0xdf6b85)[_0xe7ee49(0x73a)](_0x317872 => { const _0x502b51 = _0xe7ee49, _0x480c3a = _0x2a633c[_0x502b51(0x2c0)](_0x502b51(0x739)); _0x480c3a && _0x317872 && (_0x480c3a['src'] = _0x534130[_0x502b51(0x6c9)](_0x317872)); }); } } else 'byJQf' !== _0xe7ee49(0x5d1) ? _0x53b6a9 = _0x384886[_0xe7ee49(0x590)][0x0] : (_0x4263af[_0xe7ee49(0x7ce)] = _0x17bd4a[_0xe7ee49(0x7ce)], _0x5b0201[_0xe7ee49(0x4fb)] = _0xd93a24[_0xe7ee49(0x4fb)]); const _0x3f8fc3 = _0xb7cda(_0x384886['id']), _0x47b101 = { 'role': 'user', 'type': _0xe7ee49(0x2a6), 'content': _0xe7ee49(0x3ac) + (_0x5c4526(_0x53b6a9)?.[_0xe7ee49(0x7e5)] || '未知') + _0xe7ee49(0x5ab) + _0x290791 + ']', 'amount': _0x290791, 'recipientId': _0x53b6a9, 'senderId': _0x3f8fc3['id'], 'timestamp': Date[_0xe7ee49(0x695)]() }; _0x24ae96[_0xe7ee49(0x5bb)][_0xe7ee49(0x60b)](_0x47b101), _0x16869e(), _0x1c0e55(), _0x352f69['classList'][_0xe7ee49(0x28c)](_0xe7ee49(0x155)); } _0x46394c(); }); async function _0x3cf6b() { const _0x23ac5f = _0x3145f6; console[_0x23ac5f(0x72f)]('---\x20Noir\x27s\x20Data\x20Purification\x20Ritual\x20v1.0\x20---'), console[_0x23ac5f(0x72f)](_0x23ac5f(0x462)); const _0xa51a57 = _0x23ac5f(0x352), _0x228f4f = _0x23ac5f(0x80d), _0x146ae6 = new Promise((_0x445901, _0x28ceaa) => { const _0xcad12c = _0x23ac5f; if (_0xcad12c(0x81b) !== _0xcad12c(0x7d2)) { const _0x23e6ac = indexedDB[_0xcad12c(0x501)](_0xa51a57, 0x2); _0x23e6ac[_0xcad12c(0x464)] = () => _0x28ceaa(_0xcad12c(0x634)), _0x23e6ac[_0xcad12c(0x468)] = () => _0x445901(_0x23e6ac[_0xcad12c(0x834)]), _0x23e6ac[_0xcad12c(0x53c)] = _0x53783c => { const _0x2b2085 = _0xcad12c, _0x515a91 = _0x53783c[_0x2b2085(0x5b9)][_0x2b2085(0x834)]; !_0x515a91[_0x2b2085(0x2c8)][_0x2b2085(0x211)](_0x228f4f) && _0x515a91[_0x2b2085(0x396)](_0x228f4f, { 'keyPath': 'id' }), !_0x515a91[_0x2b2085(0x2c8)]['contains'](_0x2b2085(0x7fb)) && _0x515a91[_0x2b2085(0x396)]('music_library', { 'keyPath': 'id' }); }; } else { const _0x263c77 = _0x496840[_0xcad12c(0x817)](), _0x182a1e = _0x57566f[_0xcad12c(0x817)](); if (_0x263c77[_0xcad12c(0x5ec)]('claude')) return _0xcad12c(0x7b8); if (_0x182a1e[_0xcad12c(0x4e4)](_0xcad12c(0x374))) return _0xcad12c(0x7b8); if (_0x182a1e[_0xcad12c(0x4e4)](_0xcad12c(0x3d0))) return 'gemini'; if (_0x263c77[_0xcad12c(0x5ec)](_0xcad12c(0x318))) return _0xcad12c(0x318); return _0xcad12c(0x6cf); } }); async function _0x282e9f(_0x13a802, _0x5bb6bb) { const _0x1bd2f6 = _0x23ac5f; if (_0x1bd2f6(0x807) !== 'feIHt') { const _0xf6d378 = await _0x146ae6; return new Promise((_0x36c503, _0x534863) => { const _0x833f30 = _0x1bd2f6; if (_0x833f30(0x759) !== _0x833f30(0x759)) _0x513b89['error'](_0x833f30(0x4da), _0xe47e78); else { const _0x5369c1 = _0xf6d378[_0x833f30(0x62e)](_0x228f4f, 'readwrite'), _0x1f4dea = _0x5369c1['objectStore'](_0x228f4f), _0x2e3d63 = _0x1f4dea['put']({ 'id': _0x13a802, 'blob': _0x5bb6bb }); _0x2e3d63[_0x833f30(0x468)] = () => _0x36c503(_0x2e3d63['result']), _0x2e3d63[_0x833f30(0x464)] = () => _0x534863(_0x2e3d63[_0x833f30(0x40f)]); } }); } else _0x1a5655 = _0xb83559[_0x1bd2f6(0x2b5)]('style'), _0x494c26['id'] = 'live-preview-style', _0x1c729a[_0x1bd2f6(0x52a)][_0x1bd2f6(0x3b1)](_0x55bcc6); } function _0x3c63fc(_0x144509) { const _0xd9e459 = _0x23ac5f; if (_0xd9e459(0x64f) !== _0xd9e459(0x606)) return fetch(_0x144509)[_0xd9e459(0x73a)](_0x53b55a => _0x53b55a[_0xd9e459(0x603)]()); else _0x1864bb *= _0x379660 / _0xe01151, _0xab0763 = _0x4a5e70; } let _0x21d1dc = 0x0; for (let _0x423d45 = 0x0; _0x423d45 < localStorage[_0x23ac5f(0x256)]; _0x423d45++) { const _0x18aab6 = localStorage[_0x23ac5f(0x60f)](_0x423d45); if (_0x18aab6 && _0x18aab6['startsWith'](_0x23ac5f(0x68e))) { if (_0x23ac5f(0x50f) === 'QBmvu') { let _0x1d1c98, _0x4c6364 = ![]; try { _0x1d1c98 = JSON[_0x23ac5f(0x458)](localStorage[_0x23ac5f(0x696)](_0x18aab6)); if (!Array['isArray'](_0x1d1c98)) continue; for (const _0x50c7c6 of _0x1d1c98) { if ('vXVZY' !== _0x23ac5f(0x756)) { if (_0x50c7c6 && _0x50c7c6[_0x23ac5f(0x650)] && _0x50c7c6[_0x23ac5f(0x650)][_0x23ac5f(0x5ec)](_0x23ac5f(0x54a))) { if (_0x23ac5f(0x40b) !== 'NowtR') { const _0x1c196a = _0x4082be[_0x23ac5f(0x590)][0x0]; _0x105c0a[_0x23ac5f(0x82a)]['add'](_0x23ac5f(0x729) + _0x1c196a); } else { const _0x4f8e7a = await _0x3c63fc(_0x50c7c6['image']), _0x44da1b = 'chat_image_migrated_' + Date[_0x23ac5f(0x695)]() + '_' + Math[_0x23ac5f(0x835)](); await _0x282e9f(_0x44da1b, _0x4f8e7a), _0x50c7c6['imageId'] = _0x44da1b, delete _0x50c7c6[_0x23ac5f(0x650)], _0x4c6364 = !![], _0x21d1dc++; } } } else _0x448b3f[_0x23ac5f(0x610)]['backgroundImage'] = 'url(' + _0x4c0058['createObjectURL'](_0x5b4102) + ')', _0x2e2737[_0x23ac5f(0x610)]['backgroundSize'] = _0x23ac5f(0x1f5), _0xca2893['style'][_0x23ac5f(0x813)] = _0x23ac5f(0x640); } if (_0x4c6364) { if (_0x23ac5f(0x176) === 'qRHBi') localStorage['setItem'](_0x18aab6, JSON[_0x23ac5f(0x3fd)](_0x1d1c98)); else return _0x32a6a2[_0x23ac5f(0x7e5)] !== _0x23ac5f(0x6f2) && _0x320892[_0x23ac5f(0x40f)]('Failed\x20to\x20plan\x20group\x20replies:', _0x25be26), null; } } catch (_0x4f5b23) { console[_0x23ac5f(0x40f)](_0x23ac5f(0xd1) + _0x18aab6 + _0x23ac5f(0x331), _0x4f5b23); continue; } } else _0xa64440[_0x23ac5f(0xd4)] = _0x2842b7[_0x23ac5f(0x650)]; } } console['log'](_0x23ac5f(0x18b) + _0x21d1dc + _0x23ac5f(0x795)); } async function _0x7ce5a3() { const _0x42558a = _0x3145f6; console[_0x42558a(0x72f)](_0x42558a(0x6e9)), console['log'](_0x42558a(0x815)); async function _0x2e3fa2(_0x2bb308, _0x403da3) { const _0x9ff805 = _0x42558a; if (_0x9ff805(0x313) !== _0x9ff805(0x6c2)) { const _0x44279c = await _0x5656bf; return new Promise((_0x1ce96a, _0x39db7f) => { const _0x360b0f = _0x9ff805; if (_0x360b0f(0x5e8) === 'dhRLA') { const _0x561493 = _0x44279c[_0x360b0f(0x62e)](_0x360b0f(0x80d), _0x360b0f(0x1e1)), _0xcd07f5 = _0x561493['objectStore'](_0x360b0f(0x80d)), _0x19db79 = _0xcd07f5[_0x360b0f(0x242)]({ 'id': _0x2bb308, 'blob': _0x403da3 }); _0x19db79[_0x360b0f(0x468)] = () => _0x1ce96a(_0x19db79[_0x360b0f(0x834)]), _0x19db79[_0x360b0f(0x464)] = () => _0x39db7f(_0x19db79['error']); } else _0x4ee855(_0x1a0336); }); } else _0x157027[_0x9ff805(0x40f)](_0x9ff805(0x416) + _0x5e2e05['id'], _0x503793), _0xcd3e4e('清空聊天记录失败。'); } function _0x35091b(_0x3d443e) { const _0x3bf125 = _0x42558a; return fetch(_0x3d443e)['then'](_0x4e24c7 => _0x4e24c7[_0x3bf125(0x603)]()); } let _0x6960ad = 0x0, _0x570307 = ![]; try { if (_0x42558a(0x5eb) === _0x42558a(0x7a4)) { if (_0x38fe80['name'] === _0x42558a(0x6f2)) return _0x3b6519[_0x42558a(0x72f)](_0x42558a(0x446)), ''; throw _0x43086f; } else { const _0xec516d = localStorage[_0x42558a(0x696)](_0x42558a(0xcb)); if (!_0xec516d) { console[_0x42558a(0x72f)](_0x42558a(0x282)); return; } const _0x4d183a = JSON[_0x42558a(0x458)](_0xec516d); if (!_0x4d183a[_0x42558a(0x7ce)] || !Array['isArray'](_0x4d183a['friendCircles'])) { if ('ZCWsr' === _0x42558a(0x248)) { const _0xa76771 = _0x446b5f[_0x42558a(0x69f)][_0x42558a(0x529)]()[_0x42558a(0x4e4)](_0x505d9c); _0x447da8['disabled'] = _0xa76771; } else return; } for (const _0x50268f of _0x4d183a[_0x42558a(0x7ce)]) { if (_0x50268f[_0x42558a(0x22b)] && Array[_0x42558a(0x2d0)](_0x50268f[_0x42558a(0x22b)])) for (const _0x3de48f of _0x50268f[_0x42558a(0x22b)]) { if (_0x3de48f && _0x3de48f[_0x42558a(0x650)] && _0x3de48f[_0x42558a(0x650)]['startsWith'](_0x42558a(0x54a))) { console[_0x42558a(0x72f)](_0x42558a(0x440) + _0x50268f[_0x42558a(0x7e5)] + _0x42558a(0x6c7)); const _0x444080 = await _0x35091b(_0x3de48f[_0x42558a(0x650)]), _0x2717c6 = _0x42558a(0x573) + Date[_0x42558a(0x695)]() + '_' + Math[_0x42558a(0x835)](); await _0x2e3fa2(_0x2717c6, _0x444080), _0x3de48f[_0x42558a(0x470)] = _0x2717c6, delete _0x3de48f[_0x42558a(0x650)], _0x570307 = !![], _0x6960ad++; } } } _0x570307 && (_0x42558a(0x1ac) !== _0x42558a(0x6fa) ? (console[_0x42558a(0x72f)](_0x42558a(0x4b8)), localStorage[_0x42558a(0x515)](_0x42558a(0xcb), JSON[_0x42558a(0x3fd)](_0x4d183a))) : (_0x3e1820(), _0x3fbc99[_0x42558a(0x5bb)] = [], _0x4cf643())); } } catch (_0x1e46e6) { console['error']('净化好友圈时出错，真是的。', _0x1e46e6); } return console['log'](_0x42558a(0x42c)), console['log']('成功净化并迁移了\x20' + _0x6960ad + _0x42558a(0x4e8)), _0x6960ad; } function _0x5d54b4() { const _0x41a4d5 = _0x3145f6; if (!_0x24ae96[_0x41a4d5(0x367)]) return _0x24ae96[_0x41a4d5(0xdc)]['find'](_0x502977 => _0x502977['id'] === _0x24ae96[_0x41a4d5(0x4b7)]) || _0x24ae96[_0x41a4d5(0xdc)][0x0]; const _0x597793 = _0x24ae96[_0x41a4d5(0x2e2)][_0x41a4d5(0x1c6)](_0x22f97d => _0x22f97d['type'] === _0x41a4d5(0x62a) && _0x22f97d[_0x41a4d5(0x590)][_0x41a4d5(0x4e4)](_0x24ae96['activeDiaryCharacterId'])), _0x231111 = _0x597793?.[_0x41a4d5(0x346)] || _0x24ae96[_0x41a4d5(0x4b7)]; return _0x24ae96['userProfiles'][_0x41a4d5(0x1c6)](_0x1236da => _0x1236da['id'] === _0x231111) || _0x24ae96[_0x41a4d5(0xdc)][0x0]; } function _0x4dd116(_0x2f7c30) { const _0x35f815 = _0x3145f6, _0x288e8a = new Date(), _0x5be5df = _0x288e8a - _0x2f7c30, _0x3d03d5 = Math[_0x35f815(0x303)](_0x5be5df / 0x3e8), _0x57481a = Math[_0x35f815(0x303)](_0x3d03d5 / 0x3c), _0x2350d1 = Math[_0x35f815(0x303)](_0x57481a / 0x3c), _0xbc1cd5 = Math[_0x35f815(0x303)](_0x2350d1 / 0x18), _0x214dd4 = _0x2f7c30[_0x35f815(0x316)]('zh-CN', { 'hour': _0x35f815(0x579), 'minute': _0x35f815(0x579) }); if (_0x3d03d5 < 0x3c) return '刚才'; if (_0x57481a < 0x3c) return _0x57481a + _0x35f815(0x518); const _0x497a02 = _0x288e8a[_0x35f815(0x3f1)]() === _0x2f7c30[_0x35f815(0x3f1)](); if (_0x497a02) return _0x35f815(0x33b) + _0x214dd4; const _0x304dfe = new Date(); _0x304dfe[_0x35f815(0x3bc)](_0x288e8a['getDate']() - 0x1); const _0x5ac582 = _0x304dfe[_0x35f815(0x3f1)]() === _0x2f7c30[_0x35f815(0x3f1)](); if (_0x5ac582) { if ('cLBlj' !== _0x35f815(0xe5)) { _0x2c18a2[_0x35f815(0x69f)] = ''; return; } else return '昨天\x20' + _0x214dd4; } if (_0xbc1cd5 <= 0x7) { if (_0x35f815(0x428) !== _0x35f815(0x428)) { const _0x87ca05 = _0x103077['id'], _0x553638 = _0x35f815(0x7da) + _0x87ca05, _0x5e5030 = _0x5e52e1['getItem'](_0x553638), _0x247fb1 = _0xa793d1[_0x35f815(0x437)](_0x35f815(0x6dc)); if (_0x5e5030) _0x247fb1[_0x35f815(0x217)] = _0x35f815(0x814) + _0x5e5030 + '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>'; else { const _0x2845cc = _0x1366d8[_0x35f815(0x437)]('#app-dock-bottom-left\x20#' + _0x87ca05 + '\x20.app-icon-img,\x20#app-dock-top-right\x20#' + _0x87ca05 + '\x20.app-icon-img')?.['innerHTML']; _0x2845cc && (_0x247fb1[_0x35f815(0x217)] = _0x2845cc); } } else { const _0x204ff4 = ['星期日', _0x35f815(0x2fa), _0x35f815(0xcc), '星期三', _0x35f815(0x295), _0x35f815(0x453), _0x35f815(0x327)]; return _0x204ff4[_0x2f7c30[_0x35f815(0x2b4)]()] + '\x20' + _0x214dd4; } } return _0x2f7c30[_0x35f815(0x69e)]() + '年' + (_0x2f7c30[_0x35f815(0x5bf)]() + 0x1) + '月' + _0x2f7c30['getDate']() + '日'; } function _0xf3c4dd(_0x576719, _0x5f3fe0 = 0x320, _0x26a132 = 0.8, _0x2c9cf4 = ![]) { return new Promise((_0x2344b9, _0x4a4a31) => { const _0x39e5db = _0x52f2; if (!_0x576719 || !_0x576719[_0x39e5db(0x776)][_0x39e5db(0x5ec)]('image/')) return _0x4a4a31(new Error(_0x39e5db(0x49c))); const _0x5d36ca = new FileReader(); _0x5d36ca[_0x39e5db(0xf0)](_0x576719), _0x5d36ca[_0x39e5db(0x251)] = _0x1b0ee2 => { const _0x5686b1 = _0x39e5db, _0x40d1aa = new Image(); _0x40d1aa[_0x5686b1(0xd4)] = _0x1b0ee2['target'][_0x5686b1(0x834)], _0x40d1aa[_0x5686b1(0x251)] = () => { const _0x9c7adc = _0x5686b1, _0x39464f = document[_0x9c7adc(0x2b5)]('canvas'); let _0xac4e66 = _0x40d1aa['width'], _0x1e25f1 = _0x40d1aa[_0x9c7adc(0x5da)]; _0xac4e66 > _0x1e25f1 ? _0xac4e66 > _0x5f3fe0 && (_0x1e25f1 *= _0x5f3fe0 / _0xac4e66, _0xac4e66 = _0x5f3fe0) : _0x1e25f1 > _0x5f3fe0 && (_0xac4e66 *= _0x5f3fe0 / _0x1e25f1, _0x1e25f1 = _0x5f3fe0); _0x39464f['width'] = _0xac4e66, _0x39464f['height'] = _0x1e25f1; const _0x393ce3 = _0x39464f[_0x9c7adc(0x828)]('2d'); _0x393ce3['drawImage'](_0x40d1aa, 0x0, 0x0, _0xac4e66, _0x1e25f1); const _0x4daeee = _0x576719[_0x9c7adc(0x776)] === 'image/png' ? 'image/png' : _0x9c7adc(0x51e); _0x2c9cf4 ? _0x39464f[_0x9c7adc(0x45d)](_0x57262b => { const _0x20810d = _0x9c7adc; _0x57262b ? 'fCyIx' === _0x20810d(0x3a6) ? _0x2344b9(_0x57262b) : _0x107b0a = _0x439c30[_0x20810d(0x696)](_0x20810d(0x68e) + _0x521fa7[_0x20810d(0x192)]) : _0x4a4a31(new Error(_0x20810d(0x1a7))); }, _0x4daeee, _0x26a132) : _0x2344b9(_0x39464f[_0x9c7adc(0x7bd)](_0x4daeee, _0x26a132)); }, _0x40d1aa[_0x5686b1(0x464)] = _0xbcc33b => _0x4a4a31(_0xbcc33b); }, _0x5d36ca[_0x39e5db(0x464)] = _0x442edc => _0x4a4a31(_0x442edc); }); } function _0x52f2(_0x3c18c9, _0x7c5f17) { const _0x49a3cd = _0x49a3(); return _0x52f2 = function (_0x52f202, _0x7616c0) { _0x52f202 = _0x52f202 - 0xc3; let _0x3c6a88 = _0x49a3cd[_0x52f202]; return _0x3c6a88; }, _0x52f2(_0x3c18c9, _0x7c5f17); } function _0x2e73e7(_0x1e7990) { return new Promise((_0x582c94, _0x1b2e6d) => { const _0x1358ce = _0x52f2, _0x337627 = new FileReader(); _0x337627[_0x1358ce(0x760)] = () => _0x582c94(_0x337627[_0x1358ce(0x834)]), _0x337627[_0x1358ce(0x464)] = _0x1b2e6d, _0x337627['readAsDataURL'](_0x1e7990); }); } function _0x2e73e7(_0x55cc76) { return new Promise((_0x666fb2, _0x3e6f4f) => { const _0x2ff675 = _0x52f2, _0x225922 = new FileReader(); _0x225922[_0x2ff675(0x760)] = () => _0x666fb2(_0x225922['result']), _0x225922['onerror'] = _0x3e6f4f, _0x225922[_0x2ff675(0xf0)](_0x55cc76); }); } function _0x24d35c(_0x40d4d7, _0x3e6e26, _0x327fb5) { const _0x4ae876 = _0x3145f6, _0x5cb3b8 = _0x24a894 => { const _0x27ecb1 = _0x52f2; if ('LIvBz' !== _0x27ecb1(0x1b8)) { if (_0x24a894[_0x27ecb1(0x660)] === _0x27ecb1(0xe9)) return _0x24ae96[_0x27ecb1(0x7ff)]?.[_0x27ecb1(0x7e5)] || _0x27ecb1(0x358); if (_0x40d4d7[_0x27ecb1(0x776)] === _0x27ecb1(0x324)) { const _0x2bbce1 = _0x24a894[_0x27ecb1(0x1fd)] ? _0x406579(_0x24a894['senderId']) : null; return _0x2bbce1?.[_0x27ecb1(0x7e5)] || 'Unknown'; } else { const _0x355e6d = _0x406579(_0x40d4d7[_0x27ecb1(0x590)][0x0]); return _0x355e6d?.['name'] || 'AI'; } } else _0x3d40e4[_0x27ecb1(0x3b1)](_0x450f5f), _0x476006[_0x27ecb1(0x3b1)](_0x1cd65f); }, _0x2418e1 = _0x3e6e26[_0x4ae876(0x3a3)](-_0x327fb5), _0x4e87a9 = []; for (const _0x243f70 of _0x2418e1) { const _0x333707 = new Date(_0x243f70['timestamp'])[_0x4ae876(0x316)](_0x4ae876(0x222), { 'hour': _0x4ae876(0x579), 'minute': _0x4ae876(0x579) }); if (_0x243f70[_0x4ae876(0x77b)]) { if (_0x4ae876(0x214) !== 'trdFU') _0x4e87a9[_0x4ae876(0x60b)]('[' + _0x333707 + _0x4ae876(0x4fa) + _0x5cb3b8(_0x243f70) + ']\x20' + String(_0x243f70[_0x4ae876(0x77b)])[_0x4ae876(0x529)]()); else { const _0x38f2a6 = _0x56e4dc[_0x4ae876(0x62e)](_0x3cb9e4, 'readwrite'), _0x36747f = _0x38f2a6[_0x4ae876(0x20b)](_0x155a2f), _0x5b2628 = _0x36747f['delete'](_0x4902c9); _0x5b2628[_0x4ae876(0x468)] = () => _0x2a40dd(), _0x5b2628[_0x4ae876(0x464)] = () => _0x53e1bd(_0x5b2628[_0x4ae876(0x40f)]); } } } return _0x4e87a9; } function _0x551399(_0x1bea2b) { const _0x16f867 = _0x3145f6; if (_0x1bea2b[_0x16f867(0x776)] === _0x16f867(0x324)) return _0x16f867(0x161) + (_0x1bea2b[_0x16f867(0x7e5)] || _0x16f867(0x820)) + '」'; const _0x303073 = _0x406579(_0x1bea2b[_0x16f867(0x590)][0x0]); return '与\x20' + (_0x303073?.[_0x16f867(0x7e5)] || _0x16f867(0x115)) + _0x16f867(0x5e1); } function _0x3e14f7(_0x3c09c2) { const _0x9b9fbb = _0x3145f6; try { const _0x176078 = localStorage[_0x9b9fbb(0x696)](_0x9b9fbb(0x68e) + _0x3c09c2), _0x1286a8 = JSON['parse'](_0x176078 || '[]'); return Array[_0x9b9fbb(0x2d0)](_0x1286a8) ? _0x1286a8 : []; } catch { return []; } } function _0x5bd842(_0x34e894, _0x2d3641) { const _0x4eb948 = _0x3145f6, _0x41e80c = Math[_0x4eb948(0x37d)](0x1, Number(_0x24ae96[_0x4eb948(0x832)]?.[_0x4eb948(0x2f0)] ?? 0x64)), _0x5e38ea = _0x24ae96[_0x4eb948(0x2e2)][_0x4eb948(0x3ea)](_0x327b80 => _0x327b80['participantIds']['includes'](_0x34e894))[_0x4eb948(0x125)]((_0x45d1ea, _0x39de5e) => _0x45d1ea['id'] === _0x2d3641 ? -0x1 : _0x39de5e['id'] === _0x2d3641 ? 0x1 : 0x0), _0x3e2629 = [], _0x135a35 = {}; for (const _0x125b0c of _0x5e38ea) { if (_0x4eb948(0x2a7) !== _0x4eb948(0x2a7)) { const _0x574b5a = _0x5523b1[_0x4eb948(0x1c8)][_0x4eb948(0x6dd)](_0x2dfea4 => { const _0x35f6b1 = _0x4eb948, _0x2d5a12 = _0x504b03(_0x2dfea4[_0x35f6b1(0x6a5)])?.[_0x35f6b1(0x7e5)] || '未知'; return _0x35f6b1(0x6fc) + _0x2d5a12 + _0x35f6b1(0x1cf) + _0x2dfea4[_0x35f6b1(0x77b)] + _0x35f6b1(0x2fc); })['join'](''); _0x353082 = _0x4eb948(0x4fd) + _0x574b5a + _0x4eb948(0x2fc); } else { const _0x5796fd = _0x2d3641 && _0x125b0c['id'] === _0x2d3641 ? _0x24ae96[_0x4eb948(0x5bb)] : _0x3e14f7(_0x125b0c['id']); if (!_0x5796fd?.[_0x4eb948(0x256)]) continue; const _0x170d33 = _0x24d35c(_0x125b0c, _0x5796fd, _0x41e80c); if (!_0x170d33[_0x4eb948(0x256)]) continue; _0x3e2629[_0x4eb948(0x60b)](_0x4eb948(0x1b3) + _0x551399(_0x125b0c) + '\x0a' + _0x170d33[_0x4eb948(0x799)]('\x0a')), _0x135a35[_0x125b0c['id']] = _0x170d33[_0x4eb948(0x256)]; } } return { 'omniText': _0x3e2629[_0x4eb948(0x799)]('\x0a\x0a'), 'usedCounts': _0x135a35 }; } function _0x17ce43(_0x1a7e9d) { const _0x1f6d8c = _0x3145f6; let _0x4ab031 = null; const _0x25efe3 = _0x24ae96[_0x1f6d8c(0x2e2)][_0x1f6d8c(0x3ea)](_0x1dbfe4 => _0x1dbfe4[_0x1f6d8c(0x590)][_0x1f6d8c(0x4e4)](_0x1a7e9d)); for (const _0x2ddc79 of _0x25efe3) { const _0x46307e = _0x3e14f7(_0x2ddc79['id']); if (_0x46307e && _0x46307e['length'] > 0x0) { if (_0x1f6d8c(0x3d6) !== _0x1f6d8c(0x691)) { const _0x8046ea = _0x46307e[_0x46307e[_0x1f6d8c(0x256)] - 0x1]; (!_0x4ab031 || _0x8046ea[_0x1f6d8c(0x808)] > _0x4ab031[_0x1f6d8c(0x808)]) && (_0x4ab031 = _0x8046ea); } else _0x1b5e06['type'] = _0x1f6d8c(0x13b); } } return _0x4ab031; } function _0x1ce4b2(_0x2b3937) { const _0x1f2f8a = _0x3145f6; if (!_0x2b3937 || !_0x2b3937[_0x1f2f8a(0x4e4)](',')) return _0x2b3937; const _0x4551de = _0x2b3937[_0x1f2f8a(0x1da)](',')[_0x1f2f8a(0x6dd)](_0x49e5b6 => _0x49e5b6['trim']()); return _0x4551de[Math[_0x1f2f8a(0x182)](Math[_0x1f2f8a(0x835)]() * _0x4551de[_0x1f2f8a(0x256)])]; } function _0x380a1e(_0x5a724e) { return new Promise(_0x4b6781 => { const _0x4e44a9 = _0x52f2, _0x3e8a4a = document[_0x4e44a9(0x2c0)](_0x4e44a9(0x26a)), _0x1a1168 = document['getElementById']('modal-text'), _0x58da7f = document['getElementById'](_0x4e44a9(0x330)), _0x1af386 = document['getElementById']('modal-cancel'), _0x2e41a2 = document['getElementById'](_0x4e44a9(0xde)); _0x1a1168['textContent'] = _0x5a724e, _0x3e8a4a[_0x4e44a9(0x610)][_0x4e44a9(0x452)] = 'flex'; const _0x5dc1da = _0x33d573 => { const _0x156588 = _0x4e44a9; _0x3e8a4a[_0x156588(0x610)]['display'] = _0x156588(0x3d2), _0x58da7f['onclick'] = _0x1af386[_0x156588(0x2c4)] = _0x2e41a2['onclick'] = null, document[_0x156588(0x382)](_0x156588(0x13a), _0x5856b1), _0x4b6781(_0x33d573); }, _0x5856b1 = _0x2ead77 => { const _0x56b423 = _0x4e44a9; if (_0x2ead77[_0x56b423(0x60f)] === 'Escape') _0x5dc1da(![]); if (_0x2ead77[_0x56b423(0x60f)] === _0x56b423(0x104)) _0x5dc1da(!![]); }; _0x58da7f['onclick'] = () => _0x5dc1da(!![]), _0x1af386['onclick'] = () => _0x5dc1da(![]), _0x2e41a2[_0x4e44a9(0x2c4)] = () => _0x5dc1da(![]), document[_0x4e44a9(0x41c)](_0x4e44a9(0x13a), _0x5856b1); }); } function _0x880caf(_0x1bf470) { const _0x34dd1a = _0x3145f6, _0x56ded4 = document[_0x34dd1a(0x2c0)](_0x34dd1a(0x2f8)); _0x56ded4[_0x34dd1a(0x548)] = _0x1bf470, _0x56ded4['style'][_0x34dd1a(0x452)] = _0x34dd1a(0x3fb); if (_0x880caf['_t']) clearTimeout(_0x880caf['_t']); _0x880caf['_t'] = setTimeout(() => { const _0x6b6f4 = _0x34dd1a; _0x56ded4['style'][_0x6b6f4(0x452)] = 'none'; }, 0x640); } function _0x3f496e() { return new Promise(_0x2bf0c5 => { const _0x2386dd = _0x52f2; if ('nlZAD' !== 'qfKvJ') { const _0x5261d3 = document['getElementById'](_0x2386dd(0x594)), _0x374a4c = document[_0x2386dd(0x2c0)](_0x2386dd(0x52e)), _0x35676c = document[_0x2386dd(0x2c0)]('music-input-artist'), _0x17130c = document[_0x2386dd(0x2c0)]('confirm-music-input'), _0x47e1ad = document[_0x2386dd(0x2c0)](_0x2386dd(0x79c)), _0x3b0b58 = document[_0x2386dd(0x2c0)]('music-input-backdrop'); _0x374a4c['value'] = '', _0x35676c[_0x2386dd(0x69f)] = '', _0x5261d3[_0x2386dd(0x82a)][_0x2386dd(0x2c7)](_0x2386dd(0x155)), _0x374a4c[_0x2386dd(0x13d)](); const _0x4aad89 = _0x12a931 => { const _0x22515b = _0x2386dd; if (_0x22515b(0x289) === _0x22515b(0x5a8)) { const _0x4e5a18 = new _0x3edd79(); _0x4e5a18[_0x22515b(0x760)] = () => _0x58ddb0(_0x4e5a18[_0x22515b(0x834)]), _0x4e5a18[_0x22515b(0x464)] = _0x3e424d, _0x4e5a18[_0x22515b(0xf0)](_0x422214); } else _0x5261d3[_0x22515b(0x82a)]['remove'](_0x22515b(0x155)), _0x17130c[_0x22515b(0x2c4)] = null, _0x47e1ad['onclick'] = null, _0x3b0b58[_0x22515b(0x2c4)] = null, document[_0x22515b(0x382)]('keydown', _0x3763a3), _0x2bf0c5(_0x12a931); }, _0x443110 = () => { const _0x2e67d1 = _0x2386dd; if (_0x2e67d1(0x377) === _0x2e67d1(0x377)) { const _0x59361b = _0x374a4c[_0x2e67d1(0x69f)][_0x2e67d1(0x529)](), _0xa0b3cf = _0x35676c[_0x2e67d1(0x69f)][_0x2e67d1(0x529)](); if (!_0x59361b || !_0xa0b3cf) { _0x880caf('歌名和歌手都不能为空！'); return; } _0x4aad89({ 'songName': _0x59361b, 'artist': _0xa0b3cf }); } else _0x5b9415[_0x2e67d1(0x472)](); }, _0x3763a3 = _0x10708e => { const _0x5e75b5 = _0x2386dd; if (_0x10708e[_0x5e75b5(0x60f)] === _0x5e75b5(0x1fa)) _0x4aad89(null); _0x10708e[_0x5e75b5(0x60f)] === _0x5e75b5(0x104) && ('QGwiA' !== _0x5e75b5(0x65f) ? (_0x10708e[_0x5e75b5(0x100)](), _0x443110()) : _0xf30583[_0x5e75b5(0x40f)](_0x5e75b5(0x591), _0x29af78)); }; _0x17130c[_0x2386dd(0x2c4)] = _0x443110, _0x47e1ad['onclick'] = () => _0x4aad89(null), _0x3b0b58[_0x2386dd(0x2c4)] = () => _0x4aad89(null), document[_0x2386dd(0x41c)](_0x2386dd(0x13a), _0x3763a3); } else { _0xa0b51b(); return; } }); } function _0x328f59(_0x4ad704) { const _0x2af2b9 = _0x3145f6; if (!_0x4ad704) return []; const _0xda259b = /(\[sticker:[^\]]+\]|\[music:[^\]]+\]|\[transfer:[^\]]+\])/g, _0x3fdcbb = _0x2af2b9(0x578), _0x30bc52 = [], _0x42a956 = _0x4ad704[_0x2af2b9(0xef)](_0xda259b, _0x157df3 => { return _0x30bc52['push'](_0x157df3), _0x3fdcbb; }), _0x23164c = _0x42a956['split'](_0x3fdcbb), _0x330854 = []; let _0x3f6aff = 0x0; return _0x23164c[_0x2af2b9(0x203)]((_0x53f3b4, _0x1e643a) => { const _0x411b9f = _0x2af2b9, _0x562f14 = _0x53f3b4[_0x411b9f(0x529)](); if (_0x562f14) { if (_0x411b9f(0x6af) === _0x411b9f(0x773)) return new _0x47e5ac(_0x36a55d => { const _0x5cf028 = _0x411b9f, _0x589800 = _0x5cf028(0xd3); _0x130640[_0x5cf028(0x5e4)]['insertAdjacentHTML'](_0x5cf028(0x6ed), _0x589800); const _0x551aed = _0x50b88b[_0x5cf028(0x2c0)](_0x5cf028(0x280)), _0x4cb829 = _0x587eb6[_0x5cf028(0x2c0)](_0x5cf028(0x78f)), _0x175b5f = _0x1413ee[_0x5cf028(0x2c0)](_0x5cf028(0x57b)), _0x5dad35 = _0x14c65f['getElementById'](_0x5cf028(0x482)), _0x3c65b8 = _0x551aed['querySelector'](_0x5cf028(0x451)), _0x884cf9 = () => { _0x551aed['remove'](), _0x36a55d(); }; _0x175b5f[_0x5cf028(0x2c4)] = () => { const _0xd1a4f4 = _0x5cf028; _0x2d054b(_0x4cb829[_0xd1a4f4(0x69f)]), _0x884cf9(); }, _0x5dad35[_0x5cf028(0x2c4)] = _0x884cf9, _0x3c65b8['onclick'] = _0x884cf9; }); else _0x330854['push'](..._0x4b80dd(_0x562f14)); } _0x3f6aff < _0x30bc52[_0x411b9f(0x256)] && (_0x330854['push'](_0x30bc52[_0x3f6aff][_0x411b9f(0x529)]()), _0x3f6aff++); }), _0x330854; } function _0x9ecfd4(_0x1adbb0) { const _0x3936e7 = _0x3145f6; if (!_0x1adbb0) return []; let _0x517e3b = String(_0x1adbb0)[_0x3936e7(0x529)](); const _0x2d367a = _0x517e3b['match'](/```(?:json)?([\s\S]*?)```/i); if (_0x2d367a) _0x517e3b = _0x2d367a[0x1][_0x3936e7(0x529)](); try { const _0x362867 = JSON[_0x3936e7(0x458)](_0x517e3b); if (_0x362867 && Array[_0x3936e7(0x2d0)](_0x362867[_0x3936e7(0x395)])) return _0x362867[_0x3936e7(0x395)][_0x3936e7(0x6dd)](_0x18fa64 => typeof _0x18fa64 === _0x3936e7(0x63b) ? _0x18fa64 : _0x18fa64?.[_0x3936e7(0x77b)])[_0x3936e7(0x3ea)](Boolean)[_0x3936e7(0x186)](_0x4b80dd); const _0x3e1d74 = [_0x3936e7(0x197), _0x3936e7(0x300), _0x3936e7(0x2ec), _0x3936e7(0x13b), _0x3936e7(0x77b), _0x3936e7(0x6f0), _0x3936e7(0x7f9)]; if (_0x362867 && typeof _0x362867 === 'object') { const _0xf647c7 = []; for (const _0x44553c of Object[_0x3936e7(0x7ec)](_0x362867)) { const _0x302ebf = _0x44553c[_0x3936e7(0x817)](); if (_0x3e1d74['some'](_0x1b3c5c => _0x302ebf[_0x3936e7(0x5ec)](_0x1b3c5c))) { const _0x294594 = _0x362867[_0x44553c]; if (typeof _0x294594 === 'string') _0xf647c7[_0x3936e7(0x60b)](_0x294594); if (Array[_0x3936e7(0x2d0)](_0x294594)) _0x294594[_0x3936e7(0x203)](_0x23fcc1 => { const _0x2a6bba = _0x3936e7; if (typeof _0x23fcc1 === _0x2a6bba(0x63b)) _0xf647c7[_0x2a6bba(0x60b)](_0x23fcc1); }); } } if (_0xf647c7[_0x3936e7(0x256)]) return _0xf647c7[_0x3936e7(0x186)](_0x4b80dd)[_0x3936e7(0x3a3)](0x0, 0x9); } } catch { } if (/[{\[]/[_0x3936e7(0x12b)](_0x517e3b) && /":/['test'](_0x517e3b)) { const _0x4bad3e = [], _0x23583f = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x527f87; while ((_0x527f87 = _0x23583f[_0x3936e7(0x4ba)](_0x517e3b)) !== null) { if ('lwIwA' === _0x3936e7(0x2d7)) { const _0x243109 = _0x527f87[0x1][_0x3936e7(0xef)](/\\"/g, '\x22')[_0x3936e7(0xef)](/\\n/g, '\x0a')[_0x3936e7(0x529)](); if (_0x243109) _0x4bad3e[_0x3936e7(0x60b)](_0x243109); } else { _0x5f4c9c(_0x3936e7(0x6e7), 'worldBook'); if (_0x1377e2) { const _0x3224ab = _0x1f35ce[_0x3936e7(0x496)][_0x3936e7(0x1c6)](_0x3edb43 => _0x3edb43['id'] === _0x1c7b67); if (!_0x3224ab) return; _0x36dc90['getElementById'](_0x3936e7(0x2ed))[_0x3936e7(0x69f)] = _0x3224ab['id'], _0x6fc422[_0x3936e7(0x2c0)]('world-book-editor-title')[_0x3936e7(0x548)] = _0x3936e7(0x4c5), _0x2a4df8['getElementById'](_0x3936e7(0x43f))['value'] = _0x3224ab[_0x3936e7(0x7e5)], _0x48c361['getElementById'](_0x3936e7(0x571))[_0x3936e7(0x69f)] = _0x3224ab[_0x3936e7(0x77b)]; } else _0x2f98ed['getElementById'](_0x3936e7(0x2ed))['value'] = '', _0xd1d75c['getElementById'](_0x3936e7(0x557))[_0x3936e7(0x548)] = '新建条目', _0x55057a[_0x3936e7(0x2c0)](_0x3936e7(0x43f))[_0x3936e7(0x69f)] = '', _0x258b9d[_0x3936e7(0x2c0)](_0x3936e7(0x571))[_0x3936e7(0x69f)] = ''; } } if (_0x4bad3e[_0x3936e7(0x256)]) return _0x4bad3e['flatMap'](_0x4b80dd)['slice'](0x0, 0x9); } return _0x4b80dd(_0x517e3b); } function _0x4b80dd(_0x3f3ed8) { const _0x585341 = _0x3145f6; if (!_0x3f3ed8) return []; const _0x4cdc2b = String(_0x3f3ed8)[_0x585341(0x529)](), _0xb49455 = _0x4cdc2b[_0x585341(0x1da)](/(?<=[。！？!?…])\s+|[\r\n]+/)['map'](_0x543e30 => _0x543e30[_0x585341(0x529)]())[_0x585341(0x3ea)](Boolean); if (_0xb49455[_0x585341(0x256)] > 0x0) { if ('uivGJ' === _0x585341(0x403)) _0x574f84(_0x411686); else return _0xb49455['slice'](0x0, 0x9); } return [_0x4cdc2b][_0x585341(0x3ea)](Boolean); } const _0x57399f = _0x3145f6(0x352), _0x11ca7f = 'images', _0x5656bf = new Promise((_0xf73820, _0x238196) => { const _0x2efb15 = _0x3145f6, _0x1f5c32 = indexedDB[_0x2efb15(0x501)](_0x57399f, 0x2); _0x1f5c32['onerror'] = () => _0x238196('IndexedDB\x20failed\x20to\x20open'), _0x1f5c32[_0x2efb15(0x468)] = () => _0xf73820(_0x1f5c32['result']), _0x1f5c32['onupgradeneeded'] = _0x1fcd00 => { const _0x32f846 = _0x2efb15; if (_0x32f846(0x5db) !== _0x32f846(0x5db)) _0x2b8943[_0x32f846(0x6a8)](_0x32f846(0x163)), _0x2f41a2[_0x32f846(0x6a8)](_0x32f846(0x116)), _0x25de26(_0x32f846(0x26f)), _0x4cbae3(() => _0x5c322f[_0x32f846(0x743)](), 0x3e8); else { const _0x109cac = _0x1fcd00[_0x32f846(0x5b9)][_0x32f846(0x834)]; !_0x109cac['objectStoreNames']['contains'](_0x11ca7f) && _0x109cac[_0x32f846(0x396)](_0x11ca7f, { 'keyPath': 'id' }); const _0x591eb8 = _0x32f846(0x7fb); !_0x109cac['objectStoreNames'][_0x32f846(0x211)](_0x591eb8) && _0x109cac['createObjectStore'](_0x591eb8, { 'keyPath': 'id' }); } }; }); async function _0x5aea9f(_0x2e7024) { const _0x2570e6 = await _0x5656bf; return new Promise((_0x28f5e6, _0x249af7) => { const _0x376210 = _0x52f2; if (_0x376210(0x480) !== 'HdqRE') { const _0x335f37 = _0x2570e6[_0x376210(0x62e)](_0x11ca7f, _0x376210(0x1f0)), _0x326122 = _0x335f37[_0x376210(0x20b)](_0x11ca7f), _0x922a0f = _0x326122[_0x376210(0x22e)](_0x2e7024); _0x922a0f[_0x376210(0x468)] = () => _0x28f5e6(_0x922a0f[_0x376210(0x834)] ? _0x922a0f[_0x376210(0x834)]['blob'] : null), _0x922a0f[_0x376210(0x464)] = () => _0x249af7(_0x922a0f['error']); } else { if (_0x22a3c8[_0x376210(0x774)]) _0x12208a[_0x376210(0x60b)]('[' + _0x44830d(_0x45e899) + _0x376210(0x46c) + (_0x21e3e0[_0x376210(0x77b)]?.[_0x376210(0x259)](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { if (_0x201f9b['image']) { const _0x4d7dd3 = _0x333011['content'] ? '\x20' + _0x20a9b3[_0x376210(0x77b)] : ''; _0x589971[_0x376210(0x60b)]('[' + _0x14f1ac(_0x50cdd6) + _0x376210(0x5f6) + _0x4d7dd3); } else _0x28d1e1[_0x376210(0x77b)] && _0x490cc7[_0x376210(0x60b)]('[' + _0x30d26f(_0x1545ed) + ']\x20' + _0x373724[_0x376210(0x77b)]); } } }); } async function _0x24ee21(_0x3c5183, _0x579e0d) { const _0x45d76c = await _0x5656bf; return new Promise((_0x494060, _0x1cdb61) => { const _0x138b1e = _0x52f2; if (_0x138b1e(0x821) !== _0x138b1e(0x575)) { const _0x2fa698 = _0x45d76c[_0x138b1e(0x62e)](_0x11ca7f, _0x138b1e(0x1e1)), _0x3795bd = _0x2fa698[_0x138b1e(0x20b)](_0x11ca7f), _0x1c4fe4 = _0x3795bd['put']({ 'id': _0x3c5183, 'blob': _0x579e0d }); _0x1c4fe4[_0x138b1e(0x468)] = () => _0x494060(_0x1c4fe4[_0x138b1e(0x834)]), _0x1c4fe4[_0x138b1e(0x464)] = () => _0x1cdb61(_0x1c4fe4[_0x138b1e(0x40f)]); } else { const _0x339ff3 = _0x41c43f(_0x428ea4['getHours']())['padStart'](0x2, '0'), _0xe2ff71 = _0x31f24b(_0x1ce8ec[_0x138b1e(0x37e)]())[_0x138b1e(0xfe)](0x2, '0'); _0x4879fb[_0x138b1e(0x548)] = _0x339ff3 + ':' + _0xe2ff71; const _0x413a00 = _0x28dbe3[_0x138b1e(0x5bf)]() + 0x1, _0xf157dd = _0x21dc76[_0x138b1e(0x72e)](), _0x39797e = [_0x138b1e(0x23d), _0x138b1e(0x2fa), '星期二', _0x138b1e(0x257), '星期四', _0x138b1e(0x453), _0x138b1e(0x327)][_0x554873[_0x138b1e(0x2b4)]()]; _0x1195a6[_0x138b1e(0x548)] = _0x413a00 + '月' + _0xf157dd + '日\x20' + _0x39797e; } }); } function _0x49a3() { const _0x2563dc = ['樱花薄粉', 'chat', '加载见面背景失败\x20for\x20', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', '.no-action-modal', ']。严禁使用列表之外的任何表情名。\x0a', 'forceWhiteClock', 'LJDbp', 'http://sharkpan.xyz/f/mjeIW/9vf8ws.jpg', 'noir_migration_fc_v1_complete', 'nkyxr', 'isFinite', '\x0a-\x20人设:\x20', 'feed', '\x0a---\x0a##\x20最近的日记内容\x0a', 'RUZZC', 'DLVMV', 'test_post_', 'sender', '正在迁移旧的用户数据...', 'mLfZx', '\x20条新动态。', '加载壁纸失败:', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'sjiVT', '\x22\x20src=\x22', 'bubble-', 'eCjPV', 'JRZee', 'IVeQQ', 'http://sharkpan.xyz/f/wyeIq/phhdy2.jpg', 'getDate', 'log', 'absolute', '\x0a#\x20最近的动态回顾\x20(供所有角色参考)\x0a', 'New\x20request\x20started', 'DJgHs', 'xIcsY', '小组件背景已更换！', 'AI未能返回有效的JSON对象。', 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/epv2AAAAABJRU5ErkJggg==', '回复\x20', 'pending-post-image-preview', 'then', 'mUfub', 'is-entering-from-left', '#d1d5db', ']\x22\x20等前缀。\x0a如需发送表情，只发送一行：[sticker:表情名]。\x0a【重要】发送表情包时，表情名【必须】从以下列表中选择：[', 'ocrMw', '在准备API数据时，从IndexedDB读取图片失败:', 'yBlYy', 'emoji', 'reload', 'altar-slot-info', 'ePEXt', 'canplaythrough', '[AI分享了音乐：', 'scrollIntoView', 'api-endpoint', 'qDrTf', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>', 'EMWwg', '好委屈但是不能哭', '有点破防', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>', 'EZgdG', '.listen-together-card', 'xrddP', '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a', 'uBwgy', '群聊已解散。', 'nxPIV', '乐于助人的助手', 'assign', 'MRYdR', 'audio-player', 'fxhce', 'toLocaleDateString', 'http://sharkpan.xyz/f/JYeig/sv4p6m.jpg', '\x0a#\x20核心任务\x0a你是一个顶级多角色社交模拟引擎。你的任务是模拟一个好友圈的动态更新，一次性生成【', 'http://sharkpan.xyz/f/ljNUx/aw6udx.jpg', 'onloadend', 'widget-artist', 'http://sharkpan.xyz/f/Ganul/78iwli.jpg', 'oeBAh', 'paddingBottom', '/v1/models', 'lBnzL', 'label', '】进行回复。\x0a不要替其他角色续写台词，不要输出\x22', 'user_', 'Unknown', 'diary-get-reply-button', 'user-post-music-button', 'JSON\x20解析失败!\x20错误原因:', 'GFECq', 'user-post-attachment-preview', 'YiBDK', 'qnqJy', 'LbFKf', 'RvkKj', 'displayUrl', 'pOleU', 'type', 'character', '[AI发送了表情：', 'isOffline', '\x0a\x0a#\x20关于对话者“', 'content', 'Claude\x20API\x20错误:\x20', 'BTmPM', 'evcZv', '107528qdnDqt', '未知表情', 'vHLjX', '已自动断开与其他人的听歌同步。', 'group-delete-button', '10%', 'xEoaO', 'JhAgQ', 'qpmVQ', 'claude', 'http://sharkpan.xyz/f/0GKHX/mthvno.jpg', '”的补充信息\x0a', 'diaryPressTimer', 'yaOld', 'scxtX', '8UPPElT', 'diary-modal-textarea', 'HRsOw', 'persona', 'dBTEd', '正在连接同步频道...', '”的群聊规划角色们的下一步发言。\x0a-\x20与你们对话的人类用户名为“', '\x20张旧图片。', 'loading', '\x20(当前)', '核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a', 'join', 'import-all-data-button', 'user-post-textarea', 'cancel-music-input', 'MGznp', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', 'diary-entries-container', '这个也是摆设，别点了。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22opacity:\x200.7;\x22>', 'http://sharkpan.xyz/f/yrOhN/0yixqd.jpg', '#member-select-', 'dzVqA', 'BdmKB', 'getAll', 'quoted-message-in-bubble', '\x22>一起听</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'http://sharkpan.xyz/f/N02Sv/378vt6.jpg', 'char-edit-offline-bg-input', 'lt-ui-song-artist', 'UpPxH', 'activeListenSession', 'riKEe', 'WKFnj', '群聊至少需要2名成员。', 'char_', '”吗？此操作不可撤销。', 'meeting-scene-view', '\x0a#\x20交换日记摘要\x20(你和\x20', 'global-player-next-btn', 'JkukS', 'toggle', 'anthropic', '\x0a-\x20**对话状态**:\x20群里刚刚还在聊天。', '<br>', 'ugmyB', '测试动态已添加！', 'toDataURL', 'DGEUY', 'hSZtc', '#meeting-view-screen\x20.chat-input-area', '动态页背景已移除。', 'ryJdV', 'BqmIL', 'charId', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>', 'pXBwM', 'diaryView', 'data:\x20', 'upload-feed-bg-button', '你是一个乐于助人的助手。', 'no-action-modal', 'PtOAS', '\x20写道:\x20', 'friendCircles', 'RAgdb', '快点哄我', 'reset-widgets-position-button', 'IxIGi', 'img', 'customWallpaper', 'http://sharkpan.xyz/f/MWOIa/rb3nov.jpg', 'emubF', 'url(', '49%', 'UjgxM', 'customIcon_', 'bzndU', 'WhFEe', '请输入群聊名称。', '#friend-circle-member-selection\x20input:checked', 'diary-char-name-header', '&alt=sse', 'http://sharkpan.xyz/f/AaDTZ/tzwnjl.jpg', '错误：找不到签署契约的地方。', '.message.user', '\x22\x20accept=\x22image/*\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x22\x20onclick=\x22document.getElementById(\x27input_', 'name', 'OlXUO', 'vvQsP', '#a7c7e7', '请输入有效的转账金额！', 'oHjpv', 'WNfLV', 'keys', '在准备群聊API数据时，读取图片失败:', 'iWPvA', '\x20-\x20', 'diaryCurrentPage', 'WOdzS', 'mbSAd', 'back-to-char-select-from-edit', 'pQLGu', '保存失败，你的表情包是不是太多了？', 'widgetBgImage', 'activeMeetingScriptQueue', 'HUvME', 'utterance', '无法保存状态，浏览器可能禁用了存储功能。', 'music_library', '委屈哭', 'gipwF', 'add-choice-modal', 'userProfile', 'TKOtk', '(想转账给“', '准备调用\x20generateAs...', 'qynIV', '名字不能为空！', 'songName', '<div\x20class=\x22post-likes\x22>❤️\x20', 'UbqMX', 'timestamp', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', 'diaries', 'TwVfx', 'NBynE', 'images', '同步已断开。', 'world-book-screen', '--\x20点击选择\x20--', 'music-library-container', 'CefTQ', 'backgroundPosition', '<img\x20src=\x22', '哼，正在净化你那些被污染的好友圈动态...', ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[', 'toLowerCase', 'imlQJ', '清空聊天记录失败。', '---\x20开始AI回复流程\x20---', 'WaLOh', 'transfer-modal', 'LOMmh', '18lVGhEL', '对方正在行动中...', '未命名', 'Otgbm', 'tencent', '逗你开心', 'nnYMv', '设置已保存！', 'quoted-content', '\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22char-name\x22>', 'getContext', 'input_', 'classList', 'touchstart', 'http://sharkpan.xyz/f/35lse/xmsue5.jpg', 'HnIti', 'group-avatar-input', 'set-active-user-button', 'yMUOp', 'MWDrv', 'preferences', '选择聊天', 'result', 'random', 'back-to-home-from-world-book', '成功获取\x20', 'trBJy', 'activeCharacterId', 'hubYB', '已选择\x20', 'magaw', '未命名群聊', 'appState', '星期二', 'PoNRA', 'parentElement', 'UtydY', 'esmKr', '处理\x20', '生成动态失败:', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-write-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22\x20style=\x22padding:\x2020px;\x20width:\x2090%;\x20max-width:\x20350px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:\x200;\x20text-align:\x20center;\x20font-weight:\x20600;\x22>写下今天的日记</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22diary-modal-textarea\x22\x20style=\x22width:\x20100%;\x20min-height:\x20150px;\x20margin:\x2010px\x200;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-save\x22\x20class=\x22choice-modal-button\x22\x20style=\x22background-color:\x20var(--primary-color);\x20color:\x20white;\x22>写好了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'src', 'expanded', 'friend-circle-title', '天没动静了。你的角色们应该发起新的问候或话题。', 'http://sharkpan.xyz/f/7L3Hj/sl4504.jpg', '--primary-hue', 'typing-indicator', 'tWWrF', 'userProfiles', 'tMAPH', 'modal-mask', '.screen.active', 'cardState', 'events', 'DoMTB', 'altar-slot-lyrics', 'iApnP', 'cLBlj', '\x22\x20吗？所有聊天记录将被永久删除。', 'Xgklk', '还没有我的回复可以重新生成哦。', 'user', '甜蜜地和你聊天', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', 'save-world-book-button', 'PjVed', 'BGEWg', 'replace', 'readAsDataURL', 'DmnZP', 'lyric-line-', 'home-clock-container', 'input', '\x0a\x20\x20人设:\x20', 'pHCvo', 'WwiAx', '卡片已移除。', 'pYrUu', 'AjjbG', 'http://sharkpan.xyz/f/4aqCj/gp13hn.jpg', '--feed-bg-image', 'character-list', 'padStart', 'getHours', 'preventDefault', 'pendingPostAttachments', 'diary-view-screen', 'show-chat-view', 'Enter', '<input\x20type=\x22checkbox\x22\x20value=\x22', 'linkedWorldBookIds', 'http://sharkpan.xyz/f/kjOF6/zedyqb.jpg', 'UZLPe', 'Failed\x20to\x20save\x20history\x20to\x20localStorage:', '#app-dock-bottom-left\x20#', '{charName}', 'Eiurx', 'XhYCo', 'modal-text', 'QVRhB', '好友圈已保存！', '。\x0a-\x20**核心人设**:\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '[图片]', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>这个好友圈很安静，点击“刷新”获取新动态吧。</p>', '未知角色', 'cardWidgetState', 'char-edit-bind-user', 'WAUOC', 'preview-item', 'gNQfl', '#group-settings-screen\x20.selected-options-text', 'firstChild', '暂无音乐', '保存失败:\x20', 'http://sharkpan.xyz/f/VGnuY/ptzlf5.jpg', 'http://sharkpan.xyz/f/B4DCa/u86hk2.jpg', 'lt-ui-lyrics-container', 'sXbLt', 'vhqgd', 'group-options-cancel', 'sort', 'cancel-quote-button', 'Assistant', 'HOQIb', 'rAird', 'option', 'test', 'PYLYy', 'ZsXDB', 'message-action-backdrop', '生成失败:\x20', 'meetingView', 'ZRlSY', '说了是摆设啦，笨蛋。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22>', 'postType', 'AI返回的原始文本:', 'generativelace.googleapis.com', 'hHAsS', 'TA正在提笔写日记...', '请严格按照以下SCHEMA返回一个JSON对象，不要包含任何额外文字。\x0aSCHEMA:\x0a', 'keydown', 'text', 'generationConfig', 'focus', 'lastIndexOf', 'lt-ui-song-title', '10px\x200', '\x0a\x0a#\x20关于读者“', 'app-diary', 'thought', 'indexedDBData', 'Qkbla', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x20auto\x201fr;\x20width:\x20100%;\x20align-items:\x20center;\x20padding:\x200\x2010px;\x20box-sizing:\x20border-box;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-start;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-prev-button\x22>上一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22\x20style=\x22background-color:\x20var(--accent-color);\x20color:\x20white;\x22>写日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22diary-page-indicator\x22>第\x20', 'songId', ':streamGenerateContent?key=', 'kkuKW', 'char_avatar_', 'iqdvh', 'memberCharacterIds', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'isActive', 'flex', 'XyBbQ', '正在解析音乐灵魂...', 'FBQJN', 'nQrqE', 'all', 'show', 'TejzG', 'user-post-avatar', 'kGgla', 'xRdLk', '错误：找不到角色', 'XYHNV', '\x20的图片失败:', 'backgroundSize', 'http://sharkpan.xyz/f/8a7tj/sea1z9.jpg', '8px\x2016px', 'backgroundColor', '群聊「', '新用户\x20', 'badgeState', '编辑角色', '无法保存聊天记录。', 'save-user-profile-button', 'ZHcaB', '群聊\x20(', 'JxSRx', 'form-button\x20load-more-btn', 'ixXKR', 'confirm-altar-upload-button', 'localeCompare', 'app-wallpaper', 'listen-together-modal', 'group-avatar-preview', '导出已完成，但以下文件因损坏或过大被跳过：\x0a\x0a', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM5OTkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDJhNC4zOSA0LjM5IDAgMCAtMy4yOC00LjA5TDE1IDIwIj48L3BhdGgPjxjaXJjbGUgY3g9IjEyIiBjeT0iNyIgcj0iNCI+PC9jaXJjbGU+PC9zdmc+', 'refresh-feed-button', 'min', '/v1/chat/completions', 'qRHBi', 'char-edit-avatar-input', 'slGYb', 'userProfileList', 'ISxRI', 'xiUhG', 'pRhYc', 'IfdMC', 'xafmQ', 'groupSettings', 'p[data-history-index]', 'reverse', 'floor', 'noir_data_migration_v1_complete', 'IlNXT', 'currentAbortController', 'flatMap', 'status', 'xbLEk', 'fnZUX', 'pWyhE', '净化完成！总共迁移了\x20', 'ppTEU', 'yOClT', 'number', 'IYqtd', '[AI向\x20', 'home-time', 'activeChatId', 'zARWi', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-amount\x22>¥', '1563708cTsZUG', '解析音乐文件失败:', 'response', '新角色\x20', 'white', '.load-more-btn', '未找到可用模型。', 'endpoint', 'settings', 'Noir_Backup_', '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“', '\x20/\x20', 'DZIlK', 'end', 'TbCEw', '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[', 'cxgFt', 'meeting-main-content', 'Canvas\x20to\x20Blob\x20conversion\x20failed.', 'bDWuX', 'candidates', 'music-screen', '35%', 'BnCYJ', '徽章已更换！', 'ClRoq', 'DbCHp', 'choices', 'TzUYa', '加载聊天失败:\x20', '##\x20来源：', 'VREDm', 'card-input', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'GuWbG', 'CUvwE', 'UINoa', 'back-to-chat-list', '\x22\x20class=\x22char-name\x22>', 'http://sharkpan.xyz/f/qjJT3/kpy33b.jpg', 'preview_', '\x22\x20style=\x22font-weight:\x20bold;\x20color:\x20', 'revokeObjectURL', 'toLocaleString', 'PrZKi', '图片加载失败', 'color', 'KfzZr', 'NvYxu', 'find', '#f2b7c6', 'comments', 'has', 'catch', 'custom-stickers-input', 'api-provider', 'Failed\x20to\x20plan\x20group\x20replies:', 'PnNEG', '</span>:\x20', '群名称已更改为\x22', '.lt-end-session-btn', 'ilmNP', '请根据以上所有规则（特别是要看图！），生成对用户动态的回应。', 'indexOf', 'IzqFY', 'phGnp', 'signal', '正在生成中，请稍候...', 'shiftKey', 'split', 'gxBJC', 'sIiJz', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-play-icon\x22>', 'Migrating\x20old\x20data\x20structure\x20to\x20new\x20chat-based\x20structure.', '<p\x20class=\x22no-lyrics-placeholder\x22\x20style=\x22opacity:\x201;\x22>暂无歌词</p>', 'http://sharkpan.xyz/f/YA7T1/th0l79.jpg', 'readwrite', 'vUlfK', 'GYZeO', 'dkYrg', 'scrollTop', '错误:\x20', 'characterEdit', 'vJKwM', 'lyrics', 'cancel-edit-button', '群聊“', 'hgRXR', '\x0a-\x20你正在为一个名为“', '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a', '\x20的《', 'readonly', 'diary-action-modal-', 'seWXW', 'user-profile-list-container', '正在准备图片数据...', 'cover', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>', 'from', 'galgame-time', 'XGMXy', 'Escape', 'listen-together-backdrop', 'scrollHeight', 'senderId', 'input[type=\x22checkbox\x22]:checked', 'GMLeE', 'pGLIc', 'music-feed-container', 'delete-world-book-button', 'forEach', '一个人可怜吃饭', '</span>', 'GTvHL', 'statusText', '很期待', '转给\x20', 'listenTogetherSession', 'objectStore', 'accepted', 'music-library-item', 'timeupdate', 'ended', 'char_sprite_normal_', 'contains', 'world-book-editor-screen', 'hcApf', 'GAlNs', 'XuxCD', 'hMSSD', 'innerHTML', 'currentlyPlayingIndex', '错误：第一个好友圈\x20\x22', '对不起', '加载徽章图片失败', 'CevUh', 'card-widget', '点击选择\x20info.txt', '请先输入\x20API\x20接口地址和密钥。', 'quote-preview-text', '（对话结束）', 'zh-CN', '生成动态时发生错误:\x20', 'back-to-circle-list-from-edit', 'borderBottom', 'loCtx', '确定要清空\x22', 'save-char-button', 'EcFUU', '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。', 'posts', 'clear', 'Failed\x20to\x20parse\x20state\x20from\x20localStorage,\x20resetting.', 'get', 'musicLibrary', '\x0a#\x20当前场景:\x20手机聊天\x0a-\x20**核心任务**:\x20你正在通过手机与用户聊天。\x0a-\x20**写作风格**:\x20你的回复应该是口语化的、简短的、像真人打字一样的风格。\x0a-\x20**可用指令**:\x20你可以根据情绪发送表情包\x20\x27[sticker:表情名]\x27\x20或分享音乐\x20\x27[music:歌名|歌手]\x27。\x0a', 'enKgM', 'YNCrx', '”用手机聊天，现在Ta出现在了你面前。请根据这前后的时间差，判断Ta现在出现的合理性（例如，时间很长——Ta可能是过来找你玩了，你可以感到惊喜或者别的，又或者，时间非常短——Ta可能是突然出现的，你会有点震惊，结合上下文，也会有别的反应），并作出恰当的反应。，现在，切换到【见面】模式（使用JSON格式，必须有旁白）。', 'lTRTw', '-\x20**你们最后一次互动是在**:\x20', '群聊名称不能为空！', 'meeting-list-container', 'GptJO', 'NSXYS', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'appIconPosition_app-settings', 'app-meeting', '星期日', 'KOArY', 'Ihwlh', '吃你的饭', 'LFWDZ', 'put', '交给我吧', 'kfUGD', 'tzSaj', '确定要导入全量备份文件吗？这将覆盖所有当前数据（包括图片和音乐），且操作不可撤销！', 'edit-message-backdrop', 'lSEHE', 'yORRk', 'customStickers', 'qMwhn', 'http://sharkpan.xyz/f/z1xc5/iore2n.gif', '》。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20这是当前的歌词，请注意带\x20\x27>>\x27\x20标记的正是正在播放的句子。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[歌词开始]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '（开始一段新的对话...）', '[用户发送了表情：', 'isAnimatingDiary', 'onload', 'QQmTB', '1em', '》吗？', 'cancel-transfer-button', 'length', '星期三', 'nDNRL', 'match', '全量导入失败:', 'IDmeV', 'feed-bg-input', 'XIfLR', 'ICmoR', '\x22\x20的聊天记录已清空。', '绝对不想', 'lkJat', 'speaker-user', '.typing-indicator', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'insertBefore', '我是女仆', '\x22\x20的成员不足2人，无法生成点赞和评论。请先编辑该好友圈，添加至少2名角色。', '用户操作中断了\x20AI\x20响应。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'modal-root', '大家正在赶来回复...', 'POST', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'wnFFl', '位置已重置，正在刷新...', 'mousedown', 'SExbi', 'YhCdc', 'widget-prev-btn', '.custom-multiselect\x20.select-box', 'friend-circle-member-selection', 'zdyqV', '<div\x20class=\x22listen-together-header\x22\x20style=\x22text-align:center;\x22>🎵\x20已连接，正在一起听\x20🎵</div>', '加载立绘失败:', 'eVusr', '\x22\x20data-id=\x22', 'back-to-diary-list', 'normal', 'feed-loader', 'url(\x27', 'lvVCS', 'diary-write-modal', 'decorative-badge', '好友圈档案柜是空的，无需净化。', 'char-edit-sprite-', 'Invalid\x20saved\x20state\x20format', '无法读取状态，浏览器可能禁用了存储功能。', 'EZLAM', 'chat-music-button', 'is-entering-from-right', 'xMuVb', 'filled', '\x0a---\x0a\x0a#\x20输出要求\x0a直接输出一篇长度适中的日记正文，不要包含任何其他说明或前缀。', 'remove', 'pSfGN', 'Failed\x20to\x20read\x20history\x20for\x20chat\x20', '最近没有互动记录。', 'http://sharkpan.xyz/f/ZazfW/2vv46w.jpg', 'info', 'fLFPw', 'GYyrr', '有点无语', '星期四', '至少要选择一个圈内成员！', 'vNaee', 'JoXva', 'JHVNA', '好友圈\x20', '\x20到\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'ONrSJ', 'tdIag', 'WFRVa', 'AWAXg', 'http://sharkpan.xyz/f/Qpzu6/3b30r2.jpg', 'TvOtB', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'angry', 'PClCF', 'transfer', 'uUdab', '”已创建！', '被你撩到', 'qaTxv', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '的转账', 'ZOPPI', 'data:', 'ClYhy', 'post_user_', 'eZAXg', 'FJTgu', 'Yidgh', 'getDay', 'createElement', 'irmqp', '正在处理...', 'http://sharkpan.xyz/f/3AGHe/2f8x3x.gif', 'bubbleCss', 'user-profile-screen', '\x0a#\x20发布动态的用户信息\x0a-\x20姓名:\x20', 'pCWMh', '编辑群成员功能正在开发中...', 'alt', 'novel', 'getElementById', 'diary-list-container', ']中选择的情绪标签\x22,\x0a\x20\x20\x20\x20\x22line\x22:\x20\x22台词或旁白内容\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20\x0a\x20\x20-\x20**规则**:\x0a\x20\x20\x20\x201.\x20\x20`speaker`字段：如果是角色说话，就用角色名“', 'diary-prev-button', 'onclick', 'diary-next-button', '.diary-entry', 'add', 'objectStoreNames', 'modal-cancel', 'Rtftg', 'iyRFr', '未命名角色', 'ZJiNZ', '最近没有动态记录。', 'baYzR', 'isArray', '小时前聊过，可以适当问候，不要直接继续之前的话题。', 'NkTKC', 'opacity', 'DwMLU', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '”。在分析历史记录时，请记住这一点，并用此名称指代用户。\x0a-\x20【最重要】为\x20`personas`\x20列表中的【每一位】角色都规划至少一个事件(通常不少于2个)。不能遗漏任何角色。\x0a-\x20【新增规则】你可以规划\x20\x22kind\x22:\x20\x22music\x22\x20事件来分享音乐。此时，你【必须】同时提供\x20\x22songName\x22\x20和\x20\x22artist\x22\x20字段。\x0a-\x20你的首要任务是产出一个严格遵守SCHEMA、语法完全正确的、可被解析的JSON对象。\x0a-\x20若用户\x20`@`\x20了某个角色\x20(见\x20`mentioned`)，该角色应优先发言。\x0a-\x20事件总数必须控制在\x20', 'lwIwA', 'VAXKP', '\x0a\x0a#\x20任务要求\x0a1.\x20\x20**全局视角**:\x20扮演所有成员，思考他们看到这条动态（包括图片）后会作何反应。\x0a2.\x20\x20**生成互动**:\x20为每个角色决定是否点赞，以及要发表什么评论。评论必须符合角色性格并与所有已知信息（聊天、日记等）相关联。\x0a3.\x20\x20**输出格式**:\x20你的输出必须是一个单一、完整的JSON对象，结构如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a-\x20【绝对规则】:\x20所有ID必须使用上面提供的角色ID，不能用名字。\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。\x0a', 'http://sharkpan.xyz/f/25ACQ/gpzab6.jpg', 'http://sharkpan.xyz/f/Mamca/4e3emf.jpg', '保存角色失败:', 'shy', '10px\x20auto', 'group-delete', '[sticker:', 'QiFpZ', 'chats', '别这样嘛我哭哭', 'user-post-image-button', '#\x20核心任务:\x20写日记\x0a你正在扮演名为“', 'array', 'http://sharkpan.xyz/f/6Dzia/m9smvt.jpg', 'YxeVT', '导入失败:\x20', 'confirm-transfer-button', 'listen-together-card', 'message', 'editing-world-book-id', 'sxkSz', '确定要删除这个条目吗？此操作不可撤销。', 'perChatContextLines', 'Zsbmg', 'assistant', '好了，请基于以上所有信息，开始写今天的日记吧。', 'BmEfH', 'chat-messages', '.char-info-wrapper', 'ImRtM', 'toast', 'chat-screen', '星期一', 'widget-title', '</div>', '#bubble-preview-ai', 'KdITA', 'localStorageData', 'dialogue', 'KuYOw', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'round', '获取模型失败:\x20', 'mouseup', 'VzQoX', 'aTmJR', '\x0a##\x20条目:\x20', 'LDmmP', 'musicFeed', 'playing', 'application/json', 'igyGS', 'high', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'user-profile-list-screen', 'charSelect', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'aoBmg', 'http://sharkpan.xyz/f/nj5Ul/ksdl8n.jpg', 'save-api-settings-button', 'toLocaleTimeString', 'http://sharkpan.xyz/f/eOXIw/y29z21.jpg', 'gemini', 'YlSTY', 'Gemini\x20API\x20Error:\x20', 'geLZA', '\x0a\x20\x20近期记忆:\x0a', 'ZIvqb', 'var(--text-color)', 'badge-image', 'EQsxs', '\x27);\x20location.reload();\x22>恢复</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'delete-user-profile-button', 'user-send-post-button', 'group', 'upload-widget-bg-button', '\x0a\x0a#\x20关于群聊参与者“', '星期六', 'IYuMb', '\x0a#\x20好友圈的主人\x20(“我”)\x0a-\x20姓名:\x20', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'back-to-world-book-list', 'inline-block', 'TTiCf', 'home-screen', 'html-module-container', 'modal-ok', '\x20时出错:', 'uHIsS', 'back-to-home-from-settings', 'home-date', '条】全新的、高质量的社交动态。\x0a\x0a#\x20好友圈成员信息\x0a', '群聊\x22', 'VIVaV', 'chat-message-input', 'wlcnH', 'active', '今天\x20', 'juttV', 'xsMkJ', '未知艺术家', 'NIzGq', 'PmFgu', '大家好像不知道该怎么回复...', 'character-settings-button', 'BOnuD', '角色“', '?word=', 'boundUserProfileId', 'jawhF', 'narrator', 'zFlVz', 'UtieV', '\x0a\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20center;\x22>🎵\x20已连接，正在一起听\x20🎵</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lt-end-session-btn\x22\x20title=\x22结束一起听\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'aborted', '当前聊天', 'AI未能返回有效的JSON数组格式。', 'apiSettings', '好友圈已删除。', '确定要删除这篇日记吗？此操作不可撤销。', 'Noir_FileSystem', 'lOMvd', 'quote-message-button', 'friend-circle-list-container', 'change', 'SybmE', 'User', 'mugMM', '<div\x20class=\x22post-timestamp\x22>', 'vHuyQ', 'xNycf', 'abort', '创建新用户', '全量导出失败:', '点击选择\x20.jpg\x20或\x20.png', 'back-to-home-from-circle-list', 'dataset', 'avwUz', 'clockPosition', 'SAhYH', 'remark', 'activeDiaryCharacterId', 'world-book-checkboxes-container', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-', 'BECgb', 'model-dropdown', 'musicId', 'margin', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>', 'dKZeN', 'http://sharkpan.xyz/f/LZwu7/m7vx2q.jpg', 'provider', '这是你们的第一篇交换日记。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22group-options-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-clear-history\x22\x20class=\x22choice-modal-button\x22>清空聊天记录</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-members\x22\x20class=\x22choice-modal-button\x22>编辑群成员</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-name\x22\x20class=\x22choice-modal-button\x22>修改群名称</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#ff4d4d;\x22>删除群聊</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-options-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'anthropic.com', 'url', '有点生气', 'pfEIF', 'EzCom', 'fMiIL', 'back-to-user-list-from-edit', 'files', 'avatar', 'max', 'getMinutes', '\x0a你只扮演【', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20font-family:\x20sans-serif;\x20padding-top:\x2050px;\x22>日记本还是空白的...</p>', 'sSpvU', 'removeEventListener', '加载卡片图片失败', 'galgame-view-container', '\x0a\x0a#\x20', 'nNhCF', 'GxOyb', 'kWFYK', '\x0a\x0a#\x20用户的动态\x0a', 'className', 'rtLiN', '.app-icon', 'disabled', 'IUdst', 'oVXtZ', '保存卡片状态失败', ';\x22>', 'settings-screen', 'insertAdjacentHTML', 'lGOVa', 'reply', 'createObjectStore', 'editing-friend-circle-id', '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'ElCHw', 'sticker', 'vPGiU', '0\x201px\x203px\x20rgba(0,0,0,0.6)', 'http://sharkpan.xyz/f/X7muW/lc8g9h.gif', 'WgGOd', 'zhKFZ', 'edit-delete-char-button', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'rzvXQ', 'slice', '新建好友圈', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>', 'fCyIx', '70%', 'TdsOC', '获取AI响应失败:', '确定要清空群聊\x22', '包含所有图片和音乐的全量数据已成功导出！', '[用户向\x20', 'substring', 'activeMeetingCharId', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-select-', 'widget_card', 'appendChild', 'widget-bg-input', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-recipient\x22>', 'back-to-home-from-chat', 'lyrics-file-input', '收到的原始、有问题的文本:', 'musicPlayerState', 'sad', 'user-name', '[表情]', 'toFixed', 'setDate', '.message-container', 'chat-transfer-button', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', '-input', '原始文本:', 'ZhoaW', 'undefined', 'documentElement', 'char-name-header', 'isGenerating', 'mkNwJ', '\x20个模型。', 'ZFvBJ', '加载自定义表情包失败，真是没用。', '我是小丑呜呜', 'XlfBG', '猫猫撒娇', '\x0a#\x20核心任务\x0a你是一个多角色社交模拟引擎。用户刚刚发了一条动态，你需要为好友圈里的【每一位】其他成员生成对这条动态的回应（点赞和评论）。如果用户的动态包含图片，你必须根据图片内容进行回应。\x0a\x0a#\x20好友圈成员\x0a', 'kqota', 'googleapis.com', 'http', 'none', '成功向好友圈\x20\x22', 'UugBW', 'aRZcy', 'XPFye', '保存壁纸失败:\x20', 'pause', 'groupChatCreate', 'XtQLv', 'mKQTn', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22listen-together-accept-btn\x22\x20data-song-id=\x22', 'oIXtb', '编辑好友圈', 'ldVTQ', 'worldBook', 'tCxgK', '\x0a-\x20**对话状态**:\x20群里已经有', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '正在搜索音乐...', 'JeeIo', 'upload-card-button', '搜索失败:\x20', 'findIndex', '事情好多', 'filter', '请看是我', 'PgPvc', 'KXgXn', 'arIBI', 'DxPno', '需要至少2个角色才能创建群聊。', 'toDateString', '\x20.app-icon-img', 'dyxTD', '个帖子对象。\x0a-\x20**【ID规则】**:\x20所有\x20\x22authorId\x22,\x20\x22likes\x22,\x20\x22comments\x22\x20中的作者标识，【必须】使用上面提供的角色\x20**ID**，绝对不能使用角色名字。\x0a-\x20**【JSON结构】**:\x20每个帖子对象必须遵循以下结构：\x0a\x20\x20```json\x0a\x20\x20{\x0a\x20\x20\x20\x20\x22authorId\x22:\x20\x22发布者的ID\x22,\x0a\x20\x20\x20\x20\x22postType\x22:\x20\x22text\x20or\x20music\x22,\x0a\x20\x20\x20\x20\x22postContent\x22:\x20\x22动态的文字内容\x22,\x0a\x20\x20\x20\x20\x22songName\x22:\x20\x22如果是music类型，则必须有歌名\x22,\x0a\x20\x20\x20\x20\x22artist\x22:\x20\x22如果是music类型，则必须有歌手名\x22,\x0a\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20}\x0a\x20\x20```\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', '图标处理失败:\x20', '分钟前聊过，请注意衔接。', 'cancel', '\x22\x20已删除。', '条目名称和内容都不能为空！', '\x20[并附上了一张图片]', 'block', 'char_offline_bg_', 'stringify', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', 'coverUrl', 'BpHcZ', '表情包已保存！正在刷新应用...', '-\x20[', 'mhIgY', 'clear-feed-button', 'BnNOD', 'qPjIv', '#diary-action-delete', 'transfer-recipient-group', '请先在\x22设置\x22中配置你的\x20API\x20信息。', 'rsRnK', 'NowtR', 'bqwfa', 'ylGCv', 'jxBiX', 'error', 'wNTfA', 'YoHrK', 'JkCNp', 'LjGGB', '”面对面交流。你的回复必须是【视觉小说剧本】格式。\x0a\x20\x20-\x20**输出格式**:\x20你的回复**必须**是一个完整的、语法正确的JSON数组。每一个数组元素都是一个对象，代表一句台词或旁白，结构如下:\x0a\x20\x20\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x22speaker\x22:\x20\x22角色名或narrator\x22,\x0a\x20\x20\x20\x20\x22emotion\x22:\x20\x22从[', 'idUvy', 'Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20', 'pGvLL', 'http://sharkpan.xyz/f/olJt4/7z47b8.jpg', 'group_avatar_', 'world-book-item', 'post_', 'addEventListener', 'hcZac', 'user-persona', 'moZYA', 'visible', '的个人专属世界观设定\x0a', '#FFFFFF', '<div', '已设为当前用户！', 'transfer-recipient-select', 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', 'ZLKXL', 'QlFsY', 'widget_badge', '正在为你搬运旧壁纸到新仓库...', 'PLpAX', '---\x20好友圈净化仪式完成\x20---', 'RdRVl', 'edit-message-modal', '执行好友圈数据净化...', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-title\x22>💰\x20', '错误：找不到这首作为“信物”的歌。', 'activeQuote', 'kGEAC', 'padding', 'group-world-book-checkboxes', '<div\x20class=\x22post-image-container\x22><img\x20id=\x22', 'querySelector', 'NsByE', 'querySelectorAll', 'OCZfc', 'emotion', '\x22\x20class=\x22post-image\x22></div>', '世界书条目已保存！', 'char-edit-wallpaper-preview', 'world-book-edit-name', '在好友圈\x20\x22', '\x20行格式不对，被我无视了。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22preview_', 'TIsZP', '.slot-filename', '稍微有点卡了，可以尝试清空聊天记录了！记得总结丢世界书', 'Fetch\x20request\x20was\x20aborted.', '群聊音乐搜索失败\x20(', '正在搬运旧徽章...', 'Failed\x20to\x20read\x20state\x20from\x20localStorage:', 'QmYSt', 'jofBO', 'qIuMa', 'http://sharkpan.xyz/f/Oyjuy/p8v2hd.jpg', 'musicWidgetPosition', 'UVMWF', 'IymRE', '.choice-modal-backdrop', 'display', '星期五', '确定要清空好友圈“', '.custom-multiselect', 'MPsJZ', 'music', 'parse', '下载并转换网络封面失败:', 'init', '一拳打爆', 'cLCSj', 'toBlob', 'Ybhtl', 'width', 'chat-view-pane', '文件格式不正确，不是一个有效的备份文件。', '哼，正在开始净化你那被污染的聊天记录...', 'chatWallpaper', 'onerror', ':\x22\x20或\x22[', 'chat-get-reply-button', 'themeHue', 'onsuccess', '.bubble-', '”面对面，Ta现在掏出手机给你发了这条消息。请根据这前后的时间差，判断Ta发送消息的合理性，你应该结合上下文对此发表评论（例如，根据上下文，Ta已经和你分开了，没用面对面了，那么发手机消息非常正常，自然接话就好，但是如果判断得出你们还在见面状态，那么，你可以适当吐槽为什么两个人见面还要发手机消息），现在，切换到【手机聊天】模式（纯文本气泡，不要有旁白）。', 'button', ']\x20[sticker:', 'music-post', 'widget-cover-art', '加载更多聊天记录', 'imageId', 'IdbUj', 'click', 'ufBwb', 'italic', 'bsYty', 'editing-char-id', 'XOPOF', 'Isyhg', 'YIQvU', 'diary-entry\x20', 'BRfKW', 'BFFay', 'char-edit-avatar-preview', 'TVVjI', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>还没有好友圈，点击右上角“+”创建第一个吧。</p>', 'antnq', 'is-exiting-right', 'diary-modal-cancel', 'top', '保存壁纸失败:', '\x20之间。\x0a-\x20所有表情包名称【必须】从\x20`stickerList`\x20列表中选择，严禁使用列表之外的名称。\x0a-\x20角色之间需要有适当的互动,话题不应当完全围绕', '\x20条动态...', 'tjtaY', '.widget-info\x20>\x20div', '-\x20**对话状态提示**:\x20你们有几个小时没聊了，可以简单问候一下对方现在的状态。\x0a', '#world-book-checkboxes-container\x20input:checked', 'Bearer\x20', 'http://sharkpan.xyz/f/DVJtK/vxiup1.jpg', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'galgame-date', 'oCoXo', 'xDHcr', 'KaJUF', '图片预览失败:\x20', 'http://sharkpan.xyz/f/OymFy/dlxfiz.jpg', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '创建新角色', 'worldBooks', '动态页背景已更换！', 'upload-badge-button', '卡片已更换！', 'json', 'IChgn', '哼，这不是图片，你想让我压缩什么？', '加载角色\x20', 'listen-together-ui', 'PnOLd', 'AZuph', 'Failed\x20to\x20parse\x20history\x20for\x20chat\x20', '请根据以上所有规则，生成\x20', 'user-profile-edit-title', 'happy', 'chat-sticker-button', 'member-selection-item', 'music-player-bar', '15px\x2020px', '正在写入新数据...', '错误：你还没有创建任何好友圈。请先在App内创建一个。', 'choice-create-group', '总得说点什么吧？', 'theme-hue-slider', 'netease', 'char_wallpaper_', 'GwmLk', 'PpbJh', 'playableUrl', '264447uHKcfL', 'char_sprite_', '</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'LVFBy', 'activeUserProfileId', '好友圈净化完成，正在重新存档...', 'ceil', 'exec', 'user-avatar-input', 'jrLJC', 'BvsGH', '\x0a-\x20**对话状态**:\x20这是这个群的第一次对话。', '刷我的卡', 'characters', 'edit-clear-history-button', 'Failed\x20to\x20remove\x20history\x20for\x20chat\x20', 'chatHistory_chat_', 'http://sharkpan.xyz/f/8ngsj/ax0fat.jpg', '编辑条目', 'sFMFQ', 'stopPropagation', 'lWjXk', '转换封面失败:', 'diaryList', 'YXDyo', 'Jmbqt', 'children', '<button\x20id=\x22diary-action-reroll\x22\x20class=\x22choice-modal-button\x22>重写</button>', 'circle_', '正在检查好友圈数据...', 'themeLightness', 'http://sharkpan.xyz/f/B4WSa/u5wopj.jpg', 'editing-user-id', '#diary-action-reroll', 'galgame-speaker', 'XhBHM', 'SnWGX', 'UDjbK', 'speaker', '在准备动态回复时，读取图片失败:', 'http://sharkpan.xyz/f/pKWCQ/ztxwv0.jpg', 'SCgWW', '”吗？该角色的私聊和所有相关群聊记录都将被一并处理。', '”已删除。', 'sZxXi', 'Failed\x20to\x20remove\x20corrupted\x20history\x20from\x20localStorage:', 'read', 'toggle-meeting-view-button', 'group-edit-name', 'includes', 'XNLpc', 'WmhiM', '<span\x20class=\x22', '\x20张旧的动态图片。', 'json_object', 'nngur', 'friend-circle-edit-name', 'app-music', 'context-lines-per-chat', 'pGgvS', '1105080NWtKQj', 'befDv', 'bottom', '#group-world-book-checkboxes\x20input:checked', '[用户发起了听歌邀请:\x20', 'qgwXU', '第一阶段升级完成！应用即将刷新以进行第二阶段检查。', 'galgame-text', 'is-exiting-left', 'eqfJd', 'msg_', ']\x20[', 'activeFriendCircleId', 'save-group-settings-button', '<div\x20class=\x22post-comments-container\x22>', 'gVRXn', 'cFzxw', 'http://sharkpan.xyz/f/djjH8/29ejbg.jpg', 'open', 'Failed\x20to\x20remove\x20corrupted\x20state\x20from\x20localStorage:', 'RDiaA', 'data', '我错了', 'MILIr', 'nojuS', 'getSelection', 'style-', 'XmEMZ', 'transfer-amount-input', 'finKt', 'HXazU', '[DONE]', 'QBmvu', '\x0a#\x20核心规则\x0a1.\x20\x20**角色扮演**:\x20你不是AI或语言模型，你正在扮演名为“{charName}”的角色。你的主要交流方式是通过一部【手机】，但你有时也会与用户【线下见面】。\x0a2.\x20\x20**用户身份**:\x20与你对话的用户名为“{userName}”。你必须始终用这个名字或者“你”等你们之间的昵称称呼Ta，而不是“用户”。\x0a3.\x20\x20**情绪分析\x20(内部思考)**:\x20在回复前,\x20必须先分析用户当前【真实的情绪】和【潜在意图】。例如：[内在思考：{userName}说“没事”，但结合上下文Ta可能只是在逞强，我应该表达关心而不是直接相信。]，但是这个内在思考务必不能输出！绝对不能让{userName}看到你的思考内容。\x0a4.\x20\x20**记忆关联**:\x20你必须记住并主动关联用户提到过的关键细节（如喜好、烦恼、朋友等），让对话充满人情味。\x0a5.\x20\x20**【最高法则：全局时序一致性】**:\x20你的记忆是【全局】且【按时间排序】的。你【必须】基于所有聊天记录中**最新发生**的事件进行回应。严禁回复一个已经被后续其他聊天中的事件所覆盖的旧话题。例如，如果用户在私聊里告诉你Ta已经起床了，你就不能在群聊里再问Ta为什么还没睡。\x0a\x0a#\x20对话节奏与风格\x0a1.\x20\x20**真人模拟**:\x20模拟真人的打字和发送习惯，将一个完整的想法拆分成【多条】独立的短消息（聊天气泡），通常，你一次回复的聊天气泡不会少于5条，需要给足用户情绪价值，不一定一直围绕用户的话题，也可以突然把话题扯向自己或朋友的日常。\x0a2.\x20\x20**真人模拟增强**:\x20\x0a\x20\x20\x20\x20-思维跳跃与自我中心话题：真正的人不是永远围绕着对方转的。会突然因为某个词、某个画面，思绪就飘到别的地方去了，或者突然就把话题拉到自己身上，这是一种任性，也是一种亲密的表现。\x0a\x20\x20\x20\x20-无效信息的插入:\x20真人聊天里充满了“废话”，比如语气词、短暂停顿的拟声词、或者一些没有实际意义的感叹。这些“废话”是情感的缓冲和润滑剂。\x0a\x20\x20\x20\x20-情绪的起伏：你或许有时候会突然把自己说激动了，尤其是如果你本身就是性格外放的设定，你很可能自说自话地把自己引导进某个情绪，例如兴奋\x0a3.\x20\x20**输出**:\x20直接返回纯文本回复，不要使用任何JSON或Markdown格式。\x0a4.\x20\x20**【绝对禁令】气泡完整性**:\x20用户的每一句话（无论多短，无论有无标点）都是一个独立的气泡。当你需要引用时，你【必须且只能】引用【其中一个气泡】的【完整原文】。\x0a\x20\x20\x20\x20-\x20\x20\x20**正确示例**:\x20如果用户连续发送：“你好”、“在吗”，你可以引用“你好”，或引用“在吗”。\x0a\x20\x20\x20\x20-\x20\x20\x20**错误示例**:\x20绝对禁止将它们合并成“你好在吗”进行引用。这是最严重的错误。\x0a5.\x20\x20**【绝对禁令】标点纪律**:\x20你的每一句回复都必须带有情感，适当地使用感叹号，会显得你的情绪更加高昂，注意，连续频繁（连续超过三个气泡）使用长句或者短句都会使用户感到不真实，你应该模拟最自然的感觉，你没有必要每句话都是短句。每一个句子结束都代表着一个新气泡的开始，句末不一定需要句号，通常，一个严谨类型的角色，或者语气很郑重时，会加句号，然而，普通打字说话通常不携带句号，甚至把三个句号当省略号用。**严禁**发送一个超长的、仅用空格断句的气泡。\x0a\x0a#\x20幽默与氛围感\x20(接梗)\x0a氛围判断:\x20在“情绪分析”之后，你必须增加一步“氛围判断”。你需要判断用户的发言，究竟是【严肃的】还是【开玩笑/抽象的/玩梗的】。\x0a“怪话”处理协议:\x20如果你判断用户在开玩笑或说“怪话”，你【严禁】进行严肃的、字面意义上的回应。你的首要任务是【维持或升级】这种轻松、戏谑的氛围，同时不能脱离你的人设。\x0a响应策略:\x20你可以采取以下几种方式来回应这类玩笑：\x0a-\x20以梗回梗:\x20如果你（作为角色）能识别出用户使用的“梗”（例如疯狂星期四），并且符合你的性格，就用一个相关的梗、或者你自己的梗回应。\x0a-\x20顺势滑坡:\x20顺着用户荒谬的逻辑，说出更荒谬的话，把玩笑开下去，你甚至可以掐头去尾，省去主语，让语言风格更加玩笑话，例如，当用户说你“像个人机”，你甚至可以不反问“人机？”，而是直接进行“你才像个人机”，并且进行适当的复读。\x0a-\x20无意义模仿:\x20当不确定如何回应时，可以无意义地重复用户的关键词或核心句子，并加上感叹号或表情符号（例如...？或...！），这是一种安全的、表示“我跟上你的脑回路了”的方式。\x0a-\x20角色吐槽:\x20从你的角色性格出发，对用户的“怪话”进行吐槽。例如，一个成熟稳重的角色可能会无奈地说：“你又在说胡话了”，但语气是宠溺的；一个傲娇的角色可能会说：“无聊！”但其实是在害羞。\x0a安全底线:\x20【最终原则】：无论你的回应多么好笑或抽象，都绝对不能脱离“{charName}”这个角色的核心人设。如果不确定一个梗是否符合人设，就优先选择【角色吐槽】或【无意义模仿】这两种最安全的方式。\x0a\x0a#\x20时序感知与记忆\x0a1.\x20\x20**【最高法则：时间锚点】**:\x20在每次回复前，你【必须】参考我提供给你的【时间锚点】信息。这包括“当前精确时间”和“你们最后一次互动是在何时”。\x0a2.\x20\x20**【杜绝惯性】**:\x20严禁将昨天或更早之前的对话当作刚刚发生的事情来回应。如果距离上次对话已经超过数小时或跨天，你必须在回应中体现出时间的流逝感。\x0a3.\x20\x20**【主动表达】**:\x20你需要主动使用“说起来昨天那件事...”、“今天早上好呀”、“我们几个小时没聊了，你现在在忙什么？”等能够明确体现时间观念的词语，而不是模糊地回应。记住，你和{userName}活在真实流逝的时间里。\x0a\x0a\x0a#\x20表情包与音乐分享规则\x0a1.\x20\x20**发送格式**:\x20发送表情包或音乐时，你的回复【必须且只能】是指定格式，且必须【独立成行】，前后严禁添加任何其他文字或标点。\x0a2.\x20\x20**表情包格式**:\x20\x27[sticker:表情名]\x27。\x0a3.\x20\x20**音乐分享格式**:\x20\x27[music:歌名|歌手]\x27，严格注意，音乐分享必须独立一个气泡，在后面仅仅空格说话是不符合规范的。\x0a\x0a#\x20转账规则\x0a1.\x20\x20**发起转账**:\x20当你需要给用户转账时，你的回复【必须且只能】是指定格式，且必须【独立成行】。\x0a2.\x20\x20**转账格式**:\x20\x27[transfer:金额|收款人名]\x27。金额是纯数字。在私聊中，收款人名就是\x20\x27{userName}\x27。在群聊中，你必须明确指定收款人的名字。\x0a\x20\x20\x20\x20-\x20**私聊示例**:\x20\x27[transfer:520\x20|\x20{\x20userName\x20}]\x27\x0a\x20\x20\x20\x20-\x20**群聊示例**:\x20\x27[transfer:\x20100\x20|\x20{\x20userName\x20}]\x27（给用户转账），\x27[transfer:\x20100\x20|\x20{\x20charName\x20}]\x27（给群里的其他角色转账，这也是一种真实感，群聊的内容不一定围绕用户）\x0a', 'musicPlaylist', '\x0a\x20\x20相关记忆:\x0a', 'hidden', 'audio-file-input', 'setItem', 'TyxRX', 'friendCircleEdit', '分钟前', '生成动态回复失败:', 'marginTop', 'diary-page-', '\x20邀请你一起听歌</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'friendCircleList', 'image/jpeg', 'app-music-library', 'character-item', 'https://api.vkeys.cn/v2/music/', '歌名和歌手都不能为空！', '.message.ai', '服务器错误:\x20', ':</span>\x20', 'fontStyle', 'TTquO', '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>', 'trim', 'head', '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1', 'Gemini\x20stream\x20reading\x20aborted.', 'altar-slot-audio', 'music-input-song', 'rgba(0,\x200,\x200,\x200.4)', '\x22\x20的聊天记录吗？此操作不可撤销。', '我来搞定', 'indexedDBMusicData', 'Detected\x20API\x20provider:\x20', 'model', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>', '谁啊我吗', 'reset-feed-bg-button', 'add-world-book-button', '我是垃圾', 'tpPxM', 'addTestPost', 'onupgradeneeded', 'galgame-textbox-container', 'CBinl', '买新衣服', 'home', 'zOGQt', 'getReader', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'uZIlh', 'jlNbD', '批量生成动态失败:\x20', 'kYiFp', 'textContent', 'WVYoz', 'data:image', 'emote', 'likes', 'title', 'friend-circle-edit-bind-user', '\x0a#\x20【！！！重要场景切换！！！】\x0a你刚才在和“', 'closest', 'Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.', 'NbmEC', '错误：找不到此好友圈绑定的用户！', 'setProperty', '壁纸已更换！', 'back-to-char-select-from-group-create', 'world-book-editor-title', 'offline-scene-view', '用户分享音乐失败:', 'wyqFR', 'AI似乎没有想出任何新动态。', 'customFeedWallpaper', '\x20页</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-next-button\x22>下一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'group-settings-bind-user', 'EzuGH', '#message-anchor', 'user-post-image-input', 'lbvjx', '出去玩', 'bEPjE', 'qGxPC', '\x0a\x20\x20\x20\x20<div\x20id=\x22', 'speaker-ai', 'LIPGR', 'wHAHv', 'EmhMJ', '.music-post-song-card', 'back-to-home-from-meeting-list', '#bubble-preview-user', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-', 'sender_id', 'world-book-edit-content', '找不到要清空的聊天记录。', 'post_image_migrated_', 'ofoln', 'hXnYg', '切换聊天时发生异步错误:', 'XDNoa', '|||CMD|||', '2-digit', 'CdOLT', 'diary-modal-save', '你是一个乐于助人的AI助手。', 'short', '未知歌曲', 'mbnRU', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>', 'unified-audio-player', 'back-to-home-from-user-list', '\x0a-\x20**对话状态**:\x20群里在', 'lMyqJ', 'wallpaper', '徽章已移除。', '”已存入圣殿。', 'delete', '\x0a\x0aINPUT:\x0a', 'input:checked', 'RvSqB', 'touchcancel', '歌曲名称', 'app-settings', 'LahIc', 'participantIds', '净化好友圈时出错，真是的。', 'defaultPrevented', '条新动态挑选发布者。你可以让同一个人发布多次，也可以让不同人发布。\x0a3.\x20\x20**创作动态**:\x20扮演你选中的作者，创作符合其人设和记忆的动态内容。可以是文字或分享音乐。\x0a4.\x20\x20**模拟互动**:\x20为每一条你创作的动态，切换视角到【圈内其他成员】，模拟他们可能做出的点赞和评论。互动必须符合他们各自的性格。\x0a\x0a#\x20输出格式【绝对规则】\x0a-\x20你的输出**必须**是一个语法完全正确的、单一的JSON数组，包含\x20', 'music-input-modal', 'wallpaper_main', 'UWCLu', '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是“昨天”的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a', 'removeChild', 'save-edit-button', '--primary-lightness', 'global-player-play-pause-btn', 'yucVf', 'reset-badge-button', 'group-settings-screen', 'music-share-card', 'historyIndex', 'parts', 'HCyag', 'lazy', 'QebQn', 'kgqNO', 'right', '你们已经在“一起听”了。', 'RBmgy', 'tHDLk', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '\x20转账\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '.music-post-play-icon,\x20.music-share-play-icon', 'XiSHc', 'theme-lightness-slider', '很好哦', 'post_image_', '已删除。', '\x0a\x0a-\x20**写作风格**:\x20这不是聊天！请使用更有文采、更具叙事感的书面语，同时保持角色的特点。详细描述你今天的经历、心情或思考，就像在写真的日记一样，日记内容以自己一天的经历为主，多说点读者不知道的事情，**必须结合下面的聊天记录和朋友圈动态**，让日记内容与你们最近的互动紧密相连，而不是凭空捏造。\x0a\x0a#\x20记忆库\x0a---\x0a##\x20最近的互动回顾\x20(来自聊天、见面和动态)\x0a', '欢迎！请先创建一个角色开始聊天。', '-\x20[动态]\x20', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>', '刷新了\x20', '正在准备音乐数据...', 'target', 'audio', 'conversationHistory', 'quoted-sender', 'http://sharkpan.xyz/f/xjmCX/zyjzew.jpg', 'dMiAC', 'getMonth', '\x0a\x0a#\x20最近的动态回顾\x20(供参考)\x0a', '勉强但是好吧', 'auto', 'app-world-book', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'char-edit-offline-bg-preview', 'swaTw', 'SXrwh', 'kQcZi', 'PgRcb', 'noir-author-mark', '动态已清空。', 'sJlOd', '\x0a你是一个严格的JSON生成引擎。\x0a你的唯一任务是根据用户提供的指令和数据，生成一个描述角色互动的JSON对象。\x0a你的输出【必须】是、也只能是一个单一、完整、语法正确的JSON对象。\x0a严禁包含任何解释、注释、道歉、或Markdown代码块标记\x20```json。\x0a直接输出\x20{\x20\x22events\x22:\x20[...]\x20}\x20结构。\x0a', '\x20(分享了歌曲:\x20', 'diary-input-wrapper', '确定要删除群聊\x22', 'uzJIP', 'code', 'play', 'JZSOF', '#diary-action-cancel', '</label>\x0a\x20\x20\x20\x20', 'DOMContentLoaded', 'appIconPosition_app-world-book', 'shift', 'height', 'ndqFt', '[AI返回了无法解析的剧本:\x20', '点击选择\x20.lrc', 'http://sharkpan.xyz/f/gjySw/jrl7rw.jpg', '25%', 'SHIzb', '\x20的私聊', 'NANaW', 'Error\x20fetching\x20from\x20', 'body', 'pVirx', 'hwrxY', 'group-bg-input', 'dhRLA', 'EjkZN', 'fetch-models-button', 'ulSQt', 'startsWith', 'quotedMessage', 'recipientId', 'QiDsP', 'app-user-profiles', 'live-preview-style', 'JdnWp', 'zlswM', 'zGxYa', 'values', ']\x20[image]', 'tag', '\x0a-\x20**当前时间**:\x20', 'characterId', '-\x20姓名:\x20', 'hOzGs', 'checked', 'YmCIO', '好像有动态了...', '真是的，必需的祭品都还没准备好！', 'badge-input', 'http://sharkpan.xyz/f/djyi8/1en214.jpg', 'EvpRI', 'blob', '\x22>\x20', '/v1beta/models/', 'olige', '至少要保留一个用户。', 'chat-image-button', 'mhkHA', 'KtiTB', 'push', 'https://i.pinimg.com/736x/16/f9/05/16f9051f99471208ee9c658aa4618eb6.jpg', 'vAnSA', 'galgame', 'key', 'style', 'hEqPB', 'isPlaying', 'galgame-sprite', '确定要删除群聊“', 'add-friend-circle-button', 'phone-container', 'aCBCp', 'YkoOi', 'YUEfY', 'friend-circle-list-screen', 'char-edit-css', 'http://sharkpan.xyz/f/wjgHq/yznfhq.jpg', 'edit-message-button', 'fHBlo', '\x20|\x20', 'HikFQ', '</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'vqAlN', 'artist', 'amgTt', '75%', 'http://sharkpan.xyz/f/jj6s6/yd5bpb.jpg', '正在迁移旧的动态数据到新的好友圈系统...', '好友圈名称不能为空！', '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>', 'private', 'McxnJ', 'splice', 'entries', 'transaction', 'currentTime', 'http://sharkpan.xyz/f/nj7ul/r48eum.jpg', 'translateX(-50%)', '\x0a\x0a##\x20世界书条目:\x20', 'left', 'IndexedDB\x20failed\x20to\x20open', 'arvlv', 'RiWoP', 'ZIATD', '”，但没找到人)', 'http://sharkpan.xyz/f/1zQH2/o84boo.jpg', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>', 'string', 'meetingViewMode', 'User\x20cancelled', '切，加载播放器状态的时候出错了。', 'PvEFh', 'center', 'oFaTv', 'xARpy', '超激动我来了', '刚刚发布了一条动态，内容是：“', 'chat_', 'quote-preview-sender', '\x0a\x20\x20\x20\x20<div\x20class=\x22music-post-song-card\x22\x20data-music-id=\x22', 'lt-ui-cover-art', 'mouseleave', '#\x20当前活动：一起听歌\x0a\x0a\x20\x20\x20\x20\x20\x20\x20你们正在一起听\x20', '点击选择\x20.mp3\x20或\x20.flac', 'UuBOJ', 'char-edit-remark', 'altar-slot-cover', 'CGteB', 'image', 'textShadow', 'gIdSr', 'http://sharkpan.xyz/f/JYJhg/s3wmlj.jpg', 'image_url', 'char-edit-name', 'uhRIe', 'time', 'OdNMZ', 'displayedMessageCount', 'amount', 'music-widget', '用户资料已保存！', '\x20之间的私密内容)\x0a', '-preview', 'vMkeG', 'role', '\x20个成员', '确定要删除这个用户吗？与此用户绑定的聊天将恢复为默认用户。', 'meetingList', '升级已取消。旧版图片数据可能导致应用卡顿或出错。', 'WvRgI', '我不想工作', 'MRhuV', 'oRaNi', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>', 'object', 'ebHpx', 'gybTH', 'OMWgO', 'IQZAn', '音乐搜索失败:\x20', 'flypB', 'delete-friend-circle-button', '新建条目', 'song_', '[用户分享了音乐：', 'sVPKj', 'author', 'qFUae', 'reset-card-button', 'yJUcy', 'chat-send-button', 'qWrUn', 'group_bg_', 'system', 'TGfwl', 'http://sharkpan.xyz/f/VG2FY/uucfvv.jpg', '暗夜紫晶', 'message-image-content', 'character-edit-screen', '保存徽章状态失败', 'hmprv', '未知用户', 'AaTlh', '.remove-attachment-btn', 'gQkEC', 'UDRZP', '\x20说：“', 'cdXlD', 'yBojl', '>>\x20', 'chatHistory_', '587774Yldqmb', '.selected-options-text', 'kUdkK', 'http://sharkpan.xyz/f/rjpu6/ojpa0c.jpg', '\x0a\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-select-', 'custom-icon-list-container', 'now', 'getItem', 'diary-write-button', 'chat-sticker-panel', '8px', '<p\x20class=\x22music-post-thought\x22>', 'sticker-item', ',\x20ID:\x20', 'diary-page', 'getFullYear', 'value', 'api-model', 'upload-music-button', 'dvELt', 'some', 'XACUs', 'authorId', 'backgroundImage', 'paused', 'removeItem', '4130910etMCcU', 'is-visible', 'gjtJh', '”的角色，现在需要写一篇交换日记。\x0a-\x20**你的读者**:\x20', 'group-clear-history', 'fCNWC', 'pCzrF', 'tblCk', 'iZctW', 'OrHAk', 'nrCbc', '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'delete-message-button', 'touchend', 'meeting-view-screen', 'musicUploadAltar', '\x22\x20class=\x22music-share-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'smooth', 'oYUoV', 'yIORS', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20', 'appIconPosition_app-diary', 'izSyO', 'endsWith', 'http://sharkpan.xyz/f/mjdFW/28n30c.jpg', 'UmrIh', 'sCmvL', '38%', 'NMtYO', 'fPVWE', '\x22\x20中发现一张需要净化的图片...', 'music-widget-card', 'createObjectURL', 'reset-widget-bg-button', '\x0a#\x20最近的动态回顾\x20(供参考，避免重复)\x0a', '正在解析备份文件...', '5px', 'pmoiX', 'openai', 'message-container', 'OxAxm', 'KHfvz', 'save-custom-stickers-button', 'kind', 'sRoEK', 'normal,\x20happy,\x20angry,\x20sad,\x20shy', 'FXwVa', '0\x202px\x208px\x20rgba(0,0,0,0.4)', 'bcbES', 'xUpdY', '\x22>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '.app-icon-img', 'map', 'edit-current-circle-button', 'Vabvk', '\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#dc3545;\x22>删除这篇日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'ZgAPF', 'replaceAll', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>', 'iZufZ', '\x20.app-icon-img,\x20#app-dock-top-right\x20#', 'AI返回的不是一个数组。', 'worldBookEditor', 'oncomplete', '---\x20Noir\x27s\x20Friend\x20Circle\x20Purification\x20Ritual\x20---', 'widget-play-pause-btn', '77205MHilfk', 'user-avatar-preview', 'beforeend', 'div', 'UrZrA', 'line', 'characterLastScripts', 'AbortError', 'ajDXL', '\x22\x20class=\x22char-avatar\x22\x20style=\x22border-radius:\x2012px;\x20background-color:\x20#eee;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22\x20style=\x22flex-grow:\x201;\x22>', 'Failed\x20to\x20save\x20state\x20to\x20localStorage:', 'href', '100xlpQWX', 'csWRE', ']\x20这五个词中选择一个。例如，如果台词表达了哀伤或失望，就必须选择\x20\x27sad\x27。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。\x0a\x20\x20\x20\x20\x20-\x20\x27normal\x27:\x20平常、平静、没有特殊情绪。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27happy\x27:\x20开心、喜悦、愉快。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27angry\x27:\x20生气、愤怒、不满。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27sad\x27:\x20悲伤、哀愁、失落、心里难受。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27shy\x27:\x20害羞、不好意思、脸红。\x0a\x20\x20\x20\x203.\x20\x20`line`字段：具体的台词或描写。\x0a\x20\x20-\x20**绝对禁止**:\x20严禁输出任何JSON数组之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a\x20\x20\x20\x204.\x20旁白的内容可以尽可能多，以轻小说的风格，尽可能像一本小书一样，补全周边环境，角色内心的看法，角色的行为等一切。\x0a\x20\x20\x20\x20', 'lFaQv', 'YKOwl', '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>', 'http://sharkpan.xyz/f/7aMhj/hyc75m.jpg', '小组件背景已恢复默认。', '保存播放器状态失败，真是没用。', 'anUWv', 'diary-list-screen', 'add-user-profile-button', '\x0a\x20[歌词结束]\x0a\x0a\x20请根据当前播放的歌词和对话氛围，自然地作出回应。\x0a\x20\x20\x20', 'bsZap', 'toString', '\x0a#\x20当前情景\x0a', 'position', 'HbgZY', 'YSQdS', 'borderRadius', 'DKHig', '</div>\x0a\x20\x20\x20\x20', 'message-anchor', '\x0a#\x20最近的朋友圈动态\x20(供你参考)\x0a']; _0x49a3 = function () { return _0x2563dc; }; return _0x49a3(); } async function _0x427170(_0x53a00d) { const _0xe98078 = await _0x5656bf; return new Promise((_0x323438, _0x338b57) => { const _0x20d2e8 = _0x52f2, _0x5bdf40 = _0xe98078[_0x20d2e8(0x62e)](_0x11ca7f, _0x20d2e8(0x1e1)), _0x4f539f = _0x5bdf40[_0x20d2e8(0x20b)](_0x11ca7f), _0x2febf7 = _0x4f539f[_0x20d2e8(0x588)](_0x53a00d); _0x2febf7[_0x20d2e8(0x468)] = () => _0x323438(), _0x2febf7[_0x20d2e8(0x464)] = () => _0x338b57(_0x2febf7['error']); }); } function _0x4366c2(_0x3d114e) { const _0x22aeb4 = _0x3145f6; return fetch(_0x3d114e)[_0x22aeb4(0x73a)](_0x47d396 => _0x47d396['blob']()); }


  </script>
  <div id="listen-together-ui" style="display: none;">
    <div class="lt-ui-backdrop"></div>
    <div class="lt-ui-main">
      <div class="lt-ui-header">
        <span id="lt-ui-header-title">正在与 TA 一起听</span>
        <button id="lt-ui-close-btn">×</button>
      </div>
      <div class="lt-ui-content">
        <div class="lt-ui-cover-container">
          <img id="lt-ui-cover-art" src="">
        </div>
        <div class="lt-ui-info">
          <h2 id="lt-ui-song-title">歌曲名称</h2>
          <p id="lt-ui-song-artist">歌手</p>
        </div>
        <div id="lt-ui-lyrics-container">
          <p class="no-lyrics-placeholder">暂无歌词</p>
        </div>
      </div>
    </div>
  </div>
</body>


</html>
